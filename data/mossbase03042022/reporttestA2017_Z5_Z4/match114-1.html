<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/A2017/Z5/Z4/student7795.c</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/A2017/Z5/Z4/student9499.c<p></p><pre>
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

#define ARTIKLI		"artikli.bin"
#define PRODAVNICE		"prodavnice.txt"
#define SIZE			100

/* structures */
<a name="0"></a><font color="#FF0000"><a href="match114-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_99.gif"/></a>

struct Prodavnica {
	char naziv[SIZE];
	int ID;				
};

struct Artikal {
	char naziv[SIZE];
	double cijena;
	int prodavnica;		
};

/* functions to implement */
int ucitaj_artikle (struct Artikal *niz, int kap) {
	int i = 0;
	FILE* file = fopen(ARTIKLI, "rb");
	if(!file) return 0;
	i = fread(niz, sizeof(struct Artikal), kap, file);
	fclose(file);
	return i;
}

int ucitaj_prodavnice (struct Prodavnica *niz, int kap) {
	struct Prodavnica heap;
	char c;
	int i = 0, _pos = 0;
	
	FILE* file = fopen(PRODAVNICE, "rb");
	if(!file) return 0;
	
	while(i &lt; kap) {
		/* start reading */
		_pos = 0;
		while((_pos &lt; SIZE-1) &amp;&amp; ((c = fgetc(file)) != ','))
			heap.naziv[_pos++] = c;
		heap.naziv[_pos] = '\0';
		
		/* in case of overflow */
		if(_pos+1 == SIZE) {
			c = getc(file);
			while((c != ',') &amp;&amp; (c != EOF) &amp;&amp; (c != '\n'))
				c = getc(file);
		} 
		
		if(fscanf(file, "%d\n", &amp;heap.ID) == 1)
			niz[i++] = heap; 
		else break;
	}

	fclose(file);
	return i;
}


int izbaci_skupe (struct Prodavnica *p, int np, struct Artikal *a, int na) {
	double _midProd = 0.0, _average = 0.0;
	int _numProd = 0, _artNum = 0;
	int i = 0, j = 0;
	/* find average price of all products */
	for(i = 0; i &lt; na; i++) {
		_midProd += a[i].cijena;
		_numProd++;
	}
	if(_numProd &gt; 0)
		_midProd /= _numProd;
	
	/* find average product price in shop */
	for(i = 0; i &lt; np; i++) {
		_artNum = 0;
		_average = 0.0;
		for(j = 0; j &lt; na; j++) {
			if(p[i].ID == a[j].prodavnica) {
				_average += a[j].cijena;
				_artNum++;
			}
		}
		if(_artNum &gt; 0)
			_average /= _artNum;
		if(_average &gt; _midProd) {
			/* remove this one from stack */
			for(j = i; j &lt; np-1; j++) 
				p[j] = p[j+1];
			np--;
			i--;
		}
	}
	
	return np;
}

int sacuvaj (struct Prodavnica *p, int n, const char *ime_datoteke) {
	/* initial */
	FILE *file;
	int i, check = 0;
	
	/* can't read file */
	file = fopen(ime_datoteke, "wb");
	if(file == NULL)
		return 0;
		
	/* start writing in file, byte by byte */
	for(i = 0; i &lt; n; i++) {
		check = fwrite(p[i].naziv, SIZE, 1, file);
		check += fwrite(&amp;p[i].ID, sizeof(int), 1, file);
		if(check != 2) {
			fclose(file);
			return 0;
		}
	}
	fclose(file);
	return 1;
}

int main() {
</font>	return 0;
}
</pre>
</body>
</html>
