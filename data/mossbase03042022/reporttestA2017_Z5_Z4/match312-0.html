<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/A2017/Z5/Z4/student7933.c</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/A2017/Z5/Z4/student7933.c<p></p><pre>
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt; 

typedef struct Prodavnica {
	char naziv[100];
	int ID;	
} Prodavnica;

typedef struct Artikal {
	char naziv[100];
	double cijena;
	int prodavnica;
} Artikal;

int ucitaj_artikle (struct Artikal *niz, int kap){
	
	FILE* ulaz = fopen("artikli.bin", "rb");
	
	if(!ulaz){
		printf("Greska prilikom ucitavanja datoteke \"artikli.bin!\"");
		exit(1);
	}
	
	int i = 0;
	Artikal temp;
	
	//Ucitaj kap artikala iz "artikli.bin"
	while(i &lt; kap &amp;&amp; fread(&amp;temp, sizeof(Artikal), 1, ulaz)){
		if(ferror(ulaz)){
			printf("Doslo je do greske prilikom citanja iz \"artikli.bin\"!");
			exit(1);
		}
		
		*(niz+i) = temp;
		
		i++;
	}
	
	fclose(ulaz);
	
	return i;
}

int ucitaj_prodavnice (struct Prodavnica *niz, int kap){
	
	FILE* ulaz = fopen("prodavnice.txt", "r");
	
	if(!ulaz){
		printf("Greska prilikom ucitavanja datoteke \"prodavnice.txt\"!");
		exit(1);
	}
	
	int i = 0, j = 0;
	Prodavnica temp;
	
	char c, strLen;
	
	//Ucitaj kap prodavnica iz "prodavnice.txt"
	while(i &lt; kap){
		//Ucitaj string do ','
		j = 0;

		while(1){
			c = fgetc(ulaz);
			
			if(c == ',' || c == EOF) break;
				
			if(j &lt; 99){
				*(temp.naziv+j) = c;
				strLen = j;
			}
			
			j++;
		}
		
		*(temp.naziv + strLen + 1) = '\0';
		
		c = fscanf(ulaz, "%d\n", &amp;temp.ID);
		
		if(c != 1) break;
		
		//printf("Prodavnica: %s : %d\n", temp.naziv, temp.ID);
		*(niz+i) = temp;
		i++;
	}
	
	fclose(ulaz);
	
	return i;
}

int izbaci_skupe (struct Prodavnica *p, int np, struct Artikal *a, int na){
	int i, j;
	double avg_svih = 0;
	double avg_prod = 0;
	int br_poizvoda;
	
	//Srednja vrijednost svih artikala svih prodavnica
	for(i = 0; i &lt; na; i++){
		avg_svih += a[i].cijena;
	}
	avg_svih /= na;
	
<a name="1"></a><font color="#00FF00"><a href="match312-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_11.gif"/></a>

	for(i = 0; i &lt; np; i++){
		//Pocetne vrijednosti su na nuli za svaku prodavnicu
		br_poizvoda = 0;
		avg_prod = 0;
		
		//Racunaj srednju svih proizvoda i-te prodavnice
		for(j = 0; j &lt; na; j++){
			//Ako prodavnica u kojoj je artikal odgovara ID-u i-te prodavnice, povecaj broj artikala
			//i odmah uracunaj cijenu tog proizvoda u avg_prod
			if(a[j].prodavnica == p[i].ID){
				avg_prod += a[j].cijena;
				br_poizvoda++;
			}
		}
		
		//Nema proizvoda u ovoj prodavnici
		if(br_poizvoda == 0) continue;
		
		//Sracunaj srednju vrijednost
		avg_prod /= br_poizvoda;
</font>		
		//Ako je veca od avg_svih, izbaci i-tu prodavnicu
<a name="0"></a><font color="#FF0000"><a href="match312-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_11.gif"/></a>

		if(avg_prod &gt; avg_svih){
			
			for(j = i; j &lt; np - 1; j++){
				p[j] = p[j+1];
			}
			np--;
			i--;
		}
	}
	
	return np;
}

int sacuvaj (struct Prodavnica *p, int n, const char *ime_datoteke){
	
	FILE* izlaz = fopen(ime_datoteke, "wb");
	
	if(!izlaz){
</font>		return 0;
	}

	fwrite(p, sizeof(Prodavnica), n, izlaz);
	
	if(ferror(izlaz)) return 0;
	
	fclose(izlaz);
	
	return 1;
}

int main() {
	
	Prodavnica prod[10];
	int np = 4, i;
	
<a name="2"></a><font color="#0000FF"><a href="match312-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_5.gif"/></a>

	np = ucitaj_prodavnice(prod, np);
	
	for(i = 0; i &lt; np; i++){
		printf("-&gt;%s, %d\n", prod[i].naziv, prod[i].ID);
</font>	}
	
	return 0;
}

/*
	FILE* izlaz = fopen("artikli.bin", "wb");
	
	if(!izlaz){
		return 0;
	}

	Artikal art[10] = {
		{"Brasno", 5.2, 1},
		{"Ulje", 2, 1},
		{"Secer", 1.5, 1},
		
		{"Brasno", 5.2, 2},
		{"Ulje", 2.1, 2},
		{"Secer", 2.2, 2},
		
		{"Brasno", 5.2, 3},
		{"Ulje", 1.1, 3},
		{"Secer", 1.2, 3},
		{"Grah", 5, 3}
	};

	fwrite(art, sizeof(Artikal), 10, izlaz);
	
	if(ferror(izlaz)) return 0;
	
	fclose(izlaz);
*/</pre>
</body>
</html>
