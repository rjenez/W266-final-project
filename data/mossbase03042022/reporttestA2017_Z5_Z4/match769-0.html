<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/A2017/Z5/Z4/student2009.c</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/A2017/Z5/Z4/student2009.c<p></p><pre>
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;math.h&gt;
#include &lt;limits.h&gt;
FILE*artikli;
FILE*prodavnice;

struct Prodavnica {
	char naziv[100];
	int ID;
};

struct Artikal {
	char naziv[100];
	double cijena;
	int prodavnica;
};


int ucitaj_artikle(struct Artikal *niz, int kap)
{
	int ucitani;
	artikli=fopen("artikli.bin","rb");

	if(!artikli) /* Greska u otvaranju? artikli - NULL*/
		exit(1);

	ucitani=fread(niz,sizeof(struct Artikal),kap,artikli);
	fclose(artikli);
	return ucitani;
}

int ucitaj_prodavnice(struct Prodavnica *niz, int kap)
{
	int i=0;
	int j=-1;
	prodavnice=fopen("prodavnice.txt","r");

	if(!prodavnice) /* Greska u otvaranju? prodavnice - NULL */
		exit(1);

	do {

<a name="0"></a><font color="#FF0000"><a href="match769-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_10.gif"/></a>

		j=-1;
		do {
			if(j&lt;99) j++;
			niz[i].naziv[j] = fgetc(prodavnice);
		} while(niz[i].naziv[j]!=',' &amp;&amp; niz[i].naziv[j]!=EOF);

		niz[i].naziv[j]='\0';
		if(fscanf(prodavnice,"%d\n",&amp;niz[i].ID)==0) break;
</font>		i++;

	} while(!feof(prodavnice) &amp;&amp; i&lt;kap);

	fclose(prodavnice);
	return i;
}

int izbaci_skupe(struct Prodavnica *p, int np, struct Artikal *a, int na)
{
	double suma_svih=0.0, prosjek_svih;
	double suma_temp=0.0, prosjek_temp;
	int i=0,j=0,k=0;
	int valid=0;

	do {
		j=0;

		do {
			if(p[i].ID==a[j].prodavnica) {  /* Da li je izbacivanje uopste potrebno? */
				valid=1;  /* ID-ovi prodavnica odgovaraju ID-u kod artikala */
				break;
			}
			j++;
		} while(j&lt;na);

		i++;
	} while(i&lt;np);

	if(!valid) return np;

	i=0;
	j=0;
	do {
		suma_svih+=a[i].cijena;
		j++;
		i++;
	} while(i&lt;na);

	prosjek_svih=suma_svih/j;

	i=0;
	j=0;
	do {
		do {
			if(p[i].ID==a[j].prodavnica) {
				suma_temp+=a[j].cijena;
				k++;
			}
			j++;
		} while(j&lt;na);

<a name="1"></a><font color="#00FF00"><a href="match769-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_4.gif"/></a>

		prosjek_temp=suma_temp/k;
		if(prosjek_temp&gt;prosjek_svih) {
			for(k=i; k&lt;np-1; k++) {
				p[k]=p[k+1];
</font>			}
			i--;
			np--;
		}

		k=0;
		j=0;
		i++;
		suma_temp=0.0;
	} while(i&lt;np);

	return np;
}

int sacuvaj (struct Prodavnica *p, int n, const char *ime_datoteke)
{
	artikli=fopen(ime_datoteke,"wb");

	if(!artikli) return 0;

	fwrite(p,sizeof(struct Prodavnica),n,artikli);
	if(ferror(artikli)) return 0;
	fclose(artikli);

	return 1;
}


int main()
{
	FILE *fa, *fb;
	int i;
	struct Prodavnica p[] = {
		{"Amko", 1},
		{"Amko", 2},
		{"Amko", 3},
		{"Bingo Tuzla", 10},
		{"Bingo Konjic", 11},
		{"Bingo Pofalici", 12},
		{"Konzum", 20},
		{"Konzum ZG", 21},
	}, v[12];

	printf ("Uspjesno: %d\n", sacuvaj(p, 8, "prod1.bin"));
	printf ("Uspjesno: %d\n", sacuvaj(p, 4, "prod2.bin"));
	printf ("Spaseno:\n");

	fa = fopen ("prod1.bin", "rb");
	fb = fopen ("prod2.bin", "rb");

	for (i = 0; i &lt; 12; ++i)
		fread (v + (i &lt; 8 ? i : i), sizeof *v, (i &gt; 8 ? 1 : (i &lt; 8 ? 1 : 1)), i &lt; 8 ? fa : fb);
	for (i = 0; i &lt; 12; ++i)
		printf ("'%s', ID: %d\n", (v + i)-&gt;naziv, v[i].ID);
	fclose (fa);
	fclose (fb);

	return 0;
}</pre>
</body>
</html>
