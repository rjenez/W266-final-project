<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z3/Z6/student5881.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z3/Z6/student5881.cpp<p></p><pre>
<a name="1"></a><font color="#00FF00"><a href="match445-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

/B2017/2018: Zadaća 3, Zadatak 4
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;utility&gt;
#include &lt;map&gt;
#include &lt;stdexcept&gt;
#include &lt;stack&gt;
#include &lt;memory&gt;

enum class Boje
{
    Pik, Tref, Herc, Karo
};

struct Karta {
    Boje boja;
    std::string vrijednost;
};

struct Cvor {
    Karta karta;
    std::shared_ptr&lt;Cvor&gt; sljedeci;
</font>};

<a name="2"></a><font color="#0000FF"><a href="match445-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

const std::string imena[13] = {"2", "3", "4", "5", "6", "7", "8", "9", "10", "J", "Q", "K", "A"};


std::shared_ptr&lt;Cvor&gt; KreirajSpil()
</font>{
    std::shared_ptr&lt;Cvor&gt; pocetak(nullptr);
    std::shared_ptr&lt;Cvor&gt; prethodni;
    for (int i = 0; i &lt; 4; i++) {
        Boje boja;
        if (i==0)
            boja=Boje::Pik;
        else if (i==1)
            boja=Boje::Tref;
        else if (i==2)
            boja=Boje::Herc;
        else
            boja=Boje::Karo;
        for (int br=0; br!=13; br++) {
            Karta pom {boja, imena[br]};
            std::shared_ptr&lt;Cvor&gt; novi = std::shared_ptr&lt;Cvor&gt;(new Cvor {pom, nullptr}); // Kreiranje novog čvora
            if(!pocetak) pocetak = novi; // Prvi čvor...
            else prethodni-&gt;sljedeci = novi; // Svi osim prvog...
            prethodni = novi;
        }
    }
    prethodni-&gt;sljedeci=pocetak;
    return pocetak;
}


int BrojKarti(std::shared_ptr&lt;Cvor&gt; pocetak)
{
    int br(0);
    if (!pocetak)
        return br;
    Karta prva(pocetak-&gt;karta);
    br++;
    std::shared_ptr&lt;Cvor&gt; p(pocetak);
    p = p-&gt;sljedeci;
    for(; p!=pocetak ; p = p-&gt;sljedeci)
        br++;
    return br;
}


bool SpilValja(std::shared_ptr&lt;Cvor&gt; pocetak)
{
    if (BrojKarti(pocetak)&gt;52)
        return false;
    if (!pocetak)
        return true;
    auto p(pocetak);
    if (p-&gt;karta.boja!=Boje::Pik &amp;&amp; p-&gt;karta.boja!=Boje::Tref &amp;&amp; p-&gt;karta.boja!=Boje::Herc &amp;&amp; p-&gt;karta.boja!=Boje::Karo)
        return false;
    int i(0);
    for (; i &lt; 13; i++)
        if (p-&gt;karta.vrijednost==imena[i])
            break;
    if (i==13)
        return false;
    p = p-&gt;sljedeci;
    for (; p!=pocetak; p = p-&gt;sljedeci) {
        if (p-&gt;karta.boja!=Boje::Pik &amp;&amp; p-&gt;karta.boja!=Boje::Tref &amp;&amp; p-&gt;karta.boja!=Boje::Herc &amp;&amp; p-&gt;karta.boja!=Boje::Karo)
            return false;
        for (i=0; i &lt; 13; i++)
            if (p-&gt;karta.vrijednost==imena[i])
                break;
        if (i==13)
            return false;
    }
    if (BrojKarti(pocetak)&lt;=1)
        return true;
    p=pocetak;
    auto prethodni(p);
    Boje pocetna_boja(p-&gt;karta.boja);
    Boje sljedeca_boja(Boje::Karo);
    if (pocetna_boja==Boje::Pik)
        sljedeca_boja=Boje::Tref;
    else if (pocetna_boja==Boje::Tref)
        sljedeca_boja=Boje::Herc;
    else if (pocetna_boja==Boje::Herc)
        sljedeca_boja=Boje::Karo;
    int pocetni_indeks(0);
    for (i = 0; i &lt; 13; i++) {
        if (prethodni-&gt;karta.vrijednost==imena[i]) {
            pocetni_indeks=i;
            break;
        }
    }
    p = p-&gt;sljedeci;
    for (; p!=pocetak; p=p-&gt;sljedeci) {
        if (p-&gt;karta.boja!=prethodni-&gt;karta.boja) {
            if (p-&gt;karta.boja!=sljedeca_boja)
                return false;

            pocetna_boja=p-&gt;karta.boja;
            sljedeca_boja=Boje::Karo;
            if (pocetna_boja==Boje::Pik)
                sljedeca_boja=Boje::Tref;
            else if (pocetna_boja==Boje::Tref)
                sljedeca_boja=Boje::Herc;
            else if (pocetna_boja==Boje::Herc)
                sljedeca_boja=Boje::Karo;
            pocetni_indeks=0;
        } else {
            int sljedeci_indeks(0);
            for (i = 0; i &lt; 13; i++) {
                if (p-&gt;karta.vrijednost==imena[i]) {
                    sljedeci_indeks=i;
                    break;
                }
            }
            if (pocetni_indeks&gt;=sljedeci_indeks)
                return false;
            pocetni_indeks=sljedeci_indeks;
        }
        prethodni=prethodni-&gt;sljedeci;
    }

    return true;
}


void IzbaciKarte(std::shared_ptr&lt;Cvor&gt; &amp;pocetak, std::multimap&lt;Boje, std::string&gt; &amp;karte)
{
    if (!SpilValja(pocetak))
        throw std::logic_error("Neispravna lista!");
    if (!pocetak)
        return;
    auto p(pocetak);
    auto prethodni(pocetak);
    p = p-&gt;sljedeci;
    bool izbrisao(false);
    for(int jos_jedan(0); jos_jedan!=1; jos_jedan++) {
        for (; ; p = p-&gt;sljedeci) {
            for (auto it2(karte.begin()); it2 != karte.end(); it2++) {
                if (p-&gt;karta.boja==it2-&gt;first &amp;&amp; p-&gt;karta.vrijednost==it2-&gt;second) {
                    if (BrojKarti(pocetak)==1) {
                        pocetak-&gt;sljedeci=nullptr;
                        pocetak=nullptr;
                        it2=karte.erase(it2);
                        return;
                    } else {
                        prethodni-&gt;sljedeci=p-&gt;sljedeci;
                        if (p==pocetak)
                            pocetak=prethodni-&gt;sljedeci;
                        p=prethodni;
                        izbrisao=true;
                        it2=karte.erase(it2);
                        if (it2==karte.begin())
                            break;
                    }
                }
            }
            if (p==pocetak || jos_jedan==1) {
                if (izbrisao) {
                    izbrisao=false;
                    continue;
                }
                break;
            }
            if (!izbrisao)
                prethodni=prethodni-&gt;sljedeci;
            else
                izbrisao=false;
        }
    }
}



<a name="3"></a><font color="#00FFFF"><a href="match445-1.html#3" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

std::stack&lt;std::pair&lt;std::string, std::string&gt;&gt; IzbaciKarteRazbrajanjem(std::shared_ptr&lt;Cvor&gt; &amp;pocetak, short int &amp;r, const int &amp;b)
</font>{
    std::stack&lt;std::pair&lt;std::string, std::string&gt;&gt; rez;
    if (r&lt;1 || r&gt;52 || b&lt;1)
        throw std::logic_error("Neispravni elementi za izbacivanje!");
    if (!SpilValja(pocetak))
        throw std::logic_error("Neispravna lista!");
    if (!pocetak)
        return rez;
    int br(1), br_izbacenih(0);
    auto p(pocetak);
    auto prethodni(pocetak);
    while (prethodni-&gt;sljedeci!=pocetak)
        prethodni=prethodni-&gt;sljedeci;
    bool izbrisao(false);
    for (; ; p = p-&gt;sljedeci) {
        if (br==r) {
            switch (p-&gt;karta.boja) {
            case Boje::Pik :
                rez.push(std::make_pair("Pik", p-&gt;karta.vrijednost));
                break;
            case Boje::Tref :
                rez.push(std::make_pair("Tref", p-&gt;karta.vrijednost));
                break;
            case Boje::Herc :
                rez.push(std::make_pair("Herc", p-&gt;karta.vrijednost));
                break;
            case Boje::Karo :
                rez.push(std::make_pair("Karo", p-&gt;karta.vrijednost));
                break;
            }
            if (BrojKarti(pocetak)==1) {
                pocetak-&gt;sljedeci=nullptr;
                pocetak=nullptr;
                return rez;
            } else {
                prethodni-&gt;sljedeci=p-&gt;sljedeci;
                if (p==pocetak)
                    pocetak=prethodni-&gt;sljedeci;
                p=prethodni;
                izbrisao=true;
            }
            br_izbacenih++;
            if (br_izbacenih==b)
                break;
            br=0;
        }
        br++;
        if (!izbrisao)
            prethodni=prethodni-&gt;sljedeci;
        else
            izbrisao=false;
    }
    return rez;
}


bool StekValja(std::stack&lt;std::pair&lt;std::string, std::string&gt;&gt; red)
{
    while(!red.empty()) {
        if (red.top().first!="Pik" &amp;&amp; red.top().first!="Tref" &amp;&amp; red.top().first!="Herc" &amp;&amp; red.top().first!="Karo")
            return false;
        int i(0);
        for (; i &lt; 13; i++)
            if (red.top().second==imena[i])
                break;
        if (i==13)
            return false;
        red.pop();
    }
    return true;
}


void IspisiSpil(std::shared_ptr&lt;Cvor&gt; pocetak)
{
    std::cout &lt;&lt; "U spilu trenutno ima " &lt;&lt; BrojKarti(pocetak) &lt;&lt; " karata, i to: " &lt;&lt; std::endl;
    if (BrojKarti(pocetak)==0) {
        std::cout &lt;&lt; "Pik:" &lt;&lt; std::endl &lt;&lt; "Tref:" &lt;&lt; std::endl &lt;&lt; "Herc:" &lt;&lt; std::endl &lt;&lt; "Karo:" &lt;&lt; std::endl;
        return;
    }
    Karta prva(pocetak-&gt;karta);
    for (int i = 0; i &lt; 4; i++) {
        bool sami_pocetak(true);
        std::shared_ptr&lt;Cvor&gt; p(pocetak);
        bool sljedeci(false);
        Boje boja;
        if (i==0) {
            std::cout &lt;&lt; "Pik:";
            boja=Boje::Pik;
        } else if (i==1) {
            std::cout &lt;&lt; "Tref:";
            boja=Boje::Tref;
        } else if (i==2) {
            std::cout &lt;&lt; "Herc:";
            boja=Boje::Herc;
        } else {
            std::cout &lt;&lt; "Karo:";
            boja=Boje::Karo;
        }
        for (; sami_pocetak || p!=pocetak ; p = p-&gt;sljedeci) {
            sami_pocetak=false;
            if (p-&gt;karta.boja==boja) {
                std::cout &lt;&lt; " " &lt;&lt; p-&gt;karta.vrijednost;
                sljedeci=true;
            } else if (sljedeci)
                break;
        }
        std::cout &lt;&lt; std::endl;
    }
}


<a name="0"></a><font color="#FF0000"><a href="match445-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_2.gif"/></a>

void VratiPosljednjihNKarata(std::shared_ptr&lt;Cvor&gt; &amp;pocetak, std::stack&lt;std::pair&lt;std::string, std::string&gt;&gt; &amp;red, int n)
{
    if (n&lt;0)
        throw std::domain_error("Broj n je besmislen!");
    if (n&gt;red.size())
        throw std::range_error("Nedovoljno karata u steku!");
</font>    if (!StekValja(red))
        throw std::logic_error("Neispravne karte!");
    if (!SpilValja(pocetak))
        throw std::logic_error("Neispravna lista!");

    while(n!=0) {
        Boje b(Boje::Pik);
        if (red.top().first=="Tref")
            b=Boje::Tref;
        else if (red.top().first=="Herc")
            b=Boje::Herc;
        else if (red.top().first=="Karo")
            b=Boje::Karo;
        if (!pocetak) {
            Karta pom {b, red.top().second};
            try {
                pocetak = std::shared_ptr&lt;Cvor&gt;(new Cvor {pom, nullptr}); // Kreiranje novog čvora
            } catch (...) {
                throw;
            }
            pocetak-&gt;sljedeci=pocetak;
            red.pop();
            n--;
            continue;
        }
        auto p(pocetak);
        int br(BrojKarti(pocetak));
        while (p-&gt;karta.boja!=b) {
            p = p-&gt;sljedeci;
            br--;
            if (br==0)
                break;
        }
        if (br==0 &amp;&amp; b==Boje::Pik)
            p = pocetak;
        else if (br==0) {
            if (b==Boje::Tref) {
                br=BrojKarti(pocetak);
                p=pocetak;
                while (p-&gt;karta.boja==Boje::Pik) {
                    p = p-&gt;sljedeci;
                    br--;
                    if (br==0)
                        break;
                }
                if (br==0)
                    p=pocetak;
            } else if (b==Boje::Herc) {
                br=BrojKarti(pocetak);
                p=pocetak;
                while (p-&gt;karta.boja==Boje::Tref || p-&gt;karta.boja==Boje::Pik) {
                    p = p-&gt;sljedeci;
                    br--;
                    if (br==0)
                        break;
                }
                if (br==0)
                    p=pocetak;
            } else if (b==Boje::Karo) {
                br=BrojKarti(pocetak);
                p=pocetak;
                while (p-&gt;karta.boja==Boje::Herc || p-&gt;karta.boja==Boje::Tref || p-&gt;karta.boja==Boje::Pik) {
                    p = p-&gt;sljedeci;
                    br--;
                    if (br==0)
                        break;
                }
                if (br==0)
                    p=pocetak;
            }
        }
        int j(0), k(0);
        for (; j &lt; 13; j++)
            if (red.top().second==imena[j])
                break;
        auto prethodni(p);
        while (prethodni-&gt;sljedeci!=p)
            prethodni=prethodni-&gt;sljedeci;
        do {
            for (; k &lt; 13; k++)
                if (p-&gt;karta.vrijednost==imena[k])
                    break;
            if (k&gt;=j) {
                if (p-&gt;karta.boja==b &amp;&amp; p-&gt;karta.vrijednost==red.top().second)
                    break;
                Karta pom {b, red.top().second};
                std::shared_ptr&lt;Cvor&gt; novi=nullptr;
                try {
                    novi = std::shared_ptr&lt;Cvor&gt;(new Cvor {pom, nullptr}); // Kreiranje novog čvora
                } catch (...) {
                    pocetak-&gt;sljedeci=nullptr;
                    pocetak=nullptr;
                    throw;
                }
                novi-&gt;sljedeci=p;
                prethodni-&gt;sljedeci=novi;
                if (p==pocetak)
                    pocetak=novi;
                break;
            }
            prethodni=p;
            p = p-&gt;sljedeci;
            if (BrojKarti(pocetak)==1 || p-&gt;karta.boja!=b) {
                Karta pom {b, red.top().second};
                std::shared_ptr&lt;Cvor&gt; novi=nullptr;
                try {
                    novi = std::shared_ptr&lt;Cvor&gt;(new Cvor {pom, nullptr}); // Kreiranje novog čvora
                } catch (...) {
                    pocetak-&gt;sljedeci=nullptr;
                    pocetak=nullptr;
                    throw;
                }

                if (prethodni==pocetak) {
                    novi-&gt;sljedeci=prethodni;
                    auto preprethodni(prethodni);
                    while (preprethodni-&gt;sljedeci!=prethodni)
                        preprethodni=preprethodni-&gt;sljedeci;
                    preprethodni-&gt;sljedeci=novi;
                    break;
                }
                novi-&gt;sljedeci=p;
                prethodni-&gt;sljedeci=novi;
                break;
            }
        } while (true);
        red.pop();
        n--;
    }

}


int main ()
{
    auto spil(KreirajSpil());
    short int r;
    int b;
    std::cout &lt;&lt; "Unesite korak razbrajanja: ";
    std::cin &gt;&gt; r;
    std::cout &lt;&lt; "Unesite broj karata koje zelite izbaciti: ";
    std::cin &gt;&gt; b;
    std::stack&lt;std::pair&lt;std::string, std::string&gt;&gt; red;
    try {
        red=IzbaciKarteRazbrajanjem(spil, r ,b);
    } catch (const std::exception &amp;greska) {
        std::cout &lt;&lt; "Izuzetak: " &lt;&lt; greska.what();
        if (spil!=nullptr)
            spil-&gt;sljedeci=nullptr;
        spil=nullptr;
        return 0;
    }

    IspisiSpil(spil);
    int n;
    std::cout &lt;&lt; "Unesite broj karata koje zelite vratiti u spil: ";
    std::cin &gt;&gt; n;
    try {
        VratiPosljednjihNKarata(spil, red, n);
    } catch (const std::exception &amp;greska) {
        std::cout &lt;&lt; "Izuzetak: " &lt;&lt; greska.what();
        if (spil!=nullptr)
            spil-&gt;sljedeci=nullptr;
        spil=nullptr;
        return 0;
    }
    IspisiSpil(spil);
    if (spil!=nullptr)
        spil-&gt;sljedeci=nullptr;
    spil=nullptr;
    return 0;
}
</pre>
</body>
</html>
