<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z3/Z6/student6553.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z3/Z6/student6553.cpp<p></p><pre>
#include &lt;iostream&gt;
#include &lt;map&gt;
#include &lt;string&gt;
#include &lt;utility&gt;
#include &lt;iterator&gt;
#include &lt;stack&gt;
#include &lt;stdexcept&gt;
#include &lt;memory&gt;


enum class Boje
{
    Pik, Tref, Herc, Karo
};
<a name="4"></a><font color="#FF00FF"><a href="match279-1.html#4" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

std::string Nazivi[] {"2","3", "4", "5","6","7", "8", "9", "10", "J", "Q", "K", "A"};
</font>
struct Karta {
    Boje boja;
    std::string vrijednost;
};
struct Cvor {
    Karta karta;
    std::shared_ptr&lt;Cvor&gt; sljedeci;
};
typedef std::shared_ptr&lt;Cvor&gt; Pametni;

bool kriterij(Karta prva, Karta druga)
{
    if(prva.boja!=druga.boja) return prva.boja&lt;druga.boja;
    int poz1(0),poz2(0);
    for(int i=0; i&lt;13; i++) {
        if(prva.vrijednost==Nazivi[i]) poz1=i;
        if(druga.vrijednost==Nazivi[i]) poz2=i;
    }
    return poz1&lt;poz2;
}
void izuzetak(Karta prvi)
{
    bool nadjeno(false),nadjeno2(false);
    for(int i=0; i&lt;4; i++) if(Boje(i)==prvi.boja) nadjeno=true;
    for(int i=0; i&lt;13; i++) if(Nazivi[i]==prvi.vrijednost) nadjeno2=true;
    if(!(nadjeno &amp;&amp;nadjeno2)) throw std::logic_error("Neispravna lista");
}



Pametni KreirajSpil()
{
    Pametni pocetak(Pametni(nullptr));
    Pametni prethodni;
    for(int i=0; i&lt;4; i++) {
        for(int j=0; j&lt;13; j++) {
<a name="0"></a><font color="#FF0000"><a href="match279-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_2.gif"/></a>

            Pametni novi (std::make_shared&lt;Cvor&gt;());
            (novi-&gt;karta).boja=Boje(i);
            (novi-&gt;karta).vrijednost=Nazivi[j];
            novi-&gt;sljedeci=nullptr;
            if(!pocetak) pocetak=novi;
            else prethodni-&gt;sljedeci=novi;
            prethodni=novi;
</font>            if((i+1)*(j+1)==52) {
                novi-&gt;sljedeci=pocetak;

            }
        }
    }
    return pocetak;
}
void Provjera(Pametni pocetak)
{
    Pametni klizeci(pocetak);
    Pametni naredni;
    int brojac=0;
    for(;;) {
        izuzetak(klizeci-&gt;karta);
        naredni=klizeci-&gt;sljedeci;
        brojac++;
        if(klizeci-&gt;sljedeci==pocetak) break;
        if(!kriterij(klizeci-&gt;karta,naredni-&gt;karta)) throw std::logic_error("Neispravna lista");
        klizeci=naredni;
    }
    if(brojac&gt;52) throw std::logic_error("Neispravna lista");
}

void IzbaciKarte(Pametni&amp; pocetak, std::multimap&lt;Boje, std::string&gt;&amp; mapa)
{
    Provjera(pocetak);
    Pametni klizeci(pocetak);
    Pametni prethodni(pocetak);
    if(pocetak==nullptr) return;
    auto it=mapa.begin();
    bool poc(false);
    do {
        if(poc) it=mapa.begin();
        poc=false;
        klizeci=pocetak;
        prethodni=pocetak;
        if(mapa.empty()) return;
        while((klizeci-&gt;karta).boja!=it-&gt;first || (klizeci-&gt;karta).vrijednost!=it-&gt;second ) {
            prethodni=klizeci;
            klizeci=klizeci-&gt;sljedeci;
            if(klizeci==pocetak) break;
        }
        if((klizeci-&gt;karta).boja==it-&gt;first &amp;&amp; (klizeci-&gt;karta).vrijednost==it-&gt;second) {

            if(pocetak==pocetak-&gt;sljedeci) {
                mapa.erase(it);

                pocetak=nullptr;
                break;
            } else {


                auto pok(it);
                if(it!=mapa.begin()) pok--;
                else poc=true;
                mapa.erase(it);

                it=pok;


                if(klizeci==pocetak) {
                    pocetak=klizeci-&gt;sljedeci;
                    //prethodni-&gt;sljedeci=pocetak;
                }
                prethodni-&gt;sljedeci=klizeci-&gt;sljedeci;
                klizeci=nullptr;

            }
        } else it++;

        if(pocetak==nullptr) break;

    } while(it!=mapa.end());

}

std::stack&lt;std::pair&lt;Boje, std::string&gt;&gt; IzbaciKarteRazbrajanjem(Pametni &amp;pocetak, const short int &amp; r, const int &amp; b)
{
    if(r&lt;1 || r&gt;52 || b&lt;1) throw std:: logic_error("Neispravni elementi za izbacivanje!");
    std::stack&lt;std::pair&lt;Boje, std::string&gt;&gt; red ;
    Provjera(pocetak);

    int broj_izbacenih(0);
    Pametni it(pocetak);
    Pametni prethodni(pocetak);
    int predjeno(1);
    while(broj_izbacenih&lt;b ) {

        while(predjeno&lt;r) {
            prethodni=it;
            it=it-&gt;sljedeci;
            predjeno++;
        }
        predjeno=0;
        Pametni tmp=it-&gt;sljedeci;
        red.push(std::make_pair((it-&gt;karta).boja, (it-&gt;karta).vrijednost));
        (prethodni-&gt;sljedeci)=tmp;
        if(it==pocetak &amp;&amp; pocetak-&gt;sljedeci==pocetak) {
            it=nullptr;
            pocetak=nullptr;
            break;
        }
        if(it==pocetak) pocetak=pocetak-&gt;sljedeci;
        it=nullptr;
        it=prethodni;
        broj_izbacenih++;
    }
    return red;
}
void provjera(std::stack&lt;std::pair&lt;Boje, std::string&gt;&gt; red)
{
    int s(red.size());
    for(int i=0; i&lt;s; i++) {
        bool nadjeno1(false),nadjeno2(false);
        std::pair&lt;Boje, std::string&gt; pomocni(red.top());
        for(int j=0; j&lt;4; j++) if(pomocni.first==Boje(j)) nadjeno1=true;
        for(int k=0; k&lt;13; k++)
            if(pomocni.second==Nazivi[k]) nadjeno2=true;
        if(!(nadjeno2 &amp;&amp; nadjeno1)) throw std::logic_error("Neispravne karte");
        red.pop();
    }
}

/*Pametni it (std::make_shared&lt;Cvor&gt;());
           (it-&gt;karta).boja=pomocna.first; (it-&gt;karta).vrijednost=pomocna.second; it-&gt;sljedeci=nullptr;*/
void VratiPosljednjihNKarata(Pametni &amp;pocetak, std::stack&lt;std::pair&lt;Boje, std::string&gt;&gt;&amp;red, int n)
{
     int s(red.size());
    if(n&gt;s) throw std::range_error("Nedovoljno karata u redu!");
    if(n&lt;0) throw std::domain_error("Broj n je besmislen!");
    provjera(red);
    if(pocetak!=nullptr) Provjera(pocetak);
    int broj_ubacenih(0);
    Pametni klizeci(pocetak);
   Pametni prethodni(pocetak);
    while(broj_ubacenih&lt;n) {
        prethodni=pocetak;
        klizeci=pocetak;
<a name="1"></a><font color="#00FF00"><a href="match279-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

        auto pomocna(red.top());

        if(klizeci==nullptr ) {
           Pametni it (std::make_shared&lt;Cvor&gt;());
           (it-&gt;karta).boja=pomocna.first; (it-&gt;karta).vrijednost=pomocna.second; it-&gt;sljedeci=nullptr;
</font>            pocetak=it;
            pocetak-&gt;sljedeci=pocetak;
            broj_ubacenih++;


        } else  {

            if(klizeci-&gt;sljedeci==klizeci) {

<a name="2"></a><font color="#0000FF"><a href="match279-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

                Pametni it (std::make_shared&lt;Cvor&gt;());
           (it-&gt;karta).boja=pomocna.first; (it-&gt;karta).vrijednost=pomocna.second; it-&gt;sljedeci=nullptr;
</font>                if(pomocna.first&lt;(pocetak-&gt;karta).boja || (pomocna.first==(pocetak-&gt;karta).boja &amp;&amp; kriterij({pomocna.first, pomocna.second}, pocetak-&gt;karta))) {
                    klizeci-&gt;sljedeci=it;
                    it-&gt;sljedeci=klizeci;
                    pocetak=it;

                }
                else if((klizeci-&gt;karta).boja!=pomocna.first || (klizeci-&gt;karta).vrijednost!= pomocna.second) {
                    pocetak-&gt;sljedeci=it;
                    it-&gt;sljedeci=pocetak;
                }
                broj_ubacenih++;


            } else {

                while((klizeci-&gt;karta).boja&lt;pomocna.first) {
                    prethodni=klizeci;
                    klizeci=klizeci-&gt;sljedeci;
                    if(klizeci==pocetak) break;

                }
                if(pomocna.first&lt;(pocetak-&gt;karta).boja || (pomocna.first==(pocetak-&gt;karta).boja &amp;&amp; kriterij({pomocna.first, pomocna.second}, pocetak-&gt;karta))) {
                    do {
                        prethodni=klizeci;
                        klizeci=klizeci-&gt;sljedeci;
                    } while(klizeci!=pocetak);

<a name="3"></a><font color="#00FFFF"><a href="match279-1.html#3" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

                    Pametni it (std::make_shared&lt;Cvor&gt;());
           (it-&gt;karta).boja=pomocna.first; (it-&gt;karta).vrijednost=pomocna.second; it-&gt;sljedeci=nullptr;
</font>
                    it-&gt;sljedeci=prethodni-&gt;sljedeci;
                    prethodni-&gt;sljedeci=it;
                    pocetak=it;
                    broj_ubacenih++;

                }
                
               else if((klizeci-&gt;karta).boja&gt;pomocna.first){
                   Pametni it (std::make_shared&lt;Cvor&gt;());
           (it-&gt;karta).boja=pomocna.first; (it-&gt;karta).vrijednost=pomocna.second; it-&gt;sljedeci=nullptr;

                    it-&gt;sljedeci=prethodni-&gt;sljedeci;
                    prethodni-&gt;sljedeci=it;
                    broj_ubacenih++;
                    
                }
                else if(klizeci==pocetak  &amp;&amp; (prethodni-&gt;karta).boja&lt;pomocna.first ) {
                    Pametni it (std::make_shared&lt;Cvor&gt;());
           (it-&gt;karta).boja=pomocna.first; (it-&gt;karta).vrijednost=pomocna.second; it-&gt;sljedeci=nullptr;


                    it-&gt;sljedeci=prethodni-&gt;sljedeci;
                    (prethodni-&gt;sljedeci)=it;

                    broj_ubacenih++;

                } else if((klizeci-&gt;karta).boja==pomocna.first) {
                    while( (klizeci-&gt;karta).boja==pomocna.first &amp;&amp; kriterij(klizeci-&gt;karta,Karta {pomocna.first,pomocna.second})) {
                        prethodni=klizeci;
                        klizeci=klizeci-&gt;sljedeci;
                        if(klizeci==pocetak) break;

                    }
 if((klizeci-&gt;karta).boja!=pomocna.first || (klizeci-&gt;karta).vrijednost!= pomocna.second){

                    Pametni it (std::make_shared&lt;Cvor&gt;());
           (it-&gt;karta).boja=pomocna.first; (it-&gt;karta).vrijednost=pomocna.second; it-&gt;sljedeci=nullptr;

                    it-&gt;sljedeci=prethodni-&gt;sljedeci;
                    (prethodni-&gt;sljedeci)=it;

                    broj_ubacenih++;}

                }
            }
        }
       
        red.pop();
        if(red.empty()) break;
        
    }
    
}

void Ispisi(Pametni pocetak)
{
    const char* imena[4]= {"Pik","Tref","Herc","Karo"};
    Pametni prethodni(pocetak);
    Pametni klizeci=pocetak;
    if(pocetak==nullptr) return;
    for(;;) {

        for(int i=0; i&lt;4; i++) {
            if((klizeci-&gt;karta).boja==Boje(i)) {
                std::cout&lt;&lt;imena[i]&lt;&lt;": ";
                do {
                    std::cout&lt;&lt;(klizeci-&gt;karta).vrijednost&lt;&lt;" ";
                    prethodni=klizeci;
                    klizeci=klizeci-&gt;sljedeci;

                }  while((klizeci!=pocetak) &amp;&amp; (klizeci-&gt;karta).boja==Boje(i));
                std::cout&lt;&lt;std::endl;
            }
        }
        if(klizeci!=pocetak)  klizeci=prethodni-&gt;sljedeci;
        else break;
    }
}
void UnistiSpil(Pametni&amp; pocetak){
    if(pocetak!=nullptr) pocetak-&gt;sljedeci=nullptr;
    pocetak=nullptr;
    
}


int main()
{
    Pametni pocetak(nullptr);
    try {
        pocetak=KreirajSpil();
          

        std::cout&lt;&lt;"Unesite korak razbrajanja: ";
        short int r;
        int b;
        std::cin&gt;&gt;r;
        std::cout&lt;&lt;"Unesite broj karata koje zelite izbaciti: ";
        std::cin&gt;&gt;b;
        std::stack&lt;std::pair&lt;Boje, std::string&gt;&gt; red (IzbaciKarteRazbrajanjem(pocetak, r,b));
if(b&gt;52) b=52;
        std::cout&lt;&lt;"U spilu trenutno ima "&lt;&lt;52-b&lt;&lt;" karata, i to: "&lt;&lt;std::endl;
        Ispisi(pocetak);
        std::cout&lt;&lt;"Unesite broj karata koje zelite vratiti u spil: ";
        int n;
        std::cin&gt;&gt;n;
        int sad(red.size());
        VratiPosljednjihNKarata(pocetak, red, n);
        int c(red.size());
        std::cout&lt;&lt;"U spilu trenutno ima "&lt;&lt;52-b+sad-c&lt;&lt;" karata, i to:"&lt;&lt;std::endl;
        Ispisi(pocetak);

    }

    catch(std::domain_error izuzetak) {
        std::cout&lt;&lt;"Izuzetak: "&lt;&lt;izuzetak.what();
    } catch(std::range_error izuzetak) {
        std::cout&lt;&lt;"Izuzetak: "&lt;&lt;izuzetak.what();
    } catch(std::logic_error izuzetak) {
        std::cout&lt;&lt;"Izuzetak: "&lt;&lt;izuzetak.what();
    } catch(std::bad_alloc) {};
    UnistiSpil(pocetak);
    return 0;
}
</pre>
</body>
</html>
