<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z3/Z6/student5774.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z3/Z6/student5129.cpp<p></p><pre>
/B2017/2018: ZadaÄ‡a 3, Zadatak 6
#include &lt;iostream&gt;
#include &lt;utility&gt;
#include &lt;algorithm&gt;

#include &lt;stack&gt;
#include &lt;map&gt;

#include &lt;stdexcept&gt;
#include &lt;memory&gt;

enum class Boje { Pik, Tref, Herc, Karo };
std::string BojeSlovno[]{"Pik", "Tref", "Herc", "Karo"};
<a name="3"></a><font color="#00FFFF"><a href="match632-0.html#3" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

std::string Vrijednosti[]{"2", "3", "4", "5", "6", "7", "8", "9", "10", "J", "Q", "K", "A"};
</font>
struct Karta
{
    Boje boja;
    std::string vrijednost;
};

struct Cvor
{
    Karta karta;
    std::shared_ptr&lt;Cvor&gt;sljedeci;
};

typedef std::pair&lt;std::string, std::string&gt; StrPar;

void validateDeck(std::shared_ptr&lt;Cvor&gt;);
unsigned int size(std::shared_ptr&lt;Cvor&gt;);
std::shared_ptr&lt;Cvor&gt;ending(std::shared_ptr&lt;Cvor&gt;);

void deleteFrom(std::shared_ptr&lt;Cvor&gt;&amp;, std::shared_ptr&lt;Cvor&gt;&amp;, std::shared_ptr&lt;Cvor&gt;);

void IspisiSpil(std::shared_ptr&lt;Cvor&gt;);

std::shared_ptr&lt;Cvor&gt; KreirajSpil();
void IzbaciKarte(std::shared_ptr&lt;Cvor&gt;&amp;, std::multimap&lt;Boje, std::string&gt;&amp;);
std::stack&lt;StrPar&gt; IzbaciKarteRazbrajanjem(std::shared_ptr&lt;Cvor&gt;&amp;, const short int&amp;, const int&amp;);
void VratiPosljednjihNKarata(std::shared_ptr&lt;Cvor&gt;&amp;, std::stack&lt;StrPar&gt;&amp;, int);

int main ()
{
    std::shared_ptr&lt;Cvor&gt; spil;
    try {
        spil = KreirajSpil();
        
        short int r;
        std::cout &lt;&lt; "Unesite korak razbrajanja: ";
        std::cin &gt;&gt; r;
        
        int n;
        std::cout &lt;&lt; "Unesite broj karata koje zelite izbaciti: ";
        std::cin &gt;&gt; n;
        
        auto redVracanja = std::move(IzbaciKarteRazbrajanjem(spil, r, n));
        IspisiSpil(spil);
        
        int brVracanja;
<a name="1"></a><font color="#00FF00"><a href="match632-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_2.gif"/></a>

        std::cout &lt;&lt; "Unesite broj karata koje zelite vratiti u spil: ";
        std::cin &gt;&gt; brVracanja;
        
        VratiPosljednjihNKarata(spil, redVracanja, brVracanja);
        IspisiSpil(spil);
        
    }
    catch (const std::exception &amp;ex) {
        std::cout &lt;&lt; "Izuzetak: " &lt;&lt; ex.what() &lt;&lt; std::endl;
</font>    }
    
    spil-&gt;sljedeci = nullptr;
    spil = nullptr;
    
	return 0;
}

std::shared_ptr&lt;Cvor&gt;KreirajSpil()
{
    std::shared_ptr&lt;Cvor&gt; begin{nullptr}, previous;
    for (int i = 0; i &lt; 4; i++)
        for (int j = 0; j &lt; 13; j++)
        {
            std::shared_ptr&lt;Cvor&gt; node;
            try {
                node = std::make_shared&lt;Cvor&gt;();
                node-&gt;karta.boja = Boje(i);
                node-&gt;karta.vrijednost = Vrijednosti[j];
                node-&gt;sljedeci = begin;
            }
            catch (...) {
                //Izbrisi sto vec postoji
                throw;
            }
            
            if (!begin)
                begin = node;
            else
                previous-&gt;sljedeci = node;
                
            previous = node;
        }
        
    return begin;
}

void IzbaciKarte(std::shared_ptr&lt;Cvor&gt;&amp;spil, std::multimap&lt;Boje, std::string&gt; &amp;zaIzbaciti)
{
    if (!spil)
        return ;
    
    validateDeck(spil);
    
    auto pret = ending(spil);
    auto trenutna = spil;
    do
    {
        auto nadjena = std::find(zaIzbaciti.begin(), zaIzbaciti.end(), std::pair&lt;const Boje, std::string&gt;(trenutna-&gt;karta.boja, trenutna-&gt;karta.vrijednost));
        if (nadjena != zaIzbaciti.end())
        {
            deleteFrom(spil, pret, trenutna);
            zaIzbaciti.erase(nadjena);
            if (!spil)
                return ;
        }
        else
            pret = trenutna;
            
        trenutna = pret-&gt;sljedeci;
    }
    while (trenutna != spil);
}

<a name="0"></a><font color="#FF0000"><a href="match632-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_2.gif"/></a>

std::stack&lt;StrPar&gt; IzbaciKarteRazbrajanjem(std::shared_ptr&lt;Cvor&gt;&amp;spil, const short int &amp;korak, const int &amp;brZaIzbaciti)
{
    if (korak &lt; 1 || korak &gt; 52 || brZaIzbaciti &lt; 1)
        throw std::logic_error("Neispravni elementi za izbacivanje!");
        
    validateDeck(spil);
    
    std::stack&lt;StrPar&gt; res;
</font>    
    auto pret = ending(spil);
    auto pozicija = spil;
    for (int koliko = 0; koliko &lt; brZaIzbaciti; koliko++)
    {
        for (int koracanje = 1; koracanje &lt; korak; koracanje++) {
            pret = pozicija;
            pozicija = pozicija-&gt;sljedeci;
        }
            
        res.push(std::make_pair(BojeSlovno[int(pozicija-&gt;karta.boja)], pozicija-&gt;karta.vrijednost));
        deleteFrom(spil, pret, pozicija);
        if (!spil)
            return res;
        
        pozicija = pret-&gt;sljedeci;
    }
    
    return res;
}

void VratiPosljednjihNKarata(std::shared_ptr&lt;Cvor&gt;&amp;spil, std::stack&lt;StrPar&gt; &amp;zaUbaciti, int n)
{
    bool isValidCard(const Karta&amp;);
    bool cmpCards(const Karta&amp;, const Karta&amp;);
    std::shared_ptr&lt;Cvor&gt;lower_bound(std::shared_ptr&lt;Cvor&gt;, const Karta&amp;);
    
    if (n &gt; int(zaUbaciti.size()))
        throw std::range_error("Nedovoljno karata u steku!");
        
    if (n &lt; 0)
        throw std::domain_error("Broj n je besmislen!");
        
    validateDeck(spil);
    
    for (int i = 0; i &lt; n; i++)
    {
        Karta ubacanje{
            Boje(std::find(BojeSlovno, BojeSlovno + 4, zaUbaciti.top().first) - BojeSlovno),
            zaUbaciti.top().second
        };
        
        if (!isValidCard(ubacanje))
            throw std::logic_error("Neispravne karte!");
            
        if (spil == nullptr)
        {
            spil = std::make_shared&lt;Cvor&gt;();
            spil-&gt;karta = ubacanje;
            spil-&gt;sljedeci = spil;
        }
        else
        {
            auto gdjeUbaciti = lower_bound(spil, ubacanje);
            if (gdjeUbaciti-&gt;karta.boja != ubacanje.boja ||
                gdjeUbaciti-&gt;karta.vrijednost != ubacanje.vrijednost)
                {
                    auto pret = ending(gdjeUbaciti);
                    
                    auto noviCvor = std::make_shared&lt;Cvor&gt;();
                    noviCvor-&gt;karta = ubacanje;
                    noviCvor-&gt;sljedeci = gdjeUbaciti;
                    pret-&gt;sljedeci = noviCvor;
                    
                    if (gdjeUbaciti == spil &amp;&amp; cmpCards(ubacanje, spil-&gt;karta))
                        spil = noviCvor;
                }
        }
            
        zaUbaciti.pop();
    }
}

std::shared_ptr&lt;Cvor&gt;lower_bound(std::shared_ptr&lt;Cvor&gt;deck, const Karta &amp;card)
{
    bool cmpCards(const Karta&amp;, const Karta&amp;);
    
    if (!deck)
        return deck;
    
    auto it = deck;
    do
    {
        if (!cmpCards(it-&gt;karta, card))
            break;
        it = it-&gt;sljedeci;
    }   
    while (it != deck);
    
    return it;
}

void IspisiSpil(std::shared_ptr&lt;Cvor&gt;spil)
{
    std::cout &lt;&lt; "U spilu trenutno ima " &lt;&lt; size(spil) &lt;&lt; " karata, i to:" &lt;&lt; std::endl;
    
    auto it = spil;
    for (int i = 0; i &lt; 4; i++)
    {
        std::cout &lt;&lt; BojeSlovno[i] &lt;&lt; ": ";
        do {
            if (!it || it-&gt;karta.boja != Boje(i))
                break;
            
            std::cout &lt;&lt; it-&gt;karta.vrijednost &lt;&lt; " ";
            it = it-&gt;sljedeci;
        }
        while (it != spil);
        
        std::cout &lt;&lt; std::endl;
    }
}

void validateDeck(std::shared_ptr&lt;Cvor&gt;deck)
{
    bool validCards(std::shared_ptr&lt;Cvor&gt;);
    bool isSorted(std::shared_ptr&lt;Cvor&gt;);
    
    if (size(deck) &gt; 52 || !validCards(deck) || !isSorted(deck))
        throw std::logic_error("Neispravna lista!");
    return ;
}

bool validCards(std::shared_ptr&lt;Cvor&gt;deck)
{
    bool isValidCard(const Karta&amp;);
    
    if (!deck)
        return true;
    
    auto it = deck;
    do {
        if (!isValidCard(it-&gt;karta))
            return false;
            
        it = it-&gt;sljedeci;
    }
    while (it != deck);
    
    return true;
}

bool isValidCard(const Karta &amp;card)
{
    return !(int(card.boja) &lt; 0 ||
             int(card.boja) &gt; 3 ||
             std::find(Vrijednosti, Vrijednosti + 13, card.vrijednost) == Vrijednosti + 13);
}

bool isSorted(std::shared_ptr&lt;Cvor&gt;deck)
{
    bool cmpCards(const Karta&amp;, const Karta&amp;);
    
    if (!deck)
        return true;
    
    auto next = deck-&gt;sljedeci;
    auto end = ending(deck);
    
    for (auto it = deck; next != end; it = it-&gt;sljedeci, next = next-&gt;sljedeci)
        if (!cmpCards(it-&gt;karta, next-&gt;karta))
            return false;
            
    return true;
}

bool cmpCards(const Karta &amp;card1, const Karta &amp;card2)
{
<a name="2"></a><font color="#0000FF"><a href="match632-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_2.gif"/></a>

    return card1.boja &lt; card2.boja || (card1.boja == card2.boja &amp;&amp;
        std::find(Vrijednosti, Vrijednosti + 13, card1.vrijednost) &lt; std::find(Vrijednosti, Vrijednosti + 13, card2.vrijednost));
</font>}

unsigned int size(std::shared_ptr&lt;Cvor&gt;deck)
{
    if (deck == nullptr)
        return 0;
    
    unsigned int res{};
    
    auto it = deck;
    do {
        res++;
        it = it-&gt;sljedeci;
    }
    while (it != deck &amp;&amp; res &lt;= 52);
    
    return res;
}

std::shared_ptr&lt;Cvor&gt;ending(std::shared_ptr&lt;Cvor&gt;deck)
{
    if (!deck)
        return deck;
    
    auto it = deck;
    do
        it = it-&gt;sljedeci;
    while (it-&gt;sljedeci != deck);
    
    return it;
}

void deleteFrom(std::shared_ptr&lt;Cvor&gt;&amp;deck, std::shared_ptr&lt;Cvor&gt;&amp;previous, std::shared_ptr&lt;Cvor&gt;current)
{
    previous-&gt;sljedeci = current-&gt;sljedeci;
    
    if (deck == deck-&gt;sljedeci)
        deck = nullptr;
    else if (current == deck)
        deck = current-&gt;sljedeci;
}</pre>
</body>
</html>
