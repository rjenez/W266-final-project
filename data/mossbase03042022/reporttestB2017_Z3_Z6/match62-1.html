<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z3/Z6/student5621.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z3/Z6/student3171.cpp<p></p><pre>
<a name="0"></a><font color="#FF0000"><a href="match62-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_99.gif"/></a>

/B2017/2018: ZadaÄ‡a 3, Zadatak 6

#include &lt;iostream&gt;
#include &lt;map&gt;
#include &lt;string&gt;
#include &lt;utility&gt;
#include &lt;stdexcept&gt;
#include &lt;stack&gt;
#include &lt;iomanip&gt;
#include &lt;memory&gt;


enum class Boje
{
    Pik, Tref, Herc, Karo
};

const char* VrijednostKarte[13] {
    "2","3","4","5","6","7","8","9","10","J","Q","K","A"
};

const char* BojaKarte[4] {
    "Pik","Tref","Herc","Karo"
};


struct Karta {
    Boje boja;
    std::string vrijednost;
};


struct Cvor {
    Karta karta;
    std::shared_ptr&lt;Cvor&gt; sljedeci=nullptr;
};
typedef std::shared_ptr&lt;Cvor&gt; dp;

typedef std::multimap&lt;Boje, std::string&gt; multimapa;

void test_list(dp pocetak);

int br_elem(dp pocetak);

int daj_ID_Boje(std::string );

int daj_ID_Vrijednosti(std::string);

dp KreirajSpil();

void UnistiSpil(dp);

void IzbaciKarte(dp &amp;pocetak, multimapa m);

std::stack&lt;std::pair&lt;std::string, std::string&gt;&gt; IzbaciKarteRazbrajanjem(dp &amp;pocetak, const short int&amp;,const int&amp;);

void VratiPosljednjihNKarata(dp &amp;,std::stack&lt;std::pair&lt;std::string,std::string&gt;&gt;&amp;, int );


int main ()
{

    dp pocetak=nullptr;
    try {
        std::cout&lt;&lt;"Unesite korak razbrajanja: ";
        short int r;
        std::cin&gt;&gt;r;
        std::cout&lt;&lt;"Unesite broj karata koje zelite izbaciti: ";
        int b;
        std::cin&gt;&gt;b;
        pocetak=KreirajSpil();
        auto stek_za_kasnije( IzbaciKarteRazbrajanjem(pocetak,r,b));
        std::cout&lt;&lt;"U spilu trenutno ima "&lt;&lt;br_elem(pocetak)&lt;&lt;" karata, i to:";
        for(int i=0; i&lt;4; i++) {
            std::cout&lt;&lt;"\n"&lt;&lt;BojaKarte[i]&lt;&lt;": ";
            if(!pocetak)continue;
            for(dp klizni=pocetak;;) {
                if(klizni-&gt;karta.boja==Boje(i)) {
                    std::cout&lt;&lt;klizni-&gt;karta.vrijednost&lt;&lt;" ";
                }
                klizni=klizni-&gt;sljedeci;
                if(klizni==pocetak)break;
            }
        }


        std::cout&lt;&lt;"\nUnesite broj karata koje zelite vratiti u spil: ";
        int n;
        std::cin&gt;&gt;n;
        // VratiPrvihNKarata(spil,za_kasnije,n);
        VratiPosljednjihNKarata(pocetak,stek_za_kasnije,n);
        std::cout&lt;&lt;"U spilu trenutno ima "&lt;&lt;br_elem(pocetak)&lt;&lt;" karata, i to:";
        for(int i=0; i&lt;4; i++) {
            std::cout&lt;&lt;"\n"&lt;&lt;BojaKarte[i]&lt;&lt;": ";
            if(!pocetak)continue;
            for(dp klizni=pocetak;;) {
                if(klizni-&gt;karta.boja==Boje(i)) {
                    std::cout&lt;&lt;klizni-&gt;karta.vrijednost&lt;&lt;" ";
                }
                klizni=klizni-&gt;sljedeci;
                if(klizni==pocetak)break;
            }
        }

    } catch(std::domain_error izuzetak) {
        std::cout &lt;&lt;"Izuzetak: "&lt;&lt; izuzetak.what();
    } catch(std::range_error izuzetak) {
        std::cout &lt;&lt; "Izuzetak: " &lt;&lt;izuzetak.what();
    } catch( std::logic_error izuzetak) {
        std::cout &lt;&lt; "Izuzetak: " &lt;&lt;izuzetak.what();
    } catch(...) {
        std::cout&lt;&lt;"Problemi s memorijom!";
    }
for(dp klizni=pocetak;;klizni=klizni-&gt;sljedeci)
{
    if(klizni-&gt;sljedeci==pocetak){
        klizni-&gt;sljedeci=nullptr;
        break;
    }
}

    return 0;
}

void VratiPosljednjihNKarata(dp &amp;pocetak, std::stack&lt;std::pair&lt;std::string,std::string&gt;&gt;&amp; stek, int n)
{
    if(n&lt;0)throw std::domain_error("Broj n je besmislen!");
    if (n&gt;static_cast&lt;int&gt;(stek.size())) {
        throw std::range_error("Nedovoljno karata u redu!");
    }
    test_list(pocetak);
    dp temp(nullptr);
    dp lijevi(nullptr);
    dp desni(nullptr);


    for(int i=0; i&lt;n; i++) {
        //provjera karti
        if(!(daj_ID_Vrijednosti(stek.top().second) +1) || !(daj_ID_Boje(stek.top().first)+1))
            throw std::logic_error("Neispravne karte!");
        //ovdje se vrsi provjera karti
        //kreiranje novog cvora
        temp= std::make_shared&lt;Cvor&gt;();
        temp-&gt;karta.vrijednost=(stek.top()).second;
        temp-&gt;karta.boja=Boje(daj_ID_Boje(stek.top().first));

        if(!pocetak) {
            //nema karata
            //krecemo od nule
            pocetak=temp;
            pocetak-&gt;sljedeci=pocetak;
        } else {
            //postoji n karata , n&gt;0
            if( pocetak-&gt;karta.boja &gt; temp-&gt;karta.boja || (pocetak-&gt;karta.boja == temp-&gt;karta.boja &amp;&amp; daj_ID_Vrijednosti(pocetak-&gt;karta.vrijednost)&gt;daj_ID_Vrijednosti(temp-&gt;karta.vrijednost) ) ) {
                //trebam na pocetak postaviti
                temp-&gt;sljedeci=pocetak;
                lijevi=pocetak;
                for(;;) {
                    if(lijevi-&gt;sljedeci==pocetak)break;
                    lijevi=lijevi-&gt;sljedeci;
                }
                lijevi-&gt;sljedeci=temp;
                pocetak=temp;
                temp=nullptr;

            } else {
                desni=pocetak;
                lijevi=pocetak;
                for(;;) {
                    if(lijevi-&gt;sljedeci == pocetak)break;
                    lijevi= lijevi-&gt;sljedeci;
                }
                desni=desni-&gt;sljedeci;
                lijevi=lijevi-&gt;sljedeci;
                for(;;) {
                    if ( (temp-&gt;karta.vrijednost ==desni-&gt;karta.vrijednost &amp;&amp; temp-&gt;karta.boja == desni-&gt;karta.boja)||
                            (temp-&gt;karta.vrijednost ==lijevi-&gt;karta.vrijednost &amp;&amp; temp-&gt;karta.boja == lijevi-&gt;karta.boja))
                        break;
                    if( (temp-&gt;karta.boja == lijevi-&gt;karta.boja &amp;&amp;
                            ( (temp-&gt;karta.boja == desni-&gt;karta.boja &amp;&amp;
                               daj_ID_Vrijednosti(temp-&gt;karta.vrijednost)&gt;daj_ID_Vrijednosti(lijevi-&gt;karta.vrijednost)
                               &amp;&amp; daj_ID_Vrijednosti(temp-&gt;karta.vrijednost) &lt; daj_ID_Vrijednosti(desni-&gt;karta.vrijednost)
                              )||(temp-&gt;karta.boja &lt; desni-&gt;karta.boja &amp;&amp;  daj_ID_Vrijednosti(temp-&gt;karta.vrijednost)&gt;daj_ID_Vrijednosti(lijevi-&gt;karta.vrijednost))
                            )
                        )
                            ||
                            ( temp-&gt;karta.boja &gt; lijevi-&gt;karta.boja &amp;&amp; temp-&gt;karta.boja &lt; desni-&gt;karta.boja  )
                            ||
                            (  temp-&gt;karta.boja &gt; lijevi-&gt;karta.boja &amp;&amp; temp-&gt;karta.boja == desni-&gt;karta.boja &amp;&amp; daj_ID_Vrijednosti(temp-&gt;karta.vrijednost)&lt;daj_ID_Vrijednosti(desni-&gt;karta.vrijednost))
                            ||
                            desni==pocetak

                      ) {
                        //insert izmedju lijevog i desnog
                        lijevi-&gt;sljedeci=temp;
                        temp-&gt;sljedeci=desni;
                        temp=nullptr;
                        break;
                    }
                    lijevi=lijevi-&gt;sljedeci;
                    desni=desni-&gt;sljedeci;
                }


            }
        }
        stek.pop();
    }


}

std::stack&lt;std::pair&lt;std::string, std::string&gt;&gt; IzbaciKarteRazbrajanjem(dp &amp;pocetak, const short int&amp; r,const int&amp; b)
{
    if(r&lt;1 || r&gt;52 || b&lt;1)throw std::logic_error("Neispravni elementi za izbacivanje!");
    test_list(pocetak);
    std::stack&lt;std::pair&lt;std::string,std::string&gt;&gt; stek ;
    if(!pocetak)return stek;
    dp lijevi,srednji,desni;
    srednji=pocetak;

    desni=pocetak-&gt;sljedeci;
    lijevi=pocetak;

    for(;;) {
        if(lijevi-&gt;sljedeci == pocetak)break;
        lijevi= lijevi-&gt;sljedeci;
    }

    for(int i=0; i&lt;b &amp;&amp; pocetak ; i++) {
        for(int j=0; j&lt;r-1 &amp;&amp; srednji; j++) {
            srednji=srednji-&gt;sljedeci;
            desni=desni-&gt;sljedeci;
            lijevi=lijevi-&gt;sljedeci;
        }

        if(pocetak==lijevi &amp;&amp; lijevi==desni) {
            stek.push(std::pair&lt;std::string,std::string&gt;(BojaKarte[static_cast&lt;int&gt;(pocetak-&gt;karta.boja)], pocetak-&gt;karta.vrijednost));
            pocetak-&gt;sljedeci=nullptr;
            pocetak=nullptr;
            break;
        }
        //prvo treba spojiti lijevi i desni
        if(pocetak==srednji) {
            pocetak=desni;
            lijevi-&gt;sljedeci=desni;
            stek.push(std::pair&lt;std::string,std::string&gt;(BojaKarte[static_cast&lt;int&gt;(srednji-&gt;karta.boja)], srednji-&gt;karta.vrijednost));
            srednji-&gt;sljedeci=nullptr;
            srednji=nullptr;
            srednji=desni;
            desni=desni-&gt;sljedeci;
            // std::cout&lt;&lt;"\nIzbriso prvi\n";
        } else {
            lijevi-&gt;sljedeci=desni;
            stek.push(std::pair&lt;std::string,std::string&gt;(BojaKarte[static_cast&lt;int&gt;(srednji-&gt;karta.boja)], srednji-&gt;karta.vrijednost));
            srednji-&gt;sljedeci=nullptr;
            srednji=nullptr;
            srednji=desni;
            desni=desni-&gt;sljedeci;
            // std::cout&lt;&lt;"\nIzbriso neki\n";
        }

    }

    return stek;

}




dp KreirajSpil()
{
    //povezati sve u cirkularnu listu i vratiti pokazivac na prvi
    dp pocetak=nullptr;
    dp klizni=nullptr;
    dp novi=nullptr;

    for(int i=0; i&lt;4; i++) {
        for(int j=0; j&lt;13; j++) {
            novi= std::make_shared&lt; Cvor&gt;();
            novi-&gt;karta.boja=Boje(i);
            novi-&gt;karta.vrijednost=std::string(VrijednostKarte[j]);
            if(i==0 &amp;&amp; j==0) {
                pocetak=novi;
                klizni=novi;

            } else {
                klizni-&gt;sljedeci=novi;
                klizni=klizni-&gt;sljedeci;
            }

        }
    }
    klizni-&gt;sljedeci=pocetak;

    return pocetak;
}



void IzbaciKarte(dp &amp;pocetak, multimapa m)
{
    if(!pocetak)return;
    dp lijevi,srednji,desni;
    srednji=pocetak;

    desni=pocetak-&gt;sljedeci;
    lijevi=pocetak;
    for(;;) {
        if(lijevi-&gt;sljedeci == pocetak)break;
        lijevi= lijevi-&gt;sljedeci;
    }
    //sad kad imamo trio fantastiko, mozemo krenuti sa izbacivanjem
    int posjeta(0);

    test_list(pocetak);
    int broj_elemenata(br_elem(pocetak));
    for(;;) {
        //for petlja koja prolazi kroz listu
        if(!m.size())return;
        for (auto it = m.begin(); it != m.end(); it++) {
            /* code */
            if(it-&gt;first == srednji-&gt;karta.boja &amp;&amp; it-&gt;second == srednji-&gt;karta.vrijednost) {
                //brisanje underway
                //special case
                if(pocetak==lijevi &amp;&amp; lijevi==desni) {
                    pocetak-&gt;sljedeci=nullptr;
                    pocetak=nullptr;
                    return;
                }
                //prvo treba spojiti lijevi i desni
                if(pocetak==srednji) {
                    pocetak=desni;
                    lijevi-&gt;sljedeci=desni;
                    srednji-&gt;sljedeci=nullptr;
                    srednji=nullptr;
                    srednji=desni;
                    desni=desni-&gt;sljedeci;
                    posjeta++;
                    it=m.begin();
                    // std::cout&lt;&lt;"\nIzbriso prvi\n";
                } else {
                    lijevi-&gt;sljedeci=desni;
                    srednji-&gt;sljedeci=nullptr;
                    srednji=nullptr;
                    srednji=desni;
                    posjeta++;
                    desni=desni-&gt;sljedeci;
                    it=m.begin();
                    // std::cout&lt;&lt;"\nIzbriso neki\n";
                }

            }
            auto it2=it;
            it2++;
            if(it2==m.end())posjeta++;
            //uslov prekida mi treba ovdje

        }
        // std::cout&lt;&lt;"\nPosjeta: "&lt;&lt;posjeta&lt;&lt;"\n";
        if(posjeta &gt;= broj_elemenata)break;
        lijevi=srednji;
        srednji=desni;
        desni=desni-&gt;sljedeci;
        // posjeta++;

    }

}

int br_elem(dp pocetak)
{
    int result(0);
    if(!pocetak)return result;
    dp klizac(pocetak-&gt;sljedeci);
    for(;;) {
        result++;
        if(klizac==pocetak)break;
        if(klizac==nullptr)return -1;
        klizac=klizac-&gt;sljedeci;
        if(result&gt;52)return -1;
    }
    return result;
}

int daj_ID_Boje(std::string a)
{
    for(int i=0; i&lt;4; i++) {
        if(a == BojaKarte[i])return i;
    }
    return -1;
}

int daj_ID_Vrijednosti(std::string a)
{
    for(int i=0; i&lt;13; i++) {
        if(a == std::string(VrijednostKarte[i]))return i;
    }
    return -1;
}

void test_list(dp pocetak)
{
    int broj_elemenata(br_elem(pocetak));
    if(broj_elemenata==-1) {
        //bacanje izuzetka
        //preduga lista
        //nije kruzna
        throw std::logic_error("Neispravna lista!");
    }
    dp klizni=pocetak;
    for(; klizni-&gt;sljedeci!=pocetak;) {
        if(!(daj_ID_Vrijednosti(klizni-&gt;karta.vrijednost)+1) || !(daj_ID_Vrijednosti(klizni-&gt;sljedeci-&gt;karta.vrijednost)+1) )throw std::logic_error("Neispravna lista!");
        if(klizni-&gt;karta.boja &gt; klizni-&gt;sljedeci-&gt;karta.boja)throw std::logic_error("Neispravna lista!");
        if(klizni-&gt;karta.boja == klizni-&gt;sljedeci-&gt;karta.boja &amp;&amp; daj_ID_Vrijednosti(klizni-&gt;karta.vrijednost) &gt;= daj_ID_Vrijednosti(klizni-&gt;sljedeci-&gt;karta.vrijednost))
            throw std::logic_error("Neispravna lista!");
        klizni=klizni-&gt;sljedeci;
</font>    }

}</pre>
</body>
</html>
