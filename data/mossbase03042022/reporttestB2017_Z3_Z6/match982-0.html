<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z3/Z6/student2009.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z3/Z6/student2009.cpp<p></p><pre>
#include &lt;iostream&gt;
#include &lt;list&gt;
#include &lt;string&gt;
#include &lt;stdexcept&gt;
#include &lt;exception&gt;
#include &lt;algorithm&gt;
#include &lt;vector&gt;
#include &lt;queue&gt;
#include &lt;map&gt;
#include &lt;stack&gt;
#include &lt;memory&gt;
using std::queue;
using std::vector;
using std::string;
using std::cin;
using std::cout;
using std::endl;
using std::list;
using std::pair;
int gvelicina {};



vector&lt;string&gt; TipKarata {"Pik", "Tref", "Herc", "Karo"};
<a name="1"></a><font color="#00FF00"><a href="match982-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

vector&lt;string&gt; Karte {"2","3","4","5","6","7","8","9","10","J","Q","K","A"};
using std::shared_ptr;
</font>enum class Boje
{
    Pik=0,Tref=1,Herc=2,Karo=3
};
typedef std::multimap&lt;Boje, std::string&gt; MMapa;
struct Karta {
    Boje boja;
    string vrijednost;
};

struct Cvor {
    Karta karta;
    shared_ptr&lt;Cvor&gt; sljedeci;
};

void IspisSpila(shared_ptr&lt;const Cvor&gt; c) {
    shared_ptr&lt;const Cvor&gt; p = c;
    int TipKarte=0;
    for(;;) {
        cout &lt;&lt; TipKarata.at(TipKarte) &lt;&lt; ": ";
        shared_ptr&lt;const Cvor&gt; temp(p);
        int brojac {};
        while(temp!=nullptr &amp;&amp; temp-&gt;karta.boja == p-&gt;karta.boja) {
            brojac++;
            temp = temp-&gt;sljedeci;
            if(temp==c) break;
        }
        if(brojac&gt;0 &amp;&amp; int(p-&gt;karta.boja)==TipKarte) {
            for(int i=0; i&lt;brojac; i++,p=p-&gt;sljedeci)
                if(int(p-&gt;karta.boja)==TipKarte) cout &lt;&lt; p-&gt;karta.vrijednost &lt;&lt; " ";
            if(p==c) return;
        }
        cout &lt;&lt; endl;
        TipKarte++;
        if(TipKarte&gt;3 &amp;&amp; !p) return;
    }
}

shared_ptr&lt;Cvor&gt; KreirajSpil() {
    shared_ptr&lt;Cvor&gt;pocetak(nullptr); shared_ptr&lt;Cvor&gt;prethodni {nullptr};
    int TipKarte=0;
    while(TipKarte&lt;=3) {
        for(int i=0; i&lt;Karte.size(); i++) {
            shared_ptr&lt;Cvor&gt; novi {nullptr};
            try {
                novi = shared_ptr&lt;Cvor&gt;(new Cvor {{static_cast&lt;Boje&gt;(TipKarte),Karte.at(i)},nullptr});
                if(!pocetak) pocetak=novi;
                else prethodni-&gt;sljedeci =novi;
                prethodni=novi;
            } catch(...) {
                throw std::bad_alloc();
            }
        }
        TipKarte++;
    }
    prethodni-&gt;sljedeci=pocetak;
    return pocetak;
}

shared_ptr&lt;Cvor&gt;DajZadnji(shared_ptr&lt;Cvor&gt;c) {
   shared_ptr&lt;Cvor&gt; p=c;
    if(c==nullptr) return nullptr;
    do {
        p=p-&gt;sljedeci;
    } while(p!=nullptr &amp;&amp; p-&gt;sljedeci!=c);
    return p;
}

shared_ptr&lt;Cvor&gt; DajPrethodni(shared_ptr&lt;Cvor&gt;pocetak,shared_ptr&lt;Cvor&gt;c) {
    shared_ptr&lt;Cvor&gt;p=pocetak;
    if(pocetak==nullptr) return nullptr;
    do {
        p=p-&gt;sljedeci;
    } while(p!=nullptr &amp;&amp; p-&gt;sljedeci!=c);
    return p;
}

bool validanSpil(shared_ptr&lt;const Cvor&gt; c) {
    shared_ptr&lt;const Cvor&gt; p=c;
    do {
        bool validan {false};
        for(int i=0; i&lt;Karte.size(); i++,p=p-&gt;sljedeci) {
            if(p==nullptr) return true;
            if(int(p-&gt;karta.boja)&lt;0 || int(p-&gt;karta.boja)&gt;3) return false;
            if(p-&gt;karta.vrijednost==Karte.at(i)) {
                validan=true;
                break;
            }
        }
        if(!validan) return false;
    } while(p!=c);
    return true;
}

bool ispravnoSortiranSpil(shared_ptr&lt;Cvor&gt; c) {
    if(!c) return true;
    shared_ptr&lt;Cvor&gt; p=c;
    vector&lt;pair&lt;Boje,string&gt;&gt; v;
    do {
        v.push_back(std::make_pair(p-&gt;karta.boja,p-&gt;karta.vrijednost));
        p=p-&gt;sljedeci;
    } while(p!=nullptr &amp;&amp; p!=c);

    std::sort(v.begin(),v.end(),[](pair&lt;Boje,string&gt; x,pair&lt;Boje,string&gt; y) {
        return (int(x.first)&lt;int(y.first) || (int(x.first)==int(y.first) &amp;&amp;
                                              std::find(Karte.begin(),Karte.end(),x.second)-Karte.begin() &lt; std::find(Karte.begin(),Karte.end(),y.second)-Karte.begin()));
    });
    p=c;
    for(int i=0; i&lt;v.size(); i++,p=p-&gt;sljedeci)
        if(p-&gt;karta.boja != v.at(i).first || (p-&gt;karta.boja==v.at(i).first &amp;&amp; p-&gt;karta.vrijednost != v.at(i).second )) return false;
    return true;
}

int PrebrojSpil(shared_ptr&lt;const Cvor&gt; c) {
    shared_ptr&lt;const Cvor&gt; q=c;
    int velicina {};
    if(q!=nullptr)
        do {
            q=q-&gt;sljedeci;
            velicina++;
        } while(q!=nullptr &amp;&amp; q!=c);
    return velicina;
}

void IzbaciKarte(shared_ptr&lt;Cvor&gt; &amp;c, MMapa &amp;m) {
    int velicina=PrebrojSpil(c);
    if(velicina&gt;52 || !validanSpil(c) || !ispravnoSortiranSpil(c))
        throw std::logic_error("Neispravna lista!");
    vector&lt;MMapa::iterator&gt; mbrisanje;
    for(auto i=m.begin(); i!=m.end(); std::advance(i,1)) {
        shared_ptr&lt;Cvor&gt;p=c;
        for(int j=0; j&lt;velicina; j++,p=p-&gt;sljedeci) {
            if(velicina&gt;=1 &amp;&amp; p-&gt;sljedeci-&gt;karta.boja == i-&gt;first &amp;&amp; p-&gt;sljedeci-&gt;karta.vrijednost==i-&gt;second) {
                if(velicina&gt;=2) {
                    bool pocetak {false};
                    if(p-&gt;sljedeci==c) pocetak=true; 
                    shared_ptr&lt;Cvor&gt;next=p-&gt;sljedeci-&gt;sljedeci;
                    p-&gt;sljedeci=nullptr;
                    p-&gt;sljedeci=next;
                    if(pocetak) c=p-&gt;sljedeci;
                }
                mbrisanje.push_back(i);
                velicina--;
                if(velicina==1) c-&gt;sljedeci=nullptr;
                break;
            }
        }

    }
    if(velicina==0) c=nullptr;
    for(int i=0; i&lt;mbrisanje.size(); i++) m.erase(mbrisanje.at(i));
}

void pomjeri(shared_ptr&lt;Cvor&gt;&amp;q,int broj) {
    while(broj&gt;0 &amp;&amp; q!=nullptr) {
        q=q-&gt;sljedeci;
        broj--;
    }
}

<a name="2"></a><font color="#0000FF"><a href="match982-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

std::stack&lt;pair&lt;string,string&gt;&gt; IzbaciKarteRazbrajanjem(shared_ptr&lt;Cvor&gt;&amp;c,const short int &amp;r, const int &amp;b) {
    if(r&lt;1 || r&gt;52 || b&lt;1) throw std::logic_error("Neispravni elementi za izbacivanje!");
</font>    int velicina=PrebrojSpil(c);
    if(velicina&gt;52 || !validanSpil(c) || !ispravnoSortiranSpil(c)) throw std::logic_error("Neispravna lista!");
    std::stack&lt;pair&lt;string,string&gt;&gt; s;
    shared_ptr&lt;Cvor&gt; p=c;
    pomjeri(p,r-1);
    int brojac=b;
    while(brojac!=0) {
        short int i = r-1;
        shared_ptr&lt;Cvor&gt;prethodni=DajPrethodni(c,p);
        /*cout &lt;&lt; "Brisat ce se: " &lt;&lt; TipKarata.at(int(p-&gt;karta.boja)) &lt;&lt; " " &lt;&lt; p-&gt;karta.vrijednost &lt;&lt;endl;*/
        s.push(std::make_pair(TipKarata.at(int(p-&gt;karta.boja)),p-&gt;karta.vrijednost));
        shared_ptr&lt;Cvor&gt;&amp;next=p-&gt;sljedeci;
        prethodni-&gt;sljedeci=nullptr;

        /*delete p;*/
        velicina--;
        if(velicina==0) {
            c=nullptr;
            break;
        }
        prethodni-&gt;sljedeci=next;
        if(p==c) {c=nullptr;c=next;}
        p=next;
        /*cout &lt;&lt; "Poslije brisanja: " &lt;&lt; TipKarata.at(int(p-&gt;karta.boja)) &lt;&lt; " " &lt;&lt; p-&gt;karta.vrijednost &lt;&lt;endl;*/
        shared_ptr&lt;Cvor&gt;zadnji=DajZadnji(c);
        while(i!=0) {
            pomjeri(p,1);
            i--;
        }
        brojac--;
        zadnji-&gt;sljedeci=c;
        if(velicina==1) c-&gt;sljedeci=nullptr;
    }
    gvelicina=velicina;
    return s;
}


bool Prisutan(shared_ptr&lt;Cvor&gt;c, pair&lt;Boje,string&gt; x) {
    if(!c) return false;
    shared_ptr&lt;Cvor&gt;p=c;
    do {
<a name="0"></a><font color="#FF0000"><a href="match982-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

        if(p-&gt;karta.boja==x.first &amp;&amp; p-&gt;karta.vrijednost==x.second) return true;
        p=p-&gt;sljedeci;
    } while(p!=nullptr &amp;&amp; p!=c);
</font>    return false;
}

void Podesi(shared_ptr&lt;Cvor&gt;&amp;c, pair&lt;Boje,string&gt; x)
{
    shared_ptr&lt;Cvor&gt;novi = shared_ptr&lt;Cvor&gt;(new Cvor {{x.first,x.second},nullptr});
    int velicina=PrebrojSpil(c);
    if(velicina==0) {
        c=novi;
        return;
    } else if(velicina==1) {
        int i1 {},i2 {};
        for(int i=0; i&lt;Karte.size(); i++,i1++) if(c-&gt;karta.vrijednost==Karte.at(i)) break;
        for(int i=0; i&lt;Karte.size(); i++,i2++) if(novi-&gt;karta.vrijednost==Karte.at(i)) break;
        if(c-&gt;karta.boja&lt;novi-&gt;karta.boja || (c-&gt;karta.boja==novi-&gt;karta.boja &amp;&amp; i1&lt;i2)) {
            c-&gt;sljedeci=novi;
            c-&gt;sljedeci-&gt;sljedeci=c;
        } else {
            shared_ptr&lt;Cvor&gt;temp=c;
            c=novi;
            c-&gt;sljedeci=temp;
            c-&gt;sljedeci-&gt;sljedeci=c;
        }
        return;
    }

    int i1 {};
    for(int i=0; i&lt;Karte.size(); i++,i1++) if(novi-&gt;karta.vrijednost==Karte.at(i)) break;
    shared_ptr&lt;Cvor&gt;p=c;
    /*cout  &lt;&lt; "Novi: " &lt;&lt; TipKarata.at(int(novi-&gt;karta.boja)) &lt;&lt; " " &lt;&lt; novi-&gt;karta.vrijednost &lt;&lt; endl;*/
    for(;;) {
        shared_ptr&lt;Cvor&gt;prethodni=DajPrethodni(c,p);
        shared_ptr&lt;Cvor&gt; zadnji=DajZadnji(c);
        int i2 {},i3 {};
        for(int i=0; i&lt;Karte.size(); i++,i2++) if(p-&gt;karta.vrijednost==Karte.at(i)) break;
        for(int i=0; i&lt;Karte.size(); i++,i3++) if(prethodni-&gt;karta.vrijednost==Karte.at(i)) break;
        
       /* cout  &lt;&lt; "Trenutni: " &lt;&lt; TipKarata.at(int(p-&gt;karta.boja)) &lt;&lt; " " &lt;&lt; p-&gt;karta.vrijednost &lt;&lt; endl;
        cout  &lt;&lt; "Prethodni: " &lt;&lt; TipKarata.at(int(prethodni-&gt;karta.boja)) &lt;&lt; " " &lt;&lt; prethodni-&gt;karta.vrijednost &lt;&lt; endl; */
        
        if(novi-&gt;karta.boja&gt;=prethodni-&gt;karta.boja &amp;&amp; novi-&gt;karta.boja&lt;=p-&gt;karta.boja) {
            if((i1&gt;=i3 || novi-&gt;karta.boja&gt;prethodni-&gt;karta.boja) &amp;&amp; (i1&lt;=i2 || novi-&gt;karta.boja&lt;p-&gt;karta.boja)) {
                prethodni-&gt;sljedeci=novi;
                novi-&gt;sljedeci=p;
                break;
            }
        }

        if(prethodni==zadnji){
            // Dva slucaja - stavljamo novi zadnji ili novi prvi
            
            //Novi zadnji
            if(novi-&gt;karta.boja&gt;=prethodni-&gt;karta.boja &amp;&amp; i1&gt;i3){
                prethodni-&gt;sljedeci=novi;
                novi-&gt;sljedeci=c;
                break;
            }
            
            // Novi prvi
<a name="3"></a><font color="#00FFFF"><a href="match982-1.html#3" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

            else if(novi-&gt;karta.boja&lt;p-&gt;karta.boja || (novi-&gt;karta.boja==p-&gt;karta.boja &amp;&amp; i1&lt;=i2)){
</font><a name="3"></a><font color="#00FFFF"><a href="match982-1.html#3" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

                prethodni-&gt;sljedeci=novi;
</font>                c=novi;
                c-&gt;sljedeci=p;
                break;
            }
        }
        
        p=p-&gt;sljedeci;
    }

}

bool validanStack(pair&lt;string,string&gt; p) {
    bool validan {false};
    for(int i=0; i&lt;TipKarata.size(); i++)
        if(p.first==TipKarata.at(i)) validan=true;
    if(!validan) return false;
    for(int i=0; i&lt;Karte.size(); i++)
        if(p.second==Karte.at(i)) validan=true;
    if(!validan) return false;
    return true;
}

void VratiPosljednjihNKarata(shared_ptr&lt;Cvor&gt;&amp;c, std::stack&lt;pair&lt;string,string&gt;&gt; s, int n) {
    if(n&lt;0) throw std::domain_error("Broj n je besmislen!");
    else if(n&gt;s.size()) throw std::range_error("Nedovoljno karata u steku!");
    while(n!=0) {
        int i;
        if(!validanStack(s.top())) throw std::logic_error("Neispravne karte");
        for(i=0; i&lt;4; i++) if(s.top().first==TipKarata.at(i)) break;
        pair&lt;Boje,string&gt; temp(std::make_pair(static_cast&lt;Boje&gt;(i),s.top().second));
        shared_ptr&lt;Cvor&gt;&amp;p=c;
        if(!Prisutan(p,temp)) Podesi(p,temp);
        n--;
        s.pop();
        gvelicina++;
    }
}

int main () {
    /*int r;
    cout &lt;&lt; "Unesite korak razbrajanja: ";
    cin &gt;&gt; r;
    int b;
    cout &lt;&lt; "Unesite broj karata koje zelite izbaciti: ";
    cin &gt;&gt; b;
    shared_ptr&lt;Cvor&gt; spil {nullptr};
   try {
        spil = KreirajSpil();
        auto q=IzbaciKarteRazbrajanjem(spil,r,b);
        cout &lt;&lt; "U spilu trenutno ima " &lt;&lt; gvelicina &lt;&lt; " karata, i to:"&lt;&lt; endl;
        IspisSpila(spil);
        int p;
        cout &lt;&lt; endl;
        cout &lt;&lt; "Unesite broj karata koje zelite vratiti u spil: ";
        cin &gt;&gt; p;
        VratiPosljednjihNKarata(spil,q,p);
        cout &lt;&lt; "U spilu trenutno ima " &lt;&lt; gvelicina &lt;&lt; " karata, i to:"&lt;&lt; endl;
        IspisSpila(spil);
    } catch(std::exception &amp;ex) {
        cout &lt;&lt; "Izuzetak: " &lt;&lt; ex.what();
    } 

     shared_ptr&lt;Cvor&gt;spil {nullptr};
     try {
         spil = KreirajSpil();
         MMapa mapa {{Boje::Pik,"3"},{Boje::Pik,"4"},{Boje::Pik,"5"},{Boje::Pik,"6"},{Boje::Pik,"7"},
             {Boje::Pik,"8"},{Boje::Pik,"9"},{Boje::Pik,"10"},{Boje::Pik,"J"},{Boje::Pik,"K"},{Boje::Pik,"A"},{Boje::Pik,"Q"},
             {Boje::Tref,"2"},{Boje::Tref,"3"},{Boje::Tref,"4"},{Boje::Tref,"5"},{Boje::Tref,"6"},{Boje::Tref,"7"},{Boje::Tref,"10"},
             {Boje::Karo,"2"},{Boje::Karo,"3"},{Boje::Karo,"4"},{Boje::Karo,"5"},{Boje::Karo,"6"},{Boje::Karo,"7"},
             {Boje::Karo,"8"},{Boje::Karo,"9"},{Boje::Karo,"10"},{Boje::Karo,"J"}
         };
         IzbaciKarte(spil,mapa);
         IspisSpila(spil);
     } catch(std::exception &amp;ex) {
         cout &lt;&lt; "Izuzetak: " &lt;&lt; ex.what() &lt;&lt; endl;
     }
     if(spil!=nullptr) spil-&gt;sljedeci=nullptr;
     spil=nullptr;*/
     
    return 0;
}
</pre>
</body>
</html>
