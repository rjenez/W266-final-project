<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z3/Z6/student6410.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z3/Z6/student6410.cpp<p></p><pre>
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;map&gt;
#include &lt;stack&gt;
#include &lt;vector&gt;
#include &lt;stdexcept&gt;
#include &lt;cstring&gt;
#include &lt;memory&gt;

using std::cout;
using std::cin;

<a name="2"></a><font color="#0000FF"><a href="match835-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

enum class Boje {Pik, Tref, Herc, Karo};

struct Karta {
    Boje boja;
    std::string vrijednost;
};

struct Cvor {
    Karta karta;
    std::shared_ptr&lt;Cvor&gt; sljedeci;
</font>};

void PredKraj(std::shared_ptr&lt;Cvor&gt; pocetak) {
    if(!pocetak) return;
    auto p(pocetak);
    for(;;) {
        if(p-&gt;sljedeci==pocetak) {
            p-&gt;sljedeci=nullptr;
            break;
        }
        p=p-&gt;sljedeci;
    }
}

void PostaviNaKraj(std::shared_ptr&lt;Cvor&gt; pocetak, std::shared_ptr&lt;Cvor&gt; (&amp;kraj)) {
    if(pocetak==nullptr) return;
    auto p(pocetak);
    for(;;) {
        if(p-&gt;sljedeci==pocetak) kraj=p;
        p=p-&gt;sljedeci;
        if(p==pocetak) break;
    }
}

int VelicinaSpila(std::shared_ptr&lt;Cvor&gt; pocetak) {
    auto p(pocetak);
    if(p==nullptr) return 0;
    int velicina(0);
    for(;;) {
        p=p-&gt;sljedeci;
        velicina++;
        if(p==pocetak) break;
    }
    return velicina;
}

int PorediKarte(Karta card1, Karta card2) {
    if(int(card1.boja)&gt;int(card2.boja)) return 1;
    else if(int(card1.boja)&lt;int(card2.boja)) return 2;
    
    int pomocna1, pomocna2;
    if(card1.vrijednost=="J") pomocna1=11; 
    else if(card1.vrijednost=="Q") pomocna1=12;
    else if(card1.vrijednost=="K") pomocna1=13;
    else if(card1.vrijednost=="A") pomocna1=14;
    else pomocna1=std::stoi(card1.vrijednost);
    
    if(card2.vrijednost=="J") pomocna2=11; 
    else if(card2.vrijednost=="Q") pomocna2=12;
    else if(card2.vrijednost=="K") pomocna2=13;
    else if(card2.vrijednost=="A") pomocna2=14;
    else pomocna2=std::stoi(card2.vrijednost);
    
    if(pomocna1&gt;pomocna2) return 1;
    else if(pomocna1&lt;pomocna2) return 2;
    
    return 3;
}

bool JeLiSortiran(std::shared_ptr&lt;Cvor&gt; pocetak) {
    if(pocetak==nullptr) return true;
    auto p(pocetak);
    for(;;) {
        if(p-&gt;sljedeci==pocetak) break;
        if(PorediKarte(p-&gt;karta, p-&gt;sljedeci-&gt;karta)==1) return false;
        p=p-&gt;sljedeci;
    }
    return true;
}

bool TestirajKruznost(std::shared_ptr&lt;Cvor&gt; pocetak) {
    if(pocetak==nullptr) return true;
    auto p(pocetak);
    for(int i=0; i&lt;52; i++) {
        p=p-&gt;sljedeci;
        if(p==pocetak) return true;
    }
    return false;
}

bool JednakeKarte(Karta card1, Karta card2) {
    return card1.boja==card2.boja &amp;&amp; card1.vrijednost==card2.vrijednost;
}

bool RegularnostKarte(Karta karta) {
    if(karta.boja!=Boje::Pik &amp;&amp; karta.boja!=Boje::Tref &amp;&amp; karta.boja!=Boje::Herc &amp;&amp; karta.boja!=Boje::Karo) return false;
    if(karta.vrijednost=="J" || karta.vrijednost=="Q" || karta.vrijednost=="A" || karta.vrijednost=="K") return true;
    
    for(int i=0; i&lt;10; i++) {
        if(std::to_string(i+1)==karta.vrijednost) return true;
    }
    return false;
}
std::shared_ptr&lt;Cvor&gt; KreirajSpil() {
    std::shared_ptr&lt;Cvor&gt; pocetak(nullptr), prethodni;
    int boja(0);
    for(int i=1; i&lt;14; i++) {
        Karta pomocna;
        pomocna.boja=Boje(boja);
        if(i&lt;10) pomocna.vrijednost=std::to_string(i+1);
        else {
            if(i==10) pomocna.vrijednost="J";
            if(i==11) pomocna.vrijednost="Q";
            if(i==12) pomocna.vrijednost="K";
            if(i==13) pomocna.vrijednost="A";
        }
        std::shared_ptr&lt;Cvor&gt; novi(new Cvor{pomocna, nullptr});
        if(!pocetak) pocetak=novi;
        else prethodni-&gt;sljedeci = novi;
        prethodni=novi;
        if(boja==3 &amp;&amp; i==13) novi-&gt;sljedeci=pocetak;
        if(i==13) {
            boja++;
            if(boja==4) break;
            else i=0;
        }
    }
    return pocetak;
}

void IzbaciKarte(std::shared_ptr&lt;Cvor&gt; (&amp;pocetak), std::multimap&lt;Boje, std::string&gt; izbaci) {
    if(VelicinaSpila(pocetak)&gt;52) throw std::logic_error("Neispravna lista!");
    if(!JeLiSortiran(pocetak)) throw std::logic_error("Neispravna lista!");
    auto it(izbaci.begin());
    
    while(it!=izbaci.end()) {
        Karta pomocna{it-&gt;first, it-&gt;second};
        
        auto p(pocetak);
        std::shared_ptr&lt;Cvor&gt; p_before;
        PostaviNaKraj(pocetak, p_before);
        
        if(!TestirajKruznost(pocetak)) throw std::domain_error("Neispravna lista");
        for(int i=0; i&lt;52; i++) {
            if(!RegularnostKarte(p-&gt;karta)) throw std::logic_error("Neispravna lista");
            
            if(JednakeKarte(pomocna, p-&gt;karta)) {
                std::shared_ptr&lt;Cvor&gt; pomocni(p-&gt;sljedeci);
                if(p==pocetak) pocetak=pomocni;
                if(p==p-&gt;sljedeci) {
                    p-&gt;sljedeci=nullptr;
                    pocetak=nullptr;
                } else {
                    p=pomocni;
                    p_before-&gt;sljedeci=p;
                }
            }
            if(p-&gt;sljedeci==pocetak) break;
            if(p==nullptr) break;
            p_before=p_before-&gt;sljedeci;
            p=p-&gt;sljedeci;
        }
<a name="0"></a><font color="#FF0000"><a href="match835-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_2.gif"/></a>

        it++;
    }
}

std::stack&lt;std::pair&lt;std::string, std::string&gt;&gt; IzbaciKarteRazbrajanjem(std::shared_ptr&lt;Cvor&gt; (&amp;pocetak), const short int &amp;korak, const int &amp;koliko_karata) {
    if(korak&lt;1 || korak&gt;52 || koliko_karata&lt;1) throw std::logic_error("Neispravni elementi za izbacivanje!");
</font>    if(VelicinaSpila(pocetak)&gt;52) throw std::logic_error("Neispravna lista!");
    if(!JeLiSortiran(pocetak)) throw std::logic_error("Neispravna lista!");
    auto bezvezni(pocetak);
    for(int i=0; i&lt;52; i++) {
        if(!RegularnostKarte(bezvezni-&gt;karta)) throw std::logic_error("Neispravna lista!");
        bezvezni=bezvezni-&gt;sljedeci;
        if(bezvezni==pocetak) break;
    }
    
    std::stack&lt;std::pair&lt;std::string, std::string&gt;&gt; povratni;
    std::vector&lt;std::string&gt; v {"Pik", "Tref", "Herc", "Karo"};
    
    int brojac(0);
    std::shared_ptr&lt;Cvor&gt; p_before;
    PostaviNaKraj(pocetak, p_before);
    auto p(pocetak);
    
    if(!TestirajKruznost(pocetak)) throw std::domain_error("Neispravna lista");
    
    while(brojac!=koliko_karata &amp;&amp; pocetak!=nullptr) {
        
        for(int i=1; i&lt;korak; i++) {
            p=p-&gt;sljedeci;
            p_before=p_before-&gt;sljedeci;
        }
        
        std::pair&lt;std::string, std::string&gt; pomocni(v.at(int(p-&gt;karta.boja)), p-&gt;karta.vrijednost);
        povratni.push(pomocni);
        
        std::shared_ptr&lt;Cvor&gt; help(p-&gt;sljedeci);
        if(p==pocetak) pocetak=help;
        if(p==p-&gt;sljedeci) {
            p-&gt;sljedeci=nullptr;
            pocetak=nullptr;
        } else {
            p=help;
            p_before-&gt;sljedeci=p;
        }
<a name="1"></a><font color="#00FF00"><a href="match835-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

        brojac++;
    }
    return povratni;
}

void VratiPosljednjihNKarata(std::shared_ptr&lt;Cvor&gt; (&amp;pocetak), std::stack&lt;std::pair&lt;std::string, std::string&gt;&gt; &amp;stek, int n) {
</font>    if(n&gt;int(stek.size())) throw std::range_error("Nedovoljno karata u redu!");
    if(n&lt;0) throw std::domain_error("Broj n je besmislen!");
    if(VelicinaSpila(pocetak)&gt;52) throw std::logic_error("Neispravne karte!");
    if(!JeLiSortiran(pocetak)) throw std::logic_error("Neispravna lista!");
    
    std::vector&lt;std::string&gt; v {"Pik", "Tref", "Herc", "Karo"};
    
    while(n!=0) {
        Karta pomocna;
        for(int i=0; i&lt;4; i++) 
            if(v[i]==stek.top().first) pomocna.boja=Boje(i);
        pomocna.vrijednost=stek.top().second;
        if(!RegularnostKarte(pomocna)) throw std::logic_error("Neispravne karte!");
        
        auto p(pocetak);
        std::shared_ptr&lt;Cvor&gt; p_before;
        PostaviNaKraj(pocetak, p_before);
        if(pocetak==nullptr) {
            std::shared_ptr&lt;Cvor&gt; novi(new Cvor{pomocna});
            pocetak=novi;
            pocetak-&gt;sljedeci=pocetak;
        }
        else if(PorediKarte(p-&gt;karta, pomocna)==3 || PorediKarte(p_before-&gt;karta, pomocna)==3) {
            stek.pop();
            n--;
            continue;
        }
        else if(p==p-&gt;sljedeci) {
            if(PorediKarte(p-&gt;karta, pomocna)==1) {
                std::shared_ptr&lt;Cvor&gt; novi(new Cvor{pomocna});
                pocetak=novi;
                p=novi;
                p-&gt;sljedeci=p_before;
                p_before-&gt;sljedeci=p;
            } else if(PorediKarte(p-&gt;karta, pomocna)==2) {
                std::shared_ptr&lt;Cvor&gt; novi(new Cvor{pomocna});
                p_before=novi;
                p_before-&gt;sljedeci=p;
                p-&gt;sljedeci=p_before;
            }
        } else if(PorediKarte(pocetak-&gt;karta, pomocna)==1) {
            std::shared_ptr&lt;Cvor&gt; novi(new Cvor{pomocna});
            pocetak=novi;
            p_before-&gt;sljedeci=pocetak;
            pocetak-&gt;sljedeci=p;
        } else if(PorediKarte(p_before-&gt;karta, pomocna)==2) {
            std::shared_ptr&lt;Cvor&gt; novi(new Cvor{pomocna});
            p_before-&gt;sljedeci=novi;
            novi-&gt;sljedeci=pocetak;
        }
        
    else for(;;) {
            if(PorediKarte(p-&gt;karta, pomocna)==3 || PorediKarte(p_before-&gt;karta, pomocna)==3 || PorediKarte(p-&gt;sljedeci-&gt;karta, pomocna)==3) break;
            if(PorediKarte(p-&gt;karta, pomocna)==2 &amp;&amp; PorediKarte(pomocna, p-&gt;sljedeci-&gt;karta)==2) {
                std::shared_ptr&lt;Cvor&gt; novi(new Cvor{pomocna});
                auto pomocni(p-&gt;sljedeci);
                p-&gt;sljedeci=novi;
                novi-&gt;sljedeci=pomocni;
            }
            p=p-&gt;sljedeci;
            p_before=p_before-&gt;sljedeci;
            if(p==pocetak) break;
        }
        stek.pop();
        n--;
    }
}

void IspisSpila(std::shared_ptr&lt;Cvor&gt; pocetak) {
    int i(0);
    auto p(pocetak);
    if(pocetak==nullptr) i=0;
    for(i=0; i&lt;52; i++) {
        if(pocetak==nullptr) { i=-1; break; };
        p=p-&gt;sljedeci;
        if(p==pocetak) break;
    }
    i++;
    
    std::cout&lt;&lt;"U spilu trenutno ima "&lt;&lt;i&lt;&lt;" karata, i to:\n";
    
    p=pocetak;
    std::vector&lt;std::string&gt; v {"Pik", "Tref", "Herc", "Karo"};
    for(int i=0; i&lt;4; i++) {
        cout&lt;&lt;v[i]&lt;&lt;": ";
        while( p!=nullptr &amp;&amp; p-&gt;karta.boja==Boje(i)) {
            std::cout&lt;&lt;p-&gt;karta.vrijednost&lt;&lt;" ";
            p=p-&gt;sljedeci;
            if(p==pocetak) break;
        }
        std::cout&lt;&lt;"\n";
    }
}

int main ()
{
    auto lista(KreirajSpil());
    int korak, broj_karata;
    cout&lt;&lt;"Unesite korak razbrajanja: ";
    cin&gt;&gt;korak;
    cout&lt;&lt;"Unesite broj karata koje zelite izbaciti: ";
    cin&gt;&gt;broj_karata;
    std::stack&lt;std::pair&lt;std::string, std::string&gt;&gt; izbacene;
    
    try {
        izbacene=IzbaciKarteRazbrajanjem(lista, korak, broj_karata);
        IspisSpila(lista);
        try {
            int broj_vracenih;
            cout&lt;&lt;"Unesite broj karata koje zelite vratiti u spil: ";
            cin&gt;&gt;broj_vracenih;
            VratiPosljednjihNKarata(lista, izbacene, broj_vracenih);
            IspisSpila(lista);
        } catch(const std::exception &amp;ex) {
            cout&lt;&lt;"Izuzetak: "&lt;&lt;ex.what();
        }
    } catch(std::logic_error izuzetak) {
        cout&lt;&lt;"Izuzetak: "&lt;&lt;izuzetak.what();
    }
    PredKraj(lista);
    
    return 0;
}
</pre>
</body>
</html>
