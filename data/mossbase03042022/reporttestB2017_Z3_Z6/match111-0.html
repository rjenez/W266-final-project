<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z3/Z6/student3253.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z3/Z6/student3253.cpp<p></p><pre>
<a name="0"></a><font color="#FF0000"><a href="match111-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_99.gif"/></a>

/B2017/2018: ZadaÄ‡a 3, Zadatak 6

#include &lt;iostream&gt;
#include &lt;list&gt;
#include &lt;utility&gt;
#include &lt;vector&gt;
#include &lt;map&gt;
#include &lt;stack&gt;
#include &lt;algorithm&gt;
#include &lt;string&gt;
#include &lt;exception&gt;
#include &lt;memory&gt;

enum class Boje { Pik, Tref, Herc, Karo };
const std::vector&lt;Boje&gt; sveBoje = { Boje::Pik, Boje::Tref, Boje::Herc, Boje::Karo };
const std::vector&lt;std::string&gt; naziviKarata = { "2", "3", "4", "5", "6", "7", "8", "9", "10", "J", "Q", "K", "A" };    

typedef std::list&lt;std::pair&lt;Boje, std::string&gt;&gt; Spil;

struct Karta {
    Boje boja;
    std::string vrijednost;
};

struct Cvor {
    Karta karta;
    std::shared_ptr&lt;Cvor&gt; sljedeci;
};

std::string dajStringBoje(Boje b) {
    switch (b) {
        case Boje::Pik: return "Pik";
        case Boje::Tref: return "Tref";
        case Boje::Herc: return "Herc";
        case Boje::Karo: return "Karo";
        default: return "Nepoznato";
    }
}

void ispisiSpil(std::shared_ptr&lt;Cvor&gt; spil){
    auto trenutniCvor = spil;
    auto spilSize = 0;
    while(true){
        spilSize++;
        if(trenutniCvor-&gt;sljedeci == spil) break;
        trenutniCvor = trenutniCvor-&gt;sljedeci;
    }
    trenutniCvor = spil;
    
    std::string boja = "NULL";
    std::cout &lt;&lt; "U spilu trenutno ima " &lt;&lt; spilSize &lt;&lt; " karata, i to:";
    while(true){
        if( dajStringBoje(trenutniCvor-&gt;karta.boja) != boja){
            boja = dajStringBoje(trenutniCvor-&gt;karta.boja);
            std::cout &lt;&lt; std::endl;
            std::cout &lt;&lt; boja &lt;&lt; ":";
        }
        std::cout&lt;&lt; " " &lt;&lt;trenutniCvor-&gt;karta.vrijednost;
        if(trenutniCvor-&gt;sljedeci == spil) break;
        trenutniCvor = trenutniCvor-&gt;sljedeci;
    }
    std::cout &lt;&lt; std::endl;
}



void provjeriSpil(std::shared_ptr&lt;Cvor&gt; spil){
    auto trenutniCvor = spil;
    auto spilSize = 0;
    while (true){
        spilSize++;
        if (trenutniCvor-&gt;sljedeci == spil) break;
        
        if(spilSize &gt; 52){
            throw std::logic_error("Neispravna lista!");
        }

        trenutniCvor = trenutniCvor-&gt;sljedeci;
    }
    trenutniCvor = spil;
    
    
    for(Boje boja : sveBoje){
        for(std::string naziv : naziviKarata){
            if(trenutniCvor-&gt;sljedeci == spil){
                return;
            }
            if(trenutniCvor-&gt;karta.boja == boja &amp;&amp; trenutniCvor-&gt;karta.vrijednost == naziv){
                trenutniCvor = trenutniCvor -&gt; sljedeci;
            }
        }
    }
    if(trenutniCvor-&gt;sljedeci != spil){
        throw std::logic_error("Neispravna lista!");
    }
}

std::shared_ptr&lt;Cvor&gt; KreirajSpil() {
    std::shared_ptr&lt;Cvor&gt; cvor;
    std::shared_ptr&lt;Cvor&gt; pocetak = nullptr;
    std::shared_ptr&lt;Cvor&gt; kraj = nullptr;

    for (Boje boja: sveBoje) {
        for (std::string naziv: naziviKarata) {
            // spil.push_back(std::make_pair(boja, naziv));
            cvor = std::make_shared&lt;Cvor&gt;();
            cvor-&gt;karta.boja = boja;
            cvor-&gt;karta.vrijednost = naziv;
            
            if (pocetak == nullptr) {
                pocetak = cvor;
                kraj = cvor;
                cvor-&gt;sljedeci = cvor;
            } else {
                kraj-&gt;sljedeci = cvor;
                cvor-&gt;sljedeci = pocetak;
                kraj = cvor;
            }
        }
    }    
    
    return pocetak;
}

void IzbaciKarte(std::shared_ptr&lt;Cvor&gt; &amp;spil, std::multimap&lt;Boje, std::string&gt; &amp;crnaLista) {
    std::pair &lt;std::multimap&lt;Boje, std::string&gt;::iterator, std::multimap&lt;Boje, std::string&gt;::iterator&gt; ret;
    auto trenutniCvor = spil;
    auto prethodniCvor = spil;

    provjeriSpil(spil);
    
    while (true) {
        
        bool izbaciKartu = false;
        ret = crnaLista.equal_range(trenutniCvor-&gt;karta.boja);
        for(std::multimap&lt;Boje, std::string&gt;::iterator itCL=ret.first; itCL != ret.second; ++itCL){
            if(itCL-&gt;second == trenutniCvor-&gt; karta.vrijednost){
                std::cout&lt;&lt;"Brisem: " &lt;&lt; dajStringBoje(itCL-&gt;first) &lt;&lt; " " &lt;&lt; itCL-&gt;second &lt;&lt; std::endl;
                crnaLista.erase(itCL);
                izbaciKartu = true;
                break;
            }
        }
        
        if(izbaciKartu){
            if(trenutniCvor == trenutniCvor-&gt;sljedeci){
                trenutniCvor-&gt;sljedeci = nullptr;
                trenutniCvor = nullptr;
                spil = nullptr;
                return;
            } 
            
            if (trenutniCvor == spil) {
                spil = trenutniCvor-&gt;sljedeci;
            }
            
            trenutniCvor = trenutniCvor-&gt;sljedeci;
            prethodniCvor-&gt;sljedeci-&gt;sljedeci = nullptr;
            prethodniCvor-&gt;sljedeci = trenutniCvor;
        } else {
            prethodniCvor = trenutniCvor;
            trenutniCvor = trenutniCvor-&gt;sljedeci;
        }
        
        if(trenutniCvor-&gt;sljedeci == spil) {
            break;
        }
    }
}

std::stack&lt;std::pair&lt;std::string, std::string&gt;&gt; IzbaciKarteRazbrajanjem(std::shared_ptr&lt;Cvor&gt; spil, const short int &amp;r, const int &amp;b){
    std::stack&lt;std::pair&lt;std::string, std::string&gt;&gt; red;
    auto trenutniCvor = spil;
    auto prethodniCvor = spil;
    int korak = 1;
    int izbaceno = 0;
    
    if (r &lt; 1 || r &gt; 52 || b &lt; 1){
        throw std::logic_error("Neispravni elementi za izbacivanje!");
        // std::cout &lt;&lt; "Izuzetak: Neispravni elementi za izbacivanje!" &lt;&lt; std::endl;
    }
    provjeriSpil(spil);
    
    while(izbaceno &lt; b) {
        
        if(korak == r){
            izbaceno++;
            red.push(std::make_pair(dajStringBoje(trenutniCvor-&gt;karta.boja), trenutniCvor-&gt;karta.vrijednost));
            // std::cout &lt;&lt; "Brisem " &lt;&lt; dajStringBoje(itSpil-&gt;first) &lt;&lt; " " &lt;&lt; itSpil-&gt;second &lt;&lt; std::endl;
            
            if(trenutniCvor == trenutniCvor-&gt;sljedeci) {
                trenutniCvor-&gt;sljedeci = nullptr;
                trenutniCvor = nullptr;
                spil = nullptr;
                return red;
            }
            if(trenutniCvor == spil){
                spil = trenutniCvor-&gt;sljedeci;
            }
            trenutniCvor = trenutniCvor-&gt;sljedeci;
            prethodniCvor-&gt;sljedeci-&gt;sljedeci = nullptr;
            prethodniCvor-&gt;sljedeci = trenutniCvor;
            
            korak = 1;
            continue;
        }
        
        prethodniCvor = trenutniCvor;
        trenutniCvor = trenutniCvor-&gt;sljedeci;
        ++korak;
    }
    return red;
}

void provjeriValidnostReda(std::stack&lt;std::pair&lt;std::string, std::string&gt;&gt; red, int n){
    if(n&lt;0){
        throw std::domain_error("Broj n je besmislen!");
    }
    if(n &gt; red.size()){
        throw std::range_error("Nedovoljno karata u redu!");
    }
    while(!red.empty()){
        std::string boja = red.top().first;
        if(boja != "Pik" &amp;&amp; boja !="Tref" &amp;&amp; boja != "Herc" &amp;&amp; boja!="Karo"){
            throw std::logic_error("Neispravne karte!");
        }
        if(std::find(naziviKarata.begin(), naziviKarata.end(), red.top().second) == naziviKarata.end()){
            throw std::logic_error("Neispravne karte!");
        }
        red.pop();
    }
}

void VratiPosljednjihNKarata(std::shared_ptr&lt;Cvor&gt; spil, std::stack&lt;std::pair&lt;std::string, std::string&gt;&gt; &amp;red, int n){
    provjeriValidnostReda(red, n);
    
    while(n&gt;0){
        auto trenutna = red.top();
        auto trenutniCvor = spil;
        auto prethodniCvor = spil;
        
        for(Boje boja: sveBoje) {
            for(std::string naziv: naziviKarata){
                if(trenutniCvor-&gt;karta.boja == boja &amp;&amp; trenutniCvor-&gt;karta.vrijednost == naziv){
                    prethodniCvor = trenutniCvor;
                    trenutniCvor = trenutniCvor-&gt;sljedeci;
                } else if(trenutna.first == dajStringBoje(boja) &amp;&amp; trenutna.second == naziv){
                    auto cvor = std::make_shared&lt;Cvor&gt;();
                    cvor-&gt;karta.boja = boja;
                    cvor-&gt;karta.vrijednost = naziv;
                    prethodniCvor-&gt;sljedeci = cvor;
                    cvor-&gt;sljedeci = trenutniCvor;
                }
            }
        }
        red.pop();
        n--;
    }
}

int main ()
{
    
    std::shared_ptr&lt;Cvor&gt; nepotpunSpil = KreirajSpil();

    std::multimap&lt;Boje, std::string&gt; crnaLista = {

        { Boje::Herc , "A" },
        { Boje::Herc , "Q" },
        { Boje::Karo , "9" },
        { Boje::Pik , "9" },
    };
    
   int r, b, n;
   try {
       std::cout &lt;&lt; "Unesite korak razbrajanja: ";
       std::cin &gt;&gt; r;
       std::cout &lt;&lt; "Unesite broj karata koje zelite izbaciti: ";
       std::cin &gt;&gt; b;
       std::stack&lt;std::pair&lt;std::string, std::string&gt;&gt; red = IzbaciKarteRazbrajanjem(nepotpunSpil, r, b);
       ispisiSpil(nepotpunSpil);
       std::cout&lt;&lt; "Unesite broj karata koje zelite vratiti u spil: ";
       std::cin &gt;&gt; n;
       VratiPosljednjihNKarata(nepotpunSpil, red, n);
       ispisiSpil(nepotpunSpil);
       // std::cout&lt;&lt;"--------------------------------------------------" &lt;&lt; std::endl;
   } catch (std::exception &amp;ex) {
       std::cout &lt;&lt; "Izuzetak: " &lt;&lt; ex.what() &lt;&lt; std::endl;
   }
   
   nepotpunSpil-&gt;sljedeci = nullptr;
   nepotpunSpil = nullptr;
   
	return 0;
</font>}

</pre>
</body>
</html>
