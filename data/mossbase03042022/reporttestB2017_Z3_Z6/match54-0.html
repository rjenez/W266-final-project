<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z3/Z6/student4261.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z3/Z6/student4261.cpp<p></p><pre>
<a name="0"></a><font color="#FF0000"><a href="match54-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_99.gif"/></a>

/B2017/2018: ZadaÄ‡a 3, Zadatak 6
#include &lt;iostream&gt;
#include &lt;memory&gt;
#include &lt;stdexcept&gt;
#include &lt;map&gt;
#include &lt;string&gt;
#include &lt;stack&gt;



enum class Boje {Pik, Tref, Herc, Karo};

struct Karta {
    Boje boja;
    std::string vrijednost;
};

struct Cvor {
    Karta karta;
    std::shared_ptr&lt;Cvor&gt; sljedeci;
};


std::shared_ptr&lt;Cvor&gt; KreirajSpil() {
    
    const char* karte[13]{"2", "3", "4", "5", "6", "7", "8", "9", "10", "J", "Q", "K", "A"};
    
    std::shared_ptr&lt;Cvor&gt; prva(nullptr), prethodna, nova;
    
    for (int i=0; i&lt;4; i++) {
        for (int j=0; j&lt;13; j++) {
            nova=std::make_shared&lt;Cvor&gt;();
            nova-&gt;karta={Boje(i), karte[j]}; nova-&gt;sljedeci=nullptr;
            if (!prva) prva=nova;
            else prethodna-&gt;sljedeci=nova;
            prethodna=nova;
        }
    }
    prethodna-&gt;sljedeci=prva;
    return prva;
}

bool Nije_Kruzna (std::shared_ptr&lt;Cvor&gt; prva) {
    std::shared_ptr&lt;Cvor&gt; trenutna(prva); 
    for (int i=0; i&lt;52; i++) {
        trenutna=trenutna-&gt;sljedeci;
        if (trenutna==nullptr) return true;
        if (trenutna==prva) return false;
    }
    return true;
}

bool Prije (Karta trenutna, Karta sljedeca) {
    const char* karte[13]{"2", "3", "4", "5", "6", "7", "8", "9", "10", "J", "Q", "K", "A"};
    int trenutna_vrijednost, sljedeca_vrijednost;
    for (int i=0; i&lt;13; i++) if (trenutna.vrijednost==karte[i]) trenutna_vrijednost=i;
    for (int i=0; i&lt;13; i++) if (sljedeca.vrijednost==karte[i]) sljedeca_vrijednost=i;
    if ((trenutna.boja==sljedeca.boja &amp;&amp; trenutna_vrijednost&gt;sljedeca_vrijednost) || int(trenutna.boja)&gt;int(sljedeca.boja)) return false;
    return true;
}

bool Nije_Sortirana (std::shared_ptr&lt;Cvor&gt; prva) {
    std::shared_ptr&lt;Cvor&gt; trenutna(prva);
    do {
        std::shared_ptr&lt;Cvor&gt; sljedeca(trenutna-&gt;sljedeci);
        if (sljedeca==prva) return false;
        if (trenutna-&gt;karta.boja==sljedeca-&gt;karta.boja &amp;&amp; trenutna-&gt;karta.vrijednost==sljedeca-&gt;karta.vrijednost) return true;
        if (Prije(sljedeca-&gt;karta, trenutna-&gt;karta)) return true;
        
        trenutna=trenutna-&gt;sljedeci;
    } while (trenutna!=prva);
    return false;
}

bool Besmisleni (std::string naziv_boje, std::string vrijednost) {
    const char* karte[13]{"2", "3", "4", "5", "6", "7", "8", "9", "10", "J", "Q", "K", "A"};
    const char* boje[4]{"Pik", "Tref", "Herc", "Karo"};
    for (int i=0; i&lt;4; i++) {
        for (int j=0; j&lt;13; j++) {
            if (naziv_boje==boje[i] &amp;&amp; vrijednost==karte[j]) return false;
        }
    }
    return true;
}

bool BesmislenaLista (std::shared_ptr&lt;Cvor&gt; prva) {
    const char* boje[4]{"Pik", "Tref", "Herc", "Karo"};
    if (Besmisleni(boje[int((*prva).karta.boja)], (*prva).karta.vrijednost)) return true;
    for (std::shared_ptr&lt;Cvor&gt; trenutna=prva-&gt;sljedeci; trenutna!=prva; trenutna=trenutna-&gt;sljedeci) if (Besmisleni(boje[int((*trenutna).karta.boja)], (*trenutna).karta.vrijednost)) return true;
    return false;
}

bool Neispravna (std::shared_ptr&lt;Cvor&gt; prva) {
    if (Nije_Kruzna(prva)) return true;
    if (BesmislenaLista(prva)) return true;
    if (Nije_Sortirana(prva)) return true;
    return false;
}

std::shared_ptr&lt;Cvor&gt; Obrisi (std::shared_ptr&lt;Cvor&gt; &amp;prethodna, std::shared_ptr&lt;Cvor&gt; &amp;trenutna) {
    prethodna-&gt;sljedeci=trenutna-&gt;sljedeci;
    trenutna-&gt;sljedeci=nullptr;
    trenutna=nullptr;
    return prethodna-&gt;sljedeci;
}

void IzbaciKarte (std::shared_ptr&lt;Cvor&gt; &amp;prva, std::multimap&lt;Boje, std::string&gt; &amp;multimapa) {
    if (prva==nullptr) return;
    if (Neispravna(prva)) throw std::logic_error("Neispravna lista!");
    
    for (auto it=multimapa.begin(); it!=multimapa.end(); it++) {
        
        std::shared_ptr&lt;Cvor&gt; zadnja(prva);
        while(zadnja-&gt;sljedeci!=prva) zadnja=zadnja-&gt;sljedeci;
        
        if ((*prva).karta.boja==(*it).first &amp;&amp; (*prva).karta.vrijednost==(*it).second) {
            prva=Obrisi(zadnja, prva);
            if (prva==nullptr) return;
        }
        else {
            std::shared_ptr&lt;Cvor&gt; prethodna(prva);
            for (std::shared_ptr&lt;Cvor&gt; trenutna=prva-&gt;sljedeci; trenutna!=prva; trenutna=trenutna-&gt;sljedeci) {
                
                if (trenutna!=prva-&gt;sljedeci) prethodna=prethodna-&gt;sljedeci;
                if ((*trenutna).karta.boja==(*it).first &amp;&amp; (*trenutna).karta.vrijednost==(*it).second) {
                    trenutna=Obrisi(prethodna, trenutna);
                    if (trenutna==nullptr) return;
                }
            }
        }
    }
    return;
}

std::stack&lt;std::pair&lt;std::string, std::string&gt;&gt; IzbaciKarteRazbrajanjem (std::shared_ptr&lt;Cvor&gt; &amp;prva, const short int &amp;korak_razbrajanja, int &amp;broj_karata) {
    std::stack&lt;std::pair&lt;std::string, std::string&gt;&gt; red;
    if (prva==nullptr) return red;
    if (korak_razbrajanja&lt;1 || korak_razbrajanja&gt;52 || broj_karata&lt;1) throw std::logic_error("Neispravni elementi za izbacivanje!");
    if (Neispravna(prva)) throw std::logic_error("Neispravna lista!");
    
    int brojac(1), br_karata(broj_karata);
    const char* boje[4]{"Pik", "Tref", "Herc", "Karo"};
    std::shared_ptr&lt;Cvor&gt; trenutna(prva);
    std::shared_ptr&lt;Cvor&gt; prethodna(prva);
    while (prethodna-&gt;sljedeci!=trenutna) prethodna=prethodna-&gt;sljedeci;
    
    while (br_karata) {
        
        while (brojac!=korak_razbrajanja) { trenutna=trenutna-&gt;sljedeci; prethodna=prethodna-&gt;sljedeci; brojac++; }
        
        red.push(std::make_pair(boje[int((*trenutna).karta.boja)], (*trenutna).karta.vrijednost));
        if (trenutna==prva) {
            prva=Obrisi(prethodna, trenutna);
            if (prva==nullptr) return red;
            trenutna=prva;
            prethodna-&gt;sljedeci=prva;
        }
        else trenutna=Obrisi(prethodna, trenutna);
        if (trenutna==nullptr) return red;
        brojac=1;
        br_karata--;
    }
    return red;
}

bool BesmislenStek (std::stack&lt;std::pair&lt;std::string, std::string&gt;&gt; red) {
    
    while (!red.empty()) {
        if (Besmisleni(red.top().first, red.top().second)) return true;
        red.pop();
    }
    return false;
}

std::shared_ptr&lt;Cvor&gt; Ubaci (std::shared_ptr&lt;Cvor&gt; &amp;prethodna, std::shared_ptr&lt;Cvor&gt; &amp;trenutna, Karta karta) {
    std::shared_ptr&lt;Cvor&gt; nova=std::make_shared&lt;Cvor&gt;();
    nova-&gt;karta=karta; nova-&gt;sljedeci=trenutna;
    prethodna-&gt;sljedeci=nova;
    return nova;
}

void VratiPosljednjihNKarata (std::shared_ptr&lt;Cvor&gt; &amp;prva, std::stack&lt;std::pair&lt;std::string, std::string&gt;&gt; &amp;red, int n) {
    
    if (n&lt;0) throw std::domain_error("Broj n je besmislen!");
    if (n&gt;int(red.size())) throw std::range_error ("Nedovoljno karata u steku!");
    if (BesmislenStek(red)) throw std::logic_error("Neispravne karte!");
    if (n==0 || red.empty()) return;
    
    const char* boje[4]{"Pik", "Tref", "Herc", "Karo"};
    
    std::pair&lt;std::string, std::string&gt; karta(red.top());
    int redni_broj(0);
    for (int i=0; i&lt;4; i++) if (karta.first==boje[i]) redni_broj=i;
    
    if (prva==nullptr) {
        prva=std::make_shared&lt;Cvor&gt;();
        prva-&gt;karta={Boje(redni_broj), karta.second};
        prva-&gt;sljedeci=prva;
        red.pop();
        n--;
    }
    
    while (n &amp;&amp; red.size()) {
        
        std::shared_ptr&lt;Cvor&gt; trenutna(prva), prethodna(prva);
        while (prethodna-&gt;sljedeci!=prva) prethodna=prethodna-&gt;sljedeci;
        
        karta=red.top();
        for (int i=0; i&lt;4; i++) if (karta.first==boje[i]) redni_broj=i;
        
        for (;;) {
            if (int((*trenutna).karta.boja)==redni_broj &amp;&amp; (*trenutna).karta.vrijednost==karta.second) {
                red.pop();
                break;
            }
            else if (int((*prethodna).karta.boja)==redni_broj &amp;&amp; (*prethodna).karta.vrijednost==karta.second) {
                red.pop();
                break;
            }
            else if ((int((*trenutna).karta.boja)==redni_broj &amp;&amp; Prije({Boje(redni_broj), karta.second}, (*trenutna).karta)) || int((*trenutna).karta.boja)&gt;redni_broj || (trenutna==prva &amp;&amp; ((int((*prethodna).karta.boja)==redni_broj &amp;&amp; Prije((*prethodna).karta, {Boje(redni_broj), karta.second})) || int((*prethodna).karta.boja)&lt;redni_broj ))) {
                if (trenutna==prva &amp;&amp; redni_broj&lt;=int((*prva).karta.boja)) prva=Ubaci(prethodna, prva,  {Boje(redni_broj), karta.second});
                else trenutna=Ubaci(prethodna, trenutna, {Boje(redni_broj), karta.second});
                red.pop();
                n--;
                break;
            }
            trenutna=trenutna-&gt;sljedeci; prethodna=prethodna-&gt;sljedeci;
        }
    }
    return;
}

void Ispisi (std::shared_ptr&lt;Cvor&gt; prva) {
    const char* boje[4]{"Pik", "Tref", "Herc", "Karo"};
    
    for (int i=0; i&lt;4; i++) {
        std::cout &lt;&lt; std::endl &lt;&lt; boje[i] &lt;&lt; ": ";
        if (prva==nullptr) continue;
        if (int((*prva).karta.boja)==i) std::cout &lt;&lt; (*prva).karta.vrijednost &lt;&lt; " ";
        for (std::shared_ptr&lt;Cvor&gt; trenutna=prva-&gt;sljedeci; trenutna!=prva; trenutna=trenutna-&gt;sljedeci) {
            if (int((*trenutna).karta.boja)==i) std::cout &lt;&lt; (*trenutna).karta.vrijednost &lt;&lt; " ";
        }
    }
    std::cout &lt;&lt; std::endl;
    return;
}

int main ()
{
    short int r;
    int n, b;
    std::cout &lt;&lt; "Unesite korak razbrajanja: ";
    std::cin &gt;&gt; r;
    std::cout &lt;&lt; "Unesite broj karata koje zelite izbaciti: ";
    std::cin &gt;&gt; b;
    std::shared_ptr&lt;Cvor&gt; prva;
    try {
        prva=KreirajSpil();
        std::stack&lt;std::pair&lt;std::string, std::string&gt;&gt; stek(IzbaciKarteRazbrajanjem(prva, r, b));
        std::cout &lt;&lt; "U spilu trenutno ima " &lt;&lt; 52-stek.size() &lt;&lt; " karata, i to:";
        Ispisi(prva);
        std::cout &lt;&lt; "Unesite broj karata koje zelite vratiti u spil: ";
        std::cin &gt;&gt; n;
        VratiPosljednjihNKarata(prva, stek, n);
        std::cout &lt;&lt; "U spilu trenutno ima " &lt;&lt; 52-stek.size() &lt;&lt; " karata, i to:";
        Ispisi(prva);
        
        if (prva!=nullptr) {
            std::shared_ptr&lt;Cvor&gt; zadnja(prva);
            while(zadnja-&gt;sljedeci!=prva) zadnja=zadnja-&gt;sljedeci;
            zadnja-&gt;sljedeci=nullptr;
        }
        
    }
    catch (std::exception &amp;izuzetak) {
        if (prva!=nullptr) {
            std::shared_ptr&lt;Cvor&gt; zadnja(prva);
            while(zadnja-&gt;sljedeci!=prva) zadnja=zadnja-&gt;sljedeci;
            zadnja-&gt;sljedeci=nullptr;
        }
        std::cout &lt;&lt; "Izuzetak: " &lt;&lt; izuzetak.what();
    }
    
	return 0;
</font>}
</pre>
</body>
</html>
