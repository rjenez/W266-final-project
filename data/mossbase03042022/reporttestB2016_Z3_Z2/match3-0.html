<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z3/Z2/student2908.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z3/Z2/student2908.cpp<p></p><pre>
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;map&gt;
#include &lt;vector&gt;
#include &lt;set&gt;
#include &lt;stdexcept&gt;
#include &lt;algorithm&gt;
#include &lt;iterator&gt;
#include &lt;utility&gt;
#include &lt;cctype&gt;
#include &lt;cstring&gt;
<a name="0"></a><font color="#FF0000"><a href="match3-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_99.gif"/></a>

typedef std::map&lt;std::string,std::set&lt;int&gt; &gt; Mapa;
void pretvori(std::string &amp;s){
     for(auto&amp; c : s)
{
   c = std::tolower(c);
}
}

 bool Legalno( char znak){
 	 if(  (znak&gt;='a' &amp;&amp; znak&lt;='z') || (znak&gt;='A' &amp;&amp; znak&lt;='Z') || (znak&gt;='0' &amp;&amp; znak&lt;='9') ) {return true;}
 	 else return false;
 }
 
void UkloniDuple( std::vector&lt;std::string&gt; &amp;vec)
{
    std::sort(vec.begin(), vec.end());
    vec.erase(std::unique(vec.begin(), vec.end()), vec.end());
}

std::vector&lt;std::string&gt;NadjiRijec(std::string s){
    pretvori(s);
    std::vector&lt;std::string&gt;Kraj;
	 std::vector&lt;int&gt;Kopije;
	 std::string Vrat;
     for(int i(0);i&lt;s.length();i++){
         if((s[i]&gt;='a' &amp;&amp; s[i]&lt;='z') || (s[i]&gt;='A' &amp;&amp; s[i]&lt;='Z') || (s[i]&gt;='0' &amp;&amp; s[i]&lt;='9') ){
             Kopije.push_back(i);
         }
     }
     for(int i(0);i&lt;Kopije.size();i++){
         Vrat.push_back(s[Kopije[i]]);
         if((i+1)!=Kopije.size() and abs(Kopije[i]-Kopije[i+1])!=1) Vrat.push_back(' ');
    }
    int poc(0),duz(0);
    for(int i(0);i&lt;Vrat.size();i++){
        if(Vrat[i]!=' ')  duz++;
         if(Vrat[i]==' ' || i==Vrat.size()-1) {Kraj.push_back(Vrat.substr(poc,duz)); poc=i+1; duz=0;}
    }
    UkloniDuple(Kraj);
return Kraj;
}
   void calc_z (std::string &amp;s, std::vector&lt;int&gt; &amp;z)
{
    int len = s.size();
    z.resize (len);

    int l = 0, r = 0;
    for (int i=1; i&lt;len; ++i)
        if (z[i-l]+i &lt;= r)
            z[i] = z[i-l];
        else
        {
            l = i;
            if (i &gt; r) r = i;
            for (z[i] = r-i; r&lt;len; ++r, ++z[i])
                if (s[r] != s[z[i]])
                    break;
            --r;
        }
}
std::set&lt;int&gt;NadjiIndeks(std::string s,std::string rijec){
    
    std::set&lt;int&gt;sk;
    std::string main_string = s;
    std::string substring = rijec;
    std::string working_string = s+rijec;
    std::vector&lt;int&gt; z;
    calc_z(working_string, z);
    for(int i = substring.size(); i &lt; working_string.size(); ++i){
        if(z[i] &gt;=substring.size()   and   rijec.size()==1 and Legalno(s[i - substring.size()-1])==false  &amp;&amp; Legalno(s[i - substring.size()+1])==false )   sk.insert( i - substring.size() );
           if(z[i] &gt;=substring.size()  ) {sk.insert(i-substring.size());}
    }
    return sk;
}
Mapa KreirajIndeksPojmova( std::string s){
    std::vector&lt;std::string&gt;Kljucevi;
     Mapa Indeksi;
     Kljucevi=NadjiRijec(s);
     for(int i(0);i&lt;Kljucevi.size();i++){
         Indeksi.insert(std::make_pair(Kljucevi[i],NadjiIndeks(s,Kljucevi[i])));
     }
     return Indeksi;
}
std::set&lt;int&gt; PretraziIndeksPojmova(std::string rijec,Mapa Pojmovi){
   auto it=Pojmovi.find(rijec);  
   if( it == Pojmovi.end() ) throw std::logic_error("Pojam nije nadjen");  
   else  return  it-&gt;second;
 
}
void IspisiIndeksPojmova(Mapa Pojmovi){
    std::string k;
    for(auto it=Pojmovi.begin();it!=Pojmovi.end();it++){
         std::cout&lt;&lt;it-&gt;first&lt;&lt;": ";
        auto &amp;zadnji = *(--(it-&gt;second).end());
        for (auto x : it-&gt;second)
{
    std::cout &lt;&lt; x;
    if (&amp;x != &amp;zadnji)
        std::cout &lt;&lt; ",";
}
        std::cout&lt;&lt;std::endl;
     
    }
}
bool Provjeri(std::string rijec,std::vector&lt;std::string&gt;rijeci){
    int brojac(0);
    for(int i(0);i&lt;rijeci.size();i++){
        if(rijec==rijeci[i]) brojac++;
    }
    if(brojac==0) return true;
    if(brojac!=0) return false;
}

int main ()
{
    std::set&lt;int&gt;Indexi;
    std::string Polazni;
    Mapa Pojam=KreirajIndeksPojmova(Polazni);
    try{
        std::cout&lt;&lt;"Unesite tekst: ";
        std::vector&lt;std::string&gt;v;
        v=NadjiRijec(Polazni);
        std::getline(std::cin,Polazni);
        Mapa Pojam=KreirajIndeksPojmova(Polazni);
        IspisiIndeksPojmova(Pojam);
        for(;;){
        std::cout&lt;&lt;"Unesite rijec: ";
        std::string rijec;
        std::getline(std::cin,rijec);
        if(rijec==".") break ;
        Indexi=PretraziIndeksPojmova(rijec,Pojam);
        for(auto x: Indexi){
            std::cout&lt;&lt;x&lt;&lt;" ";
        }
        std::cout&lt;&lt;std::endl;
        }
    }
    catch(std::logic_error e){
        if(e.what()!="Unesena rijec nije nadjena!\n") {std::cout&lt;&lt;"Unesena rijec nije nadjena!\n";
        for(;;){
        std::cout&lt;&lt;"Unesite rijec: ";
        std::string rijec;
        std::getline(std::cin,rijec);
        
        if(rijec==".") break ;
        Indexi=PretraziIndeksPojmova(rijec,Pojam);
        for(auto x: Indexi){
            std::cout&lt;&lt;x&lt;&lt;" ";
        }
        std::cout&lt;&lt;std::endl;
</font>        }
        }
    }
	return 0;
}</pre>
</body>
</html>
