<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z1/student6874.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z1/student3301.cpp<p></p><pre>
/B16/17 (ZadaÄ‡a 5, Zadatak 1)
//Autotestovi by Eldar Kurtic (mail: ekurtic3@etf.unsa.ba)
//Za autotestove se obracati *iskljucivo* osobi koja ih pise
#include &lt;iostream&gt;
#include &lt;stdexcept&gt;
#include &lt;map&gt;
#include &lt;string&gt;
#include &lt;utility&gt;

struct Korisnik{
    std::string ime, prezime, adresa, telefon;
};

class Knjiga{
    std::string naslov, ime_pisca, zanr;
    int godina_izdavanja;
    Korisnik *zaduzioc;
    public:
     Knjiga(std::string naslov, std::string ime_pisca, std::string zanr, int godina_izdavanja) : naslov(naslov), ime_pisca(ime_pisca), zanr(zanr), godina_izdavanja(godina_izdavanja), zaduzioc(nullptr){}
     std::string DajNaslov() const{return naslov;}
     std::string DajAutora() const {return ime_pisca;}
     std::string DajZanr() const {return zanr;}
     int DajGodinuIzdavanja() const {return godina_izdavanja;}
<a name="3"></a><font color="#00FFFF"><a href="match22-0.html#3" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_5.gif"/></a>

     Korisnik *DajKodKogaJe() const {return zaduzioc;}
     void ZaduziKnjigu(Korisnik &amp;k){zaduzioc = &amp;k;}
     void RazduziKnjigu() {zaduzioc = nullptr;}
     bool DaLiJeZaduzena() const {return (zaduzioc!=nullptr);}
};

class Biblioteka{
    std::map&lt;int, Korisnik *&gt; mapa_korisnika;
    std::map&lt;int, Knjiga *&gt; mapa_knjiga;
    static void DealocirajMemoriju(Biblioteka &amp;b);
    
    public:
     Biblioteka(){};
     Biblioteka(const Biblioteka &amp;b);
     Biblioteka(Biblioteka &amp;&amp;b);
     ~Biblioteka() {Biblioteka::DealocirajMemoriju(*this);}
     Biblioteka &amp;operator= (const Biblioteka &amp;b);
     Biblioteka &amp;operator = (Biblioteka &amp;&amp;b);
     void RegistrirajNovogKorisnika(int clanski_broj, std::string ime, std::string prezime, std::string adresa, std::string broj_tel);
</font>     void RegistrirajNovuKnjigu (int evidencijski_broj, std::string naslov, std::string ime_pisca, std::string zanr, int godina_izdavanja);
     Korisnik &amp;NadjiKorisnika(int clanski_broj) ;
<a name="0"></a><font color="#FF0000"><a href="match22-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_39.gif"/></a>

     Knjiga &amp;NadjiKnjigu(int evidencijski_broj) ;
     void IzlistajKorisnike() const;
     void IzlistajKnjige() const;
     void ZaduziKnjigu(int evidencijski_broj, int clanski_broj);
     void RazduziKnjigu(int evidencijski_broj);
     void PrikaziZaduzenja(int clanski_broj) const;
};

void Biblioteka::DealocirajMemoriju(Biblioteka &amp;b){
    while(b.mapa_korisnika.size()){
        auto it(b.mapa_korisnika.begin());
        delete it-&gt;second;
        b.mapa_korisnika.erase(it-&gt;first);
    }
    while (b.mapa_knjiga.size()) {
        auto it(b.mapa_knjiga.begin());
        delete it-&gt;second;
        b.mapa_knjiga.erase(it-&gt;first);
    }
    
}


Biblioteka::Biblioteka(const Biblioteka &amp;b){
    
    try{
    for(auto x : b.mapa_korisnika){
        auto pok = new Korisnik(*(x.second));
        mapa_korisnika.insert(std::make_pair(x.first, pok));
        
    }
    for(auto y : b.mapa_knjiga){
        auto p = new Knjiga(*(y.second));
        mapa_knjiga.insert(std::make_pair(y.first, p));
        
    }
    }
    catch(...){
    
        DealocirajMemoriju(*this);
        throw;
    }
}

Biblioteka::Biblioteka(Biblioteka &amp;&amp;b){
    mapa_knjiga = b.mapa_knjiga;
    mapa_korisnika = b.mapa_korisnika;
    for(auto it = b.mapa_knjiga.begin(); it!=b.mapa_knjiga.end(); it++){
        b.mapa_knjiga.erase(it-&gt;first);
    }
    for(auto it = b.mapa_korisnika.begin(); it!=b.mapa_korisnika.end(); it++)
      b.mapa_korisnika.erase(it-&gt;first);
}

Biblioteka &amp;Biblioteka::operator= (const Biblioteka &amp;b){
    if(this==&amp;b)
      return *this;
  Biblioteka nova(*this); 
  DealocirajMemoriju(*this);
   try{
    for(auto it = b.mapa_korisnika.begin(); it!=b.mapa_korisnika.end(); it++){
        Korisnik *pok(new Korisnik(*(it-&gt;second)));
        mapa_korisnika.insert(std::make_pair(it-&gt;first, pok));
    }
    for(auto it= b.mapa_knjiga.begin(); it!=b.mapa_knjiga.end(); it++){
        Knjiga *pok(new Knjiga(*(it-&gt;second)));
        mapa_knjiga.insert(std::make_pair(it-&gt;first, pok));
    }
   }
   catch(...){
       DealocirajMemoriju(*this);
       for(auto it=nova.mapa_knjiga.begin(); it!=nova.mapa_knjiga.end(); it++)
           mapa_knjiga.insert(std::make_pair(it-&gt;first, it-&gt;second));
        while(nova.mapa_knjiga.size()){
          auto it=nova.mapa_knjiga.begin();
          nova.mapa_knjiga.erase(it-&gt;first);
        }
        for(auto it=nova.mapa_korisnika.begin(); it!=nova.mapa_korisnika.end(); it++)
         mapa_korisnika.insert(std::make_pair(it-&gt;first, it-&gt;second));
        while (nova.mapa_korisnika.size()) {
            auto it = nova.mapa_korisnika.begin();
            nova.mapa_korisnika.erase(it-&gt;first);
        }
        throw;
    }
  return *this;
}

Biblioteka &amp;Biblioteka::operator = (Biblioteka &amp;&amp;b){
    mapa_knjiga = b.mapa_knjiga;
    mapa_korisnika = b.mapa_korisnika;
    for(auto it = b.mapa_knjiga.begin(); it!=b.mapa_knjiga.end(); it++)
      b.mapa_knjiga.erase(it-&gt;first);
    for(auto it = b.mapa_korisnika.begin(); it!=b.mapa_korisnika.end(); it++)
      b.mapa_korisnika.erase(it-&gt;first);
    return *this;
}

void Biblioteka::RegistrirajNovogKorisnika(int clanski_broj, std::string ime, std::string prezime, std::string adresa, std::string broj_tel){
    auto it(mapa_korisnika.find(clanski_broj));
    if(it!=mapa_korisnika.end())
        throw std::logic_error("Korisnik vec postoji");
    Korisnik k;
    k.ime = ime;
    k.prezime = prezime;
    k.adresa = adresa;
    k.telefon = broj_tel;
    Korisnik *pok(new Korisnik(k));
    mapa_korisnika.insert(std::make_pair(clanski_broj, pok));
}

void Biblioteka::RegistrirajNovuKnjigu(int evidencijski_broj, std::string naslov, std::string ime_pisca, std::string zanr, int godina_izdavanja){
    auto it(mapa_knjiga.find(evidencijski_broj));
    if(it!=mapa_knjiga.end())
        throw std::logic_error("Knjiga vec postoji");
    Knjiga k(naslov, ime_pisca, zanr, godina_izdavanja);
    Knjiga *pok = new Knjiga(k);
    mapa_knjiga.insert(std::make_pair(evidencijski_broj, pok));
}


Korisnik &amp;Biblioteka::NadjiKorisnika(int clanski_broj) {
    auto it(mapa_korisnika.find(clanski_broj));
    if(it==mapa_korisnika.end())
     throw std::logic_error("Korisnik nije nadjen");
    return *(it-&gt;second);
}

Knjiga &amp;Biblioteka::NadjiKnjigu(int evidencijski_broj){
    auto it(mapa_knjiga.find(evidencijski_broj));
    if(it==mapa_knjiga.end())
     throw std::logic_error("Knjiga nije nadjena");
    return *(it-&gt;second);
}



void Biblioteka::IzlistajKorisnike() const{
    for(auto it=mapa_korisnika.begin(); it!=mapa_korisnika.end(); it++){
        std::cout&lt;&lt;"Clanski broj: "&lt;&lt;it-&gt;first&lt;&lt;std::endl;
        std::cout&lt;&lt;"Ime i prezime: "&lt;&lt;(*(it-&gt;second)).ime&lt;&lt;" "&lt;&lt;(*(it-&gt;second)).prezime&lt;&lt;std::endl;
        std::cout&lt;&lt;"Adresa: "&lt;&lt;(*(it-&gt;second)).adresa&lt;&lt;std::endl;
</font><a name="4"></a><font color="#FF00FF"><a href="match22-0.html#4" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_4.gif"/></a>

        std::cout&lt;&lt;"Broj telefona: "&lt;&lt;(*(it-&gt;second)).telefon&lt;&lt;std::endl;
        std::cout&lt;&lt;std::endl;
    }
}

void Biblioteka::IzlistajKnjige() const{
    for(auto it=mapa_knjiga.begin(); it!=mapa_knjiga.end(); it++){
        std::cout&lt;&lt;"Evidencijski broj: "&lt;&lt;it-&gt;first&lt;&lt;std::endl;
        std::cout&lt;&lt;"Naslov: "&lt;&lt;(*it-&gt;second).DajNaslov()&lt;&lt;std::endl;
</font>        std::cout&lt;&lt;"Pisac: "&lt;&lt;(*it-&gt;second).DajAutora()&lt;&lt;std::endl;
<a name="2"></a><font color="#0000FF"><a href="match22-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_12.gif"/></a>

        std::cout&lt;&lt;"Zanr: "&lt;&lt;(*it-&gt;second).DajZanr()&lt;&lt;std::endl;
        std::cout&lt;&lt;"Godina izdavanja: "&lt;&lt;(*it-&gt;second).DajGodinuIzdavanja()&lt;&lt;std::endl;
        
        if((*it-&gt;second).DajKodKogaJe()){
           std::cout&lt;&lt;"Zaduzena kod korisnika: "&lt;&lt;(*it-&gt;second).DajKodKogaJe()-&gt;ime&lt;&lt;" "&lt;&lt;(*it-&gt;second).DajKodKogaJe()-&gt;prezime&lt;&lt;std::endl;
           
        }
         
        std::cout&lt;&lt;std::endl;
    }
}

void Biblioteka::ZaduziKnjigu(int evidencijski_broj, int clanski_broj){
    auto it1(mapa_knjiga.find(evidencijski_broj));
    if(it1==mapa_knjiga.end())
       throw std::logic_error("Knjiga nije nadjena");
    auto it2(mapa_korisnika.find(clanski_broj));
    if(it2==mapa_korisnika.end())
      throw std::logic_error("Korisnik nije nadjen");
    if(it1-&gt;second-&gt;DajKodKogaJe())
       throw std::logic_error("Knjiga vec zaduzena");
    
    it1-&gt;second-&gt;Knjiga::ZaduziKnjigu(*it2-&gt;second);

}


void Biblioteka::RazduziKnjigu(int evidencijski_broj){
    auto it(mapa_knjiga.find(evidencijski_broj));
    if(it==mapa_knjiga.end())
      throw std::logic_error("Knjiga nije nadjena");
    if(!(it-&gt;second-&gt;DajKodKogaJe()))
      throw std::logic_error("Knjiga nije zaduzena");
    it-&gt;second-&gt;Knjiga::RazduziKnjigu();
}

void Biblioteka::PrikaziZaduzenja(int clanski_broj) const{
    auto it = mapa_korisnika.find(clanski_broj);
    if(it==mapa_korisnika.end())
       throw std::logic_error("Korisnik nije nadjen");
    bool ima_knjiga(false);
    for(auto iter=mapa_knjiga.begin(); iter!=mapa_knjiga.end(); iter++){
                
        if((iter-&gt;second-&gt;DajKodKogaJe())==(it-&gt;second)){
                ima_knjiga = true;
                std::cout&lt;&lt;"Evidencijski broj: "&lt;&lt;iter-&gt;first&lt;&lt;std::endl;
                std::cout&lt;&lt;"Naslov: "&lt;&lt;(iter-&gt;second)-&gt;DajNaslov()&lt;&lt;std::endl;
</font>                std::cout&lt;&lt;"Pisac: "&lt;&lt;(iter-&gt;second)-&gt;DajAutora()&lt;&lt;std::endl;
                std::cout&lt;&lt;"Zanr: "&lt;&lt;(iter-&gt;second)-&gt;DajZanr()&lt;&lt;std::endl;
<a name="1"></a><font color="#00FF00"><a href="match22-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_25.gif"/></a>

                std::cout&lt;&lt;"Godina izdavanja: "&lt;&lt;(iter-&gt;second)-&gt;DajGodinuIzdavanja()&lt;&lt;std::endl;
                std::cout&lt;&lt;std::endl;
                }
    }
    if(!ima_knjiga)
      std::cout&lt;&lt;"Nema zaduzenja za tog korisnika!";
}


int main ()
{
  Biblioteka b;
    int prva_opcija;
    std::cout&lt;&lt;"Dobrodosli!\n";
    do{
        std::cout&lt;&lt;"\nIzaberite opciju:\n 0 - kraj\n 1 - obrada korisnika\n 2 - obrada knjiga\n";
        std::cin&gt;&gt;prva_opcija;
        if(prva_opcija==0)
          break;
        if(prva_opcija==1){
            int druga_opcija;
            do{
                std::cout&lt;&lt;"\n\nIzaberite opciju:\n 0 - nazad\n 1 - dodavanje korisnika\n 2 - izlistavanje korisnika\n 3 - prikaz zaduzenja\n 4 - kraj\n";
                std::cin&gt;&gt;druga_opcija;
                if(druga_opcija==0){
                    break;
                }
                if(druga_opcija==4){
                    std::cout&lt;&lt;"Dovidjenja!";
                    return 0;
                }
                if(druga_opcija==1){
                    std::cout&lt;&lt;"Unesite clanski broj korisnika: ";
                    int cl_broj;
                    std::cin&gt;&gt;cl_broj;
                    std::string ime, prezime, adresa, broj_tel;
                    std::cout&lt;&lt;"Unesite ime korisnika: ";
                    std::cin.clear();
                    std::cin.ignore(10000, '\n');
                    std::getline(std::cin, ime);
                    std::cout&lt;&lt;"Unesite prezime korisnika: ";
                    std::getline(std::cin, prezime);
                    std::cout&lt;&lt;"Unesite adresu korisnika: ";
                    std::getline(std::cin, adresa);
                    std::cout&lt;&lt;"Unesite broj telefona korisnika: ";
                    std::getline(std::cin, broj_tel);
                    b.RegistrirajNovogKorisnika(cl_broj, ime, prezime, adresa, broj_tel);
                    std::cout&lt;&lt;"Korisnik uspjesno registrovan!";
                }
                if(druga_opcija==2){
                    b.IzlistajKorisnike();
                }
                
                if(druga_opcija==3){
                    std::cout&lt;&lt;"Unesite clanski broj korisnika: ";
                    int br;
                    std::cin&gt;&gt;br;
                    b.PrikaziZaduzenja(br);
                }
                
            }while(druga_opcija);
            
        }
            if(prva_opcija==2){
                int treca_opcija;
                do{
                    std::cout&lt;&lt;"\nIzaberite opciju:\n 0 - nazad\n 1 - dodavanje knjige\n 2 - ispis knjiga\n 3 - zaduzivanje knjige\n 4 - razduzivanje knjige\n 5 - kraj\n";
                    std::cin&gt;&gt;treca_opcija;
                    if(treca_opcija==0)
                      break;
                    if(treca_opcija==5){
                        std::cout&lt;&lt;"Dovidjenja!\n";
                        return 0;
                    }
                    
                    if(treca_opcija==1){
                        std::string naslov, ime_pisca, zanr;
                        int evidencijski_broj, godina_izdavanja;
                        std::cout&lt;&lt;"Unesite evidencijski broj knjige: ";
                        std::cin&gt;&gt;evidencijski_broj;
                        std::cin.clear();
                        std::cin.ignore(10000, '\n');
                        std::cout&lt;&lt;"Unesite naslov: ";
                        std::getline(std::cin, naslov);
                        std::cout&lt;&lt;"Unesite ime pisca: ";
                        std::getline(std::cin, ime_pisca);
                        std::cout&lt;&lt;"Unesite zanr: ";
                        std::getline(std::cin, zanr);
                        std::cout&lt;&lt;"Unesite godinu izdavanja: ";
                        std::cin&gt;&gt;godina_izdavanja;
                        b.RegistrirajNovuKnjigu(evidencijski_broj, naslov, ime_pisca, zanr, godina_izdavanja);
                        std::cout&lt;&lt;"Knjiga uspjesno evidentirana.\n";
                    }
                    
                    if(treca_opcija==2){
                        b.IzlistajKnjige();
                    }
                    if(treca_opcija==3){
                        int clanski_broj, evidencijski_broj;
                        std::cout&lt;&lt;"Unesite evidencijski broj knjige koju zelite zaduziti: ";
                        std::cin&gt;&gt;evidencijski_broj;
                        std::cout&lt;&lt;"Unesite clanski broj korisnika koji zaduzuje knjigu: ";
                        std::cin&gt;&gt;clanski_broj;
                        b.ZaduziKnjigu(evidencijski_broj, clanski_broj);
                        std::cout&lt;&lt;"Knjiga uspjesno zaduzena!\n";
                    }
                    
                    if(treca_opcija==4){
                        try{
                        int evidencijski_broj;
                        std::cout&lt;&lt;"Unesite evidencijski broj knjige koju zelite razduziti: ";
                        std::cin&gt;&gt;evidencijski_broj;
                        b.RazduziKnjigu(evidencijski_broj);
                        std::cout&lt;&lt;"Knjiga uspjesno razduzena!\n";
                        }
                        catch(std::logic_error e){
                            std::cout&lt;&lt;"Izuzetak: "&lt;&lt;e.what()&lt;&lt;". Molimo unesite ponovo.\n";
                        }
                    }
                }while(treca_opcija);
            }
        
    }while(prva_opcija);
   /* Biblioteka a;
    try{
    Biblioteka b;
    for(int i=0; i&lt;10; i++)
      b.RegistrirajNovogKorisnika(i + 1, "Neko", "Nekic", "Nigdjezemska", "000");
    for(int i=0; i&lt;5; i++)
     b.RegistrirajNovuKnjigu(i+1,"Ana Karenjina", "Lav N. Tolstoj", "roman", 1877);
    
    a = b;
    
    }
    catch(...){
        std::cout&lt;&lt;"Izuzetak";
    }
    a.IzlistajKnjige();
    std::cout&lt;&lt;std::endl;
    a.IzlistajKorisnike();*/
    return 0;
</font>}</pre>
</body>
</html>
