<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z1/student5939.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z1/student4471.cpp<p></p><pre>
<a name="1"></a><font color="#00FF00"><a href="match51-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_19.gif"/></a>

/B16/17 (ZadaÄ‡a 5, Zadatak 1)
//Autotestovi by Eldar Kurtic (mail: ekurtic3@etf.unsa.ba)
//Za autotestove se obracati *iskljucivo* osobi koja ih pise
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;map&gt;
#include &lt;vector&gt;
using std::string;
using std::map;

struct Korisnik{
   string ime;
   string prezime;
   string adresa;
   string telefon;
};

class Knjiga{
    string naslov;
    string ime_pisca;
    string zanr;
    int godina_izdanja;
    Korisnik *kor_knjige;
   
    
    public:
   // Korisnik *kor_knjige;
    Knjiga(string nasl,string ime,string znr,int god): naslov(nasl),ime_pisca(ime),zanr(znr),godina_izdanja(god),kor_knjige(nullptr){}
    string DajNaslov()const {return naslov;}
    string DajAutora()const {return ime_pisca;}
    string DajZanr()const {return zanr;}
    int DajGodinuIzdavanja()const {return godina_izdanja;}
    Korisnik *DajKodKogaJe()const {return kor_knjige;}
    
    void ZaduziKnjigu(Korisnik &amp;k){kor_knjige=&amp;k;}   //da li treba alocirat novi pok pa postavi na njeg ?
    void RazduziKnjigu(){kor_knjige=nullptr;}
    bool DaLiJeZaduzena()const { if(kor_knjige)return true; else return false; }
    
};

class Biblioteka{
    map&lt;int,Korisnik *&gt; korisnici;
    map&lt;int,Knjiga *&gt; knjige;
    void DealocirajKorisnike(){
        for(auto it=korisnici.begin();it != korisnici.end();it++)delete it-&gt;second;
    }
    
    void DealocirajKnjige(){
        for(auto it=knjige.begin();it != knjige.end();it++)delete it-&gt;second;
    }
    
    static void IspisiKorisnika(const Korisnik &amp;k,int clanski_broj){
        std::cout&lt;&lt;"Clanski broj: "&lt;&lt;clanski_broj&lt;&lt;std::endl;
        std::cout&lt;&lt;"Ime i prezime: "&lt;&lt;k.ime&lt;&lt;" "&lt;&lt;k.prezime&lt;&lt;std::endl;
        std::cout&lt;&lt;"Adresa: "&lt;&lt;k.adresa&lt;&lt;std::endl;
        std::cout&lt;&lt;"Broj telefona: "&lt;&lt;k.telefon&lt;&lt;std::endl;
        
    }
    
    static void IspisiKnjigu(const Knjiga &amp;k,int evid_broj,bool dodatno=true){
        std::cout&lt;&lt;"Evidencijski broj: "&lt;&lt;evid_broj&lt;&lt;std::endl;
        std::cout&lt;&lt;"Naslov: "&lt;&lt;k.DajNaslov()&lt;&lt;std::endl;
</font>        std::cout&lt;&lt;"Pisac: "&lt;&lt;k.DajAutora()&lt;&lt;std::endl;
<a name="0"></a><font color="#FF0000"><a href="match51-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_78.gif"/></a>

        std::cout&lt;&lt;"Zanr: "&lt;&lt;k.DajZanr()&lt;&lt;std::endl;
        std::cout&lt;&lt;"Godina izdavanja: "&lt;&lt;k.DajGodinuIzdavanja()&lt;&lt;std::endl;
        if(k.DaLiJeZaduzena() &amp;&amp; dodatno){
            Korisnik *p(k.DajKodKogaJe());
            std::cout&lt;&lt;"Zaduzena kod korisnika: "&lt;&lt;p-&gt;ime&lt;&lt;" "&lt;&lt;p-&gt;prezime&lt;&lt;std::endl;   
        }
    }
    
    public:
    Biblioteka()=default;
    ~Biblioteka(){
        this-&gt;DealocirajKorisnike();
        this-&gt;DealocirajKnjige();
    }
    //kopirajuci i pomjerajuci konstruktor
    Biblioteka (const Biblioteka &amp;b);
    Biblioteka (Biblioteka &amp;&amp;b);
    
    //kopirajuci i pomjerajuci operator dodjele
    Biblioteka &amp;operator= (const Biblioteka &amp;b);
    Biblioteka &amp;operator= (Biblioteka &amp;&amp;b){
        std::swap(korisnici,b.korisnici);
        std::swap(knjige,b.knjige);
        return *this;
    }
    
    void RegistrirajNovogKorisnika(int clanski_broj,string ime,string prezime,string adresa,string telefon);
    void RegistrirajNovuKnjigu(int evid_broj,string naslov,string ime_pisca,string zanr,int godina_izdanja);
    Korisnik &amp;NadjiKorisnika(int clanski_broj)const ;
    Knjiga &amp;NadjiKnjigu(int evid_broj)const ;  //fale konstante VERZIJE !!!!
    
    void IzlistajKorisnike()const {
        for(auto it=korisnici.begin();it != korisnici.end();it++){
            IspisiKorisnika(*(it-&gt;second),it-&gt;first);
            std::cout&lt;&lt;std::endl;
        }
    }
    
    void IzlistajKnjige()const {
        
        for(auto it=knjige.begin();it != knjige.end();it++){
            IspisiKnjigu(*(it-&gt;second),it-&gt;first);
            std::cout&lt;&lt;std::endl;
        }
    }
    
    //IZMJENE VRSENE OVDJE
    /*
    void ZaduziKnjigu(int evid_broj,int clanski_broj){
        auto it(knjige.find(evid_broj));
        if(it == knjige.end())throw std::logic_error("Knjiga nije nadjena");
        auto it2(korisnici.find(clanski_broj));
        if(it2 == korisnici.end())throw std::logic_error("Korisnik nije nadjen");
    
        
        if(k.DaLiJeZaduzena()){
            throw std::logic_error("Knjiga vec zaduzena");
        }else{
            Korisnik p=NadjiKorisnika(clanski_broj);
            k.ZaduziKnjigu(p);
        }
        
        
    }*/
    
     void ZaduziKnjigu(int broj_knjige,int broj_korisnika){
         if( !knjige.count(broj_knjige)) throw std::logic_error("Knjiga nije nadjena");
         if( !korisnici.count(broj_korisnika)) throw std::logic_error("Korisnik nije nadjen");
         auto it_knjiga(knjige.find(broj_knjige));
         auto it_korisnik(korisnici.find(broj_korisnika));
         if(it_knjiga-&gt;second-&gt;DaLiJeZaduzena())throw std::logic_error("Knjiga vec zaduzena");
         it_knjiga-&gt;second-&gt;ZaduziKnjigu(*(it_korisnik-&gt;second));
     }
    
    
    
    void RazduziKnjigu(int evid_broj) {
        auto it(knjige.find(evid_broj));
        if(it == knjige.end())throw std::logic_error("Knjiga nije nadjena");
        Knjiga k=NadjiKnjigu(evid_broj);                                         //da li brisat ??
        if(k.DaLiJeZaduzena()==false){
            throw std::logic_error("Knjiga nije zaduzena");
        }else{
            k.RazduziKnjigu();
        }
    }
    
    void PrikaziZaduzenja(int clanski_broj)const {
        auto it2(korisnici.find(clanski_broj));
        if(it2 == korisnici.end())throw std::domain_error("Korisnik nije nadjen");
        Korisnik kr=*(it2-&gt;second);//da li brisat ??
        int brojac=0;
        for(auto it=knjige.begin();it != knjige.end();it++){
                if(&amp;(*it-&gt;second-&gt;DajKodKogaJe())== &amp;kr){
                    IspisiKnjigu(*(it-&gt;second),it-&gt;first,false);
                    brojac++;
                }
        }
        if(brojac==0)std::cout&lt;&lt;"Nema zaduzenja za tog korisnika!"&lt;&lt;std::endl;
    }
    
};

//copy konstruktor
Biblioteka::Biblioteka(const Biblioteka &amp;b){
    bool uspjela_alokacija(true);
    
    try{
        for(auto it=b.korisnici.begin();it != b.korisnici.end();it++){
            korisnici.insert(std::make_pair(it-&gt;first, new Korisnik(*(it-&gt;second) )));
        }
    }catch(...){
        DealocirajKorisnike();
        uspjela_alokacija=false;
    }
    
    if(uspjela_alokacija){
        
        try{
            for(auto it=b.knjige.begin();it != b.knjige.end();it++){
                knjige.insert(std::make_pair(it-&gt;first, new Knjiga(*(it-&gt;second) )));
            }
        }catch(...){
            DealocirajKorisnike();
            DealocirajKnjige();
        }
    }
}

//pomjerajuci konstruktor
Biblioteka::Biblioteka(Biblioteka &amp;&amp;b){
    for(auto it=b.korisnici.begin();it != b.korisnici.end();it++){
            korisnici.insert(std::make_pair(it-&gt;first, it-&gt;second));
            it-&gt;second = nullptr;
    }
    
    for(auto it=b.knjige.begin();it != b.knjige.end();it++){
                knjige.insert(std::make_pair(it-&gt;first, it-&gt;second));
                it-&gt;second = nullptr;
    }
}

//kopirajuci operator dodjele
Biblioteka &amp;Biblioteka::operator= (const Biblioteka &amp;b){
    //broj knjiga i broj korisnika ne mora bit isti zato radimo 2 slucaja
        
        //odlucit cemo se za varijantu da nas nije briga jel vec ima dovoljno alocirane memorije tj vrsit cemo potpuno alokaciju !
        int uspjela_alokacija(true);
        map&lt;int,Korisnik*&gt; nova_mapa;
        try{
            for(auto it=b.korisnici.begin();it != b.korisnici.end();it++){
                nova_mapa.insert(std::make_pair(it-&gt;first, new Korisnik(*(it-&gt;second) )));
            }
        }catch(...){
            for(auto it=nova_mapa.begin();it != nova_mapa.end();it++)delete it-&gt;second;
            uspjela_alokacija=false;
        }
        
        //ako je prosla prva alokacija
        if(uspjela_alokacija){
            map&lt;int,Knjiga*&gt; nove_knjige;
            try{
                for(auto it=b.knjige.begin();it != b.knjige.end();it++){
                    nove_knjige.insert(std::make_pair(it-&gt;first, new Knjiga(*(it-&gt;second) )));
                }
            }catch(...){
                for(auto it=nove_knjige.begin();it != nove_knjige.end();it++)delete it-&gt;second;
                for(auto it=nova_mapa.begin();it != nova_mapa.end();it++)delete it-&gt;second;
                uspjela_alokacija=false;
            }
            
            //ako je sve proslo kako treba zavrsavamo alokacije
            if(uspjela_alokacija){
                this-&gt;DealocirajKorisnike();
                this-&gt;DealocirajKnjige();
                //krademo resurese od novamapa i noveknjige
                std::swap(korisnici,nova_mapa);
                std::swap(knjige,nove_knjige);
               
            }
        }
        
         return *this;
}

void Biblioteka::RegistrirajNovogKorisnika(int clanski_broj,string ime,string prezime,string adresa,string telefon){
    auto it(korisnici.find(clanski_broj));
    if(it != korisnici.end())throw std::logic_error("Korisnik vec postoji");
    korisnici.insert(std::make_pair(clanski_broj,new Korisnik{ime,prezime,adresa,telefon})); //ne moze Korisnik() jer nema konstuktora u strukturi
}

void Biblioteka::RegistrirajNovuKnjigu(int evid_broj,string naslov,string ime_pisca,string zanr,int godina_izdanja){
    auto it(knjige.find(evid_broj));
    if(it != knjige.end())throw std::logic_error("Knjiga vec postoji");
    knjige.insert(std::make_pair(evid_broj,new Knjiga(naslov,ime_pisca,zanr,godina_izdanja))); 
}

Korisnik &amp;Biblioteka::NadjiKorisnika(int clanski_broj)const {
    auto it(korisnici.find(clanski_broj));
    if(it == korisnici.end())throw std::logic_error("Korisnik nije nadjen");
    return *it-&gt;second;
}

Knjiga &amp;Biblioteka::NadjiKnjigu(int evid_broj)const {
    auto it(knjige.find(evid_broj));
    if(it == knjige.end())throw std::logic_error("Knjiga nije nadjena");
    return *it-&gt;second;
}


int main ()
{
    
    std::vector&lt;Knjiga&gt; v;
    std::vector&lt;Korisnik&gt; kor;
    Biblioteka biblioteka;
    
    kor.push_back( Korisnik{"Dzenan","Begovic","Travnik","111"});
    kor.push_back( Korisnik{"Paja","Patak","Sarajevo","222"});
    kor.push_back( Korisnik{"Robert","Kumerle","Skoplje","333"});
    
    v.push_back(Knjiga("Prokleta avlija","Ivo Andric","triler",1900));
   v.push_back(Knjiga("Tvrdava","Mak Dizdar","drama",2000));
   v.push_back(Knjiga("7 patuljaka","Hesse","bajke",1800));
   v.push_back(Knjiga("Suicide squad","Tom Cruise","horror",2016));
   
   for(int i=0;i&lt;3;i++){
       biblioteka.RegistrirajNovogKorisnika(i+1,kor[i].ime,kor[i].prezime,kor[i].adresa,kor[i].telefon);
   }
    
    for(int i=0;i&lt;4;i++){
        biblioteka.RegistrirajNovuKnjigu(i+1,v[i].DajNaslov(),v[i].DajAutora(),v[i].DajZanr(),v[i].DajGodinuIzdavanja());
    }
    
    
    biblioteka.IzlistajKorisnike();
    std::cout&lt;&lt;"-------------------------------------------------------------------"&lt;&lt;std::endl;
    biblioteka.IzlistajKnjige();
    std::cout&lt;&lt;"-------------------------------------------------------------------"&lt;&lt;std::endl;
    Biblioteka biblioteka2(biblioteka);
    biblioteka2.IzlistajKorisnike();
    std::cout&lt;&lt;"-------------------------------------------------------------------"&lt;&lt;std::endl;
    biblioteka2.IzlistajKnjige();
    std::cout&lt;&lt;"-------------------------------------------------------------------"&lt;&lt;std::endl;
    
    
     std::cout&lt;&lt;"Provjera zaduzenosti: "&lt;&lt;std::endl;
    biblioteka2.ZaduziKnjigu(1,2);
    try{
    biblioteka2.ZaduziKnjigu(2,2);
    biblioteka2.ZaduziKnjigu(3,1);
    std::cout&lt;&lt;"zaduzena nije";
    }catch(std::exception &amp;e){std::cout&lt;&lt;e.what();}
    
    
    
    
    
    //biblioteka2.ZaduziKnjigu(0,2);
    //biblioteka2.ZaduziKnjigu(0,1);
    
  //  biblioteka2.RegistrirajNovogKorisnika(3,"Mehmed","Ptk","Grcka","444");
    //biblioteka2.PrikaziZaduzenja(0);
    biblioteka2.IzlistajKnjige();
</font>    /*
    biblioteka=biblioteka2;
    biblioteka.IzlistajKorisnike();
    biblioteka.PrikaziZaduzenja(2);
    std::cout&lt;&lt;"-------------------------------------------------------------------"&lt;&lt;std::endl;*/
    
   
    
    
    
    
    
	return 0;
}











       /*
       //GRESKA
            for(auto it=korisnici.begin();it != korisnici.end();it++){
                if(it-&gt;first == clanski_broj){
                   // std::cout&lt;&lt;"Nadjen clanski broj"&lt;&lt;std::endl;
                     for(auto it2=knjige.begin();it2 != knjige.end();it2++){
                            if(it2-&gt;first== evid_broj){
                      //          std::cout&lt;&lt;"Nadjen evid broj"&lt;&lt;std::endl;
                               // if(it2-&gt;second-&gt;DaLiJeZaduzena())throw std::logic_error("Knjiga vec zaduzena");
                            }else {
                                it2-&gt;second-&gt;ZaduziKnjigu(*(it-&gt;second));
                                
                                std::cout&lt;&lt;"1"&lt;&lt;std::endl;
                            }
                            //std::cout&lt;&lt;(it2-&gt;second)-&gt;DajKodKogaJe();
                            //it2-&gt;second-&gt;ZaduziKnjigu(*(it-&gt;second));
                            //std::cout&lt;&lt;(it2-&gt;second)-&gt;DajKodKogaJe();
                        }
                }
            }
            
            */
            




/*

    Biblioteka (const Biblioteka &amp;b);  //ovaj radimo sami 
    Biblioteka (Biblioteka &amp;&amp;b) {  //ove ostale implementujemo preko copy i swap tehnike
        knjige = b.knjige;
        korisnici = b.korisnici;
        b.knjige.clear();
        b.korisnici.clear();
    }
    Biblioteka operator = (Biblioteka b) {
        std::swap(knjige,b.knjige);
        std::swap(korisnici,b.korisnici);
        return *this;
    }
    Biblioteka &amp;operator = (Biblioteka &amp;&amp;b) = default;
    void RegistrirajNovogKorisnika (int clanski_broj, std::string ime,std::string prezime, std::string adresa,std::string telefon) {
        if(korisnici.count(clanski_broj)) throw std::logic_error ("Korisnik vec postoji");
        korisnici.insert(std::make_pair(clanski_broj,new Korisnik{ime,prezime,adresa,telefon}));
    }
    
*/






</pre>
</body>
</html>
