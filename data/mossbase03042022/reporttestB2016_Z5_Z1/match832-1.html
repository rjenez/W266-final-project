<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z1/student6321.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z1/student5562.cpp<p></p><pre>
/B16/17 (ZadaÄ‡a 5, Zadatak 1)
//Autotestovi by Eldar Kurtic (mail: ekurtic3@etf.unsa.ba)
//Za autotestove se obracati *iskljucivo* osobi koja ih pise
#include &lt;iostream&gt;
#include &lt;new&gt;
#include &lt;string&gt;
#include &lt;map&gt;
#include &lt;utility&gt;
#include &lt;algorithm&gt;
#include &lt;stdexcept&gt;

struct Korisnik
{
    std::string ime, prezime, adresa, telefon;    
};


class Knjiga
{
    std::string naslov, ime_pisca, zanr;
<a name="4"></a><font color="#FF00FF"><a href="match832-0.html#4" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

    int godina_izdavanja;
    Korisnik* korisnik;
public:
    Knjiga(const std::string &amp;naslov, const std::string &amp;ime_pisca, const std::string &amp;zanr, int godina_izdavanja): naslov(naslov), ime_pisca(ime_pisca), zanr(zanr), godina_izdavanja(godina_izdavanja), korisnik(nullptr){}
</font>    std::string DajNaslov()const{ return naslov; }
    std::string DajAutora()const{ return ime_pisca; }
    std::string DajZanr()const{ return zanr; }
    int DajGodinuIzdavanja()const{ return godina_izdavanja; }
    Korisnik* DajKodKogaJe()const{ return korisnik;}
    void ZaduziKnjigu(Korisnik &amp;korisnik){Knjiga::korisnik = &amp;korisnik;}
    void RazduziKnjigu(){korisnik = nullptr;}
    bool DaLiJeZaduzena(){return korisnik;}
};


class Biblioteka
{
    std::map&lt;int, Korisnik*&gt; korisnici;
    std::map&lt;int, Knjiga*&gt; knjige;
    void IspisiKorisnika(const std::pair&lt;int, Korisnik*&gt; &amp;korisnik) const;
    void IspisiKnjigu(const std::pair&lt;int, Knjiga*&gt; &amp;knjiga)const;
    std::pair&lt;int, Korisnik*&gt; KodKogaJe(const std::pair&lt;int, Knjiga*&gt; &amp;knjiga)const;
public:
    Biblioteka() = default;
    Biblioteka(const Biblioteka &amp;b);
    Biblioteka(Biblioteka &amp;&amp;b):korisnici(b.korisnici), knjige(b.knjige){}
<a name="0"></a><font color="#FF0000"><a href="match832-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_5.gif"/></a>

    Biblioteka &amp;operator=(const Biblioteka &amp;b);
    Biblioteka &amp;operator=(Biblioteka &amp;&amp;b);
    ~Biblioteka();
    void RegistrirajNovogKorisnika(int clanski_broj, const std::string &amp;ime, const std::string &amp;prezime, const std::string &amp;adresa, const std::string &amp;telefon);
    void RegistrirajNovuKnjigu(int evidencijski_broj, const std::string &amp;naslov, const std::string &amp;ime_pisca, const std::string &amp;zanr, int godina_izdavanja);
    Korisnik &amp;NadjiKorisnika(int clanski_broj);
    Knjiga &amp;NadjiKnjigu(int evidencijski_broj);
    void IzlistajKorisnike() const;
    void IzlistajKnjige()const;
    void ZaduziKnjigu(int evidencijski_broj, int clanski_broj);
    void RazduziKnjigu(int evidencijski_broj);
    void PrikaziZaduzenja(int clanski_broj)const;
};

Biblioteka::Biblioteka(const Biblioteka &amp;b)
</font>{
    try
    {
        for (auto korisnik:b.korisnici)
            korisnici.insert(std::make_pair(korisnik.first, new Korisnik(*korisnik.second)));
        for (auto knjiga:b.knjige)
        {
            auto p(new Knjiga(*knjiga.second));
            knjige.insert(std::make_pair(knjiga.first, p));
            int broj;
            for (auto korisnik:b.korisnici) if (korisnik.second == knjiga.second-&gt;DajKodKogaJe()){ broj = korisnik.first;
            p-&gt;RazduziKnjigu(); ZaduziKnjigu(knjiga.first, broj);}
        }
    }
    catch (std::bad_alloc)
    {
        for (auto korisnik:korisnici) delete korisnik.second;
        for (auto knjiga:knjige) delete knjiga.second;
        throw;
    }
}
Biblioteka &amp;Biblioteka::operator=(const Biblioteka &amp;b)
{
    std::map&lt;int, Korisnik*&gt; korisnici2;
    std::map&lt;int, Knjiga*&gt; knjige2;
    try
    {
        for (auto korisnik:b.korisnici)
            korisnici2.insert(std::make_pair(korisnik.first, new Korisnik(*korisnik.second)));
        for (auto knjiga:b.knjige)
            knjige2.insert(std::make_pair(knjiga.first, new Knjiga(*knjiga.second)));
    }
    catch (std::bad_alloc)
    {
        for (auto korisnik:korisnici2) delete korisnik.second;
        for (auto knjiga:knjige2) delete knjiga.second;
        throw;
    }
    for (auto korisnik:korisnici) delete korisnik.second;
    for (auto knjiga:knjige) delete knjiga.second;
    korisnici = korisnici2;
    knjige = knjige2;
    for (auto knjiga:b.knjige)
    {
        int broj;
        for (auto korisnik:b.korisnici) if (korisnik.second == knjiga.second-&gt;DajKodKogaJe()){ broj = korisnik.first;
        RazduziKnjigu(knjiga.first); ZaduziKnjigu(knjiga.first, broj);}
    }
    return *this;
}
Biblioteka &amp;Biblioteka::operator=(Biblioteka &amp;&amp;b)
{
    for (auto korisnik:korisnici) delete korisnik.second; korisnici.erase(korisnici.begin(), korisnici.end());
    for (auto knjiga:knjige) delete knjiga.second; knjige.erase(knjige.begin(), knjige.end());
    korisnici = b.korisnici;
    knjige = b.knjige;
    return *this;
}
Biblioteka::~Biblioteka()
{
    for (auto korisnik:korisnici) delete korisnik.second;
<a name="2"></a><font color="#0000FF"><a href="match832-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

    for (auto knjiga:knjige) delete knjiga.second;
}
void Biblioteka::RegistrirajNovogKorisnika(int clanski_broj, const std::string &amp;ime, const std::string &amp;prezime, const std::string &amp;adresa, const std::string &amp;telefon)
</font>{
    if (korisnici.count(clanski_broj))
        throw std::logic_error("Korisnik vec postoji");
<a name="3"></a><font color="#00FFFF"><a href="match832-0.html#3" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

    korisnici.insert(std::make_pair(clanski_broj, new Korisnik(Korisnik{ime, prezime, adresa, telefon})));
}
void Biblioteka::RegistrirajNovuKnjigu(int evidencijski_broj, const std::string &amp;naslov, const std::string &amp;ime_pisca, const std::string &amp;zanr, int godina_izdavanja)
</font>{
    if (knjige.count(evidencijski_broj))
        throw std::logic_error("Knjiga vec postoji");
<a name="1"></a><font color="#00FF00"><a href="match832-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_3.gif"/></a>

    knjige.insert(std::make_pair(evidencijski_broj, new Knjiga(naslov, ime_pisca, zanr, godina_izdavanja)));
}
Korisnik &amp;Biblioteka::NadjiKorisnika(int clanski_broj)
{
    auto k(korisnici.find(clanski_broj));
    if (k == korisnici.end())
        throw std::logic_error("Korisnik nije nadjen");
    return *k-&gt;second;
}
Knjiga &amp;Biblioteka::NadjiKnjigu(int evidencijski_broj)
{
    auto k(knjige.find(evidencijski_broj));
    if (k == knjige.end())
        throw std::logic_error("Knjiga nije nadjena");
    return *k-&gt;second;
}
void Biblioteka::IzlistajKorisnike()const
{
    for (auto korisnik:korisnici)
</font>    {
        IspisiKorisnika(korisnik);
        std::cout &lt;&lt; std::endl;
    }
}
void Biblioteka::IzlistajKnjige()const
{
    for (auto knjiga:knjige)
    {
        IspisiKnjigu(knjiga);
        if (knjiga.second-&gt;DaLiJeZaduzena())
            std::cout &lt;&lt; "Zaduzena kod korisnika: " &lt;&lt;  knjiga.second-&gt;DajKodKogaJe()-&gt;ime &lt;&lt; " " &lt;&lt; knjiga.second-&gt;DajKodKogaJe()-&gt;prezime;
        std::cout &lt;&lt; std::endl;
    }
}
void Biblioteka::ZaduziKnjigu(int evidencijski_broj, int clanski_broj)
{
    if (!knjige.count(evidencijski_broj))
        throw std::logic_error("Knjiga nije nadjena");
    if (knjige[evidencijski_broj]-&gt;DaLiJeZaduzena())
        throw std::logic_error("Knjiga vec zaduzena");
    if (!korisnici.count(clanski_broj))
        throw std::logic_error("Korisnik nije nadjen");
    knjige[evidencijski_broj]-&gt;ZaduziKnjigu(*korisnici[clanski_broj]);
}
void Biblioteka::RazduziKnjigu(int evidencijski_broj)
{
    if (!knjige.count(evidencijski_broj))
        throw std::logic_error("Knjiga nije nadjena");
    if (!knjige[evidencijski_broj]-&gt;DaLiJeZaduzena())
        throw std::logic_error("Knjiga nije zaduzena");
    knjige[evidencijski_broj]-&gt;RazduziKnjigu();
}
void Biblioteka::IspisiKorisnika(const std::pair&lt;int, Korisnik*&gt; &amp;korisnik)const
{
    std::cout &lt;&lt; "Clanski broj: " &lt;&lt; korisnik.first &lt;&lt; std::endl;
    std::cout &lt;&lt; "Ime i prezime: " &lt;&lt; korisnik.second-&gt;ime &lt;&lt; " " &lt;&lt; korisnik.second-&gt;prezime &lt;&lt; std::endl;
    std::cout &lt;&lt; "Adresa: " &lt;&lt; korisnik.second-&gt;adresa &lt;&lt; std::endl;
    std::cout &lt;&lt; "Broj telefona: " &lt;&lt; korisnik.second-&gt;telefon &lt;&lt; std::endl;
    std::cout &lt;&lt; std::endl;
}
void Biblioteka::IspisiKnjigu(const std::pair&lt;int, Knjiga*&gt; &amp;knjiga)const
{
    std::cout &lt;&lt; "Evidencijski broj: " &lt;&lt; knjiga.first &lt;&lt; std::endl;
    std::cout &lt;&lt; "Naslov: " &lt;&lt; knjiga.second-&gt;DajNaslov() &lt;&lt; std::endl;
    std::cout &lt;&lt; "Pisac: " &lt;&lt; knjiga.second-&gt;DajAutora() &lt;&lt; std::endl;
    std::cout &lt;&lt; "Zanr: " &lt;&lt; knjiga.second-&gt;DajZanr() &lt;&lt; std::endl;
    std::cout &lt;&lt; "Godina izdavanja: " &lt;&lt; knjiga.second-&gt;DajGodinuIzdavanja() &lt;&lt; std::endl;
        
}
void Biblioteka::PrikaziZaduzenja(int clanski_broj)const
{
    if (!korisnici.count(clanski_broj))
        throw std::logic_error("Korisnik nije nadjen");
    bool nadjena(false);
    for (auto knjiga:knjige)
        if (knjiga.second-&gt;DajKodKogaJe() == korisnici.find(clanski_broj)-&gt;second)
        {
            nadjena = true;
            IspisiKnjigu(knjiga);
            std::cout &lt;&lt; std::endl;
        }
    if (!nadjena)
        std::cout &lt;&lt; "Nema zaduzenja za tog korisnika!" &lt;&lt; std::endl;
}

void Ignore()
{
    std::cin.ignore(1000, '\n');
}
int main ()
{
    Biblioteka biblioteka;
    for(;;)
    {
        int opcija1;
        std::cout &lt;&lt; "\nIzaberite opciju:\n 0 - kraj\n 1 - uredjivanje korisnika\n 2 - uredjivanje knjiga\n";
        std::cin &gt;&gt; opcija1; Ignore();
        if (opcija1 == 0) break;
        else if (opcija1 == 1)
        {
            for (;;)
            {
                int opcija2;
                std::cout &lt;&lt; "\nIzaberite opciju:\n 0 - nazad\n 1 - registriraj novog korisnika\n 2 - nadji korisnika\n 3 - izlistaj korisnike\n 4 - prikazi zaduzenja korisnika\n";
                std::cin &gt;&gt; opcija2; Ignore();
                if (opcija2 == 0) break;
                else if (opcija2 == 1)
                {
                    std::string ime, prezime, adresa, telefon;
                    int clanski_broj;
                    std::cout &lt;&lt; "Unesite clanski broj korisnika: "; std::cin &gt;&gt; clanski_broj; Ignore();
                    std::cout &lt;&lt; "Unesite ime korisnika: "; std::getline(std::cin, ime);
                    std::cout &lt;&lt; "Unesite prezime korisnika: "; std::getline(std::cin, prezime);
                    std::cout &lt;&lt; "unesite adresu korisnika: "; std::getline(std::cin, adresa);
                    std::cout &lt;&lt; "Unesite broj telefona korisnika: "; std::getline(std::cin, telefon);
                    try
                    {
                        biblioteka.RegistrirajNovogKorisnika(clanski_broj, ime, prezime, adresa, telefon);
                        std::cout &lt;&lt; "Korisnik uspjesno registriran!\n";
                    }
                    catch (std::logic_error e)
                    {
                        std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
                    }
                }
                else if (opcija2 == 2)
                {
                    int clanski_broj;
                    std::cout &lt;&lt; "Unesite clanski broj korisnika: ";
                    std::cin &gt;&gt; clanski_broj; Ignore();
                    try
                    {
                        Korisnik korisnik(biblioteka.NadjiKorisnika(clanski_broj));
                        std::cout &lt;&lt; "Korisnik sa clanskim brojem " &lt;&lt; clanski_broj &lt;&lt; " je: " &lt;&lt; korisnik.ime &lt;&lt; " " &lt;&lt; korisnik.prezime &lt;&lt; ", zivi na adresi: " &lt;&lt; korisnik.adresa &lt;&lt; ", br. telefona: " &lt;&lt; korisnik.telefon &lt;&lt; "." &lt;&lt; std::endl;
                    }
                    catch(std::logic_error e)
                    {
                        std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
                    }
                }
                else if (opcija2 == 3)
                {
                    std::cout &lt;&lt; "Registrirani korisnici u biblioteci su:\n";
                    biblioteka.IzlistajKorisnike();
                }
                else if (opcija2 == 4)
                {
                    int clanski_broj;
                    std::cout &lt;&lt; "Unesite clanski broj korisnika: ";
                    std::cin &gt;&gt; clanski_broj; Ignore();
                    try
                    {
                        biblioteka.PrikaziZaduzenja(clanski_broj);
                    }
                    catch(std::logic_error e)
                    {
                        std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
                    }
                }
            }
        }
        else if (opcija1 == 2)
        {
            for(;;)
            {
                int opcija2;
                std::cout &lt;&lt; "\nIzaberite opciju:\n 0 - nazad\n 1 - registriraj novu knjigu\n 2 - nadji knjigu\n 3 - izlistaj knjige\n 4 - zaduzi knjigu\n 5 - razduzi knjigu\n";
                std::cin &gt;&gt; opcija2; Ignore();
                if (opcija2 == 0) break;
                else if (opcija2 == 1)
                {
                    int evidencijski_broj, godina_izdavanja;
                    std::string naslov, pisac, zanr;
                    std::cout &lt;&lt; "Unesite evidencijski_broj: "; std::cin &gt;&gt; evidencijski_broj; Ignore();
                    std::cout &lt;&lt; "Unesite naslov: "; std::getline(std::cin, naslov);
                    std::cout &lt;&lt; "Unesite autora: "; std::getline(std::cin, pisac);
                    std::cout &lt;&lt; "Unesite zanr: "; std::getline(std::cin, zanr);
                    std::cout &lt;&lt; "Unesite godinu izdavanja: "; std::cin &gt;&gt; godina_izdavanja; Ignore();
                    try
                    {
                        biblioteka.RegistrirajNovuKnjigu(evidencijski_broj, naslov, pisac, zanr, godina_izdavanja);
                        std::cout &lt;&lt; "Knjiga je uspjesno registrirana!\n";
                    }
                    catch (std::logic_error e)
                    {
                        std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
                    }
                }
                else if (opcija2 == 2)
                {
                    int evidencijski_broj;
                    std::cout &lt;&lt; "Unesite evidencijski broj knjige: "; std::cin &gt;&gt; evidencijski_broj; Ignore();
                    try
                    {
                        Knjiga knjiga(biblioteka.NadjiKnjigu(evidencijski_broj));
                        std::cout &lt;&lt; "Knjiga s evidencijskim brojem " &lt;&lt; evidencijski_broj &lt;&lt; " je " &lt;&lt; knjiga.DajNaslov() &lt;&lt; ", autora " &lt;&lt; knjiga.DajAutora() &lt;&lt; ", zanr " &lt;&lt; knjiga.DajZanr() &lt;&lt; " izdata " &lt;&lt; knjiga.DajGodinuIzdavanja() &lt;&lt; ". godine" &lt;&lt; std::endl;
                    }
                    catch (std::logic_error e)
                    {
                        std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
                    }
                }
                else if (opcija2 == 3)
                {
                    std::cout &lt;&lt; "Registrirane knjige u biblioteci su:\n";
                    biblioteka.IzlistajKnjige();
                }
                else if (opcija2 == 4)
                {
                    int clanski_broj, evidencijski_broj;
                    std::cout &lt;&lt; "Unesite evidencijski_broj knjige: "; std::cin &gt;&gt; evidencijski_broj; Ignore();
                    std::cout &lt;&lt; "Unesite clanski broj korisnika: "; std::cin &gt;&gt; clanski_broj; Ignore();
                    try
                    {
                        biblioteka.ZaduziKnjigu(evidencijski_broj, clanski_broj);
                        std::cout &lt;&lt; "Knjiga uspjesno zaduzena!\n";
                    }
                    catch(std::logic_error e)
                    {
                        std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
                    }
                }
                else if (opcija2 == 5)
                {
                    int evidencijski_broj;
                    std::cout &lt;&lt; "Unesi evidencijski broj knjige: "; std::cin &gt;&gt; evidencijski_broj; Ignore();
                    try
                    {
                        biblioteka.RazduziKnjigu(evidencijski_broj);
                        std::cout &lt;&lt; "Knjiga uspjesno razduzena!\n";
                    }
                    catch(std::logic_error e)
                    {
                        std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
                    }
                }
            }
            
        }
    }
	return 0;
}</pre>
</body>
</html>
