<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z1/student9325.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z1/student9325.cpp<p></p><pre>
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;stdexcept&gt;
#include &lt;map&gt;

struct Korisnik {
    std::string ime, prezime, adresa, telefon;  
};

bool operator == (const Korisnik &amp;k1, const Korisnik &amp;k2) {
<a name="3"></a><font color="#00FFFF"><a href="match251-1.html#3" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_2.gif"/></a>

    return k1.ime == k2.ime &amp;&amp; k1.prezime == k2.prezime &amp;&amp; k1.adresa == k2.adresa &amp;&amp; k1.telefon == k2.telefon;
}

class Knjiga {
    std::string naslov_knige, ime_pisca, zanr;
    int godina_izdavanja;
    Korisnik* zaduzenik = nullptr;
public: 
    Knjiga(std::string naslov_knige, std::string ime_pisca, std::string zanr, int godina_izdavanja) 
    : naslov_knige(naslov_knige), ime_pisca(ime_pisca), zanr(zanr), godina_izdavanja(godina_izdavanja) {}
</font>    
    std::string DajNaslov() const {
        return naslov_knige;
    }
    std::string DajAutora() const {
        return ime_pisca;
    }
    std::string DajZanr() const {
        return zanr;
    }
    int DajGodinuIzdavanja() const {
        return godina_izdavanja;
    }
<a name="4"></a><font color="#FF00FF"><a href="match251-1.html#4" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

    Korisnik* DajKodKogaJe() const {
        return zaduzenik;
    }
    void ZaduziKnjigu(Korisnik &amp;korisnik) {
        zaduzenik = &amp;korisnik;
    }
    void RazduziKnjigu() {
        zaduzenik = nullptr;
    }
    bool DaLiJeZaduzena() {
        if(zaduzenik == nullptr) return false;
        return true;
    }
};

class Biblioteka {
    std::map&lt;int, Korisnik*&gt; mapa_korisnika;
    std::map&lt;int, Knjiga*&gt; mapa_knjiga;
</font>public: 
    void RegistrirajNovogKorisnika(int clanski_broj_korisnika, std::string ime, std::string prezime, std::string adresa, std::string telefon);
    void RegistrirajNovuKnjigu(int evidencijski_broj_knige, std::string naslov, std::string ime_pisca, std::string zanr, int godina_izdavanja);
    ~Biblioteka() {
        Dealociraj();
    }
    Korisnik&amp; NadjiKorisnika(int clanski_broj_korisnika);
    Knjiga&amp; NadjiKnjigu(int evidencijski_broj_knige);
    void IzlistajKorisnike() const;
    void IzlistajKnjige() const;
    void ZaduziKnjigu(int evidencijski_broj_knjige, int clanski_broj_korisnika);
    void RazduziKnjigu(int evidencijski_broj_knjige);
    void PrikaziZaduzenja(int clanski_broj_korisnika);
    
    Biblioteka&amp; operator = (const Biblioteka &amp;b2);
    Biblioteka&amp; operator = (Biblioteka &amp;&amp;b2);
    Biblioteka(const Biblioteka &amp;b);
    Biblioteka(Biblioteka &amp;&amp;b);
    Biblioteka() = default;
    
    void Dealociraj();
};

<a name="5"></a><font color="#FF0000"><a href="match251-1.html#5" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

void Biblioteka::RegistrirajNovogKorisnika(int clanski_broj_korisnika, std::string ime, std::string prezime, std::string adresa, std::string telefon) {
    for(auto iter = mapa_korisnika.begin(); iter != mapa_korisnika.end(); iter++) 
        if(iter-&gt;first == clanski_broj_korisnika) 
</font>            throw std::logic_error("Korisnik vec postoji");
    Korisnik* novi_korisnik = nullptr; 
    try {
        novi_korisnik = new Korisnik;
        novi_korisnik-&gt;ime = ime;
        novi_korisnik-&gt;prezime = prezime;
        novi_korisnik-&gt;adresa = adresa;
        novi_korisnik-&gt;telefon = telefon;
        mapa_korisnika.insert(std::make_pair(clanski_broj_korisnika, novi_korisnik));
    }
    catch(...) {
        delete novi_korisnik;
        throw;
    }
}
<a name="6"></a><font color="#00FF00"><a href="match251-1.html#6" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

void Biblioteka::RegistrirajNovuKnjigu(int evidencijski_broj_knjige, std::string naslov, std::string ime_pisca, std::string zanr, int godina_izdavanja) {
    for(auto iter = mapa_knjiga.begin(); iter != mapa_knjiga.end(); iter++) 
</font>        if(iter-&gt;first == evidencijski_broj_knjige) 
            throw std::logic_error("Knjiga vec postoji");    
    Knjiga* nova_knjiga = nullptr;
    try {
        nova_knjiga = new Knjiga(naslov, ime_pisca, zanr, godina_izdavanja);
        mapa_knjiga.insert(std::make_pair(evidencijski_broj_knjige, nova_knjiga));
    }
    catch(...) {
        delete nova_knjiga;
        throw;
    }
}
Korisnik&amp; Biblioteka::NadjiKorisnika(int clanski_broj_korisnika) {
    for(auto iter = mapa_korisnika.begin(); iter != mapa_korisnika.end(); iter++) {
        if(iter-&gt;first == clanski_broj_korisnika)
            return *(iter-&gt;second);
    }
    throw std::logic_error("Korisnik nije nadjen");
}
Knjiga&amp; Biblioteka::NadjiKnjigu(int evidencijski_broj_knjige) {
<a name="9"></a><font color="#FF00FF"><a href="match251-1.html#9" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

    for(auto iter = mapa_knjiga.begin(); iter != mapa_knjiga.end(); iter++) {
        if(iter-&gt;first == evidencijski_broj_knjige)
            return *(iter-&gt;second);
    }
    throw std::logic_error("Knjiga nije nadjena");    
}
void Biblioteka::IzlistajKorisnike() const {
</font>    for(auto iter = mapa_korisnika.begin(); iter != mapa_korisnika.end(); iter++) {
        std::cout &lt;&lt; "Clanski broj: " &lt;&lt; iter-&gt;first &lt;&lt; std::endl;
        std::cout &lt;&lt; "Ime i prezime: " &lt;&lt; iter-&gt;second-&gt;ime &lt;&lt; " " &lt;&lt; iter-&gt;second-&gt;prezime &lt;&lt; std::endl;
<a name="10"></a><font color="#FF0000"><a href="match251-1.html#10" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

        std::cout &lt;&lt; "Adresa: " &lt;&lt; iter-&gt;second-&gt;adresa &lt;&lt; std::endl;
        std::cout &lt;&lt; "Broj telefona: " &lt;&lt; iter-&gt;second-&gt;telefon &lt;&lt; std::endl &lt;&lt; std::endl;
    }
}
void Biblioteka::IzlistajKnjige() const {
</font>    for(auto iter = mapa_knjiga.begin(); iter != mapa_knjiga.end(); iter++) {
        std::cout &lt;&lt; "Evidencijski broj: " &lt;&lt; iter-&gt;first &lt;&lt; std::endl;
        std::cout &lt;&lt; "Naslov: " &lt;&lt; iter-&gt;second-&gt;DajNaslov() &lt;&lt; std::endl;
        std::cout &lt;&lt; "Pisac: " &lt;&lt; iter-&gt;second-&gt;DajAutora() &lt;&lt; std::endl;
        std::cout &lt;&lt; "Zanr: " &lt;&lt; iter-&gt;second-&gt;DajZanr() &lt;&lt; std::endl;
        std::cout &lt;&lt; "Godina izdavanja: " &lt;&lt; iter-&gt;second-&gt;DajGodinuIzdavanja() &lt;&lt; std::endl;
        
        if(iter-&gt;second-&gt;DaLiJeZaduzena()) {
            std::cout &lt;&lt; "Zaduzena kod korisnika: ";
            std::cout &lt;&lt; iter-&gt;second-&gt;DajKodKogaJe()-&gt;ime &lt;&lt; " " &lt;&lt; iter-&gt;second-&gt;DajKodKogaJe()-&gt;prezime &lt;&lt; std::endl;
        }
        std::cout &lt;&lt; std::endl;
    }
}
void Biblioteka::ZaduziKnjigu(int evidencijski_broj_knjige, int clanski_broj_korisnika) {
    if(NadjiKnjigu(evidencijski_broj_knjige).DaLiJeZaduzena())
        throw std::logic_error("Knjiga vec zaduzena");
    NadjiKnjigu(evidencijski_broj_knjige).ZaduziKnjigu(NadjiKorisnika(clanski_broj_korisnika));
}
void Biblioteka::RazduziKnjigu(int evidencijski_broj_knjige) {
    if(!NadjiKnjigu(evidencijski_broj_knjige).DaLiJeZaduzena())
        throw std::logic_error("Knjiga nije zaduzena");
    NadjiKnjigu(evidencijski_broj_knjige).RazduziKnjigu();
}
void Biblioteka::PrikaziZaduzenja(int clanski_broj_korisnika) {
<a name="11"></a><font color="#00FF00"><a href="match251-1.html#11" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

    auto korisnik = NadjiKorisnika(clanski_broj_korisnika);
    bool zaduzen = false;
    for(auto iter = mapa_knjiga.begin(); iter != mapa_knjiga.end(); iter++) {
        if(iter-&gt;second-&gt;DaLiJeZaduzena()) {
</font>            if(*(iter-&gt;second-&gt;DajKodKogaJe()) == korisnik) {
                zaduzen = true;
                std::cout &lt;&lt; "Evidencijski broj: " &lt;&lt; iter-&gt;first &lt;&lt; std::endl;
                std::cout &lt;&lt; "Naslov: " &lt;&lt; iter-&gt;second-&gt;DajNaslov() &lt;&lt; std::endl;
                std::cout &lt;&lt; "Pisac: " &lt;&lt; iter-&gt;second-&gt;DajAutora() &lt;&lt; std::endl;
                std::cout &lt;&lt; "Zanr: " &lt;&lt; iter-&gt;second-&gt;DajZanr() &lt;&lt; std::endl;
                std::cout &lt;&lt; "Godina izdavanja: " &lt;&lt; iter-&gt;second-&gt;DajGodinuIzdavanja() &lt;&lt; std::endl &lt;&lt; std::endl;
            }
        }
    }
    if(!zaduzen) std::cout &lt;&lt; "Nema zaduzenja za tog korisnika!";
}

Biblioteka&amp; Biblioteka::operator = (const Biblioteka &amp;b2) {
    Dealociraj();
    
    std::map&lt;int, Korisnik*&gt; m_korisnika;
    std::map&lt;int, Knjiga*&gt; m_knjiga;
    Korisnik* novi_korisnik = nullptr;
    Knjiga* nova_knjiga = nullptr;
    try {
        for(auto x = b2.mapa_korisnika.begin(); x != b2.mapa_korisnika.end(); x++) {
            novi_korisnik = new Korisnik;
            novi_korisnik-&gt;ime = x-&gt;second-&gt;ime;
<a name="7"></a><font color="#0000FF"><a href="match251-1.html#7" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

            novi_korisnik-&gt;prezime = x-&gt;second-&gt;prezime;
            novi_korisnik-&gt;adresa = x-&gt;second-&gt;adresa;
            novi_korisnik-&gt;telefon = x-&gt;second-&gt;telefon;        
            m_korisnika.insert(std::make_pair(x-&gt;first, novi_korisnik));
</font>        }
        mapa_korisnika = m_korisnika;
        
        for(auto x = b2.mapa_knjiga.begin(); x != b2.mapa_knjiga.end(); x++) {
            nova_knjiga = new Knjiga(x-&gt;second-&gt;DajNaslov(), x-&gt;second-&gt;DajAutora(), x-&gt;second-&gt;DajZanr(), x-&gt;second-&gt;DajGodinuIzdavanja());
            m_knjiga.insert(std::make_pair(x-&gt;first, nova_knjiga));
        }
        mapa_knjiga = m_knjiga;
    }
    catch(...) {
        for(auto x : m_korisnika) {
            delete x.second; 
            x.second = nullptr;
        }
        for(auto x : m_knjiga) {
            delete x.second;
            x.second = nullptr;
        }
    }
    return *this;
}
Biblioteka&amp; Biblioteka::operator = (Biblioteka &amp;&amp;b2) {
    if(this == &amp;b2) return *this;
    Dealociraj();
    mapa_korisnika = b2.mapa_korisnika;
    mapa_knjiga = b2.mapa_knjiga;
    return *this;
}
Biblioteka::Biblioteka(Biblioteka &amp;&amp;b2) {
    mapa_korisnika = b2.mapa_korisnika;
    mapa_knjiga = b2.mapa_knjiga;
}
Biblioteka::Biblioteka(const Biblioteka &amp;b2) {
    std::map&lt;int, Korisnik*&gt; m_korisnika;
    std::map&lt;int, Knjiga*&gt; m_knjiga;
    Korisnik* novi_korisnik = nullptr;
    Knjiga* nova_knjiga = nullptr;
    try {
        for(auto x = b2.mapa_korisnika.begin(); x != b2.mapa_korisnika.end(); x++) {
            novi_korisnik = new Korisnik;
            novi_korisnik-&gt;ime = x-&gt;second-&gt;ime;
<a name="8"></a><font color="#00FFFF"><a href="match251-1.html#8" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

            novi_korisnik-&gt;prezime = x-&gt;second-&gt;prezime;
            novi_korisnik-&gt;adresa = x-&gt;second-&gt;adresa;
            novi_korisnik-&gt;telefon = x-&gt;second-&gt;telefon;        
            m_korisnika.insert(std::make_pair(x-&gt;first, novi_korisnik));
</font>        }
        mapa_korisnika = m_korisnika;
        
        for(auto x = b2.mapa_knjiga.begin(); x != b2.mapa_knjiga.end(); x++) {
            nova_knjiga = new Knjiga(x-&gt;second-&gt;DajNaslov(), x-&gt;second-&gt;DajAutora(), x-&gt;second-&gt;DajZanr(), x-&gt;second-&gt;DajGodinuIzdavanja());
            m_knjiga.insert(std::make_pair(x-&gt;first, nova_knjiga));
        }
        mapa_knjiga = m_knjiga;
    }
    catch(...) {
        for(auto x : m_korisnika) {
            delete x.second; 
            x.second = nullptr;
        }
        for(auto x : m_knjiga) {
            delete x.second;
            x.second = nullptr;
        }
    }
}

void Biblioteka::Dealociraj() {
    for(auto x : mapa_korisnika) {
        delete x.second; 
        x.second = nullptr;
    }
    for(auto x : mapa_knjiga) {
        delete x.second; 
        x.second = nullptr;
    }
}
void OcistiTok() {
    std::cin.ignore(1000, '\n');
    std::cin.clear();
}

int main() {
    Biblioteka bi;
    while(true) {
        std::cout &lt;&lt; "Odaberite opciju: " &lt;&lt; std::endl;
        std::cout &lt;&lt; "1 - Registracija novog korisnika " &lt;&lt; std::endl;
        std::cout &lt;&lt; "2 - Registracija nove knjige" &lt;&lt; std::endl;
        std::cout &lt;&lt; "3 - Lista registriranih korisnika" &lt;&lt; std::endl;
        std::cout &lt;&lt; "4 - Lista registriranih knjiga" &lt;&lt; std::endl;
        std::cout &lt;&lt; "5 - Zaduzivanje knjige " &lt;&lt; std::endl;
        std::cout &lt;&lt; "6 - Razduzivanje knjige" &lt;&lt; std::endl;
        std::cout &lt;&lt; "7 - Lista zaduzenih korisnika" &lt;&lt; std::endl;
        std::cout &lt;&lt; "8 - Izlaz" &lt;&lt; std::endl;
        std::cout &lt;&lt; "Opcija: "; int opcija; std::cin &gt;&gt; opcija;
        try {
            std::cout &lt;&lt; std::endl; OcistiTok();
            if(opcija == 1) {
                std::cout &lt;&lt; "Clanski broj: "; int clanski_broj_korisnika; std::cin &gt;&gt; clanski_broj_korisnika;
                OcistiTok();
                std::cout &lt;&lt; "Ime: "; std::string ime; std::getline(std::cin, ime);
                std::cout &lt;&lt; "Prezime: "; std::string prezime; std::getline(std::cin, prezime);
<a name="1"></a><font color="#00FF00"><a href="match251-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_2.gif"/></a>

                std::cout &lt;&lt; "Adresa: "; std::string adresa; std::getline(std::cin, adresa);
                std::cout &lt;&lt; "Telefon: "; std::string telefon; std::getline(std::cin, telefon);
                bi.RegistrirajNovogKorisnika(clanski_broj_korisnika, ime, prezime, adresa, telefon);
            }
            else if(opcija == 2) {
                std::cout &lt;&lt; "Evidencijski broj: "; int evidencijski_broj_knjige; std::cin &gt;&gt; evidencijski_broj_knjige;
</font>                OcistiTok();
                std::cout &lt;&lt; "Naslov: "; std::string naslov; std::getline(std::cin, naslov);
                std::cout &lt;&lt; "Ime autora: "; std::string autor; std::getline(std::cin, autor);
<a name="2"></a><font color="#0000FF"><a href="match251-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_2.gif"/></a>

                std::cout &lt;&lt; "Zanr: "; std::string zanr; std::getline(std::cin, zanr);
                std::cout &lt;&lt; "Godina izdavanja: "; int godina_izdavanja; std::cin &gt;&gt; godina_izdavanja;
                bi.RegistrirajNovuKnjigu(evidencijski_broj_knjige, naslov, autor, zanr, godina_izdavanja);
            }
</font><a name="0"></a><font color="#FF0000"><a href="match251-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_4.gif"/></a>

            else if(opcija == 3) {
                bi.IzlistajKorisnike();
            }
            else if(opcija == 4) {
                bi.IzlistajKnjige();
            }
            else if(opcija == 5) {
                std::cout &lt;&lt; "Evidencijski broj knjige: "; int evidencijski_broj_knjige; std::cin &gt;&gt; evidencijski_broj_knjige;
                std::cout &lt;&lt; "Clanski broj korisnika: "; int clanski_broj_korisnika; std::cin &gt;&gt; clanski_broj_korisnika;
                bi.ZaduziKnjigu(evidencijski_broj_knjige, clanski_broj_korisnika);
            }
            else if(opcija == 6) {
                std::cout &lt;&lt; "Clanski broj korisnika: "; int clanski_broj_korisnika; std::cin &gt;&gt; clanski_broj_korisnika;
                bi.RazduziKnjigu(clanski_broj_korisnika);
            }
            else if(opcija == 7) {
                std::cout &lt;&lt; "Clanski broj korisnika: "; int clanski_broj_korisnika; std::cin &gt;&gt; clanski_broj_korisnika;
                bi.PrikaziZaduzenja(clanski_broj_korisnika);
</font>            }
            else if(opcija == 8) {
                return 0;
            }
            else throw std::runtime_error("Nekoretan unos");
        }
        catch(std::domain_error e) {
            std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
        }
        catch(std::logic_error e) {
            std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
        }
        catch(std::bad_alloc) {
            std::cout &lt;&lt; "Nedovoljno memorije" &lt;&lt; std::endl;
        }
        catch(std::runtime_error e) {
            std::cout &lt;&lt; e.what();
        }
        catch(...) {
            std::cout &lt;&lt; "Nepoznata greska..." &lt;&lt; std::endl;
        }
    }
	return 0;
}

/*int maintest() {
    Biblioteka b;
    b.RegistrirajNovogKorisnika(4555, "arr","ss" , "ddd", "123");
    b.RegistrirajNovogKorisnika(45665, "arr","ss" , "ddd", "163");
    b.RegistrirajNovogKorisnika(68765, "arr","ss" , "ddd", "14463");
    b.RegistrirajNovuKnjigu(4444, "eee", "erer","3434", 1223); 
    b.RegistrirajNovuKnjigu(45544, "eee", "erer","3434", 1223); 
    Biblioteka b2(std::move(b));
    //b2.RegistrirajNovogKorisnika(4124445, "errrr","gg" , "ddnnnn", "123423");
    
   // b2.RegistrirajNovuKnjigu(4444, "eee", "erer","3434", 1223); 
    //b = b2;
    
    
    b2.IzlistajKnjige();
}*/

/*

                std::cout &lt;&lt; "Clanski broj: " &lt;&lt; clanski_broj_korisnika &lt;&lt; std::endl;
                std::cout &lt;&lt; "Ime i prezime: " &lt;&lt; NadjiKorisnika(clanski_broj_korisnika).ime &lt;&lt; " " &lt;&lt; NadjiKorisnika(clanski_broj_korisnika).prezime &lt;&lt; std::endl;
                std::cout &lt;&lt; "Adresa: " &lt;&lt; NadjiKorisnika(clanski_broj_korisnika).adresa &lt;&lt; std::endl;
                std::cout &lt;&lt; "Broj telefona: " &lt;&lt; NadjiKorisnika(clanski_broj_korisnika).telefon &lt;&lt; std::endl &lt;&lt; std::endl;
                
                */</pre>
</body>
</html>
