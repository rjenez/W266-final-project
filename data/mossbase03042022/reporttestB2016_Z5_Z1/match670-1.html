<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z1/student9296.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z1/student4863.cpp<p></p><pre>
/B16/17 (ZadaÄ‡a 5, Zadatak 1)
//Autotestovi by Eldar Kurtic (mail: ekurtic3@etf.unsa.ba)
//Za autotestove se obracati *iskljucivo* osobi koja ih pise
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;map&gt;
#include &lt;new&gt;
#include &lt;algorithm&gt;
#include &lt;stdexcept&gt;
#include &lt;iterator&gt;

struct Korisnik {
    std::string ime, prezime, adresa, telefon;  
};

class Knjiga {
    std::string naslov, pisac, zanr;
    int godina_izdavanja;
    Korisnik* zaduzenik{nullptr};
public:
    Knjiga(std::string naslov, std::string pisac, std::string zanr, int god) : naslov(naslov), pisac(pisac), zanr(zanr), godina_izdavanja(god) {}
    std::string DajNaslov() const {return naslov;}
    std::string DajAutora() const {return pisac;}
    std::string DajZanr() const {return zanr;}
    int DajGodinuIzdavanja() const {return godina_izdavanja;}
    Korisnik* DajKodKogaJe() const {return zaduzenik;}
    void ZaduziKnjigu(Korisnik&amp; citac);
    void RazduziKnjigu();
    bool DaLiJeZaduzena();
};

void Knjiga::ZaduziKnjigu(Korisnik&amp; citac) {
    zaduzenik = &amp;citac;
}
void Knjiga::RazduziKnjigu() {
    zaduzenik = nullptr;
}
bool Knjiga::DaLiJeZaduzena() {
    return zaduzenik;
}

class Biblioteka {
    std::map&lt;int, Korisnik*&gt; m_korisnika;
    std::map&lt;int, Knjiga*&gt; m_knjiga;
public:
    ~Biblioteka();
    Biblioteka&amp; operator = (const Biblioteka &amp;b);
    Biblioteka&amp; operator = (Biblioteka &amp;&amp;b);
    void RegistrirajNovogKorisnika(int cl_br, std::string ime, std::string prezime, std::string adresa, std::string brtel);
<a name="0"></a><font color="#FF0000"><a href="match670-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_3.gif"/></a>

    void RegistrirajNovuKnjigu(int ev_br, std::string naslov, std::string autor, std::string zanr, int god_izdavanja);
    Korisnik&amp; NadjiKorisnika(int clanski_br) const;
    Knjiga&amp; NadjiKnjigu(int evidencijski_br) const;
    void IzlistajKorisnike() const;
    void IzlistajKnjige() const;
    void ZaduziKnjigu(int ev_broj, int cl_broj);
    void RazduziKnjigu(int ev_broj);
    void PrikaziZaduzenja(int cl_broj) const;
};
Biblioteka::~Biblioteka() {
</font>    for(auto it = m_korisnika.begin(); it != m_korisnika.end(); it++)
        delete it-&gt;second;
    for(auto it = m_knjiga.begin(); it != m_knjiga.end(); it++)
        delete it-&gt;second;
}
Biblioteka&amp; Biblioteka::operator = (const Biblioteka &amp;b) {
    if(&amp;b != this){
    std::map&lt;int, Korisnik*&gt; tmp_korisnika;
    std::map&lt;int, Knjiga*&gt; tmp_knjiga;
    try{
        for(auto it = b.m_korisnika.begin(); it != b.m_korisnika.end(); it++)
            tmp_korisnika[it-&gt;first] = new Korisnik (*it-&gt;second);
        for(auto it = b.m_knjiga.begin(); it != b.m_knjiga.end(); it++)
            tmp_knjiga[it-&gt;first] = new Knjiga (*it-&gt;second);
    }
    catch(std::bad_alloc) {
        for(auto it = tmp_korisnika.begin(); it != tmp_korisnika.end(); it++)
            delete it-&gt;second;
        for(auto it = tmp_knjiga.begin(); it != tmp_knjiga.end(); it++)
        throw;
    }
    for(auto it = m_korisnika.begin(); it != m_korisnika.end(); it++)
        delete it-&gt;second;
    for(auto it = m_knjiga.begin(); it != m_knjiga.end(); it++)
        delete it-&gt;second;
    m_korisnika = tmp_korisnika;
    m_knjiga = tmp_knjiga;
    for(auto it = b.m_knjiga.begin(); it != b.m_knjiga.end(); it++) {
        for(auto it2 = b.m_korisnika.begin(); it2 != b.m_korisnika.end(); it2++)
            if(it-&gt;second-&gt;DajKodKogaJe() == it2-&gt;second) {
                auto it3(m_korisnika.begin());
                std::advance(it3, std::distance(b.m_korisnika.begin(), it2));
                m_knjiga[it-&gt;first]-&gt;ZaduziKnjigu(*it3-&gt;second);
            }
    }
    }
    return *this;
}

Biblioteka&amp; Biblioteka::operator =(Biblioteka &amp;&amp;b) {
    std::swap(m_korisnika, b.m_korisnika);
    std::swap(m_knjiga, b.m_knjiga);
    return *this;
}
<a name="3"></a><font color="#00FFFF"><a href="match670-0.html#3" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_2.gif"/></a>

void Biblioteka::RegistrirajNovogKorisnika(int cl_br, std::string ime, std::string prezime, std::string adresa, std::string brtel) {
   if(m_korisnika.count(cl_br)) throw std::logic_error("Korisnik vec postoji");
    try{
</font>        m_korisnika[cl_br] = new Korisnik{ime, prezime, adresa, brtel};
    }
    catch(std::bad_alloc) {
<a name="4"></a><font color="#FF00FF"><a href="match670-0.html#4" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_2.gif"/></a>

        throw;
    }
}
void Biblioteka::RegistrirajNovuKnjigu(int ev_br, std::string naslov, std::string autor, std::string zanr, int god_izdavanja) {
    if(m_knjiga.count(ev_br)) throw std::logic_error("Knjiga vec postoji");
</font>    try{
        m_knjiga[ev_br] = new Knjiga(naslov, autor, zanr, god_izdavanja);
    }
    catch(std::bad_alloc) {
        throw;
    }
}
<a name="5"></a><font color="#FF0000"><a href="match670-0.html#5" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_2.gif"/></a>

Korisnik &amp;Biblioteka::NadjiKorisnika(int clanski_br) const {
    auto it(m_korisnika.find(clanski_br));
    if(it == m_korisnika.end()) throw std::logic_error("Korisnik nije nadjen");
    return *(it-&gt;second);
}
Knjiga &amp;Biblioteka::NadjiKnjigu(int ev_br) const {
</font><a name="1"></a><font color="#00FF00"><a href="match670-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_3.gif"/></a>

    auto it(m_knjiga.find(ev_br));
    if(it == m_knjiga.end()) throw std::logic_error("Knjiga nije nadjena");
    return *(it-&gt;second);
}
void Biblioteka::IzlistajKorisnike() const {
    for(auto it = m_korisnika.begin(); it != m_korisnika.end(); it++) {
        std::cout &lt;&lt; "Clanski broj: " &lt;&lt; it-&gt;first;
</font>        std::cout &lt;&lt; "\nIme i prezime: " &lt;&lt; it-&gt;second-&gt;ime &lt;&lt; " " &lt;&lt; it-&gt;second-&gt;prezime;
<a name="2"></a><font color="#0000FF"><a href="match670-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_2.gif"/></a>

        std::cout &lt;&lt; "\nAdresa: " &lt;&lt; it-&gt;second-&gt;adresa;
        std::cout &lt;&lt; "\nBroj telefona: " &lt;&lt; it-&gt;second-&gt;telefon &lt;&lt; std::endl &lt;&lt; std::endl;
    }
}
void Biblioteka::IzlistajKnjige() const {
    for(auto it = m_knjiga.begin(); it != m_knjiga.end(); it++) {
</font>        std::cout &lt;&lt; "Evidencijski broj: " &lt;&lt; it-&gt;first;
        std::cout &lt;&lt; "\nNaslov: " &lt;&lt; it-&gt;second-&gt;DajNaslov();
        std::cout &lt;&lt; "\nPisac: " &lt;&lt; it-&gt;second-&gt;DajAutora();
        std::cout &lt;&lt; "\nZanr: " &lt;&lt; it-&gt;second-&gt;DajZanr();
        std::cout &lt;&lt; "\nGodina izdavanja: " &lt;&lt; it-&gt;second-&gt;DajGodinuIzdavanja() &lt;&lt; std::endl;
<a name="6"></a><font color="#00FF00"><a href="match670-0.html#6" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

        if(it-&gt;second-&gt;DaLiJeZaduzena()) std::cout &lt;&lt; "Zaduzena kod korisnika: " &lt;&lt; it-&gt;second-&gt;DajKodKogaJe()-&gt;ime &lt;&lt; " " &lt;&lt; it-&gt;second-&gt;DajKodKogaJe()-&gt;prezime &lt;&lt; std::endl;
        std::cout &lt;&lt; std::endl;
    }
}
void Biblioteka::ZaduziKnjigu(int ev_br, int cl_br) {
</font>    if(!m_knjiga.count(ev_br)) throw std::logic_error("Knjiga nije nadjena");
    if(!m_korisnika.count(cl_br)) throw std::logic_error("Korisnik nije nadjen");
<a name="7"></a><font color="#0000FF"><a href="match670-0.html#7" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

    if(m_knjiga[ev_br]-&gt;DaLiJeZaduzena()) throw std::logic_error("Knjiga vec zaduzena");
    m_knjiga[ev_br]-&gt;ZaduziKnjigu(*m_korisnika[cl_br]);
}
void Biblioteka::RazduziKnjigu(int ev_br) {
</font>    if(!m_knjiga.count(ev_br)) throw std::logic_error("Knjiga nije nadjena");
    if(!m_knjiga[ev_br]-&gt;DaLiJeZaduzena()) throw std::logic_error("Knjiga nije zaduzena");
    delete m_knjiga[ev_br];
    m_knjiga[ev_br]-&gt;RazduziKnjigu();
}
void Biblioteka::PrikaziZaduzenja(int cl_br) const {
    auto i(m_korisnika.find(cl_br));
    if(i == m_korisnika.end()) throw std::logic_error("Korisnik nije nadjen");
    bool nadjen(false);
    for(auto it = m_knjiga.begin(); it != m_knjiga.end(); it++) {
        if(it-&gt;second-&gt;DajKodKogaJe() == &amp;NadjiKorisnika(cl_br)) {
            std::cout &lt;&lt; "Evidencijski broj: " &lt;&lt; it-&gt;first;
            std::cout &lt;&lt; "\nNaslov: " &lt;&lt; it-&gt;second-&gt;DajNaslov();
            std::cout &lt;&lt; "\nPisac: " &lt;&lt; it-&gt;second-&gt;DajAutora();
            std::cout &lt;&lt; "\nZanr: " &lt;&lt; it-&gt;second-&gt;DajZanr();
            std::cout &lt;&lt; "\nGodina izdavanja: " &lt;&lt; it-&gt;second-&gt;DajGodinuIzdavanja() &lt;&lt; std::endl &lt;&lt; std::endl;
            nadjen = true;
        }
    }
    if(!nadjen) std::cout &lt;&lt; "Nema zaduzenja za tog korisnika!";
}

int main ()
{
    try{
    Biblioteka b;
    b.RegistrirajNovogKorisnika(100, "abc", "abc", "abc", "abc");
    b.RegistrirajNovogKorisnika(20, "efg", "ef", "ef", "ef");
    b.RegistrirajNovuKnjigu(5, "abc", "abc", "abc", 123);
    b.RegistrirajNovuKnjigu(6, "abc", "abc", "abc", 567);
    b.RegistrirajNovuKnjigu(1, "a", "a", "a", 13);
    b.ZaduziKnjigu(5, 100);
    b.ZaduziKnjigu(6, 100);
    b.ZaduziKnjigu(1, 20);
    Biblioteka c;
    c = b;
    c.PrikaziZaduzenja(100);
    }
    catch(std::logic_error) {
    }
    catch(std::bad_alloc){
    }
    
   
	return 0;
}</pre>
</body>
</html>
