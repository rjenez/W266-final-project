<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z2/Z1/student9805.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z2/Z1/student9805.cpp<p></p><pre>
/*B 2017/2018, ZadaÄ‡a 2, Zadatak 1
	
	NAPOMENA: ulaz/izlaz za zadatke je specificiran
	javnim autotestovima. Zalbe za ne analiziranje testova
	se ne uvazavaju!
	
	NAPOMENA: nece svi (javni) testovi sa zamgera biti 
	dostupni na c9.

	Za sva ostala pitanja i nedoumice vezane za 
	autotestove javiti se na forum (c2).
*/
#include &lt;iostream&gt;
#include &lt;vector&gt;
#include &lt;sstream&gt;
#include &lt;string&gt;
#include &lt;stdexcept&gt;

<a name="0"></a><font color="#FF0000"><a href="match124-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_87.gif"/></a>

using namespace std;

enum class Polje{ Prazno,Posjeceno,Mina,BlokiranoPrazno,BlokiranoPosjeceno,BlokiranoMina };
enum class Smjerovi {GoreLijevo,Gore,GoreDesno,Desno,DoljeDesno,Dolje,DoljeLijevo,Lijevo};
enum class Status {NijeKraj,KrajPoraz,KrajPobjeda};
enum class KodoviGresaka {PogresnaKomanda,NeispravnaKomanda,NeispravanParametar,NedostajeParametar,SuvisanParametar};
enum class Komande {PomjeriJednoMjesto,PomjeriDalje,Blokiraj,Deblokiraj,PrikaziOkolinu,ZavrsiIgru,KreirajIgru};

typedef std::vector&lt;std::vector&lt;Polje&gt;&gt; Tabla;

Tabla KreirajIgru(int x,vector&lt;vector&lt;int&gt;&gt; &amp;tabla){
	Tabla poljezaminu(x,vector&lt;Polje&gt;(x,Polje::Prazno));
	for(const auto &amp;vek : tabla){
		if(vek.size()!=2)throw domain_error ("Ilegalan format zadavanja mina!");
		if(vek[0]&lt;0 || vek[0]&gt;=x || vek[1]&lt;0 || vek[1]&gt;=x){
			throw domain_error("Ilegalne pozicije mina");
		}
		poljezaminu[vek[0]][vek[1]]=Polje::Mina;
	}
	return poljezaminu;
}
bool LegalnoPolje(const Tabla &amp;poljezaigru,int x,int y){
	if(x&gt;0 &amp;&amp; x&lt;poljezaigru.size() &amp;&amp; y&gt;0 &amp;&amp; y&lt;poljezaigru[x].size()) return true;
	else return false;
}
void ValidirajPolje(const Tabla &amp;polja, int x, int y) {
  if(!LegalnoPolje(polja, x, y))
    throw std::domain_error("Polje (" + to_string(x) + "," + to_string(y) + ") ne postoji");
}

std::vector&lt;std::vector&lt;int&gt;&gt; PrikaziOkolinu(const Tabla &amp;polja, int x, int y) {
  std::vector&lt;std::vector&lt;int&gt;&gt; m(3, std::vector&lt;int&gt;(3));
  ValidirajPolje(polja, x, y);
  for(int i = x - 1; i &lt;= x + 1; i++)
    for(int j = y - 1; j &lt;= y + 1; j++) {
      int brojac(0);
      for(int p = i - 1; p &lt;= i + 1; p++)
        for(int q = j - 1; q &lt;= j + 1; q++) {
          if(LegalnoPolje(polja, p, q) &amp;&amp; !(p == i &amp;&amp; q == j) &amp;&amp;
            (polja[p][q] == Polje::Mina || polja[p][q] == Polje::BlokiranoMina))
              brojac++;
        }
      m[i - x + 1][j - y + 1] = brojac;
    }
  return m;
}

void BlokirajPolje(Tabla &amp;polja, int x, int y) {
  ValidirajPolje(polja, x, y);
  if(polja[x][y] &lt; Polje::BlokiranoPrazno)
    polja[x][y] = Polje(int(polja[x][y]) + 3);
}

void DeblokirajPolje(Tabla &amp;polja, int x, int y) {
  ValidirajPolje(polja, x, y);
  if(polja[x][y] &gt;= Polje::BlokiranoPrazno)
    polja[x][y] = Polje(int(polja[x][y]) - 3);
}

Status Idi(Tabla &amp;polja, int &amp;x, int &amp;y, int novi_x, int novi_y) {
  if(!LegalnoPolje(polja, novi_x, novi_y))
    throw std::out_of_range("Izlazak van igrace table");
  if(polja[novi_x][novi_y] &gt;= Polje::BlokiranoPrazno)
    throw std::logic_error("Blokirano polje");
  polja[x][y] = Polje::Posjeceno;
  x = novi_x; y = novi_y;
  if(polja[x][y] == Polje::Mina || polja[x][y] == Polje::BlokiranoMina) {
    for(int i = 0; i &lt; polja.size(); i++)
      for(int j = 0; j &lt; polja[i].size(); j++) polja[i][j] = Polje::Prazno;
    return Status::KrajPoraz;
  }
  bool ima_prazno(false);
  for(int i = 0; i &lt; polja.size(); i++)
    for(int j = 0; j &lt; polja[i].size(); j++)
      if(!(i == x &amp;&amp; j == y) &amp;&amp; polja[i][j] == Polje::Prazno) ima_prazno = true;
  if(!ima_prazno) return Status::KrajPobjeda;
  return Status::NijeKraj;
}

Status Idi(Tabla &amp;polja, int &amp;x, int &amp;y, Smjerovi smjer) {
  int dx[]{-1, -1, -1, 0, 1, 1, 1, 0};
  int dy[]{-1, 0, 1, 1, 1, 0, -1, -1};
  return Idi(polja, x, y, x + dx[int(smjer)], y + dy[int(smjer)]);
}

void PrijaviGresku(KodoviGresaka greska) {
  const char *tekstovi[] = {"Nerazumljiva komanda!", "Komanda trazi parametar koji nije naveden!",
	"Zadan je suvisan parametar nakon komande!", "Parametar komande nije ispravan!"};
  std::cout &lt;&lt; tekstovi[int(greska)] &lt;&lt; std::endl;
}

int PreskociRazmake() {
  while(std::cin.peek() == ' ') std::cin.get();
  return std::cin.peek();
}

bool ProcesirajGresku(KodoviGresaka &amp;gdje, KodoviGresaka kod) {
  std::cin.clear(); std::cin.ignore(10000, '\n');
  gdje = kod;
  return false;
}

bool UnosKomande(Komande &amp;komanda, Smjerovi &amp;smjer, int &amp;x, int &amp;y, KodoviGresaka &amp;greska) {
  bool ima_greska(false);
  char znak;
  std::cin &gt;&gt; znak;
  if(znak == 'P') {
    char znak2(std::cin.get());
    if(znak2 == '1') komanda = Komande::PomjeriJednoMjesto;
    else if(znak2 == '&gt;') komanda = Komande::PomjeriDalje;
    else if(znak2 == 'O') komanda = Komande::PrikaziOkolinu;
    else ima_greska = true;
  }
  else if(znak == 'B') komanda = Komande::Blokiraj;
  else if(znak == 'D') komanda = Komande::Deblokiraj;
  else if(znak == 'Z') komanda = Komande::ZavrsiIgru;
  else if(znak == 'K') komanda = Komande::KreirajIgru;
  else ima_greska = true;
  if(ima_greska)
    return ProcesirajGresku(greska, KodoviGresaka::PogresnaKomanda);
  if(komanda == Komande::PomjeriJednoMjesto) {
    if(PreskociRazmake() == '\n')
      return ProcesirajGresku(greska, KodoviGresaka::NedostajeParametar);
    std::string par, legalne[]{"GL", "G", "GD", "D", "DoD", "Do", "DoL", "L"};
    std::cin &gt;&gt; par;
    int gdje_je(-1);
    for(int i = 0; i &lt; 8; i++)
      if(legalne[i] == par) gdje_je = i;
    if(gdje_je == -1)
      return ProcesirajGresku(greska, KodoviGresaka::NeispravanParametar);
    smjer = Smjerovi(gdje_je);
  }
  if(komanda == Komande::PomjeriDalje || komanda == Komande::Blokiraj ||
    komanda == Komande::Deblokiraj) {
      if(PreskociRazmake() == '\n')
        return ProcesirajGresku(greska, KodoviGresaka::NedostajeParametar);
      std::cin &gt;&gt; x;
      if(!std::cin)
        return ProcesirajGresku(greska, KodoviGresaka::NeispravanParametar);
      if(PreskociRazmake() == '\n')
        return ProcesirajGresku(greska, KodoviGresaka::NedostajeParametar);
      std::cin &gt;&gt; y;
      if(!std::cin || (std::cin.peek() != ' ' &amp;&amp; std::cin.peek() != '\n'))
        return ProcesirajGresku(greska, KodoviGresaka::NeispravanParametar);
  }
  if(PreskociRazmake() != '\n')
    return ProcesirajGresku(greska, KodoviGresaka::SuvisanParametar);
  return true;
}

void IzvrsiKomandu(Komande komanda, Tabla &amp;polja, int &amp;x, int &amp;y,Smjerovi p_smjer = Smjerovi::Gore, int p_x = 0, int p_y = 0) {
    Status rezultat(Status::NijeKraj);
    try {
      if(komanda == Komande::PomjeriJednoMjesto) rezultat = Idi(polja, x, y, p_smjer);
      else if(komanda == Komande::PomjeriDalje) rezultat = Idi(polja, x, y, p_x, p_y);
      else if(komanda == Komande::Blokiraj) BlokirajPolje(polja, p_x, p_y);
      else if(komanda == Komande::Deblokiraj) DeblokirajPolje(polja, p_x, p_y);
      else if(komanda == Komande::PrikaziOkolinu) {
        std::vector&lt;std::vector&lt;int&gt;&gt; okolina(PrikaziOkolinu(polja, x, y));
        for(int i = 0; i &lt; 3; i++) {
          for(int j = 0; j &lt; 3; j++) std::cout &lt;&lt; okolina[i][j] &lt;&lt; " ";
          std::cout &lt;&lt; std::endl;
        }
      }
      else if(komanda == Komande::KreirajIgru) {
        int n;
        std::cout &lt;&lt; "Unesite broj polja: ";
        std::cin &gt;&gt; n;
        std::vector&lt;std::vector&lt;int&gt;&gt; mine;
        std::cout &lt;&lt; "Unesite pozicije mina: ";
        for(;;) {
          char znak;
          bool ima_greska(false);
          int x, y;
          std::cin &gt;&gt; znak;
          if(znak == '.') break;
          if(znak != '(') ima_greska = true;
          if(!ima_greska) {
            std::cin &gt;&gt; x &gt;&gt; znak;
            if(!std::cin || znak != ',') ima_greska = true;
          }
          if(!ima_greska) {
            std::cin &gt;&gt; y &gt;&gt; znak;
            if(!std::cin || znak != ')') ima_greska = true;
          }
          if(ima_greska || x &lt; 0 || x &gt;= n || y &lt; 0 || y &gt;= n) {
            std::cin.clear();
            std::cin.ignore(10000, '\n');
            std::cout &lt;&lt; "Greska, unesite ponovo!" &lt;&lt; std::endl;
          }
          else mine.push_back({x, y});
        }
        polja = KreirajIgru(n, mine);
      }
      if(komanda == Komande::PomjeriJednoMjesto || komanda == Komande::PomjeriDalje)
        std::cout &lt;&lt; "Tekuca pozicija igraca je (" &lt;&lt; x &lt;&lt; "," &lt;&lt; y &lt;&lt; ")" &lt;&lt; std::endl;
    }
    catch(std::domain_error e) {
      std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
    }
    catch(std::out_of_range e) {
</font><a name="1"></a><font color="#00FF00"><a href="match124-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_11.gif"/></a>

      std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
    }
    catch(std::logic_error e) {
      std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
    }
    if(komanda == Komande::PomjeriJednoMjesto || komanda == Komande::PomjeriDalje) {
      if(rezultat == Status::KrajPobjeda)
        std::cout &lt;&lt; "Bravo, obisli ste sva sigurna polja" &lt;&lt; std::endl;
      if(rezultat == Status::KrajPoraz)
        std::cout &lt;&lt; "Nagazili ste na minu" &lt;&lt; std::endl;
      if(rezultat != Status::NijeKraj) komanda = Komande::ZavrsiIgru;
    }
    if(komanda == Komande::ZavrsiIgru) {
      for(int i = 0; i &lt; polja.size(); i++)
        for(int j = 0; j &lt; polja[i].size(); j++) polja[i][j] = Polje::Prazno;
      throw std::runtime_error("Igra zavrsena");
    }
}

int main(){
  try {
    Tabla polja;
    int xpozicija(0), ypozicija(0);
    for(;;) {
      Komande komanda;
      Smjerovi smjer;
      int x, y;
      KodoviGresaka greska;
      std::cout &lt;&lt; "Unesite komandu: ";
      if(UnosKomande(komanda, smjer, x, y, greska))
        IzvrsiKomandu(komanda, polja, xpozicija, ypozicija, smjer, x, y);
      else
        PrijaviGresku(greska);
    }
  }
  catch(...) {
    std::cout &lt;&lt; "Dovidjenja!" &lt;&lt; std::endl;
</font>  }
  return 0;
}
</pre>
</body>
</html>
