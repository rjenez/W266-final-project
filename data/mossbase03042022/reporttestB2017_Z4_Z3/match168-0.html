<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student5536.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student5536.cpp<p></p><pre>
<a name="5"></a><font color="#FF0000"><a href="match168-1.html#5" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_2.gif"/></a>

/B2017/2018: ZadaÄ‡a 4, Zadatak 3
#include &lt;iostream&gt;
#include &lt;tuple&gt;
#include &lt;stdexcept&gt;
#include &lt;iomanip&gt;
#include &lt;algorithm&gt;
#include &lt;vector&gt;

typedef std::tuple &lt;int,int,int&gt; TaplIntova;
typedef std::pair &lt;int,int&gt; ParIntova;

class Datum
{
    friend class Pregled;
    friend class Pregledi;
    int dan,mjesec,godina;
    static void Izuzetak(int dan, int mjesec, int godina) {
        int broj_dana [] {31,28,31,30,31,30,31,31,30,31,30,31};
</font>        if ((godina % 4 == 0 &amp;&amp; godina % 100 != 0) || godina % 400 == 0) broj_dana[1]++;
<a name="2"></a><font color="#0000FF"><a href="match168-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_17.gif"/></a>

        if (godina&lt;1 || dan&lt;1 || mjesec&lt;1 || mjesec&gt;12 || dan&gt;broj_dana[mjesec-1]) throw std::domain_error ("Neispravan datum");
    }
    
    int DajDan() const {
        return dan;
    }
    
    int DajMjesec() const {
        return mjesec;
    }
    
    int DajGodinu() const {
        return godina;
    }
    
    Datum &amp;PostaviDan (int dan) {
        int broj_dana [] {31,28,31,30,31,30,31,31,30,31,30,31};
        if ((godina % 4 == 0 &amp;&amp; godina % 100 != 0) || godina % 400 == 0) broj_dana[1]++; // za prestupne godine

        if (dan&gt;broj_dana[mjesec-1]) {
            if (mjesec==12) { // u slucaju da treba preci na sljedecu godinu
                godina++;
                mjesec=0;
            }
            dan=1;
            mjesec++;
        } // prelaz u mjesec+1

        else if (dan==0) {
            if (mjesec==1) {  // u slucaju da treba preci na sljedecu godinu
                godina--;
                mjesec=13;  // posto ce ga umanjiti u daljem dijelu koda
            }
            mjesec--;
            dan=broj_dana[mjesec-1];
        }  // prelaz u mjesec - 1

        Datum::dan=dan;
        Izuzetak(dan,mjesec,godina);
        return *this;
    }
public:
    Datum (int dan, int mjesec, int godina) {
        Izuzetak(dan,mjesec,godina);
        Datum::dan=dan;
        Datum::mjesec=mjesec;
        Datum::godina=godina;
    }

    void Postavi (int dan, int mjesec, int godina) {
        Izuzetak(dan,mjesec,godina);
        Datum::dan=dan;
        Datum::mjesec=mjesec;
        Datum::godina=godina;
    }

    TaplIntova Ocitaj () const {
        return std::tie(dan,mjesec,godina);
    }

    void Ispisi () const {
        std::cout&lt;&lt;dan&lt;&lt;"/"&lt;&lt;mjesec&lt;&lt;"/"&lt;&lt;godina;
    }
};

class Vrijeme
{
    friend class Pregled;
    friend class Pregledi;
    int sati, minute;
    static void Izuzetak (int sati, int minute) {
        if (sati&lt;0 || sati&gt;23 || minute&lt;0 || minute &gt; 59) throw std::domain_error ("Neispravno vrijeme");
    }
    
    int DajSate() const {
        return sati;
    }
    
    int DajMinute() const {
        return minute;
    }
    
public:
    Vrijeme (int sati, int minute) {
        Izuzetak(sati,minute);
        Vrijeme::sati=sati;
        Vrijeme::minute=minute;
    }

    void Postavi (int sati, int minute) {
        Vrijeme(sati,minute);
    }

    ParIntova Ocitaj () const {
        return std::make_pair(sati,minute);
    }

    void Ispisi() const {
        if (sati&lt;10 &amp;&amp; minute&lt;10) std::cout&lt;&lt;"0"&lt;&lt;sati&lt;&lt;":0"&lt;&lt;minute;
        else if (sati&lt;10 &amp;&amp; minute&gt;10) std::cout&lt;&lt;"0"&lt;&lt;sati&lt;&lt;":"&lt;&lt;minute;
        else if (sati&gt;10 &amp;&amp; minute&lt;10) std::cout&lt;&lt;sati&lt;&lt;":0"&lt;&lt;minute;
        else std::cout&lt;&lt;sati&lt;&lt;":"&lt;&lt;minute;
    }
};

class Pregled
{
    std::string ime_pacijenta;
    Datum datum;
    Vrijeme vrijeme;
public:
    // Konstruktor
    Pregled ( const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda ) :
</font>        ime_pacijenta (ime_pacijenta), datum(datum_pregleda), vrijeme(vrijeme_pregleda) {}

    Pregled (const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda,
<a name="1"></a><font color="#00FF00"><a href="match168-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_19.gif"/></a>

             int minute_pregleda) : ime_pacijenta(ime_pacijenta), datum(dan_pregleda,mjesec_pregleda,godina_pregleda), vrijeme(sati_pregleda,minute_pregleda) {}

    void PromijeniPacijenta (const std::string &amp;ime_pacijenta) {
        Pregled::ime_pacijenta=ime_pacijenta;
    }

    void PromijeniDatum (const Datum &amp;novi_datum) {
        Pregled::datum=novi_datum;
    }

    void PromijeniVrijeme (const Vrijeme &amp;novo_vrijeme) {
        Pregled::vrijeme=novo_vrijeme;
    }

    void PomjeriDanUnaprijed () {
        Pregled::datum.PostaviDan(Pregled::datum.DajDan()+1);
    }

    void PomjeriDanUnazad () {
        Pregled::datum.PostaviDan(Pregled::datum.DajDan()-1);
    }

    std::string DajImePacijenta () const {
        return ime_pacijenta;
    }

    Datum DajDatumPregleda () const {
        return datum;
    }

    Vrijeme DajVrijemePregleda () const {
        return vrijeme;
    }

    static bool DolaziPrije (const Pregled &amp;p1, const Pregled &amp;p2) {
        if (p1.DajDatumPregleda().DajGodinu()&lt;p2.DajDatumPregleda().DajGodinu()) return true;
        else if (p1.DajDatumPregleda().DajGodinu()&gt;p2.DajDatumPregleda().DajGodinu()) return false;
        else {
            if (p1.DajDatumPregleda().DajMjesec()&lt;p2.DajDatumPregleda().DajMjesec()) return true;
            else if (p1.DajDatumPregleda().DajMjesec()&gt;p2.DajDatumPregleda().DajMjesec()) return false;
            else {
                if (p1.DajDatumPregleda().DajDan()&lt;p2.DajDatumPregleda().DajDan()) return true;
                else if (p1.DajDatumPregleda().DajDan()&gt;p2.DajDatumPregleda().DajDan()) return false;
                else {
                    if (p1.DajVrijemePregleda().DajSate()&lt;p2.DajVrijemePregleda().DajSate()) return true;
                    else if (p1.DajVrijemePregleda().DajSate()&gt;p2.DajVrijemePregleda().DajSate()) return false;
                    else {
                        if (p1.DajVrijemePregleda().DajMinute()&lt;p2.DajVrijemePregleda().DajMinute()) return true;
                    }
                }
            }
        }
        return false;
    }

    void Ispisi () const {
        std::cout&lt;&lt;std::left&lt;&lt;std::setw(30)&lt;&lt;ime_pacijenta;
        Pregled::datum.Ispisi();
        std::cout&lt;&lt;" ";
        Pregled::vrijeme.Ispisi();
        std::cout&lt;&lt;std::endl;
    }
};

class Pregledi
{
    const int max_broj_pregleda;
    int broj_pregleda;
    Pregled **pregledi;

public:

    explicit Pregledi (int max_broj_pregleda): max_broj_pregleda(max_broj_pregleda), broj_pregleda(0), pregledi(new Pregled *[max_broj_pregleda] {}) {}

    Pregledi (std::initializer_list &lt;Pregled&gt; spisak_pregleda) : max_broj_pregleda(spisak_pregleda.size()), broj_pregleda(spisak_pregleda.size()),
        pregledi (new Pregled *[spisak_pregleda.size()] {}) {
        for (int i = 0; i&lt;spisak_pregleda.size(); i++) {
            Pregled *pregled (new Pregled (*(spisak_pregleda.begin()+i)));  // dobijem i-ti pregled unutar liste
            pregledi[i]=pregled;  // i-ti pregled = i-ti pregled sa liste
        }
    }

    ~Pregledi() {
        for (int i = 0; i&lt;broj_pregleda; i++) delete pregledi[i];
        delete [] pregledi;
    }
// Kopirajuci konstruktor
    Pregledi (const Pregledi &amp;pregledi) : max_broj_pregleda(pregledi.max_broj_pregleda), broj_pregleda(pregledi.broj_pregleda),
        pregledi (new Pregled*[pregledi.max_broj_pregleda] {}) {
        for (int i = 0; i&lt;pregledi.broj_pregleda; i++) {
            Pregled *pregled(new Pregled (**(pregledi.pregledi+i)));
            Pregledi::pregledi[i]=pregled;
        }
    }
// Pomjerajuci konstruktor
    Pregledi (Pregledi &amp;&amp;pregledi) : max_broj_pregleda(pregledi.max_broj_pregleda), broj_pregleda(pregledi.broj_pregleda), 
    pregledi(pregledi.pregledi) {
        pregledi.pregledi=nullptr;
        pregledi.broj_pregleda=0;
    }

    Pregledi &amp;operator = (const Pregledi &amp;pregledi);

    Pregledi &amp;operator = (Pregledi &amp;&amp;pregledi);

    void RegistrirajPregled (const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda);
</font>
    void RegistrirajPregled (const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda,
<a name="0"></a><font color="#FF0000"><a href="match168-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_39.gif"/></a>

                             int sati_pregleda, int minute_pregleda);

    void RegistrirajPregled (Pregled *pregled);

    int DajBrojPregleda () const {
        return broj_pregleda;
    }

    int DajBrojPregledaNaDatum (const Datum &amp;datum) const {
        return std::count_if (pregledi, pregledi+broj_pregleda, [datum](Pregled *pregled) {
            return (pregled-&gt;DajDatumPregleda().DajGodinu()==datum.DajGodinu() &amp;&amp; pregled-&gt;DajDatumPregleda().DajMjesec()==datum.DajMjesec() &amp;&amp;
                    pregled-&gt;DajDatumPregleda().DajDan()==datum.DajDan());
        });
    }

    Pregled &amp;DajNajranijiPregled () {
        if (!broj_pregleda) throw std::domain_error ("Nema registriranih pregleda");
        auto it=std::min_element (pregledi, pregledi+broj_pregleda, [] (Pregled *pregled1, Pregled *pregled2) {
            return Pregled::DolaziPrije(*pregled1, *pregled2);
        });
        return (**it);
    }
    
    Pregled DajNajranijiPregled() const {
        if (!broj_pregleda) throw std::domain_error ("Nema registriranih pregleda");
        auto it=std::min_element (pregledi, pregledi+broj_pregleda, [] (Pregled *pregled1, Pregled *pregled2) {
            return Pregled::DolaziPrije(*pregled1, *pregled2);
        });
        return (**it);
    }

    void IsprazniKolekciju () {
        if (!broj_pregleda) return; // u slucaju da je vec prazna kolekcija
        for (int i = 0; i&lt;broj_pregleda; i++) {
            delete pregledi[i];
            pregledi[i]=nullptr;
        }
        delete [] pregledi;
        pregledi = nullptr;
        broj_pregleda=0;
    } 

    void ObrisiNajranijiPregled ();

    void ObrisiPregledePacijenta (const std::string &amp;ime_pacijenta);

    void IspisiPregledeNaDatum (const Datum &amp;datum) const {
        for (int i = 0; i&lt;broj_pregleda; i++)
            if (pregledi[i]-&gt;DajDatumPregleda().DajGodinu()==datum.DajGodinu() &amp;&amp; pregledi[i]-&gt;DajDatumPregleda().DajMjesec()==datum.DajMjesec() &amp;&amp;
                    pregledi[i]-&gt;DajDatumPregleda().DajDan()==datum.DajDan()) pregledi[i]-&gt;Ispisi();
    }
    
    void IspisiSvePreglede() const;
}; 

void Pregledi::IspisiSvePreglede () const {
        if (broj_pregleda==0) return;
        std::vector&lt;int&gt; VektorUspjesnih(broj_pregleda);
        for (int j = 0; j&lt;broj_pregleda; j++) {
            int redni_broj(0);   // redni broj j-tog pregleda kojeg treba ispisati
            for (int i = 0; i&lt;broj_pregleda; i++) {
                if (i==j) continue;
                if (!Pregled::DolaziPrije(*pregledi[j], *pregledi[i])) {
                    redni_broj++;
                }
            }
            VektorUspjesnih.at(redni_broj)=j;  // ubacujem u redni broh mjesto j (redni broj j-tog pregleda)
        }
        for (int i = 0; i&lt;broj_pregleda; i++)
            pregledi[VektorUspjesnih.at(i)]-&gt;Ispisi();
    }

Pregledi &amp;Pregledi::operator = (const Pregledi &amp;pregledi)
{
    Pregled **novi_pregledi(new Pregled *[pregledi.max_broj_pregleda]);
    for (int i = 0; i&lt;pregledi.broj_pregleda; i++) {
        Pregled *pregled (new Pregled (**(pregledi.pregledi+i)));
        novi_pregledi[i]=pregled;
    }
    for (int i=0; i&lt;broj_pregleda; i++) delete Pregledi::pregledi[i];
    delete [] Pregledi::pregledi;
    Pregledi::pregledi=novi_pregledi;
    broj_pregleda=pregledi.broj_pregleda;
    Pregledi::pregledi=novi_pregledi;
    return *this;
}

Pregledi &amp;Pregledi::operator =(Pregledi &amp;&amp;pregledi)
{
    std::swap (broj_pregleda, pregledi.broj_pregleda);
    std::swap (Pregledi::pregledi, pregledi.pregledi);
    return *this;
}

void Pregledi::RegistrirajPregled (const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda)
{
    if (broj_pregleda&gt;=max_broj_pregleda) throw std::range_error ("Dostignut maksimalan broj pregleda");
    Pregled *pregled(nullptr);
    pregled = new Pregled (ime_pacijenta,datum_pregleda,vrijeme_pregleda);
    pregledi[broj_pregleda++]=pregled;
}

void Pregledi::RegistrirajPregled (const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda,
                                   int sati_pregleda, int minute_pregleda)
{
    if (broj_pregleda&gt;=max_broj_pregleda) throw std::range_error ("Dostignut maksimalan broj pregleda");
    Pregled *pregled(nullptr);
    Datum datum(dan_pregleda,mjesec_pregleda,godina_pregleda);
    Vrijeme vrijeme (sati_pregleda,minute_pregleda);
    pregled = new Pregled (ime_pacijenta,datum,vrijeme);
    pregledi[broj_pregleda++]=pregled;
}

void Pregledi::RegistrirajPregled (Pregled *pregled)
{
    if (broj_pregleda&gt;=max_broj_pregleda) throw std::range_error ("Dostignut maksimalan broj pregleda");
    pregledi[broj_pregleda++]=pregled;
}

void Pregledi::ObrisiPregledePacijenta (const std::string &amp;ime_pacijenta)
{
    for (int i = 0; i&lt;broj_pregleda; i++) 
        if (pregledi[i]-&gt;DajImePacijenta()==ime_pacijenta) {
            delete pregledi[i];
            pregledi[i]=nullptr;
            for (int k = i+1; k&lt;broj_pregleda; k++) {
                pregledi[k-1]=pregledi[k];
                pregledi[k]=nullptr;
            }
            delete pregledi[broj_pregleda-1];
            pregledi[broj_pregleda-1]=nullptr;
            broj_pregleda--;
            i--;
        }
}

void Pregledi::ObrisiNajranijiPregled ()
{   
    if (!broj_pregleda) throw std::range_error ("Prazna kolekcija");
    Pregled pregled(DajNajranijiPregled());
    for (int i = 0; i&lt;broj_pregleda; i++) 
        if (pregledi[i]-&gt;DajDatumPregleda().DajGodinu()==pregled.DajDatumPregleda().DajGodinu() &amp;&amp; pregledi[i]-&gt;DajDatumPregleda().DajMjesec()==pregled.DajDatumPregleda().DajMjesec() &amp;&amp;
                pregledi[i]-&gt;DajDatumPregleda().DajDan()==pregled.DajDatumPregleda().DajDan()) {
            delete pregledi[i];
            pregledi[i]=nullptr;

            for (int k = i+1; k&lt;broj_pregleda; k++) {
                pregledi[k-1]=pregledi[k];
                pregledi[k]=nullptr;
            }
            delete pregledi[broj_pregleda-1];
            pregledi[broj_pregleda-1]=nullptr;
            broj_pregleda--;
            break;
        }
}

int main ()
{
    try {
        int max;
        std::cout&lt;&lt;"Unesite maksimalan broj pregleda: ";
        std::cin&gt;&gt;max;
        Pregledi pregledi(max);
        for (int i = 0; i&lt;max; i++) {
            std::cout&lt;&lt;"Unesite ime novog pacijenta ili 'kraj' za zavrsetak unosa: ";
            std::string ime_pacijenta;
            std::cin.ignore(10000, '\n');
            std::getline(std::cin, ime_pacijenta);
            if (ime_pacijenta=="kraj") break;
            int dan, mjesec, godina, sati, minute;
            std::cout&lt;&lt;"Unesite dan mjesec i godinu pregleda: ";
            std::cin&gt;&gt;dan&gt;&gt;mjesec&gt;&gt;godina;
            std::cout&lt;&lt;"Unesite sate i minute pregleda: ";
            std::cin&gt;&gt;sati&gt;&gt;minute;
            pregledi.RegistrirajPregled(ime_pacijenta,dan,mjesec,godina,sati,minute);
        }
        std::cout&lt;&lt;"Trenutno su registrovani sljedeci pregledi "&lt;&lt;std::endl;
        pregledi.IspisiSvePreglede();
        std::cout&lt;&lt;std::endl;
        while (1) { // popraviti 5-icu
            std::cout&lt;&lt;"Odaberite jednu od sljedecih opcija"&lt;&lt;std::endl&lt;&lt;"1 - Broj pregleda na datum"&lt;&lt;std::endl&lt;&lt;"2 - Najraniji pregled"&lt;&lt;
</font><a name="6"></a><font color="#00FF00"><a href="match168-1.html#6" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_2.gif"/></a>

                     std::endl&lt;&lt;"3 - Obrisi pregled pacijenta"&lt;&lt;std::endl&lt;&lt;"4 - Obrisi najraniji pregled"&lt;&lt;std::endl&lt;&lt;"5 - Ispisi sve pregleda na datum"&lt;&lt;
                     std::endl&lt;&lt;"6 - Ispisi sve preglede"&lt;&lt;std::endl&lt;&lt;"7 - Kraj programa"&lt;&lt;std::endl;
            int kod;
            std::cin&gt;&gt;kod;
            if (kod==7) return 0;
            else if (kod==6) pregledi.IspisiSvePreglede();
            else if (kod==1) {
                std::cout&lt;&lt;"Unesite dan mjesec i godinu : ";
                int dan,mjesec,godina;
                std::cin&gt;&gt;dan&gt;&gt;mjesec&gt;&gt;godina;
</font><a name="3"></a><font color="#00FFFF"><a href="match168-1.html#3" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_6.gif"/></a>

                std::cout&lt;&lt;"Broj pregleda na datum "&lt;&lt;dan&lt;&lt;" "&lt;&lt;mjesec&lt;&lt;" "&lt;&lt;godina&lt;&lt;" je: "&lt;&lt;pregledi.DajBrojPregledaNaDatum({dan,mjesec,godina})&lt;&lt;std::endl;
            } else if (kod==4) {
                pregledi.ObrisiNajranijiPregled();
                std::cout&lt;&lt;"Najraniji pregled uspjesno obrisan"&lt;&lt;std::endl;
            } else if (kod == 3) {
                std::cout&lt;&lt;"Unesite ime pacijenta: ";
                std::cin.ignore(10000,'\n');
                std::string ime_pacijenta;
                std::getline(std::cin,ime_pacijenta);
                int prije(pregledi.DajBrojPregleda());
                pregledi.ObrisiPregledePacijenta(ime_pacijenta);
                std::cout&lt;&lt;"Uspjesno obrisano "&lt;&lt;prije-pregledi.DajBrojPregleda()&lt;&lt;" pregleda"&lt;&lt;std::endl;
            } else if (kod==2) {
                std::cout&lt;&lt;"Najraniji pregled je: "&lt;&lt;std::endl;
                pregledi.DajNajranijiPregled().Ispisi();
                std::cout&lt;&lt;std::endl;
            } else if (kod==5) {
                std::cout&lt;&lt;"Unesite dan mjesec i godinu : ";
                int dan,mjesec,godina;
                std::cin&gt;&gt;dan&gt;&gt;mjesec&gt;&gt;godina;
</font><a name="4"></a><font color="#FF00FF"><a href="match168-1.html#4" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_3.gif"/></a>

                std::cout&lt;&lt;"Pregledi na datum "&lt;&lt;dan&lt;&lt;" "&lt;&lt;mjesec&lt;&lt;" "&lt;&lt;godina&lt;&lt;" su:"&lt;&lt;std::endl;
                pregledi.IspisiPregledeNaDatum({dan,mjesec,godina});
                std::cout&lt;&lt;std::endl;
            } else std::cout&lt;&lt;"Pogresan kod"&lt;&lt;std::endl;
            std::cout&lt;&lt;std::endl;
        }
        
    } catch (std::domain_error izuzetak) {
        std::cout&lt;&lt;izuzetak.what();
    } catch (std::logic_error izuzetak) {
      std::cout&lt;&lt;izuzetak.what();
    } catch (std::range_error izuzetak) {
      std::cout&lt;&lt;izuzetak.what();
</font>    }
    return 0;
}
</pre>
</body>
</html>
