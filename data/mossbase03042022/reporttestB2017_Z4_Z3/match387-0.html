<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student7980.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student7980.cpp<p></p><pre>
<a name="4"></a><font color="#FF00FF"><a href="match387-1.html#4" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

/B2017/2018: ZadaÄ‡a 4, Zadatak 3
#include &lt;iostream&gt;
#include &lt;utility&gt;
#include &lt;string&gt;
#include &lt;tuple&gt;
#include &lt;iomanip&gt;
#include &lt;algorithm&gt;



class Datum
{
    int dan, mjesec, godina;
    int DajDan() const {
        return dan;
    }
    int DajMjesec() const{
        return mjesec;
    }
    int DajGodinu() const{
        return godina;
    }
    friend class Pregled;
public:
    Datum(int dan, int mjesec, int godina);
</font>    void Postavi(int dan, int mjesec, int godina);
    std::tuple&lt;int, int, int&gt; Ocitaj() const;
    void Ispisi() const;
};

Datum::Datum(int dan, int mjesec, int godina)
{
    Datum::Postavi(dan, mjesec, godina);
}

void Datum::Postavi(int dan, int mjesec, int godina)
{
    Datum::dan=dan;
    Datum::mjesec=mjesec;
    Datum::godina=godina;
}

std::tuple&lt;int, int, int&gt; Datum::Ocitaj() const
{
    return std::make_tuple(dan, mjesec, godina);
}

void Datum::Ispisi() const
{
    std::cout &lt;&lt; Datum::dan &lt;&lt; "/" &lt;&lt; Datum::mjesec &lt;&lt; "/" &lt;&lt; Datum::godina &lt;&lt; " ";
}

/////////////////////////////////
class Vrijeme
{
    int sati, minute;
public:
    Vrijeme(int sati, int minute);
    void Postavi(int sati, int minute);
    std::pair&lt;int, int&gt; Ocitaj () const;
    void Ispisi() const;
};

Vrijeme::Vrijeme(int sati, int minute)
{
    Postavi(sati, minute);
}

void Vrijeme::Postavi(int sati, int minute)
{
    Vrijeme::sati=sati;
    Vrijeme::minute=minute;
}

std::pair&lt;int, int&gt; Vrijeme::Ocitaj() const
{
    return std::make_pair(sati, minute);
}

void Vrijeme::Ispisi() const
{
    if(Vrijeme::sati &lt; 10)std::cout &lt;&lt; "0";
    std::cout &lt;&lt; Vrijeme::sati &lt;&lt; ":";
    if(Vrijeme::minute &lt; 10)std::cout &lt;&lt; "0";
    std::cout &lt;&lt; Vrijeme::minute &lt;&lt; std::endl;
}

//////////////////////////////////
class Pregled
{
    std::string ime;
    Datum d;
    Vrijeme v;
    static int broj_pregleda;
    friend class Pregledi;
public:
    Pregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda);
    Pregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda);
    void PromijeniPacijenta(const std::string &amp;ime_pacijenta);
    void PromijeniDatum(const Datum &amp;novi_datum);
    void PromijeniVrijeme(const Vrijeme &amp;novo_vrijeme);
    void PomjeriDanUnaprijed();
    void PomjeriDanUnazad();
    std::string DajImePacijenta() const;
    Datum DajDatumPregleda() const;
    Vrijeme DajVrijemePregleda() const;
    static bool DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2);
    void Ispisi() const;
};

Pregled::Pregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda):d(datum_pregleda), v(vrijeme_pregleda)
{
    Pregled::ime=ime_pacijenta;
    broj_pregleda++;
}

Pregled::Pregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda):d(dan_pregleda, mjesec_pregleda, godina_pregleda), v(sati_pregleda, minute_pregleda)
{
    Pregled::ime=ime_pacijenta;
    broj_pregleda++;
}

void Pregled::PromijeniPacijenta(const std::string &amp;ime_pacijenta)
{
    Pregled::ime=ime_pacijenta;
}

void Pregled::PromijeniDatum(const Datum &amp;novi_datum)
{
    Pregled::d=novi_datum;
}

void Pregled::PromijeniVrijeme(const Vrijeme &amp;novo_vrijeme)
{
    Pregled::v=novo_vrijeme;
}

<a name="7"></a><font color="#0000FF"><a href="match387-1.html#7" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

int Pregled::broj_pregleda=0;

void Pregled::PomjeriDanUnaprijed()
{
    int broj_dana[] {31,28,31,30,31,30,31,31,30,31,30,31};
</font>    int da,mj,gd;
    std::tuple&lt;int, int, int&gt; p(Pregled::d.Datum::Ocitaj());
<a name="1"></a><font color="#00FF00"><a href="match387-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_3.gif"/></a>

    std::tie(da,mj,gd)=p;
    if(gd % 4 == 0 &amp;&amp; gd % 100 != 0 || gd % 400 == 0)
        broj_dana[1]++;
    da++;
    if(da &gt; broj_dana[mj-1]) da=1, mj++;
    if(mj&gt;12) mj=1, gd++;
    Pregled::d.dan=da;
    Pregled::d.mjesec=mj;
    Pregled::d.godina=gd;
}

void Pregled::PomjeriDanUnazad()
{
    int broj_dana[] {31,28,31,30,31,30,31,31,30,31,30,31};
</font>    int da,mj,gd;
    std::tuple&lt;int, int, int&gt; p(Pregled::d.Datum::Ocitaj());
<a name="2"></a><font color="#0000FF"><a href="match387-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_2.gif"/></a>

    std::tie(da,mj,gd)=p;
    if(gd % 4 == 0 &amp;&amp; gd % 100 != 0 || gd % 400 == 0)
        broj_dana[1]++;
    da--;
    if(da &lt; 1) {
        da=broj_dana[mj-1];
        mj--;
    }
    if(mj&lt;1) {
        da=broj_dana[11];
        mj=12;
        gd--;
    }
    Pregled::d.dan=da;
    Pregled::d.mjesec=mj;
    Pregled::d.godina=gd;
</font>}


std::string Pregled::DajImePacijenta() const
{
    return Pregled::ime;
}

Datum Pregled::DajDatumPregleda() const
{
    return Pregled::d;
}

Vrijeme Pregled::DajVrijemePregleda() const
{
    return Pregled::v;
}

bool Pregled::DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2)
{
    Datum dat1(p1.DajDatumPregleda());
    Datum dat2(p2.DajDatumPregleda());
    int d1,d2,m1,m2,g1,g2;
    std::tuple&lt;int, int, int&gt; o1(dat1.Ocitaj());
    std::tuple&lt;int, int, int&gt; o2(dat2.Ocitaj());
    std::tie(d1, m1, g1)= o1;
    std::tie(d2, m2, g2) = o2;
    if(g1 &lt; g2) return true;
    if(g1==g2) {
        if(m1==m2) {
            if(d1 &lt; d2) { return true;}
            else if(d1 == d2) {
                Vrijeme vri1(p1.DajVrijemePregleda());
                Vrijeme vri2(p2.DajVrijemePregleda());
                std::pair&lt;int, int&gt; k1(vri1.Ocitaj());
                std::pair&lt;int, int&gt; k2(vri2.Ocitaj());
                int sati1=std::get&lt;0&gt; (k1);
                int min1=std::get&lt;1&gt;(k1);
                int sati2=std::get&lt;0&gt;(k2);
<a name="8"></a><font color="#00FFFF"><a href="match387-1.html#8" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_0.gif"/></a>

                int min2=std::get&lt;1&gt;(k2);

                if(sati1 &lt; sati2) return true;
                else if(sati1 == sati2) {
                    if(min1 &lt; min2) return true;
</font>                    return false;
                }
            }
            return false;
        } else if(m1 &lt; m2 ) return true;
        return false;
    }
    return false ;
}

void Pregled::Ispisi() const
{
    std::cout &lt;&lt; std::left &lt;&lt; std::setw(30) &lt;&lt; DajImePacijenta();
    d.Datum::Ispisi();
    v.Vrijeme::Ispisi();
}

//////////////////////////////
class Pregledi
{
    Pregled **p;
    int max;
    int ukupan_broj_pregleda;
    friend class Pregled;
public:    
    explicit Pregledi(int max_broj_pregleda);
    Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda);
    ~Pregledi();
    Pregledi(const Pregledi &amp;pregledi);
    Pregledi(Pregledi &amp;&amp;pregledi);
    Pregledi &amp;operator =(const Pregledi &amp;pregledi);
    Pregledi &amp;operator =(Pregledi &amp;&amp;pregledi);
    void RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda);
    void RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda);
    void RegistrirajPregled(Pregled *pregled);
    int DajBrojPregleda() const;
    int DajBrojPregledaNaDatum(const Datum &amp;datum) const;
    Pregled &amp;DajNajranijiPregled();
    Pregled DajNajranijiPregled() const;
    void IsprazniKolekciju();
    void ObrisiNajranijiPregled();
    void ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta);
    void IspisiPregledeNaDatum(const Datum &amp;datum) const;
    void IspisiSvePreglede() const;

};

Pregledi::Pregledi(int max_broj_pregleda):max(max_broj_pregleda)
{
    p=new Pregled*[max];
    Pregledi::ukupan_broj_pregleda=0;
}

Pregledi::Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda):max(spisak_pregleda.size())
{
    ukupan_broj_pregleda=spisak_pregleda.size();
    
    p=new Pregled*[ukupan_broj_pregleda];
    
    int i(0);
	for(auto it=spisak_pregleda.begin(); it != spisak_pregleda.end(); it++) 
	{
		try {
			p[i] = new Pregled(*it);
			i++;
		} catch(std::bad_alloc) {
			for(int i=0; i&lt;ukupan_broj_pregleda; i++) 
			{
				delete[] p[i];
				p[i]=nullptr;
			}
			delete[] p;
			throw;
		}
	}
}

Pregledi::~Pregledi()
{
    for(int i=0; i&lt;ukupan_broj_pregleda; i++) delete p[i];
    delete[] p;
}

Pregledi::Pregledi(const Pregledi &amp;pregledi):max(pregledi.max)
{
    ukupan_broj_pregleda=pregledi.ukupan_broj_pregleda;
<a name="3"></a><font color="#00FFFF"><a href="match387-1.html#3" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

    for(int i=0; i&lt;ukupan_broj_pregleda; i++) p[i]=nullptr;
    try {
		for(int i=0; i&lt;ukupan_broj_pregleda; i++) {
			p[i]=new Pregled(*pregledi.p[i]);

		}
	} catch(...) {
		for(int i=0; i&lt;ukupan_broj_pregleda; i++) delete[] p[i];
</font>        delete[] p;
		throw;
	}
}

Pregledi::Pregledi(Pregledi &amp;&amp;pregledi):max(pregledi.max)
{
    ukupan_broj_pregleda=pregledi.ukupan_broj_pregleda;
    p=pregledi.p;
    pregledi.p=nullptr;
    pregledi.ukupan_broj_pregleda = 0;
}

Pregledi &amp;Pregledi::operator =(const Pregledi &amp;pregledi){
    if(this != &amp;pregledi)
    {
        for (int i=0; i&lt;ukupan_broj_pregleda; i++)delete[] p[i];
        delete[] p;
        ukupan_broj_pregleda=pregledi.ukupan_broj_pregleda;
<a name="6"></a><font color="#00FF00"><a href="match387-1.html#6" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

        p=new Pregled*[pregledi.max];
        for(int i=0; i&lt;ukupan_broj_pregleda; i++) p[i]=new Pregled(*pregledi.p[i]);
    }
    return *this;
}

Pregledi &amp;Pregledi::operator =(Pregledi &amp;&amp;pregledi)
</font>{
    std::swap(ukupan_broj_pregleda, pregledi.ukupan_broj_pregleda);
    std::swap(p, pregledi.p);
    
<a name="0"></a><font color="#FF0000"><a href="match387-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_3.gif"/></a>

    return *this;
}

void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda)
{
    if(ukupan_broj_pregleda &gt; max)throw std::range_error("Dostignut maksimalan broj pregleda");
    Pregled pregled{ime_pacijenta, datum_pregleda, vrijeme_pregleda};
    p[ukupan_broj_pregleda++]=new Pregled(pregled);
}

void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda)
{
    if(ukupan_broj_pregleda &gt; max)throw std::range_error("Dostignut maksimalan broj pregleda");
    Pregled pregled{ime_pacijenta, dan_pregleda, mjesec_pregleda, godina_pregleda, sati_pregleda, minute_pregleda};
    p[ukupan_broj_pregleda++]=nw(pregled);
</font>    
    // DINAMICKA ALOKACIJA JE SMRT
    
    //std::cout &lt;&lt; "XXXXXXXXX";
    //if(max==ukupan_broj_pregleda)delete[] p[ukupan_broj_pregleda];
}

<a name="5"></a><font color="#FF0000"><a href="match387-1.html#5" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

void Pregledi::RegistrirajPregled(Pregled *pregled)
{
    if(ukupan_broj_pregleda &gt; max) throw std::range_error("Dostignut maksimalan broj pregleda");
    p[ukupan_broj_pregleda++]=pregled;
}

int Pregledi::DajBrojPregleda() const
{
    return Pregledi::ukupan_broj_pregleda;
}

int Pregledi::DajBrojPregledaNaDatum(const Datum &amp;datum) const
</font>{
    int broj = std::count_if(p,p+ukupan_broj_pregleda , [&amp;datum](Pregled *p1)
    {
        if(std::get&lt;0&gt;(p1-&gt;DajDatumPregleda().Ocitaj())==std::get&lt;0&gt;(datum.Ocitaj())&amp;&amp;
        std::get&lt;1&gt;(p1-&gt;DajDatumPregleda().Ocitaj()) == std::get&lt;1&gt;(datum.Ocitaj()) &amp;&amp;
        std::get&lt;2&gt;(p1-&gt;DajDatumPregleda().Ocitaj()) == std::get&lt;2&gt;(datum.Ocitaj())) return true;
        return false;
    });
    return broj;
}

Pregled &amp;Pregledi::DajNajranijiPregled()
{
   
auto pom(*std::min_element(p, p+ukupan_broj_pregleda, [](Pregled *p1, Pregled *p2)
    {
        if(Pregled::DolaziPrije(*p1,*p2)) return true;
        return false;
        
    }));
    return *pom;
}
Pregled Pregledi::DajNajranijiPregled() const
{
    if(ukupan_broj_pregleda==0) throw std::domain_error("Nema registriranih pregleda");
    auto pom(*std::min_element(p, p+ukupan_broj_pregleda, [](Pregled *p1, Pregled *p2)
    {
        if(Pregled::DolaziPrije(*p1,*p2)) return true;
        return false;
        
    }));
    return *pom;
}
void Pregledi::IsprazniKolekciju()
{
    for(int i=0; i&lt;ukupan_broj_pregleda; i++) delete[] p[i];
    delete[] p;
}
void Pregledi::ObrisiNajranijiPregled()
{
    int index(0);
    auto pom(*std::min_element(p, p+ukupan_broj_pregleda, [](Pregled *p1, Pregled *p2)
    {
        if(Pregled::DolaziPrije(*p1,*p2)) return true;
        return false;
        
    }));
    
    /*for(int i=0; i&lt;ukupan_broj_pregleda; i++)
    {
        
        if(pom==p[i])index=i;
        
    }*/
    
    std::remove_if(p, p+ukupan_broj_pregleda, [pom](Pregled *p1)
    {
        if(std::get&lt;0&gt;(p1-&gt;DajDatumPregleda().Ocitaj())==std::get&lt;0&gt;(pom-&gt;DajDatumPregleda().Ocitaj()) &amp;&amp; std::get&lt;1&gt;(p1-&gt;DajDatumPregleda().Ocitaj())==std::get&lt;1&gt;(pom-&gt;DajDatumPregleda().Ocitaj()) &amp;&amp; std::get&lt;2&gt;(p1-&gt;DajDatumPregleda().Ocitaj())==std::get&lt;2&gt;(pom-&gt;DajDatumPregleda().Ocitaj())) return true;
        return false;
    });
    ukupan_broj_pregleda--;
   // delete[] p[index];
    
}
void Pregledi::ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta)
{
    for(int i=0; i&lt;ukupan_broj_pregleda; i++)
    {
        if(p[i]-&gt;DajImePacijenta()==ime_pacijenta)
        {
            std::remove(p, p+ukupan_broj_pregleda, p[i]);
            break;
        }
    }
    ukupan_broj_pregleda--;
}
void Pregledi::IspisiPregledeNaDatum(const Datum &amp;datum) const
{
    std::sort(p, p+ukupan_broj_pregleda, [](Pregled *p1, Pregled *p2)
    {
        if(Pregled::DolaziPrije(*p1,*p2))return true;
        return false;
    });
    
    for(int i=0; i&lt;ukupan_broj_pregleda; i++)
    {
       if(std::get&lt;0&gt;(p[i]-&gt;Pregled::DajDatumPregleda().Ocitaj())==std::get&lt;0&gt;(datum.Datum::Ocitaj()) &amp;&amp; std::get&lt;1&gt;(p[i]-&gt;Pregled::DajDatumPregleda().Ocitaj())==std::get&lt;1&gt;(datum.Datum::Ocitaj()) &amp;&amp; std::get&lt;2&gt;(p[i]-&gt;Pregled::DajDatumPregleda().Ocitaj())==std::get&lt;2&gt;(datum.Datum::Ocitaj()))p[i]-&gt;Ispisi();
    }
    
}
void Pregledi::IspisiSvePreglede() const
{
    
    std::sort(p, p+ukupan_broj_pregleda, [](Pregled *p1, Pregled *p2)
    {
        if(Pregled::DolaziPrije(*p1,*p2))return true;
        return false;
    });
    for(int i=0; i&lt;ukupan_broj_pregleda; i++)
    {
       p[i]-&gt;Ispisi();
    }
}


int main ()
{
    
    std::cout &lt;&lt; "Unesite maksimalan broj pregleda: ";
    int n;
    std::cin &gt;&gt; n;
    Pregledi preg(n);
    
    for(int i=0; i&lt;n; i++)
    {
        std::cout &lt;&lt; "Unesite ime novog pacijenta ili 'kraj' za zavrsetak unosa: ";
        std::string s;
        std::cin.clear();
        std::cin.ignore(10000,'\n');
        std::getline(std::cin,s);
        if(s=="kraj")break;
        std::cout &lt;&lt; "Unesite dan mjesec i godinu pregleda: ";
        int dan, mjesec, godina;
        std::cin &gt;&gt; dan &gt;&gt; mjesec &gt;&gt; godina;
        std::cout &lt;&lt; "Unesite sate i minute pregleda: ";
        int h, m;
        std::cin &gt;&gt; h &gt;&gt; m;
        preg.Pregledi::RegistrirajPregled(s, dan, mjesec, godina, h, m);
    }
    
    std::cout &lt;&lt; "Trenutno su registrovani sljedeci pregledi" &lt;&lt; std::endl;
    preg.Pregledi::IspisiSvePreglede();
    
    int x;
    
while(1)
{
    std::cout &lt;&lt; std::endl &lt;&lt; "Odaberite jednu od sljedecih opcija" &lt;&lt; std::endl;
    std::cout &lt;&lt; "1 - Broj pregleda na datum" &lt;&lt; std::endl;
    std::cout &lt;&lt; "2 - Najraniji pregled" &lt;&lt; std::endl;
    std::cout &lt;&lt; "3 - Obrisi pregled pacijenta" &lt;&lt; std::endl;
    std::cout &lt;&lt; "4 - Obrisi najraniji pregled" &lt;&lt; std::endl;
    std::cout &lt;&lt; "5 - Ispisi sve pregleda na datum" &lt;&lt; std::endl;
    std::cout &lt;&lt; "6 - Ispisi sve preglede" &lt;&lt; std::endl;
    std::cout &lt;&lt; "7 - Kraj programa" &lt;&lt; std::endl;
    
    std::cin &gt;&gt; x;
    if(x==7)break;
    
   /* if(x==1)
    {
        std::cout &lt;&lt; "Unesite dan mjesec i godinu : ";
        int d, m, g;
        std::cin &gt;&gt; d &gt;&gt; m &gt;&gt; g;
        Datum dat(0,0,0);
        dat.Datum::Postavi(d,m,g);
        preg.Pregledi::IspisiPregledeNaDatum(dat);
        //preg.Pregledi::IspisiPregledeNaDatum(dat.Datum::Postavi(d,m,g));
    }*/
    
    if(x==1)
    {
        std::cout &lt;&lt; "Unesite dan mjesec i godinu : ";
        int d, m, g;
        std::cin &gt;&gt; d &gt;&gt; m &gt;&gt; g;
        Datum dat(0,0,0);
        dat.Datum::Postavi(d,m,g);
        std::cout &lt;&lt; "Broj pregleda na datum ";
        std::cout &lt;&lt; d &lt;&lt; " " &lt;&lt; m &lt;&lt; " " &lt;&lt; g &lt;&lt; " je: ";
        std::cout &lt;&lt; preg.Pregledi::DajBrojPregledaNaDatum(dat) &lt;&lt; std::endl;
    }
    if(x==4)
    {
        /*for(int i=0; i&lt;n; i++)
        {
            
            
            if(*p==preg.Pregledi::DajNajranijiPregled())delete preg[i];
            
            p++;
        }*/
        preg.Pregledi::ObrisiNajranijiPregled();
        
        std::cout &lt;&lt; "Najraniji pregled uspjesno obrisan" &lt;&lt; std::endl;
       // auto u(preg.Pregledi::DajNajranijiPregled());
        //preg.Pregledi::~Pregledi();
        
    }
    if(x==6)
    {
        preg.Pregledi::IspisiSvePreglede();
    }
    
}    
    return 0;
}
</pre>
</body>
</html>
