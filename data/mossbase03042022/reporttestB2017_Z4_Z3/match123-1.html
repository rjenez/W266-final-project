<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student7485.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student5624.cpp<p></p><pre>
<a name="3"></a><font color="#00FFFF"><a href="match123-0.html#3" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_5.gif"/></a>

/B2017/2018: ZadaÄ‡a 4, Zadatak 3
#include &lt;iostream&gt;
#include &lt;stdexcept&gt;
#include &lt;tuple&gt;
#include &lt;utility&gt;
#include &lt;string&gt;
#include &lt;initializer_list&gt;
#include &lt;iomanip&gt;
#include &lt;algorithm&gt;
#include &lt;vector&gt;

using std::cout;
using std::cin;
using std::string;
using std::get;

class Datum
{
    int dan, mjesec, godina;
    public:
    Datum(int dan, int mjesec, int godina) { Postavi(dan, mjesec, godina); }
    void Postavi(int dan, int mjesec, int godina);
    std::tuple&lt;int, int, int&gt; Ocitaj() const;
    void Ispisi() const;
};

void Datum::Postavi(int dan, int mjesec, int godina)
{
    int broj_dana[]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    if (godina % 4 == 0 &amp;&amp; godina % 100 == 0 || godina % 400 == 0)
        broj_dana[1]++;
    if (dan &lt; 1 || mjesec &lt; 1 || mjesec &gt; 12 ||godina &lt; 1 || dan &gt; broj_dana[mjesec-1])
</font><a name="2"></a><font color="#0000FF"><a href="match123-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_9.gif"/></a>

        throw std::domain_error("Neispravan datum");
    Datum::dan=dan;
    Datum::mjesec=mjesec;
    Datum::godina=godina;
}

std::tuple&lt;int, int, int&gt; Datum::Ocitaj() const
{
    std::tuple&lt;int, int, int&gt; t;
    t=std::make_tuple(dan, mjesec, godina);
    return t;
}

void Datum::Ispisi() const
{
    cout&lt;&lt;dan&lt;&lt;"/"&lt;&lt;mjesec&lt;&lt;"/"&lt;&lt;godina;
}

class Vrijeme
{
    int sati, minute;
    public:
    Vrijeme(int sati, int minute) { Postavi(sati, minute); }
    void Postavi(int sati, int minute);
    std::pair&lt;int, int&gt; Ocitaj () const;
    void Ispisi() const;
    friend class Pregled;
};

void Vrijeme::Postavi(int sati, int minute)
{
    if (sati &lt; 0 || sati &gt; 23 || minute &lt; 0 || minute &gt; 59)
        throw std::domain_error("Neispravno vrijeme");
    Vrijeme::sati=sati;
    Vrijeme::minute=minute;
}

std::pair&lt;int, int&gt; Vrijeme::Ocitaj() const
{
    std::pair&lt;int, int&gt; p;
    p=std::make_pair(sati, minute);
    return p;
}

void Vrijeme::Ispisi() const
{
    if (sati&lt;10)
        cout&lt;&lt;"0";
    cout&lt;&lt;sati&lt;&lt;":";
    if (minute&lt;10)
        cout&lt;&lt;"0";
    cout&lt;&lt;minute;    
}
class Pregled
{
    string ime;
    Datum datum;
    Vrijeme vrijeme;
    public:
    Pregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda):ime(ime_pacijenta), datum(datum_pregleda), vrijeme(vrijeme_pregleda){}
</font><a name="1"></a><font color="#00FF00"><a href="match123-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_25.gif"/></a>

    Pregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda):ime(ime_pacijenta),
     datum(Datum(dan_pregleda, mjesec_pregleda,godina_pregleda)), vrijeme(Vrijeme(sati_pregleda, minute_pregleda)){}
    void PromijeniPacijenta(const std::string &amp;ime_pacijenta) { ime = ime_pacijenta; }
    void PromijeniDatum(const Datum &amp;novi_datum) { datum = novi_datum; }
    void PromijeniVrijeme(const Vrijeme &amp;novo_vrijeme) { vrijeme = novo_vrijeme; }
    void PomjeriDanUnaprijed();
    void PomjeriDanUnazad();
    std::string DajImePacijenta() const { return ime; }
    Datum DajDatumPregleda() const { return datum; }
    Vrijeme DajVrijemePregleda() const { return vrijeme; }
    static bool DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2);
    void Ispisi() const;
};

void Pregled::PomjeriDanUnaprijed()
{
    int broj_dana[]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    if (get&lt;2&gt;(datum.Ocitaj()) % 4 == 0 &amp;&amp; get&lt;2&gt;(datum.Ocitaj()) % 100 == 0 || get&lt;2&gt;(datum.Ocitaj()) % 400 == 0)
        broj_dana[1]++;
    int d;
    d=get&lt;0&gt;(datum.Ocitaj());
    d++;
    int m, g;
    m=get&lt;1&gt;(datum.Ocitaj());
    g=get&lt;2&gt;(datum.Ocitaj());
    if (d &gt; broj_dana[m - 1])
    {
        d=1;
        m++;
        if (m &gt; 12)
        {
            m=1;
            g++;
        }
    }
    datum.Postavi(d, m ,g);
}

void Pregled::PomjeriDanUnazad()
{
    int broj_dana[]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    if (get&lt;2&gt;(datum.Ocitaj()) % 4 == 0 &amp;&amp; get&lt;2&gt;(datum.Ocitaj()) % 100 == 0 || get&lt;2&gt;(datum.Ocitaj()) % 400 == 0)
        broj_dana[1]++;
    int d, m ,g;
    d=get&lt;0&gt;(datum.Ocitaj());
    m=get&lt;1&gt;(datum.Ocitaj());
    g=get&lt;2&gt;(datum.Ocitaj());
    d--;
    if (d &lt; 1)
    {
        if (m==1)
        {
            d=broj_dana[11];
            m=12;
            g--;
        }
        else
        {
            d=broj_dana[m-2];
            m--;
        }
    }
    datum.Postavi(d, m, g);
}

bool Pregled::DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2)
{
    Datum dat_1(p1.DajDatumPregleda()), dat_2(p2.DajDatumPregleda());
    Vrijeme vri_1(p1.DajVrijemePregleda()), vri_2(p2.DajVrijemePregleda());
    
   /* dat_1=p1.DajDatumPregleda();
    vri_1=p1.DajVrijemePregleda();
    
    dat_2=p2.DajDatumPregleda();
    vri_2=p2.DajVrijemePregleda();*/
    
    int dat1_d, dat1_m, dat1_g, dat2_d, dat2_m, dat2_g;
    dat1_d=get&lt;0&gt;(dat_1.Ocitaj());
    dat1_m=get&lt;1&gt;(dat_1.Ocitaj());
    dat1_g=get&lt;2&gt;(dat_1.Ocitaj());
    
    dat2_d=get&lt;0&gt;(dat_2.Ocitaj());
    dat2_m=get&lt;1&gt;(dat_2.Ocitaj());
    dat2_g=get&lt;2&gt;(dat_2.Ocitaj());
    
    int vri1_sat, vri1_min, vri2_sat, vri2_min;
    
    vri1_sat = vri_1.Ocitaj().first;
    vri1_min = vri_1.Ocitaj().second;
    
    vri2_sat = vri_2.Ocitaj().first;
    vri2_min = vri_2.Ocitaj().second;
    
    if (dat1_g &lt; dat2_g)
        return true;
    else if (dat1_g &gt; dat2_g)
        return false;
    else if(dat1_g == dat2_g)
    {
        if (dat1_m &lt; dat2_m)
            return true;
        else if (dat1_m &gt; dat2_m)
            return false;
        else if(dat1_m == dat2_m)
        {
            if (dat1_d &lt; dat2_d)
                return true;
            else if (dat1_d &gt; dat2_d)
                return false;
            else if(dat1_d == dat2_d)
            {
                if (vri1_sat &lt; vri2_sat)
                    return true;
                else if (vri1_sat &gt; vri2_sat)
                    return false;
                else if(vri1_sat == vri2_sat)
                {
                    if (vri1_min &lt; vri2_min)
                        return true;
                    else if (vri1_min &gt; vri2_min)
                        return false;
                    //else if(p1.vrijeme.minute==p2.vrijeme.minute)
                }
            }
        }
    }
}

void Pregled::Ispisi() const
{
    cout&lt;&lt;std::left&lt;&lt;std::setw(30)&lt;&lt;DajImePacijenta();
    DajDatumPregleda().Ispisi();
    cout&lt;&lt;" ";
    DajVrijemePregleda().Ispisi();
    cout&lt;&lt;"\n";
}


class Pregledi
{
    int max;
    Pregled **pok;
    public:
    explicit Pregledi(int max_broj_pregleda):max(max_broj_pregleda), pok(new Pregled*[max_broj_pregleda]{}) {}
    Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda);
    ~Pregledi();
    Pregledi(const Pregledi &amp;pregledi);
    Pregledi(Pregledi &amp;&amp;pregledi);
    Pregledi &amp;operator =(const Pregledi &amp;pregledi);
</font>    Pregledi &amp;operator =(Pregledi &amp;&amp;pregledi);
    void RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda);
    void RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda);
    void RegistrirajPregled(Pregled *pregled);
    int DajBrojPregleda() const;
    int DajBrojPregledaNaDatum(const Datum &amp;datum) const;
    Pregled &amp;DajNajranijiPregled();
    Pregled DajNajranijiPregled() const;
<a name="0"></a><font color="#FF0000"><a href="match123-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_54.gif"/></a>

    void IsprazniKolekciju();
    void ObrisiNajranijiPregled();
    void ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta);
    void IspisiPregledeNaDatum(const Datum &amp;datum) const;
    void IspisiSvePreglede() const;
};

Pregledi::Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda):max(spisak_pregleda.size()), pok(new Pregled*[spisak_pregleda.size()]{})
{
    try
    {
        int i=0;
        for(Pregled neki:spisak_pregleda)
        {
            pok[i]=new Pregled(neki);
            i++;
        }
    }
    catch(...)
    {
        for(int i=0; i&lt;spisak_pregleda.size(); i++)
            delete pok[i];
        delete[] pok;    
    }
}

Pregledi::~Pregledi()
{
    if (pok==nullptr)
        return;
    for(int i=0; i&lt;max; i++)
        delete pok[i];
    delete[] pok;    
}

Pregledi::Pregledi(const Pregledi &amp;pregledi):max(pregledi.max)
{
    try
    {
        pok=new Pregled*[pregledi.max]{};
        for(int i=0; i&lt;pregledi.max; i++)
            pok[i]=new Pregled(*(pregledi.pok[i]));
    }
    catch(...)
    {
        for(int i=0; i&lt;pregledi.max; i++)
            delete pok[i];
        delete[] pok;    
    }
}

Pregledi::Pregledi(Pregledi &amp;&amp;pregledi):max(pregledi.max), pok(pregledi.pok)
{
    pregledi.pok=nullptr;
}

Pregledi &amp;Pregledi::operator=(const Pregledi &amp;pregledi)
{
    if (pregledi.max != max)
        throw std::logic_error("Nesaglasni kapaciteti");
    if (&amp;pregledi!=this)
    {
        for(int i=0; i&lt;max; i++)
            delete pok[i];
        delete[] pok ;
        
        pok=new Pregled*[pregledi.max]{};
        for(int i=0; i&lt;pregledi.max; i++)
            pok[i]=new Pregled(*(pregledi.pok[i]));
    }
    return *this;
}

Pregledi &amp;Pregledi::operator=(Pregledi &amp;&amp;pregledi)
{
    if (pregledi.max != max)
        throw std::logic_error("Nesaglasni kapaciteti");
    std::swap(pok, pregledi.pok);
    return *this;    
}

void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda)
{
    bool ima_mjesta=false;
    for(int i=0; i&lt;max; i++)
        if(pok[i] == nullptr)
        {
            ima_mjesta=true;
            break;
        }
    if (ima_mjesta == false)
        throw std::range_error("Dostignut maksimalni broj pregleda");
    else
    {
        for(int i=0; i&lt;max; i++)
            if (pok[i] == nullptr)
            {
                pok[i]= new Pregled(ime_pacijenta, datum_pregleda, vrijeme_pregleda);
                break;
            }
    }
}

void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda)
{
    bool ima_mjesta=false;
    for(int i=0; i&lt;max; i++)
        if (pok[i] == nullptr)
        {
            ima_mjesta=true;
            break;
        }
    if (ima_mjesta == false)
        throw std::range_error("Dostignut maksimalni broj pregleda");
    else
    {
        for(int i=0; i&lt;max; i++)
            if (pok[i] == nullptr)
            {
                pok[i]=new Pregled(ime_pacijenta, dan_pregleda, mjesec_pregleda, godina_pregleda, sati_pregleda, minute_pregleda);
                break;
            }
    }
}

void Pregledi::RegistrirajPregled(Pregled *pregled)
{
    bool ima_mjesta=false;
    for(int i=0; i&lt;max; i++)
        if (pok[i] == nullptr)
        {
            ima_mjesta=true;
            break;
        }
    if (ima_mjesta == false)
        throw std::range_error("Dostignut maksimalni broj pregleda");
    else
    {
        for(int i=0; i&lt;max; i++)
            if (pok[i] == nullptr)
            {
                pok[i]= pregled;
                break;
            }
    }
}

int Pregledi::DajBrojPregleda() const
{
    int brojac(0);
    for(int i=0; i&lt;max; i++)
    {
        if (pok[i] == nullptr)
            continue;
        brojac++;    
    }
    return brojac;
}

int Pregledi::DajBrojPregledaNaDatum(const Datum &amp;datum) const
{
    int br=DajBrojPregleda();
    return std::count_if(pok, pok + br, [datum] (Pregled *p1)
    {
        return p1-&gt;DajDatumPregleda().Ocitaj()==datum.Ocitaj();
    });
}

Pregled &amp;Pregledi::DajNajranijiPregled()
{
    int br=DajBrojPregleda();
    if (br == 0)
        throw std::domain_error("Nema registriranih pregleda");
    auto p=std::min_element(pok, pok+br, [](Pregled *p1, Pregled *p2)
    {
        if(!p1)
            return false;
        if(!p2)
            return true;
        return Pregled::DolaziPrije(*p1, *p2); /////UPITNIK
    });
    return **p;
}


Pregled Pregledi::DajNajranijiPregled() const
{
    int br=DajBrojPregleda();
    if (br == 0)
        throw std::domain_error("Nema registriranih pregleda");
     auto p=std::min_element(pok, pok+br, [](Pregled *p1, Pregled *p2)
    {
        if(!p1)
            return false;
        if(!p2)
            return true;
        return Pregled::DolaziPrije(*p1, *p2); /////UPITNIK
    }); 
    return **p;
}

void Pregledi::IsprazniKolekciju()
{
    if (pok == nullptr)
        return;
    for(int i=0; i&lt;max; i++)
    {
        delete pok[i];
        pok[i]=nullptr;
    }    
    delete[] pok;
    pok=nullptr;
}

void Pregledi::ObrisiNajranijiPregled()
{
    int br=DajBrojPregleda();
    if (br == 0)
        throw std::range_error("Prazna kolekcija");    
    Pregled &amp;rani=DajNajranijiPregled();
    for(int i=0; i&lt;max; i++)
    {
        if (pok[i] == nullptr)
            continue;
        else if (pok[i]== &amp;rani)
        {
            delete pok[i];
            pok[i]=nullptr;
        }    
    }        
}

void Pregledi::ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta)
{
    for(int i=0; i&lt;max; i++)
    {
        if (pok[i] &amp;&amp; pok[i]-&gt;DajImePacijenta() == ime_pacijenta)
        {
            delete pok[i];
            pok[i]=nullptr;
        }    
    }        
           
}

void Pregledi::IspisiPregledeNaDatum(const Datum &amp;datum) const
{
    std::vector&lt;Pregled*&gt; vek;
    for(int i=0; i&lt;max; i++)
    {
        if (pok[i] &amp;&amp; pok[i]-&gt;DajDatumPregleda().Ocitaj() == datum.Ocitaj())
            vek.push_back(pok[i]);
            
    }
      std::sort(vek.begin(), vek.end(), [](Pregled *pok1, Pregled *pok2)
    {
        return Pregled::DolaziPrije(*pok1, *pok2);
    });
    for(int i=0; i&lt;vek.size(); i++)
        vek[i]-&gt;Ispisi();
        
}

void Pregledi::IspisiSvePreglede() const
{
    std::vector&lt;Pregled*&gt; vek;
    for(int i=0; i&lt;max; i++)
    {
        if (pok[i] == nullptr)
            continue;
        else
            vek.push_back(pok[i]);
    }
    std::sort(vek.begin(), vek.end(), [](Pregled *pok1, Pregled *pok2)
    {
        return Pregled::DolaziPrije(*pok1, *pok2);
    });
    for(int i=0; i&lt;vek.size(); i++)
        vek[i]-&gt;Ispisi();
}

int main ()
{
    int max;
    cout&lt;&lt;"Unesite maksimalan broj pregleda: ";
    cin&gt;&gt;max;
    Pregledi p(max);
    for(int i=0; i&lt;max; i++)
    {
        string pacijent, ispravnost;
        cout&lt;&lt;"Unesite ime novog pacijenta ili \'kraj\' za zavrsetak unosa: ";
        cin&gt;&gt;pacijent;
        ispravnost={"kraj"};
        if (pacijent == ispravnost)
            break;
        int dan, mjesec, godina;
        cout&lt;&lt;"Unesite dan mjesec i godinu pregleda: ";
        cin&gt;&gt;dan&gt;&gt;mjesec&gt;&gt;godina;
        cout&lt;&lt;"Unesite sate i minute pregleda: ";
        int sat, min;
        cin&gt;&gt;sat&gt;&gt;min;
        try
        {
        p.RegistrirajPregled(pacijent, dan, mjesec, godina, sat, min);
        }
        catch(std::range_error izuzetak)
        {
            cout&lt;&lt;izuzetak.what();
        }
    }
    cout&lt;&lt;"Trenutno su registrovani sljedeci pregledi\n";
    p.IspisiSvePreglede();
    while(1)
    {
        int odabir(0);
        cout&lt;&lt;"\nOdaberite jednu od sljedecih opcija\n";
        cout&lt;&lt;"1 - Broj pregleda na datum\n";
        cout&lt;&lt;"2 - Najraniji pregled\n";
        cout&lt;&lt;"3 - Obrisi pregled pacijenta\n";
        cout&lt;&lt;"4 - Obrisi najraniji pregled\n";
        cout&lt;&lt;"5 - Ispisi sve pregleda na datum\n";
        cout&lt;&lt;"6 - Ispisi sve preglede\n";
        cout&lt;&lt;"7 - Kraj programa\n";
        cin&gt;&gt;odabir;
        try
        {
            if (odabir == 7)
                break;
            if (odabir == 1) 
            {
                cout&lt;&lt;"Unesite dan mjesec i godinu : ";
                int dan, mjesec, godina;
                cin&gt;&gt;dan&gt;&gt;mjesec&gt;&gt;godina;
                cout&lt;&lt;"Broj pregleda na datum "&lt;&lt;dan&lt;&lt;" "&lt;&lt;mjesec&lt;&lt;" "&lt;&lt;godina&lt;&lt;" je: "&lt;&lt;p.DajBrojPregledaNaDatum(Datum(dan,mjesec,godina))&lt;&lt;"\n";
            }
            else if(odabir == 2)
            {
                cout&lt;&lt;"Najraniji pregled je:\n";
                p.DajNajranijiPregled().Ispisi();
                
            }
            else if (odabir == 3)
            {
                string ime;
                int br1=p.DajBrojPregleda();
                cout&lt;&lt;"Unesite ime pacijenta: ";
                cin&gt;&gt;ime;
                p.ObrisiPregledePacijenta(ime);
                cout&lt;&lt;"Uspjesno obrisano "&lt;&lt;br1 - p.DajBrojPregleda()&lt;&lt;" pregleda\n";
            }
            else if(odabir == 4)
            {
              p.ObrisiNajranijiPregled();
              cout&lt;&lt;"Najraniji pregled uspjesno obrisan\n";
            }
            else if(odabir == 5)
            {
                int dan, mjesec, godina;
                cout&lt;&lt;"Unesite dan mjesec i godinu : ";
                cin&gt;&gt;dan&gt;&gt;mjesec&gt;&gt;godina;
                cout&lt;&lt;"Pregledi na datum "&lt;&lt;dan&lt;&lt;" "&lt;&lt;mjesec&lt;&lt;" "&lt;&lt;godina&lt;&lt;" su:\n";
                p.IspisiPregledeNaDatum(Datum(dan,mjesec,godina));
            }
            else if(odabir == 6)
            {
                p.IspisiSvePreglede();
            }
        }
        catch(std::exception izuzetak)
        {
            cout&lt;&lt;izuzetak.what();
</font>        }
    }
	return 0;
}


</pre>
</body>
</html>
