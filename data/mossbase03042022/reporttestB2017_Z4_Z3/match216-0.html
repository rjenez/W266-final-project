<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student1793.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student1793.cpp<p></p><pre>
<a name="0"></a><font color="#FF0000"><a href="match216-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_99.gif"/></a>

/B2017/2018: ZadaÄ‡a 4, Zadatak 3
#include &lt;iostream&gt;
#include &lt;tuple&gt;
#include &lt;stdexcept&gt;
#include &lt;iomanip&gt;
#include &lt;algorithm&gt;

using namespace std;

class Datum
{
    int dan,mjesec,godina;

    static int BrojDana(int mjesec, int godina) {
        int broj_dana[] {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
        if(godina % 4 == 0 &amp;&amp; godina % 100 != 0 || godina % 400 == 0)
            broj_dana[1]++;
        return broj_dana[mjesec - 1];
    }

    static bool IspravanDatum(int dan, int mjesec, int godina) {
        if (dan&lt;=0||dan&gt;BrojDana(mjesec,godina) || mjesec&lt;=0||mjesec&gt;12 || godina&lt;0)
            return false;

        return true;
    }

public:
    Datum(int dan, int mjesec, int godina) {
        Postavi(dan,mjesec,godina);
    }
    void Postavi(int dan, int mjesec, int godina) {
        if(!IspravanDatum(dan,mjesec,godina)) throw domain_error("Neispravan datum");
        this-&gt;dan = dan;
        this-&gt;mjesec = mjesec;
        this-&gt;godina = godina;
    }
    std::tuple&lt;int, int, int&gt; Ocitaj() const {
        return tuple&lt;int,int,int&gt;(dan,mjesec,godina);
    }
    void Ispisi() const {
        cout&lt;&lt;dan&lt;&lt;"/"&lt;&lt;mjesec&lt;&lt;"/"&lt;&lt;godina;
    }
};



class Vrijeme
{
    int sati, minute;

    static bool IspravnoVrijeme(int sati, int minute) {
        if(sati&lt;0||sati&gt;23||minute&lt;0||minute&gt;59) return false;

        return true;

    }
public:
    Vrijeme(int sati, int minute) {
        Postavi(sati,minute);
    }
    void Postavi(int sati, int minute) {
        if(!IspravnoVrijeme(sati,minute)) {
            throw domain_error("Neispravno vrijeme");
        }
        this-&gt;sati = sati;
        this-&gt;minute = minute;
    }
    std::pair&lt;int, int&gt; Ocitaj () const {
        return make_pair(sati,minute);
    }
    void Ispisi() const {
        cout&lt;&lt; (sati&lt;10?"0":"")&lt;&lt;sati&lt;&lt;":"&lt;&lt; (minute&lt;10?"0":"")&lt;&lt;minute;
    }
};


class Pregled
{
    string ime_pacijenta;
    Datum datum_pregleda;
    Vrijeme vrijeme_pregleda;
public:
    Pregled(const string &amp;ime_pacijenta, const Datum&amp; datum_pregleda, const Vrijeme&amp; vrijeme_pregleda):
        datum_pregleda(datum_pregleda),vrijeme_pregleda(vrijeme_pregleda) {
        this-&gt;ime_pacijenta = ime_pacijenta;
    }
    Pregled(const string&amp; ime_pacijenta, int dan_pregleda, int mjesec_pregleda,int godina_pregleda, int sati_pregleda, int minute_pregleda):
        datum_pregleda(dan_pregleda,mjesec_pregleda,godina_pregleda),vrijeme_pregleda(sati_pregleda,minute_pregleda) {
        this-&gt;ime_pacijenta = ime_pacijenta;
    }
    void PromijeniPacijenta(const string&amp; ime_pacijenta) {
        this-&gt;ime_pacijenta = ime_pacijenta;
    }
    void PromijeniDatum(const Datum&amp;novi_datum) {
        this-&gt;datum_pregleda = novi_datum;
    }
    void PromijeniVrijeme(const Vrijeme&amp; novo_vrijeme) {
        this-&gt;vrijeme_pregleda = novo_vrijeme;
    }
    string DajImePacijenta()const {
        return ime_pacijenta;
    }
    Datum DajDatumPregleda()const {
        return datum_pregleda;
    }
    Vrijeme DajVrijemePregleda()const {
        return vrijeme_pregleda;
    }
    static bool DolaziPrije(const Pregled &amp;p1, const Pregled&amp;p2) {
        int dan1,mjesec1,godina1;
        tie(dan1,mjesec1,godina1) = p1.datum_pregleda.Ocitaj();
        int dan2,mjesec2,godina2;
        tie(dan2,mjesec2,godina2) = p2.datum_pregleda.Ocitaj();

        pair&lt;int,int&gt; v1 = p1.vrijeme_pregleda.Ocitaj();
        pair&lt;int,int&gt; v2 = p1.vrijeme_pregleda.Ocitaj();

        if(godina1&lt;godina2)return true;
        else if(godina1==godina2) {
            if(mjesec1&lt;mjesec2)return true;
            else if(mjesec1==mjesec2) {
                if(dan1&lt;dan2)return true;
                else if(dan1==dan2) {
                    if(v1.first&lt;v2.first)return true;
                    else if(v1.first==v2.first) {
                        if(v1.second == v2.second)return true;
                    }
                }
            }
        }

        return false;
    }
    void Ispisi()const {
        cout&lt;&lt;left&lt;&lt;setw(30)&lt;&lt;ime_pacijenta;
        datum_pregleda.Ispisi();
        cout&lt;&lt;" ";
        vrijeme_pregleda.Ispisi();
        cout&lt;&lt;endl;
    }
};

class Pregledi
{
    Pregled**pregledi;
    int kapacitet;
    int broj_pregleda;
public:
    explicit Pregledi(int max_broj_pregleda) {
        this-&gt;kapacitet = max_broj_pregleda;
        pregledi = new Pregled*[max_broj_pregleda];
        broj_pregleda = 0;
    }
    Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda) {
        pregledi = new Pregled*[spisak_pregleda.size()];
        kapacitet = spisak_pregleda.size();
        broj_pregleda = spisak_pregleda.size();
        int i=0;
        for (auto it = spisak_pregleda.begin(); it!=spisak_pregleda.end(); it++) {
            pregledi[i++] = new Pregled(*it);
        }
    }
    ~Pregledi() {
        for (int i = 0; i &lt; broj_pregleda; i++) {
            delete pregledi[i];
        }
        delete[] pregledi;
    }
    Pregledi(const Pregledi &amp;p) {
        try {
            kapacitet = p.kapacitet;
            broj_pregleda = p.broj_pregleda;
            pregledi = new Pregled*[kapacitet];
            for (int i = 0; i &lt; broj_pregleda; i++) {
                pregledi[i] = nullptr;
            }
            try {
                for (int i = 0; i &lt; broj_pregleda; i++) {
                    pregledi[i] = new Pregled(*p.pregledi[i]);
                }
            } catch(bad_alloc) {
                for (int i = 0; i &lt; broj_pregleda; i++) {
                    delete pregledi[i];
                }
                delete[] pregledi;
            }
        } catch(bad_alloc) {
            throw;
        }
    }
    Pregledi(Pregledi &amp;&amp;p) {
        broj_pregleda = p.broj_pregleda;
        kapacitet = p.kapacitet;
        pregledi = p.pregledi;
        p.pregledi = nullptr;
        p.broj_pregleda = 0;
    }
    Pregledi &amp;operator =(const Pregledi &amp;p) {
        if(this==&amp;p) return *this;
        for(int i=0; i&lt;broj_pregleda; i++)delete pregledi[i];
        delete[] pregledi;

        broj_pregleda = p.broj_pregleda;
        kapacitet = p.kapacitet;
        for (int i = 0; i &lt; broj_pregleda; i++) {
            pregledi[i] = new Pregled(*p.pregledi[i]);
        }

        return *this;
    }
    Pregledi &amp;operator =(Pregledi &amp;&amp;p) {
        if(this==&amp;p) return *this;
        for(int i=0; i&lt;broj_pregleda; i++)delete pregledi[i];
        delete[] pregledi;

        broj_pregleda = p.broj_pregleda;
        kapacitet = p.kapacitet;
        pregledi = p.pregledi;
        p.pregledi = nullptr;
        p.broj_pregleda=0;

        return *this;
    }
    void RegistrirajPregled(const std::string &amp;ime_pacijenta,
                            const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda) {
        if(broj_pregleda == kapacitet) {
            throw range_error("Dostignut maksimalni broj pregleda");
        }

        pregledi[broj_pregleda++]= new Pregled(ime_pacijenta,datum_pregleda,vrijeme_pregleda);
    }
    void RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda,
                            int mjesec_pregleda, int godina_pregleda, int sati_pregleda,
                            int minute_pregleda) {
        if(broj_pregleda==kapacitet) {
            throw range_error("Dostignut maksimalni broj pregleda");
        }
        pregledi[broj_pregleda++]=new Pregled(ime_pacijenta,dan_pregleda,mjesec_pregleda,godina_pregleda,sati_pregleda,minute_pregleda);
    }
    void RegistrirajPregled(Pregled *pregled) {
        if(broj_pregleda==kapacitet) {
            throw range_error("Dostignut maksimalni broj pregleda");
        }
        pregledi[broj_pregleda++]=pregled;
    }
    int DajBrojPregleda() const {
        return broj_pregleda;
    }
    int DajBrojPregledaNaDatum(const Datum &amp;datum) const {
        int d,m,g;
        tie(d,m,g) = datum.Ocitaj();
        return count_if(pregledi,pregledi+broj_pregleda,[d,m,g](Pregled*p) {
            int dan,mjesec,godina;
            tie(dan,mjesec,godina) = p-&gt;DajDatumPregleda().Ocitaj();
            return dan==d &amp;&amp; mjesec ==m &amp;&amp; godina==g;
        });
    }
    Pregled &amp;DajNajranijiPregled() {
        if(broj_pregleda==0)throw domain_error("Nema registriranih pregleda");
        return **min_element(pregledi, pregledi+broj_pregleda,[](Pregled*a,Pregled*b) {
            return Pregled::DolaziPrije(*a,*b);
        });
    }
    Pregled DajNajranijiPregled() const {
        if(broj_pregleda==0)throw domain_error("Nema registriranih pregleda");
        return **min_element(pregledi, pregledi+broj_pregleda,[](Pregled*a,Pregled*b) {
            return Pregled::DolaziPrije(*a,*b);
        });
    }
    void IsprazniKolekciju() {
        for (int i = 0; i &lt; broj_pregleda; i++) {
            delete pregledi[i];
        }
        broj_pregleda=0;
    }
    void ObrisiNajranijiPregled() {
        if(broj_pregleda==0)throw range_error("Prazna kolekcija");
        Pregled** najraniji= min_element(pregledi, pregledi+broj_pregleda,[](Pregled*a,Pregled*b) {
            return Pregled::DolaziPrije(*a,*b);
        });

        int indeks_najranijeg = najraniji - pregledi;
        delete pregledi[indeks_najranijeg];
        for (int i = indeks_najranijeg; i &lt; broj_pregleda-1; i++) {
            pregledi[i] = pregledi[i+1];
        }
        pregledi[broj_pregleda-1] = nullptr;
        broj_pregleda--;
    }

    void ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta) {
        for (int i = 0; i &lt; broj_pregleda; i++) {
            if(pregledi[i]-&gt;DajImePacijenta() == ime_pacijenta) {
                delete pregledi[i];
                for(int j=i; j&lt;broj_pregleda-1; j++) {
                    pregledi[j]=pregledi[j+1];
                }
                pregledi[broj_pregleda-1]=nullptr;
                broj_pregleda--;
            }
        }
    }

    void IspisiPregledeNaDatum(const Datum &amp;datum) const {
        Pregledi p(kapacitet);
        int d,m,g;
        tie(d,m,g) = datum.Ocitaj();
        for (int i = 0; i &lt; broj_pregleda; i++) {
            int dan,mjesec,godina;
            tie(dan,mjesec,godina) = pregledi[i]-&gt;DajDatumPregleda().Ocitaj();
            if( dan==d &amp;&amp; mjesec ==m &amp;&amp; godina==g) {
                p.RegistrirajPregled(new Pregled(*pregledi[i]));
            }
        }
        p.IspisiSvePreglede();
    }


    void IspisiSvePreglede() const {
        sort(pregledi,pregledi+broj_pregleda,[](Pregled*a,Pregled*b) {
            return Pregled::DolaziPrije(*a,*b);
        });

        for (int i = 0; i &lt; broj_pregleda; i++) {
            pregledi[i]-&gt;Ispisi();
        }
    }
};
int main ()
{

    try {
        int kapacitet;
        cout&lt;&lt;"Unesite maksimalan broj pregleda: ";
        cin&gt;&gt;kapacitet;
        cin.ignore(1000,'\n');
        Pregledi p(kapacitet);

        while(true) {
            if(p.DajBrojPregleda()==kapacitet)break;
            string ime;
            cout&lt;&lt;"Unesite ime novog pacijenta ili 'kraj' za zavrsetak unosa: ";
            getline(cin,ime);
            if(ime=="kraj")break;
            cout&lt;&lt;"Unesite dan mjesec i godinu pregleda: ";
            int dan,mjesec,godina;
            cin&gt;&gt;dan&gt;&gt;mjesec&gt;&gt;godina;
            cout&lt;&lt;"Unesite sate i minute pregleda: ";
            int sati, minute;
            cin&gt;&gt;sati&gt;&gt;minute;
            cin.ignore(1000,'\n');
            p.RegistrirajPregled(ime, dan, mjesec, godina, sati, minute);
        }

        cout&lt;&lt;"Trenutno su registrovani sljedeci pregledi"&lt;&lt;endl;
        p.IspisiSvePreglede();
        
        
        while(true){
            cout&lt;&lt;"Odaberite jednu od sljedecih opcija\n1 - Broj pregleda na datum\n2 - Najraniji pregled\n3 - Obrisi pregled pacijenta\n4 - Obrisi najraniji pregled\n5 - Ispisi sve pregleda na datum\n6 - Ispisi sve preglede\n7 - Kraj programa"&lt;&lt;endl;
            int izbor;
            cin&gt;&gt;izbor;
            
           if(izbor==1){
               int d,m,g;
               cout&lt;&lt;"Unesite dan mjesec i godinu : ";
               cin&gt;&gt;d&gt;&gt;m&gt;&gt;g;
               cout&lt;&lt;"Broj pregleda na datum "&lt;&lt;d&lt;&lt;" "&lt;&lt;m&lt;&lt;" "&lt;&lt;g&lt;&lt;" je: "&lt;&lt;p.DajBrojPregledaNaDatum(Datum(d,m,g))&lt;&lt;endl;
           }
           else if(izbor==2){
               cout&lt;&lt;"Najraniji pregled je:"&lt;&lt;endl;
               p.DajNajranijiPregled().Ispisi();
           }
           else if(izbor==3){
               string pomocno_ime;
               cout&lt;&lt;"Unesite ime pacijenta: ";
                        cin.ignore(1000,'\n');
               getline(cin,pomocno_ime);
               int prije = p.DajBrojPregleda();
               p.ObrisiPregledePacijenta(pomocno_ime);
               int poslije = p.DajBrojPregleda();
               cout&lt;&lt;"Uspjesno obrisano "&lt;&lt;prije-poslije&lt;&lt;" pregleda"&lt;&lt;endl;
           }
           else if(izbor==4){
               p.ObrisiNajranijiPregled();
               cout&lt;&lt;"Najraniji pregled uspjesno obrisan"&lt;&lt;endl;
           }
           else if(izbor==5){
               int d,m,g;
               cout&lt;&lt;"Unesite dan mjesec i godinu : ";
               cin&gt;&gt;d&gt;&gt;m&gt;&gt;g;
               cout&lt;&lt;"Pregledi na datum "&lt;&lt;d&lt;&lt;" "&lt;&lt;m&lt;&lt;" "&lt;&lt;g&lt;&lt;" su:"&lt;&lt;endl;
               p.IspisiPregledeNaDatum(Datum(d,m,g));
           }
           else if(izbor==6){
               p.IspisiSvePreglede();
           }
           else if(izbor==7){
               break;
           }
        }
    } catch(domain_error e) {
        cout&lt;&lt;e.what()&lt;&lt;endl;
    } catch(range_error e) {
        cout&lt;&lt;e.what()&lt;&lt;endl;
    }
    return 0;
</font>
}
</pre>
</body>
</html>
