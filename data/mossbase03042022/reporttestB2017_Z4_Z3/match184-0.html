<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student3867.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student3867.cpp<p></p><pre>
#include &lt;iostream&gt;
#include &lt;tuple&gt;
#include &lt;utility&gt;
#include &lt;stdexcept&gt;
#include &lt;string&gt;
#include &lt;iomanip&gt;
#include &lt;cstdlib&gt;
#include &lt;initializer_list&gt;
#include &lt;algorithm&gt;

/*Datum*/
<a name="1"></a><font color="#00FF00"><a href="match184-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_21.gif"/></a>

class Datum
{
    int dan, mjesec, godina;

public:
    Datum ( int d, int m, int g ) { this -&gt; Postavi ( d, m, g ); }
    void Postavi ( int, int, int );
    
    std::tuple &lt; int, int, int &gt; Ocitaj ( void ) const { return std::tie ( dan, mjesec, godina ); }
    
    void Ispisi ( void ) const { std::cout &lt;&lt; dan &lt;&lt; "/" &lt;&lt; mjesec &lt;&lt; "/" &lt;&lt; godina; }
};

void Datum::Postavi ( int d, int m, int g )
{
    int broj_dana [ 12 ] { 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };
    if ( ( g % 4 == 0 and g % 100 != 0 ) or g % 400 == 0 )  broj_dana [ 1 ]++;
    if ( g &lt; 1 or d &lt; 1 or m &lt; 1 or m &gt; 12 or d &gt; broj_dana [ m - 1 ] )
        throw std::domain_error ( "Neispravan datum" );
    dan = d; mjesec = m; godina = g;
}
/*~Datum*/

/*Vrijeme*/
class Vrijeme
{
    int sati, minute;

public:
    Vrijeme ( int sati, int minute ) { this -&gt; Postavi ( sati, minute ); }
    void Postavi ( int, int );
    
    std::pair &lt; int, int &gt; Ocitaj ( void ) const { return std::make_pair ( sati, minute ); }
    
    void Ispisi ( void ) const { std::cout &lt;&lt; std::right &lt;&lt; std::setw ( 2 ) &lt;&lt; std::setfill ( '0' ) &lt;&lt; sati &lt;&lt; ":" &lt;&lt; 
        std::right &lt;&lt; std::setw ( 2 ) &lt;&lt; std::setfill ( '0' ) &lt;&lt; minute; }
};

void Vrijeme::Postavi ( int h, int m )
{
    if ( h &lt; 0 or h &gt; 23 or m &lt; 0 or m &gt; 59 )
        throw std::domain_error ( "Neispravno vrijeme" );
    sati = h; minute = m;
}
/*~Vrijeme*/

/*Pregled*/
class Pregled
{
    std::string ime;
    Datum datum;
    Vrijeme vrijeme;    
    
    //broj proteklih dana od pocetka godine za svaki mjesec
    const int dim [ 12 ] = { 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334, 365 };

    int NumberOfDays ( void ) const // broj dana od nultog dana u Gregorijanskom kalendaru
    {
        std::tuple &lt; int, int, int &gt; date ( this -&gt; DajDatumPregleda ().Ocitaj () );
        int dan { std::get &lt; 0 &gt; ( date ) }, mjesec { std::get &lt; 1 &gt; ( date ) }, godina { std::get &lt; 2 &gt; ( date ) };
        return
        (
            ( godina - 1 ) * 365 + ( mjesec &gt; 1 ? dim [ mjesec - 2 ] : 0 ) + dan - 1 + 
            ( mjesec &gt; 2 ? godina / 4 - godina / 100 + godina / 400 :
            ( godina - 1 ) / 4 - ( godina - 1 ) / 100 + ( godina - 1 ) / 400 )
        );
    }

    int NumberOfMinutes ( void ) const // broj minuta od nulte minute u Gregorijanskom kalendaru
    { 
        std::pair &lt; int, int &gt; par ( this -&gt; DajVrijemePregleda ().Ocitaj () );
        int sati { par.first }, minute { par.second };
        return ( this -&gt; NumberOfDays () ) * 1440 + sati * 60 + minute; 
    }
    
public:
    Pregled ( const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda )
        : ime { ime_pacijenta }, datum { datum_pregleda }, vrijeme { vrijeme_pregleda } {}
</font>    
    Pregled ( const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda )
<a name="0"></a><font color="#FF0000"><a href="match184-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_66.gif"/></a>

        : ime { ime_pacijenta }, datum ( dan_pregleda, mjesec_pregleda, godina_pregleda ), vrijeme ( sati_pregleda, minute_pregleda ) {}
    
    void PromijeniPacijenta  ( const std::string &amp;ime_pacijenta ) { ime = ime_pacijenta; }
    void PromijeniDatum ( const Datum &amp;novi_datum ) { datum = novi_datum; }
    void PromijeniVrijeme ( const Vrijeme &amp;novo_vrijeme ) { vrijeme = novo_vrijeme; }
    
    void PomjeriDanUnaprijed ( void );
    void PomjeriDanUnazad ( void );
    
    std::string DajImePacijenta ( void ) const { return ime; }
    Datum DajDatumPregleda ( void ) const { return datum; }
    Vrijeme DajVrijemePregleda ( void ) const { return vrijeme; }
    
    static bool DolaziPrije ( const Pregled &amp;p1, const Pregled &amp;p2 ) 
        { return p1.NumberOfMinutes () &lt; p2.NumberOfMinutes (); }
    
    void Ispisi ( void ) const
    {
        std::cout &lt;&lt; std::setw ( 30 ) &lt;&lt; std::left  &lt;&lt; std::setfill ( ' ' ) &lt;&lt; ime;
        datum.Ispisi (); std::cout &lt;&lt; " "; vrijeme.Ispisi ();
    }
};

void Pregled::PomjeriDanUnaprijed ( void )
{
    std::tuple &lt; int, int, int &gt; date = datum.Ocitaj ();
    int d { std::get &lt; 0 &gt; ( date ) }, m { std::get &lt; 1 &gt; ( date ) }, g { std::get &lt; 2 &gt; ( date ) };
    
    int broj_dana [ 12 ] { 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };
    if ( ( g % 4 == 0 and g % 100 != 0 ) or g % 400 == 0 )  broj_dana [ 1 ]++;
    
    if ( d &gt; broj_dana [ m - 1 ] ) ( d = 1 ), m++;
    if ( m &gt; 12 ) ( m = 1 ), g++;
    
    datum.Postavi ( d, m, g );
}

void Pregled::PomjeriDanUnazad ( void )
{
    std::tuple &lt; int, int, int &gt; date = datum.Ocitaj ();
    int d { std::get &lt; 0 &gt; ( date ) }, m { std::get &lt; 1 &gt; ( date ) }, g { std::get &lt; 2 &gt; ( date ) };
    
    int broj_dana [ 12 ] { 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };
    if ( ( g % 4 == 0 and g % 100 != 0 ) or g % 400 == 0 )  broj_dana [ 1 ]++;
    
    if ( d &lt; 1 )
    {
        m--;
        if ( m &lt; 1 )
            g--;
        d = broj_dana [ m - 1 ];
    }
    
    datum.Postavi ( d, m, g );
}
/*~Pregled*/

/*Pregledi*/
class Pregledi
{
    Pregled **p;
    
    unsigned int velicina_niza, trenutna_velicina;
    
    void Alloc ( int n ) // alokacija memorije za clan 'p'
    {
        p = new Pregled *[ n ];
        for ( int i = 0; i &lt; n; i++ )
            p [ i ] = nullptr;
        velicina_niza = n;
        trenutna_velicina = 0;
    }

public:
    explicit Pregledi ( int max_broj_pregleda ) { this -&gt; Alloc ( max_broj_pregleda ); }
    
    Pregledi ( std::initializer_list &lt; Pregled &gt; spisak_pregleda )
    {
        this -&gt; Alloc ( spisak_pregleda.size () );
        int i { 0 };
        for ( Pregled pregled : spisak_pregleda )
            p [ i++ ] = new Pregled ( pregled.DajImePacijenta (), pregled.DajDatumPregleda (), pregled.DajVrijemePregleda () );
            
        trenutna_velicina = velicina_niza = spisak_pregleda.size ();
    }
    
    ~Pregledi ( void )
    {
        for ( int i = 0; i &lt; trenutna_velicina; i++ )
            delete p [ i ];
        delete [] p;
    }
    
    Pregledi ( const Pregledi &amp;pregledi )
    {
        this -&gt; Alloc ( pregledi.velicina_niza );
        trenutna_velicina = pregledi.trenutna_velicina;
        
        for ( int i = 0; i &lt; trenutna_velicina; i++ )
            p [ i ] = new Pregled 
                ( pregledi.p [ i ] -&gt; DajImePacijenta (), pregledi.p [ i ] -&gt; DajDatumPregleda (), pregledi.p [ i ] -&gt; DajVrijemePregleda () );
    }
    
    Pregledi ( Pregledi &amp;&amp;pregledi ) 
        : p { pregledi.p }, velicina_niza { pregledi.velicina_niza }, trenutna_velicina { pregledi.trenutna_velicina }
        { pregledi.~Pregledi (); }   

    Pregledi &amp;operator = ( const Pregledi &amp;pregledi )
    {
        this -&gt; ~Pregledi ();
        this -&gt; Alloc ( pregledi.velicina_niza );
        trenutna_velicina = pregledi.trenutna_velicina;
        
        for ( int i = 0; i &lt; trenutna_velicina; i++ )
            p [ i ] = new Pregled 
                ( pregledi.p [ i ] -&gt; DajImePacijenta (), pregledi.p [ i ] -&gt; DajDatumPregleda (), pregledi.p [ i ] -&gt; DajVrijemePregleda () );
        
        return *this;
    }
    
    Pregledi &amp;operator = ( Pregledi &amp;&amp;pregledi )
    {
        if ( this != &amp;pregledi )
        {
            this -&gt; ~Pregledi ();
            p = pregledi.p;
            velicina_niza = pregledi.velicina_niza;
            trenutna_velicina = pregledi.trenutna_velicina;
        }
        pregledi.~Pregledi ();
        return *this;
    }
    
    void RegistrirajPregled ( const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda )
    {
        if ( trenutna_velicina == velicina_niza )
            throw std::domain_error ( "Dostignut maksimalni broj pregleda" );
        
        p [ trenutna_velicina++ ] = new Pregled ( ime_pacijenta, datum_pregleda, vrijeme_pregleda );
    }
    
    void RegistrirajPregled ( const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, 
        int sati_pregleda, int minute_pregleda )
    {
        if ( trenutna_velicina == velicina_niza )
            throw std::domain_error ( "Dostignut maksimalni broj pregleda" );
        
        p [ trenutna_velicina++ ] = new Pregled ( ime_pacijenta, dan_pregleda, mjesec_pregleda, godina_pregleda, sati_pregleda, minute_pregleda );
    }
    
    void RegistrirajPregled ( Pregled *pregled )
    {
        if ( trenutna_velicina == velicina_niza )
            { delete pregled; throw std::domain_error ( "Dostignut maksimalni broj pregleda" ); }
        
        p [ trenutna_velicina++ ] = new Pregled ( pregled -&gt; DajImePacijenta (), pregled -&gt; DajDatumPregleda (), pregled -&gt; DajVrijemePregleda () );
        
        delete pregled;
    }
    
    int DajBrojPregleda ( void ) const { return trenutna_velicina; }
    int DajBrojPregledaNaDatum ( const Datum &amp;datum ) const
    {
        return std::count_if ( p, p + trenutna_velicina, 
            [ = ] ( Pregled *p ) -&gt; bool
            {
                std::tuple &lt; int, int, int &gt; d1 ( p -&gt; DajDatumPregleda ().Ocitaj () ), d2 ( datum.Ocitaj () );
                int dan1 { std::get &lt; 0 &gt; ( d1 ) }, mjesec1 { std::get &lt; 1 &gt; ( d1 ) }, godina1 { std::get &lt; 2 &gt; ( d1 ) },
                    dan2 { std::get &lt; 0 &gt; ( d2 ) }, mjesec2 { std::get &lt; 1 &gt; ( d2 ) }, godina2 { std::get &lt; 2 &gt; ( d2 ) };
                return dan1 == dan2 and mjesec1 == mjesec2 and godina1 == godina2;
            }
        );
    }
    
    Pregled &amp;DajNajranijiPregled ( void )
    {
        if ( trenutna_velicina == 0 )
            throw std::domain_error ( "Nema registriranih pregleda" );
        
        return **std::min_element ( this -&gt; p, this -&gt; p + trenutna_velicina,
            [] ( Pregled *p1, Pregled *p2 ) -&gt; bool
                { return Pregled::DolaziPrije ( *p1, *p2 ); }
        );
    }
    
    Pregled DajNajranijiPregled ( void ) const
    {
        if ( trenutna_velicina == 0 )
            throw std::domain_error ( "Nema registriranih pregleda" );
        
        return **std::min_element ( this -&gt; p, this -&gt; p + trenutna_velicina,
            [] ( Pregled *p1, Pregled *p2 ) -&gt; bool
                { return Pregled::DolaziPrije ( *p1, *p2 ); }
        );        
    }
    
    void IsprazniKolekciju ( void )
    {
        for ( int i = 0; i &lt; trenutna_velicina; i++ )
            ( delete p [ i ] ), p [ i ] = nullptr;
    }
    
    void ObrisiNajranijiPregled ( void )
    {
        if ( trenutna_velicina == 0 )
            throw std::range_error ( "Prazna kolekcija" );
        
        Pregled pregled { this -&gt; DajNajranijiPregled () };
        
        for ( int i = 0; i &lt; trenutna_velicina; i++ )
            if 
            ( 
                p [ i ] -&gt; DajImePacijenta () == pregled.DajImePacijenta () and 
                p [ i ] -&gt; DajDatumPregleda ().Ocitaj () == pregled.DajDatumPregleda ().Ocitaj () and
                p [ i ] -&gt; DajVrijemePregleda ().Ocitaj () == pregled.DajVrijemePregleda ().Ocitaj () 
            )
            {
                delete p [ i ];
                
                if ( trenutna_velicina == 1 or i + 1 == trenutna_velicina ) // prazan niz nakon brisanja ili zadnji pregled u nizu
                    { p [ i ] = nullptr; trenutna_velicina--; }
                else
                { // mijenja pregled za brisanje sa zadnjim pregledom u nizu
                    p [ i ] = new Pregled ( p [ --trenutna_velicina ] -&gt; DajImePacijenta (), 
                        p [ trenutna_velicina ] -&gt; DajDatumPregleda (), p [ trenutna_velicina ] -&gt; DajVrijemePregleda () );
                    delete p [ trenutna_velicina ];
                    p [ trenutna_velicina ] = nullptr;
                }
                break;
            }
    }
    
    void ObrisiPregledePacijenta ( const std::string &amp;ime_pacijenta )
    {
        for ( int i = 0; i &lt; trenutna_velicina; i++ )
            if ( p [ i ] -&gt; DajImePacijenta () == ime_pacijenta )
            {
                delete p [ i ];
                if ( trenutna_velicina == 1 or i + 1 == trenutna_velicina ) // prazan niz nakon brisanja ili zadnji pregled u nizu
                    { p [ i ] = nullptr; trenutna_velicina--; }
                else
                { // mijenja pregled za brisanje sa zadnjim pregledom u nizu
                    p [ i ] = new Pregled ( p [ --trenutna_velicina ] -&gt; DajImePacijenta (), 
                        p [ trenutna_velicina ] -&gt; DajDatumPregleda (), p [ trenutna_velicina ] -&gt; DajVrijemePregleda () );
                    delete p [ trenutna_velicina ];
                    p [ trenutna_velicina ] = nullptr;
                }
                i--;
            }
    }
    
    void IspisiPregledeNaDatum ( const Datum &amp;datum ) const
    {
        Pregledi pp ( *this );
        while ( pp.DajBrojPregleda () != 0 )
        {
            if ( pp.DajNajranijiPregled ().DajDatumPregleda ().Ocitaj () == datum.Ocitaj () )
                pp.DajNajranijiPregled ().Ispisi ();
            pp.ObrisiNajranijiPregled ();
            std::cout &lt;&lt; std::endl;
        }
    }
    
    void IspisiSvePreglede ( void ) const
    {
        Pregledi pp ( *this );
        while ( pp.DajBrojPregleda () != 0 )
        {
            pp.DajNajranijiPregled ().Ispisi ();
            pp.ObrisiNajranijiPregled ();
            std::cout &lt;&lt; std::endl;
        }
    }
};
/*~Pregledi*/

int main ( void )
{
    int max_br_p;
    std::cout &lt;&lt; "Unesite maksimalan broj pregleda: ";
    std::cin &gt;&gt; max_br_p;
    
    Pregledi pregledi ( max_br_p );
    int i { 0 };
    std::string p_ime;
    int p_dan, p_mjesec, p_godina;
    int p_sat, p_minut;
    
    try
    {
    while ( std::cout &lt;&lt; "Unesite ime novog pacijenta ili 'kraj' za zavrsetak unosa: " )
    {
        std::cin.clear ();
        std::cin.ignore ( 30, '\n' );
        p_ime = "";
        std::getline ( std::cin, p_ime );
        if ( p_ime == "kraj" )
            break;
        
        std::cout &lt;&lt; "Unesite dan mjesec i godinu pregleda: ";
        std::cin &gt;&gt; p_dan &gt;&gt; p_mjesec &gt;&gt; p_godina;
        
        std::cout &lt;&lt; "Unesite sate i minute pregleda: ";
        std::cin &gt;&gt; p_sat &gt;&gt; p_minut;
        
        pregledi.RegistrirajPregled ( p_ime, p_dan, p_mjesec, p_godina, p_sat, p_minut );
        if ( max_br_p == ++i )
            break;
    }
    }
    catch ( const std::exception &amp;e ) { std::cout &lt;&lt; e.what (); return 0; }
    
    std::cout &lt;&lt; "Trenutno su registrovani sljedeci pregledi\n";
    pregledi.IspisiSvePreglede ();
    
    while ( std::cout &lt;&lt; "\nOdaberite jednu od sljedecih opcija\n"
        "1 - Broj pregleda na datum\n2 - Najraniji pregled\n3 - Obrisi pregled pacijenta\n"
        "4 - Obrisi najraniji pregled\n5 - Ispisi sve pregleda na datum\n6 - Ispisi sve preglede\n"
        "7 - Kraj programa\n" )
    {
        int izbor, pre_pre { pregledi.DajBrojPregleda () };
        std::cin &gt;&gt; izbor;
        if ( izbor == 7 )
            break;
        switch ( izbor )
        {
            case 1 :
                    std::cout &lt;&lt; "Unesite dan mjesec i godinu : ";
                    std::cin &gt;&gt; p_dan &gt;&gt; p_mjesec &gt;&gt; p_godina;
                    std::cout &lt;&lt; "Broj pregleda na datum " &lt;&lt; p_dan &lt;&lt; " " &lt;&lt; p_mjesec &lt;&lt; " " &lt;&lt; p_godina &lt;&lt; " je: " &lt;&lt; 
</font><a name="2"></a><font color="#0000FF"><a href="match184-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_9.gif"/></a>

                        pregledi.DajBrojPregledaNaDatum ( Datum ( p_dan, p_mjesec, p_godina ) ) &lt;&lt; std::endl;
                break;
            case 2 :
                    std::cout &lt;&lt; "Najraniji pregled je:\n";
                    try { pregledi.DajNajranijiPregled ().Ispisi (); }
                    catch ( const std::exception &amp;e ) { std::cout &lt;&lt; e.what (); }
                    std::cout &lt;&lt; std::endl;
                break;
            case 3 :
                    std::cout &lt;&lt; "Unesite ime pacijenta: ";
                    std::cin.clear ();
                    std::cin.ignore ( 30, '\n' );
                    p_ime = "";
                    std::getline ( std::cin, p_ime );
                    pregledi.ObrisiPregledePacijenta ( p_ime );
                    std::cout &lt;&lt; "Uspjesno obrisano " &lt;&lt; pre_pre - pregledi.DajBrojPregleda () &lt;&lt; " pregleda\n";
                    i = pregledi.DajBrojPregleda ();
                break;
            case 4 :
                    try { pregledi.ObrisiNajranijiPregled (); }
                    catch ( const std::exception &amp;e ) { std::cout &lt;&lt; e.what () &lt;&lt; std::endl; continue; }
                    std::cout &lt;&lt; "Najraniji pregled uspjesno obrisan\n";
                break;
            case 5 :
                    std::cout &lt;&lt; "Unesite dan mjesec i godinu : ";
                    std::cin &gt;&gt; p_dan &gt;&gt; p_mjesec &gt;&gt; p_godina;
                    std::cout &lt;&lt; "Pregledi na datum " &lt;&lt; p_dan &lt;&lt; " " &lt;&lt; p_mjesec &lt;&lt; " " &lt;&lt; p_godina &lt;&lt; " su:\n";
                    pregledi.IspisiPregledeNaDatum ( Datum ( p_dan, p_mjesec, p_godina ) );
                    std::cout &lt;&lt; std::endl;
                break;
            case 6 :
                pregledi.IspisiSvePreglede ();
</font>        }
    }
    
    return 0;
}</pre>
</body>
</html>
