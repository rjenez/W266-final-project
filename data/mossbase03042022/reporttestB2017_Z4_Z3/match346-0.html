<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student3023.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student3023.cpp<p></p><pre>
/B2017/2018: Zadaća 4, Zadatak 3
#include &lt;iostream&gt;
#include &lt;tuple&gt;
#include &lt;iomanip&gt;
#include &lt;memory&gt;
#include &lt;vector&gt;
#include &lt;stdexcept&gt;
#include &lt;cmath&gt;
#include &lt;cctype&gt;
#include &lt;algorithm&gt;
#include &lt;utility&gt;
#include &lt;cstring&gt;
#include &lt;string&gt;
#include &lt;functional&gt;

class Datum {
int dan_pr, mjesec_pr, godina_pr;
Datum()=default;
public:
Datum(int dan, int mjesec, int godina) {
    if(dan&lt;0 || mjesec&lt;0 || mjesec&gt;12 || godina&lt;0 || godina&gt;2018) throw std::domain_error("Neispravan datum");
    if((mjesec==1 || mjesec==3 || mjesec==5 || mjesec==7 || mjesec==8 || mjesec==10 || mjesec==12) &amp;&amp; dan&gt;31) throw std::domain_error("Neispravan datum");
    if((mjesec==4 || mjesec==6 || mjesec==9 || mjesec==11) &amp;&amp; dan&gt;30) throw std::domain_error("Neispravan datum");
    if(godina%4==0 &amp;&amp; (godina%100!=0 || godina%400==0)) {
        if(mjesec==2 &amp;&amp; dan&gt;29) throw std::domain_error("Neispravan datum");
    } else {
        if(mjesec==2 &amp;&amp; dan&gt;28) throw std::domain_error("Neispravan datum");
    }
    Postavi(dan, mjesec, godina);
}
void Postavi(int dan, int mjesec, int godina) {
    if(dan&lt;0 || mjesec&lt;0 || mjesec&gt;12 || godina&lt;0 || godina&gt;2018) throw std::domain_error("Neispravan datum");
    if((mjesec==1 || mjesec==3 || mjesec==5 || mjesec==7 || mjesec==8 || mjesec==10 || mjesec==12) &amp;&amp; dan&gt;31) throw std::domain_error("Neispravan datum");
    if((mjesec==4 || mjesec==6 || mjesec==9 || mjesec==11) &amp;&amp; dan&gt;30) throw std::domain_error("Neispravan datum");
    if(godina%4==0 &amp;&amp; (godina%100!=0 || godina%400==0)) {
        if(mjesec==2 &amp;&amp; dan&gt;29) throw std::domain_error("Neispravan datum");
    } else {
        if(mjesec==2 &amp;&amp; dan&gt;28) throw std::domain_error("Neispravan datum");
    }
    dan_pr=dan;
    mjesec_pr=mjesec;
    godina_pr=godina;
}
std::tuple&lt;int, int, int&gt;Ocitaj() const {
    return std::make_tuple(dan_pr, mjesec_pr, godina_pr);
}
void Ispisi() const {std::cout &lt;&lt; DajDan() &lt;&lt; "/" &lt;&lt; DajMjesec() &lt;&lt; "/" &lt;&lt; DajGodinu() &lt;&lt; std::endl;}
int DajDan() const {return this-&gt;dan_pr;}
int DajMjesec() const {return this-&gt;mjesec_pr;}
int DajGodinu() const {return this-&gt;godina_pr;}
};

class Vrijeme {
int sati_pr, minute_pr;
public:
Vrijeme(int sati, int minute) {
    if(sati&lt;0 || minute&lt;0 || sati&gt;23 || minute&gt;59) throw std::domain_error("Neispravno vrijeme");
    Postavi(sati, minute);
}
void Postavi(int sati, int minute) {
    if(sati&lt;0 || minute&lt;0 || sati&gt;23 || minute&gt;59) throw std::domain_error("Neispravno vrijeme");
    sati_pr=sati;
    minute_pr=minute;
}
std::pair&lt;int, int&gt;Ocitaj() const {
    return std::make_pair(sati_pr, minute_pr);
}
void Ispisi() const {std::cout &lt;&lt; std::setw(2) &lt;&lt; std::setfill('0') &lt;&lt; sati_pr &lt;&lt; ":" &lt;&lt; std::setw(2) &lt;&lt; minute_pr;}
int DajSate() const {return sati_pr;}
int DajMinute() const {return minute_pr;}
};

class Pregled {
Datum d;
Vrijeme v;
std::string ime_pacijenta;
Pregled()=default;
public:
Pregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda) : d(datum_pregleda), v(vrijeme_pregleda) {
    this-&gt;ime_pacijenta=ime_pacijenta;
}
Pregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda) : d(dan_pregleda, mjesec_pregleda, godina_pregleda), v(sati_pregleda, minute_pregleda) {
    this-&gt;ime_pacijenta=ime_pacijenta;
}
void PromijeniPacijenta(const std::string &amp;ime_pacijenta) {this-&gt;ime_pacijenta=ime_pacijenta;}
void PromijeniDatum(const Datum &amp;novi_datum) {
    int d1(novi_datum.DajDan());
    int m1(novi_datum.DajMjesec());
    int g1(novi_datum.DajGodinu());
    this-&gt;d.Postavi(d1, m1, g1);
}
void PromijeniVrijeme(const Vrijeme &amp;novo_vrijeme) {
    int s1(novo_vrijeme.DajSate());
    int m1(novo_vrijeme.DajMinute());
    this-&gt;v.Postavi(s1, m1);
}
void PomjeriDanUnaprijed() {
    int broj_dana[]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    int temp=d.DajDan();
    int temp1=d.DajMjesec();
    int temp2=d.DajGodinu();
    if(temp2==0 &amp;&amp; (temp2%100!=0 || temp2%400==0)) broj_dana[1]++;
    temp++;
    if(temp&gt;broj_dana[temp1-1]) temp=1; temp1++;
    if(temp1&gt;12) temp1=1; temp2++;
    this-&gt;d.Postavi(temp,temp1,temp2);
}
void PomjeriDanUnazad() {
    int broj_dana[]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    int temp=d.DajDan();
    int temp1=d.DajMjesec();
    int temp2=d.DajGodinu();
    if(temp2==0 &amp;&amp; (temp2%100!=0 || temp2%400==0)) broj_dana[1]++;
    temp--;
    if(temp&lt;1) temp1--;
    if(temp1&lt;1) temp1=12; temp=broj_dana[temp1-1]; temp2--;
    this-&gt;d.Postavi(temp,temp1,temp2);
}
std::string DajImePacijenta() const {return this-&gt;ime_pacijenta;}
Datum DajDatumPregleda() const {return this-&gt;d;}
Vrijeme DajVrijemePregleda() const {return this-&gt;v;}
static bool DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2);
void Ispisi() const {
    std::cout &lt;&lt; std::setw(30) &lt;&lt; std::left &lt;&lt; ime_pacijenta;
    d.Ispisi();
    std::cout &lt;&lt; " ";
    v.Ispisi();
    std::cout &lt;&lt; std::endl;
}
};

bool Pregled::DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2) {
    if(p1.d.DajGodinu()&lt;p2.d.DajGodinu()) return true;
    else return false;
    if(p1.d.DajMjesec()&lt;p2.d.DajMjesec()) return true;
    else return false;
    if(p1.d.DajDan()&lt;p2.d.DajDan()) return true;
    else return false;
    if(p1.v.DajSate()&lt;p2.v.DajSate()) return true;
    else return false;
    if(p1.v.DajMinute()&lt;p2.v.DajMinute()) return true;
    else return false;
    
    return false;
}

class Pregledi {
int broj_pregleda;
int silos;
Pregled **pregledi{};
Pregledi()=default;
void AlocirajNiz(int br) {
    pregledi=nullptr;
    try {
        pregledi=new Pregled*[br];
    }catch(...) {
        IsprazniKolekciju();
        throw;
    }
}
public:
explicit Pregledi(int max_broj_pregleda) : broj_pregleda(0), silos(max_broj_pregleda) {AlocirajNiz(silos);}
Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda) : broj_pregleda(spisak_pregleda.size()), silos(spisak_pregleda.size()) {
    int brojac=0;
    try {
        pregledi=new Pregled*[broj_pregleda];
        for(int i=0; i&lt;broj_pregleda; i++) pregledi[i]=nullptr;
        for(auto &amp;i : spisak_pregleda) pregledi[brojac++]=new Pregled(i);
    }catch(...){
        IsprazniKolekciju();
        throw;
    }
}
~Pregledi() {
<a name="8"></a><font color="#00FFFF"><a href="match346-1.html#8" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

    for(int i=0; i&lt;silos; i++) delete pregledi[i];
    delete[] pregledi;
}
Pregledi(const Pregledi &amp;pregledi) : broj_pregleda(pregledi.broj_pregleda), silos(pregledi.silos) {
</font><a name="9"></a><font color="#FF00FF"><a href="match346-1.html#9" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

    AlocirajNiz(silos);
    try {
        for(int i=0; i&lt;broj_pregleda; i++) this-&gt;pregledi[i]=new Pregled(*pregledi.pregledi[i]);
</font>    }catch(...) {
        IsprazniKolekciju();
        throw;
    }
}
Pregledi(Pregledi &amp;&amp;pregledi) : broj_pregleda(pregledi.broj_pregleda), silos(pregledi.silos) {
<a name="7"></a><font color="#0000FF"><a href="match346-1.html#7" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

    this-&gt;pregledi=pregledi.pregledi;
    pregledi.pregledi=nullptr;
}
Pregledi &amp;operator =(const Pregledi &amp;pregledi) {
    if(silos!=pregledi.silos) throw std::logic_error("Nesaglasne liste pregleda");
    if(&amp;pregledi==this) return *this;
</font>    
    try {
        for(int i=0; i&lt;silos; i++) this-&gt;pregledi[i]=new Pregled(*pregledi.pregledi[i]);
    }catch(...) {
        IsprazniKolekciju();
        throw;
    }
}
<a name="10"></a><font color="#FF0000"><a href="match346-1.html#10" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_0.gif"/></a>

Pregledi &amp;operator =(Pregledi &amp;&amp;pregledi) {
    if(silos!=pregledi.silos) throw std::logic_error("Nesaglasne liste pregleda");
    if(&amp;pregledi==this) return *this;
    
    this-&gt;pregledi=pregledi.pregledi;
</font>    broj_pregleda=pregledi.broj_pregleda;
<a name="0"></a><font color="#FF0000"><a href="match346-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_4.gif"/></a>

    pregledi.pregledi=nullptr;
}
void RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda) {
    if(broj_pregleda==silos) throw std::range_error("“Dostignut maksimalni broj pregleda");
    try {
        pregledi[broj_pregleda++]=new Pregled(ime_pacijenta, datum_pregleda, vrijeme_pregleda);
    }catch(std::bad_alloc) {
        broj_pregleda--;
        throw std::logic_error("Nema dovoljno memorije!");
    }catch(...) {
        broj_pregleda--;
        throw;
    }
}
void RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda) {
    if(broj_pregleda==silos) throw std::range_error("“Dostignut maksimalni broj pregleda");
    try {
        pregledi[broj_pregleda++]=new Pregled(ime_pacijenta, dan_pregleda, mjesec_pregleda, godina_pregleda, sati_pregleda, minute_pregleda);
    }catch(std::bad_alloc) {
        broj_pregleda--;
        throw std::logic_error("Nema dovoljno memorije!");
    }catch(...) {
        broj_pregleda--;
        throw;
</font>    }
}
void RegistrirajPregled(Pregled *pregled) {
     if(broj_pregleda==silos) throw std::range_error("“Dostignut maksimalni broj pregleda");
     try {
         pregledi[broj_pregleda++]=pregled;
     }catch(std::bad_alloc) {
        broj_pregleda--;
        throw std::logic_error("Nema dovoljno memorije!");
    }catch(...) {
        broj_pregleda--;
        throw;
    }
}
int DajBrojPregleda() const {
    if(broj_pregleda==0) throw std::domain_error("Nema registriranih pregleda");
    return broj_pregleda;
}
<a name="1"></a><font color="#00FF00"><a href="match346-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_2.gif"/></a>

int DajBrojPregledaNaDatum(const Datum &amp;datum) const {
    if(broj_pregleda==0) throw std::domain_error("Nema registriranih pregleda");
    return std::count_if(pregledi, pregledi+broj_pregleda, [&amp;](Pregled *pregled) {
        return (pregled-&gt;DajDatumPregleda().DajDan()==datum.DajDan() &amp;&amp; pregled-&gt;DajDatumPregleda().DajMjesec()==datum.DajMjesec() &amp;&amp; pregled-&gt;DajDatumPregleda().DajGodinu()==datum.DajGodinu());
    });
}
Pregled &amp;DajNajranijiPregled();
</font><a name="11"></a><font color="#00FF00"><a href="match346-1.html#11" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_0.gif"/></a>

Pregled DajNajranijiPregled() const;
void IsprazniKolekciju() {
    if(pregledi==nullptr) return;
    for(int i=0; i&lt;broj_pregleda; i++) delete pregledi[i];
    delete[] pregledi;
</font>}
void ObrisiNajranijiPregled() {
<a name="4"></a><font color="#FF00FF"><a href="match346-1.html#4" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

    if(broj_pregleda==0) throw std::range_error("Prazna kolekcija");
    Pregled pregled=Pregledi::DajNajranijiPregled();
    Pregledi temp_pregledi = Pregledi(silos);
    int brojac=0;
    for (int i=0; i&lt;broj_pregleda; i++) {
        auto a=pregledi[i];
        if (a-&gt;DajImePacijenta()==pregled.DajImePacijenta() &amp;&amp; a-&gt;DajDatumPregleda().DajDan()==pregled.DajDatumPregleda().DajDan() &amp;&amp; a-&gt;DajDatumPregleda().DajMjesec()==pregled.DajDatumPregleda().DajMjesec() &amp;&amp; a-&gt;DajDatumPregleda().DajGodinu()==pregled.DajDatumPregleda().DajGodinu() &amp;&amp; a-&gt;DajVrijemePregleda().DajSate()==pregled.DajVrijemePregleda().DajSate() &amp;&amp; pregled.DajVrijemePregleda().DajMinute() == pregled.DajVrijemePregleda().DajMinute()) continue;
</font><a name="12"></a><font color="#0000FF"><a href="match346-1.html#12" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_0.gif"/></a>

        temp_pregledi.pregledi[brojac++] = pregledi[i];
    }
    std::copy(temp_pregledi.pregledi, temp_pregledi.pregledi+silos, pregledi);
    broj_pregleda--;
</font>}
<a name="6"></a><font color="#00FF00"><a href="match346-1.html#6" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

void ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta) {
    if(broj_pregleda==0) std::range_error("Prazna kolekcija");
    Pregledi temp=Pregledi(silos);
    int brojac=0;
    for(int i=0; i&lt;broj_pregleda; i++) {
        if(pregledi[i]-&gt;DajImePacijenta()==ime_pacijenta) continue;
</font><a name="13"></a><font color="#00FFFF"><a href="match346-1.html#13" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_0.gif"/></a>

        temp.pregledi[brojac++]=pregledi[i];
    }
    broj_pregleda=brojac;
    std::copy(temp.pregledi, temp.pregledi+silos, pregledi);
</font>}
void IspisiPregledeNaDatum(const Datum &amp;datum) const {
    bool ima_pregleda(false);
<a name="5"></a><font color="#FF0000"><a href="match346-1.html#5" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

    for(int i = 0; i &lt; broj_pregleda; i++) {
        if(pregledi[i]-&gt;DajDatumPregleda().DajDan() == datum.DajDan() &amp;&amp; pregledi[i]-&gt;DajDatumPregleda().DajMjesec() == datum.DajMjesec() &amp;&amp; pregledi[i]-&gt;DajDatumPregleda().DajGodinu() == datum.DajGodinu()) {
</font>            (*pregledi[i]).Ispisi();
            std::cout &lt;&lt; std::endl;
            ima_pregleda = true;
        }
    }
    if(!ima_pregleda) throw std::domain_error("Nema pregleda na traženi dan!\n"); 
}
void IspisiSvePreglede() const {
    bool ima_pregleda(false);
    for(int i = 0; i &lt; broj_pregleda; i++) {
        (*pregledi[i]).Ispisi();
        std::cout &lt;&lt; std::endl;
        ima_pregleda = true;
    }
    if(!ima_pregleda) throw "Nema pregleda!\n"; 
}

};

<a name="2"></a><font color="#0000FF"><a href="match346-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

Pregled &amp;Pregledi::DajNajranijiPregled() {
    if(broj_pregleda==0) throw std::domain_error("Nema registriranih pregleda");
    Pregled *najraniji(pregledi[0]);
    for(int i = 1; i &lt; broj_pregleda; i++) {
        if(Pregled::DolaziPrije(*pregledi[i], *najraniji)) najraniji = pregledi[i];
    }
    return *najraniji;
}
Pregled Pregledi::DajNajranijiPregled() const {
</font><a name="3"></a><font color="#00FFFF"><a href="match346-1.html#3" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

    if(broj_pregleda==0) throw std::domain_error("Nema registriranih pregleda");
    Pregled *najraniji(pregledi[0]);
    for(int i = 1; i &lt; broj_pregleda; i++) {
        if(Pregled::DolaziPrije(*pregledi[i], *najraniji)) najraniji = pregledi[i];
    }
    return *najraniji;
</font>}

int main () {
    std::cout &lt;&lt; "Unesite maksimalan broj pregleda: ";
    int max_broj;
    std::cin &gt;&gt; max_broj;
    int d,m,g;
    int h,m1;
    std::vector&lt;std::shared_ptr&lt;Pregled&gt;&gt;pregledi;
    pregledi.resize(max_broj);
    try {
        std::cout &lt;&lt; "Unesite ime novog pacijenta ili 'kraj' za zavrsetak unosa: ";
        while(1) {
            int a=0;
            std::string ime;
            std::getline(std::cin, ime);
            int test=0;
            for(int i=0; i&lt;ime.length(); i++) {
                if(ime.length()!=4) break;  
                if(ime[0]=='k') 
                    if(ime[1]=='r')
                        if(ime[2]=='a')
                            if(ime[3]=='j')
                                test=1; break;
            }
            if(test) break;
            else {
                std::cout &lt;&lt; "Unesite dan mjesec i godinu pregleda: ";
                std::cin &gt;&gt; d &gt;&gt; m &gt;&gt; g;
                std::cout &lt;&lt; "Unesite sate i minute: ";
                std::cin &gt;&gt; h &gt;&gt; m1;
                try {
                    pregledi[a++]=new Pregled(ime, Datum(d,m,g), Vrijeme(h,m1));
                }catch(...) {
                    std::cout &lt;&lt; "Nedovoljno memorije!";
                    a--;
                }
            }
        }
        std::cout &lt;&lt; "Unesite jednu od sljedecih opcija " &lt;&lt; std::endl;
        std::cout &lt;&lt; "1 - Broj pregleda na datum " &lt;&lt; std::endl;
        std::cout &lt;&lt; "2 - Najraniji pregled " &lt;&lt; std::endl;
        std::cout &lt;&lt; "3 - Obrisi pregled pacijenta " &lt;&lt; std::endl;
        std::cout &lt;&lt; "4 - Obrisi najraniji pregled " &lt;&lt; std::endl;
        std::cout &lt;&lt; "5 - Ispisi sve pregleda na datum " &lt;&lt; std::endl;
        std::cout &lt;&lt; "6 - Ispisi sve preglede " &lt;&lt; std::endl;
        std::cout &lt;&lt; "7 - Kraj programa " &lt;&lt; std::endl;
        for(;;) {   
            Datum datum1();
            int opcija, broj;
            std::cin &gt;&gt; opcija;
            switch(opcija) {
                case 1:
                    std::cout &lt;&lt; "Unesite dan mjesec i godinu : ";
                    int a1, b1, c1;
                    std::cin &gt;&gt; a1 &gt;&gt; b1 &gt;&gt; c1;
                    datum1.Postavi(a1, b1, c1);
                    broj=pregled1.DajBrojPregledaNaDatum(datum1);
                    std::cout &lt;&lt; "Broj pregleda na datum " &lt;&lt; a1 &lt;&lt; " " &lt;&lt; b1 &lt;&lt; " " &lt;&lt; c1 &lt;&lt; " je: " &lt;&lt; broj &lt;&lt; std::endl;
                    break;
                        
                case 2:
                    std::cout &lt;&lt; std::endl;
                    break;
                
                case 3: 
                    std::cout &lt;&lt; std::endl;
                    break;
                
                case 4:
                    std::cout &lt;&lt; "Najraniji pregled uspjesno obrisan" &lt;&lt; std::endl;
                    break;
                        
                case 5:
                    int a3, b3, c3; 

                    std::cout &lt;&lt; std::endl;
                    break;
                
                case 6:
                    std::cout &lt;&lt; std::endl;
                    break;
                
                case 7:
                    return 0;
                default:
                    break;
            }catch(std::domain_error jedan) {
                std::cout &lt;&lt; jedan.what() &lt;&lt; std::endl;
            }catch(std::range_error dva) {
                std::cout &lt;&lt; dva.what() &lt;&lt; std::endl;
            }catch(std::logic_error tri) {
                std::cout &lt;&lt; tri.what() &lt;&lt; std::endl;
            }catch(std::bad_alloc) {
                std::cout &lt;&lt; "Nedovoljno memorije!" &lt;&lt; std::endl;
                return 0;
            } 
        }
    }
	return 0;
}    
</pre>
</body>
</html>
