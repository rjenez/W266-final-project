<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student5162.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student5162.cpp<p></p><pre>
<a name="4"></a><font color="#FF00FF"><a href="match155-1.html#4" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

/B2017/2018: ZadaÄ‡a 4, Zadatak 3
#include &lt;iostream&gt;
#include &lt;tuple&gt;
#include &lt;stdexcept&gt;
#include &lt;algorithm&gt;
#include &lt;iomanip&gt;
#include &lt;initializer_list&gt;
#include &lt;string&gt;
#include &lt;new&gt;
#include &lt;vector&gt;
#include &lt;memory&gt;
#include &lt;utility&gt;

class Datum{
    int dan,mjesec,godina;
    void Testiraj_datum(int dan, int mjesec, int godina){
        int broj_dana[12]{31,28,31,30,31,30,31,31,30,31,30,31};
</font>        if((godina%4==0 &amp;&amp; godina%100!=0) || godina%400==0) broj_dana[1]++;
<a name="2"></a><font color="#0000FF"><a href="match155-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_12.gif"/></a>

        if(godina&lt;1||dan&lt;1 ||mjesec&lt;1 ||mjesec&gt;12 || dan&gt;broj_dana[mjesec-1])
        throw std::domain_error("Neispravan datum!");
    }
public:
    Datum(int dan, int mjesec, int godina){
        try{
        Testiraj_datum(dan,mjesec,godina);
        }catch(...){
            throw;
        }
        Datum::dan=dan; Datum::mjesec=mjesec; Datum::godina=godina;
    }
    void Postavi(int dan, int mjesec, int godina){
        try{
        Testiraj_datum(dan,mjesec,godina);
        }catch(...){
            throw;
        }
        Datum::dan=dan; Datum::mjesec=mjesec; Datum::godina=godina;
    }
    std::tuple&lt;int,int,int&gt; Ocitaj() const{ return std::make_tuple(dan,mjesec,godina);}
    void Ispisi() const{ std::cout&lt;&lt;dan&lt;&lt;"/"&lt;&lt;mjesec&lt;&lt;"/"&lt;&lt;godina;}
};
class Vrijeme{
    int sati,minute;
    void Testiraj_vrijeme(int sati, int minute){
        if(sati&lt;0 || sati&gt;23 || minute&lt;0 || minute&gt;59) throw std::domain_error("Neispravno vrijeme!");
    }
public:
    Vrijeme(int sati,int minute){
        try{
        Testiraj_vrijeme(sati,minute);
        }catch(...){
            throw;
        }
        Vrijeme::sati=sati; Vrijeme::minute=minute;
    }
    void Postavi(int sati,int minute){
        try{
        Testiraj_vrijeme(sati,minute);
        }catch(...){
            throw;
        }
        Vrijeme::sati=sati; Vrijeme::minute=minute;
    }
    std::pair&lt;int,int&gt; Ocitaj() const{return std::make_pair(sati,minute);}
    void Ispisi() const{ if(sati/10==0) std::cout&lt;&lt;"0"&lt;&lt;sati&lt;&lt;":"; else std::cout&lt;&lt;sati&lt;&lt;":"; if(minute/10==0) std::cout&lt;&lt;"0"&lt;&lt;minute&lt;&lt;std::endl; else std::cout&lt;&lt;minute;}
};
class Pregled{
    std::string ime_pacijenta;
    Datum datum_pregleda;
    Vrijeme vrijeme_pregleda;
public:
    Pregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda,const Vrijeme &amp;vrijeme_pregleda): ime_pacijenta(ime_pacijenta), datum_pregleda(datum_pregleda), vrijeme_pregleda(vrijeme_pregleda) {}
</font><a name="1"></a><font color="#00FF00"><a href="match155-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_20.gif"/></a>

    Pregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda,int godina_pregleda, int sati_pregleda, int minute_pregleda): ime_pacijenta(ime_pacijenta),
    datum_pregleda(Datum(dan_pregleda,mjesec_pregleda,godina_pregleda)), vrijeme_pregleda(Vrijeme(sati_pregleda,minute_pregleda)){}
    void PromijeniPacijenta(const std::string &amp;ime_pacijenta){
        Pregled::ime_pacijenta=ime_pacijenta;
    }
    void PromijeniDatum(const Datum &amp;novi_datum){
        Pregled::datum_pregleda=novi_datum;
    }
    void PromijeniVrijeme(const Vrijeme &amp;novo_vrijeme){
        Pregled::vrijeme_pregleda=novo_vrijeme;
    }
    void PomjeriDanUnaprijed();
    void PomjeriDanUnazad();
    std::string DajImePacijenta() const{return ime_pacijenta;}
    Datum DajDatumPregleda() const{return datum_pregleda;}
    Vrijeme DajVrijemePregleda() const{return vrijeme_pregleda;}
    static bool DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2);
    void Ispisi() const;

};
void Pregled::PomjeriDanUnaprijed(){
    int broj_dana[12]{31,28,31,30,31,30,31,31,30,31,30,31};
    std::tuple&lt;int,int,int&gt; pomocni(datum_pregleda.Ocitaj());
    if((std::get&lt;2&gt;(pomocni)%4==0 &amp;&amp; std::get&lt;2&gt;(pomocni)%100!=0) || std::get&lt;2&gt;(pomocni)%400==0) broj_dana[1]++;
    std::get&lt;0&gt;(pomocni)++;
    if(std::get&lt;0&gt;(pomocni)&gt;broj_dana[std::get&lt;1&gt;(pomocni)-1]){
        std::get&lt;0&gt;(pomocni)=1;
        std::get&lt;1&gt;(pomocni)++;
        if(std::get&lt;1&gt;(pomocni)&gt;12){
            std::get&lt;1&gt;(pomocni)=1;
            std::get&lt;2&gt;(pomocni)++;
        }
    }
    PromijeniDatum(Datum(std::get&lt;0&gt;(pomocni),std::get&lt;1&gt;(pomocni), std::get&lt;2&gt;(pomocni)));
}
void Pregled::PomjeriDanUnazad(){
    int broj_dana[12]{31,28,31,30,31,30,31,31,30,31,30,31};
    std::tuple&lt;int,int,int&gt; pomocni(datum_pregleda.Ocitaj());
    if((std::get&lt;2&gt;(pomocni)%4==0 &amp;&amp; std::get&lt;2&gt;(pomocni)%100!=0) || std::get&lt;2&gt;(pomocni)%400==0) broj_dana[1]++;
    std::get&lt;0&gt;(pomocni)--;
    if(std::get&lt;0&gt;(pomocni)&lt;1){
        std::get&lt;1&gt;(pomocni)--;
        if(std::get&lt;1&gt;(pomocni)&lt;1){
            std::get&lt;1&gt;(pomocni)=12;
            std::get&lt;2&gt;(pomocni)--;
        }
        std::get&lt;0&gt;(pomocni)=broj_dana[std::get&lt;1&gt;(pomocni)-1];
    }
    PromijeniDatum(Datum(std::get&lt;0&gt;(pomocni),std::get&lt;1&gt;(pomocni), std::get&lt;2&gt;(pomocni)));
}
bool Pregled::DolaziPrije(const Pregled &amp;p1,const Pregled &amp;p2){
    std::tuple&lt;int,int,int&gt; prvi(p1.datum_pregleda.Ocitaj()), drugi(p2.datum_pregleda.Ocitaj());
    std::pair&lt;int,int&gt; prvo(p1.vrijeme_pregleda.Ocitaj()), drugo(p2.vrijeme_pregleda.Ocitaj());
    if(std::get&lt;2&gt;(prvi)&gt;std::get&lt;2&gt;(drugi)) return false;
    else if(std::get&lt;2&gt;(prvi)==std::get&lt;2&gt;(drugi)){
</font>        if(std::get&lt;1&gt;(prvi)&gt;std::get&lt;1&gt;(drugi)) return false;
        else if(std::get&lt;1&gt;(prvi)==std::get&lt;1&gt;(drugi)){
<a name="3"></a><font color="#00FFFF"><a href="match155-1.html#3" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_11.gif"/></a>

            if(std::get&lt;0&gt;(prvi)&gt;std::get&lt;0&gt;(drugi)) return false;
            else if(std::get&lt;0&gt;(prvi)==std::get&lt;0&gt;(drugi)){
                if(prvo.first&gt;drugo.first) return false;
                else if(prvo.first==drugo.first){
                    if(prvo.second&gt;drugo.second) return false;
                    else return true;
                }
            }
        }
    }
    return true;
}
void Pregled::Ispisi() const{
    std::cout&lt;&lt;std::left&lt;&lt;std::setw(30)&lt;&lt;ime_pacijenta;
    datum_pregleda.Ispisi();
    std::cout&lt;&lt;" ";
    vrijeme_pregleda.Ispisi();
    std::cout&lt;&lt;"\n";
}
class Pregledi{
    const int max_broj_pregleda;
    int broj_pregleda;
    Pregled** izvrseni_pregledi;
public:
    explicit Pregledi(int max_broj_pregleda): max_broj_pregleda(max_broj_pregleda), broj_pregleda(0), izvrseni_pregledi(new Pregled*[max_broj_pregleda]{}) {}
    Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda): max_broj_pregleda(spisak_pregleda.size()), broj_pregleda(spisak_pregleda.size()), izvrseni_pregledi(new Pregled*[spisak_pregleda.size()]{}) {
        int i(0);
        for(auto it(spisak_pregleda.begin()); it!=spisak_pregleda.end(); it++){
            izvrseni_pregledi[i]=new Pregled(*it);
            i++;
        }
    }
    ~Pregledi(){
        for(int i(0); i&lt;broj_pregleda; i++) delete izvrseni_pregledi[i];
        delete[] izvrseni_pregledi;
    }
    Pregledi(const Pregledi &amp;pregledi): max_broj_pregleda(pregledi.max_broj_pregleda), broj_pregleda(pregledi.broj_pregleda), izvrseni_pregledi(new Pregled*[pregledi.max_broj_pregleda]{}) {
        for(int i(0); i&lt;pregledi.broj_pregleda; i++) 
        izvrseni_pregledi[i]=new Pregled(*pregledi.izvrseni_pregledi[i]);
    }
    Pregledi(Pregledi &amp;&amp;pregledi): max_broj_pregleda(pregledi.max_broj_pregleda), broj_pregleda(pregledi.broj_pregleda), izvrseni_pregledi(pregledi.izvrseni_pregledi) {
        pregledi.izvrseni_pregledi=nullptr;
        pregledi.broj_pregleda=0;
    }
    Pregledi &amp;operator =(const Pregledi &amp;pregledi);
    Pregledi &amp;operator =(Pregledi &amp;&amp;pregledi);
    void RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda);
</font>    void RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda,int minute_pregleda);
    void RegistrirajPregled(Pregled *pregled);
    int DajBrojPregleda() const{return broj_pregleda;}
    int DajBrojPregledaNaDatum(const Datum &amp;datum) const;
    Pregled &amp;DajNajranijiPregled();
<a name="0"></a><font color="#FF0000"><a href="match155-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_45.gif"/></a>

    Pregled DajNajranijiPregled() const;
    void IsprazniKolekciju();
    void ObrisiNajranijiPregled();
    void ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta);
    void IspisiPregledeNaDatum(const Datum &amp;datum) const;
    void IspisiSvePreglede() const;
};
Pregledi &amp;Pregledi::operator =(const Pregledi &amp;pregledi){
            Pregled** pregledi2(new Pregled*[pregledi.max_broj_pregleda]);
            for(int i(0); i&lt;pregledi.broj_pregleda; i++)
                pregledi2[i]=new Pregled(*pregledi.izvrseni_pregledi[i]);
            
            for(int i(0); i&lt;broj_pregleda; i++)
                delete izvrseni_pregledi[i];
            delete[] izvrseni_pregledi;
            broj_pregleda=pregledi.broj_pregleda;
            izvrseni_pregledi=pregledi2;
        return *this;
    }
Pregledi &amp;Pregledi::operator=(Pregledi &amp;&amp;pregledi){
    if(&amp;pregledi!=this){
    std::swap(broj_pregleda,pregledi.broj_pregleda);
    std::swap(izvrseni_pregledi,pregledi.izvrseni_pregledi);
    }
    return *this;
}
void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda) {
    if(broj_pregleda&gt;=max_broj_pregleda) throw std::range_error("Dostignut maksimalni broj pregleda");
    izvrseni_pregledi[broj_pregleda]=new Pregled(Pregled(ime_pacijenta,datum_pregleda,vrijeme_pregleda));
    broj_pregleda++;
}
void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda,int minute_pregleda) {
    if(broj_pregleda&gt;=max_broj_pregleda) throw std::range_error("Dostignut maksimalni broj pregleda");
    izvrseni_pregledi[broj_pregleda]=new Pregled(Pregled(ime_pacijenta,dan_pregleda,mjesec_pregleda,godina_pregleda,sati_pregleda,minute_pregleda));
    broj_pregleda++;
}
void Pregledi::RegistrirajPregled(Pregled *pregled){
    if(broj_pregleda&gt;=max_broj_pregleda) throw std::range_error("Dostignut maksimalni broj pregleda");
    izvrseni_pregledi[broj_pregleda]=new Pregled(*pregled);
    broj_pregleda++;
}
int Pregledi::DajBrojPregledaNaDatum(const Datum &amp;datum) const{
    int konacni(0);
    konacni=std::count_if(izvrseni_pregledi, izvrseni_pregledi+broj_pregleda, [datum] (Pregled* pregledi) {return pregledi-&gt;DajDatumPregleda().Ocitaj()==datum.Ocitaj();});
    return konacni;
}
Pregled &amp;Pregledi::DajNajranijiPregled(){
    auto it(std::min_element(izvrseni_pregledi, izvrseni_pregledi+broj_pregleda, [] (Pregled* p1,Pregled*p2) {return Pregled::DolaziPrije(*p1,*p2);}));
    if(it==izvrseni_pregledi+broj_pregleda) throw std::domain_error("Nema registriranih pregleda");
    return **it;
}
Pregled Pregledi::DajNajranijiPregled() const{
    auto it(std::min_element(izvrseni_pregledi, izvrseni_pregledi+broj_pregleda, [] (Pregled* p1,Pregled*p2) {return Pregled::DolaziPrije(*p1,*p2);}));
    if(it==izvrseni_pregledi+broj_pregleda) throw std::domain_error("Nema registriranih pregleda");
    return **it;
}
void Pregledi::IsprazniKolekciju(){
    for(int i(0); i&lt;broj_pregleda; i++){
        delete izvrseni_pregledi[i];
        izvrseni_pregledi[i]=nullptr;
    }
    broj_pregleda=0;
}
void Pregledi::ObrisiNajranijiPregled(){
    if(broj_pregleda==0) throw std::range_error("Prazna kolekcija");
    auto it(std::min_element(izvrseni_pregledi, izvrseni_pregledi+broj_pregleda, [] (Pregled* p1,Pregled*p2) { return Pregled::DolaziPrije(*p1,*p2);}));
    if(it==izvrseni_pregledi+broj_pregleda) throw std::domain_error("Nema registriranih pregleda");
    delete *it;
    for(auto it2(it); it2!=izvrseni_pregledi+broj_pregleda-1; it2++){
        std::swap(*it2,*(it2+1));
    }
    broj_pregleda--;
}
void Pregledi::ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta) {
    if(broj_pregleda==0) throw std::range_error("Prazna kolekcija");
    for(int i(0); i&lt;broj_pregleda; i++){
        if(ime_pacijenta==izvrseni_pregledi[i]-&gt;DajImePacijenta()){
            delete izvrseni_pregledi[i];
            for(auto it2(&amp;izvrseni_pregledi[i]); it2!=izvrseni_pregledi+broj_pregleda-1; it2++) std::swap(*it2,*(it2+1));
            broj_pregleda--;
            i--;
        }
    }
}
void Pregledi::IspisiPregledeNaDatum(const Datum &amp;datum) const{
    std::vector&lt;Pregled*&gt; vektor;
    for(int i(0); i&lt;broj_pregleda; i++){
        if(izvrseni_pregledi[i]-&gt;DajDatumPregleda().Ocitaj()==datum.Ocitaj()) vektor.push_back(izvrseni_pregledi[i]);
    }
    std::sort(vektor.begin(),vektor.end(), [](Pregled* p1,Pregled* p2) {return p1-&gt;DajVrijemePregleda().Ocitaj()&gt;p2-&gt;DajVrijemePregleda().Ocitaj();});
    for(auto it(vektor.begin()); it!=vektor.end(); it++)
        (*it)-&gt;Ispisi();
}
void Pregledi::IspisiSvePreglede() const{
    Pregledi novi_pregledi(*this);
    if(broj_pregleda==1) izvrseni_pregledi[0]-&gt;Ispisi();
    else{
    std::sort(novi_pregledi.izvrseni_pregledi,novi_pregledi.izvrseni_pregledi+broj_pregleda,[](Pregled* p1, Pregled*p2) {return Pregled::DolaziPrije(*p1,*p2);});
    for(int i(0); i&lt;novi_pregledi.broj_pregleda; i++){
        novi_pregledi.izvrseni_pregledi[i]-&gt;Ispisi();
    }
    }
}
int main ()
{
    int max_broj_pregleda;
    std::cout&lt;&lt;"Unesite maksimalan broj pregleda: ";
    std::cin&gt;&gt;max_broj_pregleda;
    Pregledi svi_pregledi(max_broj_pregleda);
    for(int i(0); i&lt;max_broj_pregleda; i++){
        std::cin.ignore(10000,'\n');
        std::string s;
        std::cout&lt;&lt;"Unesite ime novog pacijenta ili 'kraj' za zavrsetak unosa: ";
        std::getline(std::cin,s);
        if(s=="kraj") break;
        int dan,mjesec,godina;
        std::cout&lt;&lt;"Unesite dan mjesec i godinu pregleda: ";
        std::cin&gt;&gt;dan&gt;&gt;mjesec&gt;&gt;godina;
        int sati,minute;
        std::cout&lt;&lt;"Unesite sate i minute pregleda: ";
        std::cin&gt;&gt;sati&gt;&gt;minute;
        try{
        svi_pregledi.RegistrirajPregled(s,dan,mjesec,godina,sati,minute);
        }catch(std::domain_error domena){
            std::cout&lt;&lt;domena.what()&lt;&lt;std::endl;
            i--;
        }
    }
    int opcija;
    std::cout&lt;&lt;"Trenutno su registrovani sljedeci pregledi\n";
    svi_pregledi.IspisiSvePreglede();
    do{
    std::cout&lt;&lt;"\nOdaberite jednu od sljedecih opcija\n1 - Broj pregleda na datum\n2 - Najraniji pregled\n3 - Obrisi pregled pacijenta\n4 - Obrisi najraniji pregled\n5 - Ispisi sve pregleda na datum\n6 - Ispisi sve preglede\n7 - Kraj programa\n";
    std::cin&gt;&gt;opcija;
    if(opcija==1){
        int d,m,g;
        std::cout&lt;&lt;"Unesite dan mjesec i godinu : ";
        std::cin&gt;&gt;d&gt;&gt;m&gt;&gt;g;
        std::cout&lt;&lt;"Broj pregleda na datum "&lt;&lt;d&lt;&lt;" "&lt;&lt;m&lt;&lt;" "&lt;&lt;g&lt;&lt;" je: "&lt;&lt;svi_pregledi.DajBrojPregledaNaDatum(Datum(d,m,g))&lt;&lt;std::endl;
    }
    else if(opcija==2){
        std::cout&lt;&lt;"Najraniji pregled je:\n";
        svi_pregledi.IspisiPregledeNaDatum(svi_pregledi.DajNajranijiPregled().DajDatumPregleda());
        std::cout&lt;&lt;std::endl;
    }
    else if(opcija==3){
        int broj_pregleda(svi_pregledi.DajBrojPregleda());
        std::string s;
        std::cin.ignore(10000,'\n');
        std::cout&lt;&lt;"Unesite ime pacijenta: ";
        std::getline(std::cin,s);
        try{
        svi_pregledi.ObrisiPregledePacijenta(s);
        }catch(std::range_error rang){
            std::cout&lt;&lt;rang.what()&lt;&lt;std::endl;
        }
        std::cout&lt;&lt;"Uspjesno obrisano "&lt;&lt;broj_pregleda-svi_pregledi.DajBrojPregleda()&lt;&lt;" pregleda"&lt;&lt;std::endl;
    }
    else if(opcija==4){
        try{
        svi_pregledi.ObrisiNajranijiPregled();
        }catch(std::range_error rang){
            std::cout&lt;&lt;rang.what()&lt;&lt;std::endl;
        }catch(std::domain_error domena){
            std::cout&lt;&lt;domena.what()&lt;&lt;std::endl;
        }
        std::cout&lt;&lt;"Najraniji pregled uspjesno obrisan"&lt;&lt;std::endl;
    }
    else if(opcija==5){
        int d,m,g;
        std::cout&lt;&lt;"Unesite dan mjesec i godinu : ";
        std::cin&gt;&gt;d&gt;&gt;m&gt;&gt;g;
        std::cout&lt;&lt;"Pregledi na datum "&lt;&lt;d&lt;&lt;" "&lt;&lt;m&lt;&lt;" "&lt;&lt;g&lt;&lt;" su: \n";
        svi_pregledi.IspisiPregledeNaDatum(Datum(d,m,g));
        std::cout&lt;&lt;std::endl;
    }
    else if(opcija==6){
        svi_pregledi.IspisiSvePreglede();
        std::cout&lt;&lt;std::endl;
    }
    }while(opcija!=7);
	return 0;
</font>}
</pre>
</body>
</html>
