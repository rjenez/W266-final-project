<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student6363.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student6363.cpp<p></p><pre>
#include &lt;iostream&gt;
#include &lt;stdexcept&gt;
#include &lt;exception&gt;
#include &lt;tuple&gt;
#include &lt;vector&gt;
#include &lt;string&gt;
#include &lt;iomanip&gt;
#include &lt;algorithm&gt;
<a name="1"></a><font color="#00FF00"><a href="match217-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_18.gif"/></a>

using std::cout;
using std::cin;
using std::endl;
using std::string;
using std::vector;

class Datum
{
    int dan,mjesec,godina;
    static int BrojDana (int mjesec, int godina) {
        int BrojDana[12]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
        if ((godina%4==0 &amp;&amp; godina%100!=0) || godina%400==0) BrojDana[1]++;
        return BrojDana[mjesec-1];
    }
public:
    Datum(int dan, int mjesec, int godina) {
        Postavi(dan,mjesec,godina);
    }
    void Postavi(int dan, int mjesec, int godina) {
            if(godina&lt;1 || mjesec&lt;1 || mjesec&gt;12 || dan&lt;1 || dan&gt;BrojDana(mjesec,godina)) throw std::domain_error("Neispravan datum");
                Datum::dan = dan;
                Datum::mjesec = mjesec;
                Datum::godina = godina;
            }
            
    std::tuple&lt;int, int, int&gt; Ocitaj() const {
        return std::make_tuple(dan,mjesec,godina);
    }
    void Ispisi() const {
        cout &lt;&lt; dan &lt;&lt; "/" &lt;&lt; mjesec &lt;&lt; "/" &lt;&lt; godina;
    }

    friend class Pregled;
    friend class Pregledi;
};

class Vrijeme
{
    int sati,minute;
public:
    Vrijeme(int sati, int minute) {
        Postavi(sati,minute);
    }

    void Postavi(int sati, int minute) {
        if(sati&lt;0 || sati&gt;23 || minute&lt;0 || minute&gt;59) throw std::domain_error("Neispravno vrijeme");
        Vrijeme::sati=sati;
        Vrijeme::minute=minute;
    }

    std::pair&lt;int, int&gt; Ocitaj () const {
        return std::make_pair(sati,minute);
    }

    void Ispisi() const {
        std::cout &lt;&lt; std::setfill('0') &lt;&lt; std::setw(2) &lt;&lt; sati &lt;&lt; ":" &lt;&lt; std::setw(2) &lt;&lt; minute &lt;&lt; std::setfill(' ');
    }

    friend class Pregled;
    friend class Pregledi;
};

class Pregled
{
    string ime_pacijenta;
    Datum datum_pregleda;
    Vrijeme vrijeme_pregleda;

public:
    Pregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda,const Vrijeme &amp;vrijeme_pregleda):
</font>        ime_pacijenta(ime_pacijenta), datum_pregleda(datum_pregleda), vrijeme_pregleda(vrijeme_pregleda) {}

<a name="0"></a><font color="#FF0000"><a href="match217-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_79.gif"/></a>

    Pregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda,int godina_pregleda, int sati_pregleda, int minute_pregleda) :
        ime_pacijenta(ime_pacijenta), datum_pregleda(dan_pregleda,mjesec_pregleda,godina_pregleda), vrijeme_pregleda(sati_pregleda,minute_pregleda) {}

    void PromijeniPacijenta(const std::string &amp;ime_pacijenta) {
        Pregled::ime_pacijenta=ime_pacijenta;
    }

    void PromijeniDatum(const Datum &amp;novi_datum) {
        datum_pregleda=novi_datum;
    }

    void PromijeniVrijeme(const Vrijeme &amp;novo_vrijeme) {
        vrijeme_pregleda=novo_vrijeme;
    }

    void PomjeriDanUnaprijed() {
        int dan1(datum_pregleda.dan), mjesec1(datum_pregleda.mjesec), godina1(datum_pregleda.godina);
        dan1++;
        if(dan1&gt;Datum::BrojDana(mjesec1,godina1)) {dan1=1; mjesec1=1;}
        if (mjesec1&gt;12) { mjesec1=1; godina1++; }
        datum_pregleda=Datum(dan1, mjesec1, godina1);
    }

    void PomjeriDanUnazad() {
        int dan1(datum_pregleda.dan), mjesec1(datum_pregleda.mjesec), godina1(datum_pregleda.godina);
        dan1--;
        if (dan1&lt;1) { mjesec1--; 
            if (mjesec1&gt;0) dan1=Datum::BrojDana(mjesec1, godina1);
        }
        if(mjesec1&lt;1) { mjesec1=12; godina1--; if(godina1&lt;1) throw std::domain_error("Neispravan datum"); dan1=Datum::BrojDana(mjesec1,godina1); }
        datum_pregleda=Datum(dan1, mjesec1, godina1);
    }

    std::string DajImePacijenta() const {
        return ime_pacijenta;
    }

    Datum DajDatumPregleda() const {
        return datum_pregleda;
    }

    Vrijeme DajVrijemePregleda() const {
        return vrijeme_pregleda;
    }

    static bool DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2) {
        return ( p1.datum_pregleda.godina&lt;p2.datum_pregleda.godina ||
                 (p1.datum_pregleda.godina==p2.datum_pregleda.godina &amp;&amp; p1.datum_pregleda.mjesec&lt;p2.datum_pregleda.mjesec) ||
                 (p1.datum_pregleda.godina==p2.datum_pregleda.godina &amp;&amp; p1.datum_pregleda.mjesec==p2.datum_pregleda.mjesec &amp;&amp;
                  p1.datum_pregleda.dan&lt;p2.datum_pregleda.dan) || (p1.datum_pregleda.godina==p2.datum_pregleda.godina &amp;&amp;
                          p1.datum_pregleda.mjesec==p2.datum_pregleda.mjesec &amp;&amp; p1.datum_pregleda.dan==p2.datum_pregleda.dan &amp;&amp; p1.vrijeme_pregleda.sati&lt;p2.vrijeme_pregleda.sati)
                 || (p1.datum_pregleda.godina==p2.datum_pregleda.godina &amp;&amp; p1.datum_pregleda.mjesec==p2.datum_pregleda.mjesec &amp;&amp;
                     p1.datum_pregleda.dan==p2.datum_pregleda.dan &amp;&amp; p1.vrijeme_pregleda.sati==p2.vrijeme_pregleda.sati
                     &amp;&amp; p1.vrijeme_pregleda.minute&lt;p2.vrijeme_pregleda.minute));
    }

    void Ispisi() const {
        cout &lt;&lt; std::left &lt;&lt; std::setw(30) &lt;&lt; ime_pacijenta &lt;&lt; std::right;
        datum_pregleda.Ispisi();
        cout &lt;&lt; " ";
        vrijeme_pregleda.Ispisi();
        cout &lt;&lt; endl;
    }

    friend class Vrijeme;
    friend class Datum;
    friend class Pregledi;
};

class Pregledi
{
    Pregled **pregledi {};
    int broj_pregleda {};
    int max_broj_pregleda;
public:
    explicit Pregledi(int max_broj_pregleda) : pregledi(new Pregled*[max_broj_pregleda] {}), max_broj_pregleda(max_broj_pregleda) {}
    
    Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda) {
        auto it = spisak_pregleda.begin();
        try {
            broj_pregleda=max_broj_pregleda=spisak_pregleda.size();
            pregledi=new Pregled*[spisak_pregleda.size()] {};
            for(int i=0; i&lt;spisak_pregleda.size(); i++,it++,broj_pregleda++)
                pregledi[i]=new Pregled(*it);
        } catch(...) {
            for(int i=0; i&lt;spisak_pregleda.size(); i++) delete pregledi[i];
            delete[] pregledi;
            Pregledi::pregledi=nullptr;
            throw;
        }
    }
    
    ~Pregledi() {
        for(int i=0; i&lt;broj_pregleda; i++) delete pregledi[i];
        delete [] pregledi;
        Pregledi::pregledi=nullptr;
    }
    
    Pregledi(const Pregledi &amp;pregledi) : broj_pregleda(pregledi.broj_pregleda), max_broj_pregleda(pregledi.max_broj_pregleda) {
        try {
            Pregledi::pregledi=new Pregled*[broj_pregleda] {};
            for(int i=0; i&lt;broj_pregleda; i++)
                Pregledi::pregledi[i]=new Pregled(*pregledi.pregledi[i]);
        } catch(...) {
            for(int i=0; i&lt;broj_pregleda; i++) delete Pregledi::pregledi[i];
            delete[] Pregledi::pregledi;
            Pregledi::pregledi=nullptr;
            throw;
        }
    }
    
    Pregledi(Pregledi &amp;&amp;pregledi) {
        std::swap(Pregledi::max_broj_pregleda,pregledi.max_broj_pregleda);
        std::swap(Pregledi::broj_pregleda,pregledi.broj_pregleda);
        std::swap(Pregledi::pregledi,pregledi.pregledi);
    }
    
    Pregledi &amp;operator =(const Pregledi &amp;pregledi) {
        Pregled**temp {};
        try
        {temp=new Pregled*[pregledi.broj_pregleda] {};
        for(int i=0; i&lt;pregledi.broj_pregleda; i++)
            temp[i]=new Pregled(*pregledi.pregledi[i]);
        }
        catch(...){
            for(int i=0; i&lt;pregledi.broj_pregleda; i++) delete temp[i];
            delete[] temp;
            temp=nullptr;
            throw;
        }
        for(int i=0; i&lt;max_broj_pregleda; i++) delete Pregledi::pregledi[i];
        delete [] Pregledi::pregledi;
        Pregledi::pregledi=temp;
        broj_pregleda=pregledi.broj_pregleda;
        max_broj_pregleda=pregledi.max_broj_pregleda;
        return *this;
    }
    
    Pregledi &amp;operator =(Pregledi &amp;&amp;pregledi) {
        std::swap(Pregledi::max_broj_pregleda,pregledi.max_broj_pregleda);
        std::swap(Pregledi::broj_pregleda,pregledi.broj_pregleda);
        std::swap(Pregledi::pregledi,pregledi.pregledi);
        return *this;
    }
    
    void RegistrirajPregled(const std::string &amp;ime_pacijenta,const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda) {
        if(broj_pregleda+1&gt;max_broj_pregleda) throw std::range_error("Dostignut maksimalni broj pregleda");
        pregledi[broj_pregleda]=new Pregled(ime_pacijenta,datum_pregleda,vrijeme_pregleda);
        broj_pregleda++;
    }
    
    void RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda,int mjesec_pregleda, int godina_pregleda,
                            int sati_pregleda,int minute_pregleda) {
        if(broj_pregleda+1&gt;max_broj_pregleda) throw std::range_error("Dostignut maksimalni broj pregleda");
        pregledi[broj_pregleda]=new Pregled(ime_pacijenta,dan_pregleda,mjesec_pregleda,godina_pregleda,sati_pregleda,minute_pregleda);
        broj_pregleda++;
    }

    void RegistrirajPregled(Pregled *pregled) {
        if(broj_pregleda+1&gt;max_broj_pregleda){ throw std::range_error("Dostignut maksimalni broj pregleda"); delete pregled;}
        pregledi[broj_pregleda]=pregled;
        broj_pregleda++;
    }

    int DajBrojPregleda() const {
        return broj_pregleda;
    }

    int DajBrojPregledaNaDatum(const Datum &amp;datum) const {
        int brojac = std::count_if(pregledi,pregledi+broj_pregleda,
        [datum](Pregled*p) {
            return (p-&gt;datum_pregleda.dan==datum.dan &amp;&amp; p-&gt;datum_pregleda.mjesec==datum.mjesec &amp;&amp;
                    p-&gt;datum_pregleda.godina==datum.godina);
        });
        return brojac;
    }
    
    Pregled &amp;DajNajranijiPregled() {
        if(broj_pregleda==0 || pregledi==nullptr) throw std::domain_error("Nema registriranih pregleda");
        return **std::min_element(pregledi,pregledi+broj_pregleda,
                                  [](Pregled*p1,Pregled*p2)-&gt;bool {return Pregled::DolaziPrije(*p1,*p2);});
    }
    
    Pregled DajNajranijiPregled() const {
        if(broj_pregleda==0 || pregledi==nullptr) throw std::domain_error("Nema registriranih pregleda");
        return **std::min_element(pregledi,pregledi+broj_pregleda,
                                  [](Pregled*p1,Pregled*p2)-&gt;bool {return Pregled::DolaziPrije(*p1,*p2);});
    }
    
    void IsprazniKolekciju() {
        for(int i=0; i&lt;max_broj_pregleda; i++) {
            delete pregledi[i];
            pregledi[i]=nullptr;
        }
        broj_pregleda=0;
    }
    
    void ObrisiNajranijiPregled() {
        if(broj_pregleda==0 || pregledi==nullptr) throw std::range_error("Prazna kolekcija");
        Pregled &amp;del=DajNajranijiPregled();
        for(int i=0; i&lt;broj_pregleda; i++)
            if(&amp;del==pregledi[i]) {
                delete pregledi[i];
                for(int j=i; j+1&lt;broj_pregleda; j++) pregledi[j]=pregledi[j+1];
                broj_pregleda--;
            }
    }
    
    void ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta) {
        for(int i=0; i&lt;broj_pregleda; i++) {
            if(pregledi[i]-&gt;ime_pacijenta==ime_pacijenta) {
                delete pregledi[i];
                for(int j=i; j+1&lt;broj_pregleda; j++) pregledi[j]=pregledi[j+1];
                broj_pregleda--;
                i--;
            }
        }
    }
    
    void IspisiPregledeNaDatum(const Datum &amp;datum) const {
        vector&lt;const Pregled*&gt; vp;
        for(int i=0; i&lt;broj_pregleda; i++)
            if(pregledi[i]-&gt;datum_pregleda.dan==datum.dan &amp;&amp; pregledi[i]-&gt;datum_pregleda.mjesec==datum.mjesec &amp;&amp;
                    pregledi[i]-&gt;datum_pregleda.godina==datum.godina) vp.push_back(pregledi[i]);
        std::sort(vp.begin(),vp.end(),[](const Pregled *p1,const Pregled *p2) {
            return Pregled::DolaziPrije(*p1,*p2);
        });
        for(int i=0; i&lt;vp.size(); i++) vp.at(i)-&gt;Ispisi();
    }
    
    void IspisiSvePreglede() const {
        vector&lt;const Pregled*&gt; vp;
        for(int i=0; i&lt;broj_pregleda; i++) vp.push_back(pregledi[i]);
        std::sort(vp.begin(),vp.end(),[](const Pregled *p1,const Pregled *p2) {
            return Pregled::DolaziPrije(*p1,*p2);
        });
        for(int i=0; i&lt;vp.size(); i++) vp.at(i)-&gt;Ispisi();
    }

    friend class Datum;
    friend class Vrijeme;
    friend class Pregled;
};


int main ()
{
     {//AT20 (skriveni) Klasa Pregleedi, RegistrirajPregled, prva verzija izuzetak
        Pregledi p(20);
        try {
            for (int i = 0, d=1; i &lt; 25; i++, d++) {
                p.RegistrirajPregled("Dalila", {d, d%12+1, 2001}, {1, 1});
            }
            p.IspisiSvePreglede();
        }
        catch(std::range_error &amp;ex){
            std::cout &lt;&lt; "OK " &lt;&lt; ex.what() &lt;&lt; std::endl;
        }
        p.IspisiSvePreglede();
</font>    }
    return 0;
}
</pre>
</body>
</html>
