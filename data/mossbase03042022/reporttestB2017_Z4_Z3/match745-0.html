<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student9081.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student9081.cpp<p></p><pre>
/B2017/2018: ZadaÄ‡a 4, Zadatak 3
#include &lt;iostream&gt;
#include &lt;tuple&gt;
#include &lt;stdexcept&gt;
#include &lt;utility&gt;
#include &lt;iomanip&gt;
#include &lt;initializer_list&gt;
#include &lt;new&gt;
#include &lt;algorithm&gt;
#include &lt;vector&gt;
#include &lt;string&gt;

class Datum {
    int dan,mjesec,godina;
public:
    Datum (int dan,int mjesec,int godina) {Postavi(dan,mjesec,godina);}
    void Postavi (int dan, int mjesec, int godina);
    std::tuple&lt;int,int,int&gt; Ocitaj () const {return std::make_tuple(dan,mjesec,godina);}
    void Ispisi () const {std::cout&lt;&lt;dan&lt;&lt;"/"&lt;&lt;mjesec&lt;&lt;"/"&lt;&lt;godina;}
};

void Datum::Postavi (int dan, int mjesec, int godina)
{
    int bd[]{31,28,31,30,31,30,31,31,30,31,30,31};
    if (godina%4==0 &amp;&amp; (godina%100!=0 || godina%400==0)) bd[1]++;
    if (godina&lt;1 || dan&lt;1 || mjesec&lt;1 || mjesec&gt;12 || dan&gt;bd[mjesec-1])
        throw std::domain_error ("Neispravan datum");
    Datum::dan=dan; Datum::mjesec=mjesec; Datum::godina=godina;
}

class Vrijeme {
    int sati,minute;
public:
    Vrijeme (int sati, int minute) {Postavi(sati,minute);}
    void Postavi (int sati,int minute);
    std::pair&lt;int,int&gt; Ocitaj () const {return std::make_pair(sati,minute);}
    void Ispisi() const {std::cout&lt;&lt;std::right&lt;&lt;std::setfill('0')&lt;&lt;std::setw(2)&lt;&lt;sati&lt;&lt;":"&lt;&lt;std::setfill('0')&lt;&lt;std::setw(2)&lt;&lt;minute;}
};

void Vrijeme::Postavi(int sati, int minute)
{
    if (sati&lt;0 || sati&gt;23 || minute&lt;0 || minute&gt;59)
        throw std::domain_error ("Neispravno vrijeme");
    Vrijeme::sati=sati; Vrijeme::minute=minute;
}

class Pregled {
    std::string ime_pacijenta;
    Datum datum_pregleda;
    Vrijeme vrijeme_pregleda;
    static int DajBrojDana (int mjesec, int godina);
public:
    Pregled (const std::string &amp;ime, const Datum &amp;datum, const Vrijeme &amp;vrijeme) : ime_pacijenta(ime),datum_pregleda(datum),vrijeme_pregleda(vrijeme) {}
    Pregled (const std::string &amp;ime, int dan, int mjesec, int godina, int sati, int minute): ime_pacijenta(ime),datum_pregleda(Datum(dan,mjesec,godina)),vrijeme_pregleda(Vrijeme(sati,minute)) {}
<a name="2"></a><font color="#0000FF"><a href="match745-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_2.gif"/></a>

    void PromijeniPacijenta (const std::string &amp;ime) {ime_pacijenta=ime;}
    void PromijeniDatum (const Datum &amp;novi_datum) {datum_pregleda=novi_datum;}
    void PromijeniVrijeme (const Vrijeme &amp;novo_vrijeme) {vrijeme_pregleda=novo_vrijeme;}
    void PomjeriDanUnaprijed ();
    void PomjeriDanUnazad ();
    std::string DajImePacijenta () const {return ime_pacijenta;}
    Datum DajDatumPregleda () const {return datum_pregleda;}
    Vrijeme DajVrijemePregleda () const {return vrijeme_pregleda;}
    static bool DolaziPrije (const Pregled &amp;p1, const Pregled &amp;p2);
    void Ispisi () const {std::cout&lt;&lt;std::left&lt;&lt;std::setw(30)&lt;&lt;std::setfill(' ')&lt;&lt;ime_pacijenta; datum_pregleda.Ispisi(); std::cout&lt;&lt;" "; vrijeme_pregleda.Ispisi(); std::cout&lt;&lt;std::endl;}
</font><a name="5"></a><font color="#FF0000"><a href="match745-1.html#5" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

};

bool Pregled::DolaziPrije (const Pregled &amp;p1, const Pregled &amp;p2)
{
    auto par1(p1.vrijeme_pregleda.Ocitaj()),par2(p2.vrijeme_pregleda.Ocitaj());
</font><a name="3"></a><font color="#00FFFF"><a href="match745-1.html#3" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_2.gif"/></a>

    auto tup1(p1.datum_pregleda.Ocitaj()),tup2(p2.datum_pregleda.Ocitaj());
    if (std::get&lt;2&gt;(tup1)==std::get&lt;2&gt;(tup2))
    {
        if (std::get&lt;1&gt;(tup1)==std::get&lt;1&gt;(tup2))
        {
            if (std::get&lt;0&gt;(tup1)==std::get&lt;0&gt;(tup2))
</font>            {
                if (par1.first==par2.first)
                {
                    return par1.second&lt;par2.second;
                }
                return par1.first&lt;par2.first;
            }
            return std::get&lt;0&gt;(tup1)&lt;std::get&lt;0&gt;(tup2);
        }
        return std::get&lt;1&gt;(tup1)&lt;std::get&lt;1&gt;(tup2);
    }
    return std::get&lt;2&gt;(tup1)&lt;std::get&lt;2&gt;(tup2);
}

int Pregled::DajBrojDana (int mjesec, int godina)
{
    int bd[]{31,28,31,30,31,30,31,31,30,31,30,31};
    if (godina %4==0 &amp;&amp; (godina%100!=0 || godina%400==0)) bd[1]++;
    return bd[mjesec-1];
}

void Pregled::PomjeriDanUnaprijed()
{
    std::tuple&lt;int,int,int&gt; t(datum_pregleda.Ocitaj());
    std::get&lt;0&gt;(t)++;
    if (std::get&lt;0&gt;(t)&gt;DajBrojDana(std::get&lt;1&gt;(t),std::get&lt;2&gt;(t))) std::get&lt;0&gt;(t)=1,std::get&lt;1&gt;(t)++;
    if (std::get&lt;1&gt;(t)&gt;12) std::get&lt;1&gt;(t)=1,std::get&lt;2&gt;(t)++;
    datum_pregleda.Postavi(std::get&lt;0&gt;(t),std::get&lt;1&gt;(t),std::get&lt;2&gt;(t));
}

void Pregled::PomjeriDanUnazad()
{
    std::tuple&lt;int,int,int&gt; t(datum_pregleda.Ocitaj());
    std::get&lt;0&gt;(t)--;
    if (std::get&lt;0&gt;(t)==0)
    {
        std::get&lt;1&gt;(t)--;
        if (std::get&lt;1&gt;(t)==0) std::get&lt;1&gt;(t)=12,std::get&lt;2&gt;(t)--;
        std::get&lt;0&gt;(t)=DajBrojDana(std::get&lt;1&gt;(t),std::get&lt;2&gt;(t));
    }
    datum_pregleda.Postavi(std::get&lt;0&gt;(t),std::get&lt;1&gt;(t),std::get&lt;2&gt;(t));
}

class Pregledi{
    int max_broj_pregleda,broj_pregleda;
    Pregled **pok;
    static void OslobodiMemoriju (Pregled **pokazivac, int broj);
    Pregled **begin() const {return pok;}
    Pregled **end() const {return pok+max_broj_pregleda;}
public:
    explicit Pregledi (int max);
    Pregledi (std::initializer_list&lt;Pregled&gt; spisak_pregleda);
    ~Pregledi () {OslobodiMemoriju(pok,max_broj_pregleda);}
    Pregledi (const Pregledi &amp;pregledi);
    Pregledi (Pregledi &amp;&amp;pregledi);
    Pregledi &amp;operator=(const Pregledi &amp;pregledi);
    Pregledi &amp;operator=(Pregledi &amp;&amp;pregledi);
    void RegistrirajPregled (const std::string &amp;ime_pacijenta,const Datum &amp;datum_pregleda,const Vrijeme &amp;vrijeme_pregleda);
    void RegistrirajPregled (const std::string &amp;ime_pacijenta,int dan, int mjesec, int godina,int sati,int minute);
    void RegistrirajPregled (Pregled *pregled);
    int DajBrojPregleda() const {return broj_pregleda;}
    int DajBrojPregledaNaDatum (const Datum &amp;datum) const;
    Pregled &amp;DajNajranijiPregled ();
    Pregled DajNajranijiPregled () const;
    void IsprazniKolekciju ();
    void ObrisiNajranijiPregled ();
    void ObrisiPregledePacijenta (const std::string &amp;ime_pacijenta);
    void IspisiPregledeNaDatum (const Datum &amp;datum) const;
    void IspisiSvePreglede () const;
};

Pregledi::Pregledi (int max): max_broj_pregleda(max),broj_pregleda(0),pok(new Pregled* [max]{}) {}

void Pregledi::IspisiPregledeNaDatum (const Datum &amp;datum) const
{
    auto t1(datum.Ocitaj());
    std::vector&lt;bool&gt; vec(max_broj_pregleda,false);
    for (int i=0;i&lt;max_broj_pregleda;i++)
    {
        int min(0);
        while (vec[min]==true) min++;
        for (int j=0;j&lt;max_broj_pregleda;j++)
        {
            if (pok[min]!=nullptr &amp;&amp; pok[j]!=nullptr &amp;&amp; vec[j]==false &amp;&amp; Pregled::DolaziPrije(*pok[j],*pok[min]))
            min=j;
            else if (pok[min]==nullptr &amp;&amp; pok[j]!=nullptr &amp;&amp; vec[j]==false)
            min=j;
        }
        vec[min]=true;
        if (pok[min]!=nullptr)
        {
            auto t2(pok[min]-&gt;DajDatumPregleda().Ocitaj());
            if (std::get&lt;0&gt;(t1)==std::get&lt;0&gt;(t2) &amp;&amp; std::get&lt;1&gt;(t1)==std::get&lt;1&gt;(t2) &amp;&amp; std::get&lt;2&gt;(t1)==std::get&lt;2&gt;(t2))
            pok[min]-&gt;Ispisi();
        }
    }
}

void Pregledi::IspisiSvePreglede () const
{
    std::vector&lt;bool&gt; vec(max_broj_pregleda,false);
    for (int i=0;i&lt;max_broj_pregleda;i++)
    {
        int min(0);
        while (vec[min]==true) min++;
        for (int j=0;j&lt;max_broj_pregleda;j++)
        {
            if (pok[min]!=nullptr &amp;&amp; pok[j]!=nullptr &amp;&amp; vec[j]==false &amp;&amp; Pregled::DolaziPrije(*pok[j],*pok[min]))
            min=j;
            else if (pok[min]==nullptr &amp;&amp; pok[j]!=nullptr &amp;&amp; vec[j]==false)
            min=j;
        }
        vec[min]=true;
        if (pok[min]!=nullptr)
        pok[min]-&gt;Ispisi();
    }
}

void Pregledi::ObrisiPregledePacijenta (const std::string &amp;ime_pacijenta)
{
    for (int i=0;i&lt;max_broj_pregleda;i++)
    {
       if (pok[i]!=nullptr)
       {
           if (pok[i]-&gt;DajImePacijenta()==ime_pacijenta)
           {
               delete pok[i]; pok[i]=nullptr;
               broj_pregleda--;
           }
       }
    }
}

void Pregledi::ObrisiNajranijiPregled ()
{
    if (DajBrojPregleda()==0)
        throw std::range_error ("Prazna kolekcija");
    auto pok_p(&amp;DajNajranijiPregled());
    for (int i=0;i&lt;max_broj_pregleda;i++)
    {
        if (pok[i]==pok_p)
        {
            delete pok[i]; pok[i]=nullptr;
            broj_pregleda--;
        }
    }
}

void Pregledi::IsprazniKolekciju ()
{
    for (int i=0;i&lt;max_broj_pregleda;i++)
    {
        delete pok[i]; pok[i]=nullptr;
    }
    broj_pregleda=0;
}

Pregled &amp;Pregledi::DajNajranijiPregled ()
{
    if (DajBrojPregleda()==0)
        throw std::domain_error ("Nema registriranih pregleda");
    return **std::min_element(this-&gt;begin(),this-&gt;end(),[] (Pregled *p1, Pregled *p2)
    {
        if (p1==nullptr) return false;
        if (p1!=nullptr &amp;&amp; p2==nullptr) return true;
        return Pregled::DolaziPrije(*p1,*p2);
    });
}

Pregled Pregledi::DajNajranijiPregled() const
{
    if (DajBrojPregleda()==0)
        throw std::domain_error ("Nema registriranih pregleda");
    return **std::min_element(this-&gt;begin(),this-&gt;end(),[] (Pregled *p1, Pregled *p2)
    {
        if (p1==nullptr) return false;
        if (p1!=nullptr &amp;&amp; p2==nullptr) return true;
        return Pregled::DolaziPrije(*p1,*p2);
    });
}

int Pregledi::DajBrojPregledaNaDatum(const Datum &amp;datum) const
{
    return std::count_if(this-&gt;begin(),this-&gt;end(),[datum] (Pregled *p) 
    {
        if (p==nullptr) return false;
<a name="1"></a><font color="#00FF00"><a href="match745-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_2.gif"/></a>

        auto t1(p-&gt;DajDatumPregleda().Ocitaj()),t2(datum.Ocitaj());
        return std::get&lt;0&gt;(t1)==std::get&lt;0&gt;(t2) &amp;&amp; std::get&lt;1&gt;(t1)==std::get&lt;1&gt;(t2) &amp;&amp; std::get&lt;2&gt;(t1)==std::get&lt;2&gt;(t2);
    });
}

void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda)
{
    if (DajBrojPregleda()==max_broj_pregleda)
</font>        throw std::range_error ("Dostignut maksimalni broj pregleda");
    for (int i=0;i&lt;max_broj_pregleda;i++)
    {
        if(pok[i]==nullptr)
        {
            pok[i]=new Pregled(ime_pacijenta,datum_pregleda,vrijeme_pregleda);
            broj_pregleda++;
            break;
        }
    }
}

void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan, int mjesec, int godina, int sati, int minute)
{
    if (DajBrojPregleda()==max_broj_pregleda)
        throw std::range_error ("Dostignut maksimalni broj pregleda");
    for (int i=0;i&lt;max_broj_pregleda;i++)
    {
        if (pok[i]==nullptr)
        {
            pok[i]=new Pregled(ime_pacijenta,dan,mjesec,godina,sati,minute);
            broj_pregleda++;
            break;
        }
    }
}

void Pregledi::RegistrirajPregled (Pregled *pregled)
{
    if (DajBrojPregleda()==max_broj_pregleda) {
        delete pregled;
        throw std::range_error ("Dostignut maksimalni broj pregleda");}
    for (int i=0;i&lt;max_broj_pregleda;i++)
    {
        if (pok[i]==nullptr &amp;&amp; pregled!=nullptr)
        {
            pok[i]=pregled;
            broj_pregleda++;
            break;
        }
    }
}

Pregledi &amp;Pregledi::operator=(const Pregledi &amp;pregledi)
{
    if (&amp;pregledi!=this) {
    Pregled **novi(new Pregled* [pregledi.max_broj_pregleda]{});
    try
    {
        for (int i=0;i&lt;pregledi.max_broj_pregleda;i++)
        {
            if (pregledi.pok[i]!=nullptr)
            novi[i]=new Pregled (*pregledi.pok[i]);
            else
            novi[i]=nullptr;
        }
    }
    catch (std::bad_alloc)
    {
        OslobodiMemoriju(novi,pregledi.max_broj_pregleda);
        throw;
    }
    OslobodiMemoriju(this-&gt;pok,this-&gt;max_broj_pregleda);
    pok=novi; max_broj_pregleda=pregledi.max_broj_pregleda; broj_pregleda=pregledi.broj_pregleda;}
    return *this;
}

Pregledi &amp;Pregledi::operator =(Pregledi &amp;&amp;pregledi)
{
    std::swap(max_broj_pregleda,pregledi.max_broj_pregleda); std::swap(pok,pregledi.pok); std::swap(broj_pregleda,pregledi.broj_pregleda);
    Pregledi::OslobodiMemoriju(pregledi.pok,pregledi.max_broj_pregleda);
    pregledi.pok=nullptr; pregledi.max_broj_pregleda=0; pregledi.broj_pregleda=0;
    return *this;
}

Pregledi::Pregledi (const Pregledi &amp;pregledi): max_broj_pregleda(pregledi.max_broj_pregleda),broj_pregleda(pregledi.broj_pregleda),pok(new Pregled* [max_broj_pregleda]{})
{
    try
    {
        for (int i=0;i&lt;max_broj_pregleda;i++)
        {
            if (pregledi.pok[i]!=nullptr)
            pok[i]=new Pregled(*pregledi.pok[i]);
            else
            pok[i]=nullptr;
        }
    }
    catch (std::bad_alloc)
    {
        Pregledi::OslobodiMemoriju(pok,max_broj_pregleda);
        throw;
    }
}

Pregledi::Pregledi (Pregledi &amp;&amp;pregledi): max_broj_pregleda(pregledi.max_broj_pregleda),broj_pregleda(pregledi.broj_pregleda),pok(pregledi.pok)
{
    pregledi.pok=nullptr; pregledi.max_broj_pregleda=0; pregledi.broj_pregleda=0;
}

void Pregledi::OslobodiMemoriju (Pregled **pokazivac, int broj)
{
    if (!pokazivac) return;
    for (int i=0;i&lt;broj;i++) delete pokazivac[i];
    delete[] pokazivac;
}

Pregledi::Pregledi (std::initializer_list&lt;Pregled&gt; spisak_pregleda): max_broj_pregleda(spisak_pregleda.size()),broj_pregleda(spisak_pregleda.size()),pok(new Pregled* [max_broj_pregleda]{})
{
    auto it(spisak_pregleda.begin());
    try
    {
        for (int i=0;i&lt;max_broj_pregleda;i++)
        {
            pok[i]=new Pregled(*it);
            it++;
        }
    }
    catch (std::bad_alloc)
    {
        Pregledi::OslobodiMemoriju(pok,max_broj_pregleda);
        throw;
    }
}

int main ()
{
    int n;
    std::cout&lt;&lt;"Unesite maksimalan broj pregleda: ";
    std::cin&gt;&gt;n;
    Pregledi pr(n);
    for (int i=0;i&lt;n;i++)
    {
        std::string ime;
        std::cout&lt;&lt;"Unesite ime novog pacijenta ili 'kraj' za zavrsetak unosa: ";
<a name="0"></a><font color="#FF0000"><a href="match745-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_2.gif"/></a>

        std::cin.ignore(10000,'\n');
        std::getline(std::cin,ime);
        if (ime=="kraj") break;
        int dan,mjesec,godina,sati,minute;
        std::cout&lt;&lt;"Unesite dan mjesec i godinu pregleda: ";
        std::cin&gt;&gt;dan&gt;&gt;mjesec&gt;&gt;godina;
        std::cout&lt;&lt;"Unesite sate i minute pregleda: ";
        std::cin&gt;&gt;sati&gt;&gt;minute;
        pr.RegistrirajPregled(ime,dan,mjesec,godina,sati,minute);
    }
    std::cout&lt;&lt;"Trenutno su registrovani sljedeci pregledi \n";
</font>    pr.IspisiSvePreglede();
    for (;;)
    {
        int x;
        std::cout&lt;&lt;"\nOdaberite jednu od sljedecih opcija\n1 - Broj pregleda na datum\n2 - Najraniji pregled\n3 - Obrisi pregled pacijenta\n";
        std::cout&lt;&lt;"4 - Obrisi najraniji pregled\n5 - Ispisi sve pregleda na datum\n6 - Ispisi sve preglede\n7 - Kraj programa\n";
<a name="6"></a><font color="#00FF00"><a href="match745-1.html#6" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

        std::cin&gt;&gt;x;
        if (x==1)
        {
            int d,m,g;
            std::cout&lt;&lt;"Unesite dan mjesec i godinu : ";
            std::cin&gt;&gt;d&gt;&gt;m&gt;&gt;g;
            std::cout&lt;&lt;"Broj pregleda na datum "&lt;&lt;d&lt;&lt;" "&lt;&lt;m&lt;&lt;" "&lt;&lt;g&lt;&lt;" je: "&lt;&lt;pr.DajBrojPregledaNaDatum(Datum(d,m,g))&lt;&lt;std::endl;
</font>        }
        else if (x==2) {std::cout&lt;&lt;"Najraniji pregled je:\n"; pr.DajNajranijiPregled().Ispisi();}
        else if (x==4)
        {
            pr.ObrisiNajranijiPregled();
            std::cout&lt;&lt;"Najraniji pregled uspjesno obrisan\n";
        }
<a name="4"></a><font color="#FF00FF"><a href="match745-1.html#4" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

        else if (x==3)
        {
            std::string ip;
            std::cout&lt;&lt;"Unesite ime pacijenta: ";
            std::cin.ignore(10000,'\n');
            std::getline(std::cin,ip);
            int broj(pr.DajBrojPregleda());
            pr.ObrisiPregledePacijenta(ip);
</font>            std::cout&lt;&lt;"Uspjesno obrisano "&lt;&lt;broj-pr.DajBrojPregleda()&lt;&lt;" pregleda\n";
        }
<a name="7"></a><font color="#0000FF"><a href="match745-1.html#7" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_0.gif"/></a>

        else if (x==5)
        {
            int d,m,g;
            std::cout&lt;&lt;"Unesite dan mjesec i godinu : ";
            std::cin&gt;&gt;d&gt;&gt;m&gt;&gt;g;
            std::cout&lt;&lt;"Pregledi na datum "&lt;&lt;d&lt;&lt;" "&lt;&lt;m&lt;&lt;" "&lt;&lt;g&lt;&lt;" su: \n";
</font>            pr.IspisiPregledeNaDatum(Datum(d,m,g));
        }
        else if (x==6) pr.IspisiSvePreglede();
        else if (x==7) break;
    }
	return 0;
}
</pre>
</body>
</html>
