<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student4559.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student5129.cpp<p></p><pre>
<a name="2"></a><font color="#0000FF"><a href="match188-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_6.gif"/></a>

/B2017/2018: ZadaÄ‡a 4, Zadatak 3
#include &lt;iostream&gt;
#include &lt;iomanip&gt;
#include &lt;algorithm&gt;

#include &lt;tuple&gt;

#include &lt;stdexcept&gt;

class Datum {
    int dan, mjesec, godina;
public:
    static constexpr int brojDana[12]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    static bool jeLiPrestupna(int godina) {
        return godina % 400 == 0 || (godina % 4 == 0 &amp;&amp; godina % 100 != 0);
    }
    
    Datum(int dan, int mjesec, int godina);
    void Postavi(int dan, int mjesec, int godina);
    std::tuple&lt;int, int, int&gt; Ocitaj() const;
    void Ispisi() const;
};

class Vrijeme {
    int sati, minute;
public:
    Vrijeme(int sati, int minute);
    void Postavi(int sati, int minute);
    std::pair&lt;int, int&gt; Ocitaj() const;
    void Ispisi() const;
};

class Pregled {
    std::string ime_pacijenta;
    Datum datum_pregleda;
    Vrijeme vrijeme_pregleda;
public:
    Pregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda);
</font>    Pregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda,
        int sati_pregleda, int minute_pregleda);
        
    void PromijeniPacijenta(const std::string &amp;ime_pacijenta);
<a name="3"></a><font color="#00FFFF"><a href="match188-0.html#3" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_4.gif"/></a>

    void PromijeniDatum(const Datum &amp;novi_datum);
    void PromijeniVrijeme(const Vrijeme &amp;novo_vrijeme);
    
    void PomjeriDanUnaprijed();
    void PomjeriDanUnazad();
    
    std::string DajImePacijenta() const;
    Datum DajDatumPregleda() const;
    Vrijeme DajVrijemePregleda() const;
    
    static bool DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2);
    
    void Ispisi() const;
};

class Pregledi {
    Pregled **pregledi;
    int max_br_pregleda;
    int br_pregleda;
    
    void pobrisiPreglede() {
        for (int i = 0; i &lt; br_pregleda; i++)
            delete pregledi[i];
        br_pregleda = 0;
        
        delete[] pregledi;
        pregledi = nullptr;
    }
public:
    explicit Pregledi(int max_broj_pregleda);
    Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda);
    
    ~Pregledi();
    
    Pregledi(const Pregledi &amp;pregledi);
    Pregledi(Pregledi &amp;&amp;pregledi);
</font>    Pregledi &amp;operator=(const Pregledi &amp;pregledi);
    Pregledi &amp;operator=(Pregledi &amp;&amp;pregledi);
    
    void RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda);
    void RegistrirajPregled(const std::string &amp;ime_pacijenta, int datum_pregleda, int mjesec_pregleda,
        int godina_pregleda, int sati_pregleda, int minute_pregleda);
    void RegistrirajPregled(Pregled *pregled);
    
    int DajBrojPregleda() const;
    int DajBrojPregledaNaDatum(const Datum &amp;datum) const;
    Pregled &amp;DajNajranijiPregled();
<a name="1"></a><font color="#00FF00"><a href="match188-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_7.gif"/></a>

    Pregled DajNajranijiPregled() const;
    
    void IsprazniKolekciju();
    void ObrisiNajranijiPregled();
    void ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta);
    void IspisiPregledeNaDatum(const Datum &amp;datum) const;
    void IspisiSvePreglede() const;
};

int main ()
{
    int max_br_pregleda;
    std::cout &lt;&lt; "Unesite maksimalan broj pregleda: ";
    std::cin &gt;&gt; max_br_pregleda;
    
    try {
        Pregledi pregledi(max_br_pregleda);
        
        for (int i = 0; i &lt; max_br_pregleda; i++)
        {
            std::string ime;
            std::cout &lt;&lt; "Unesite ime novog pacijenta ili 'kraj' za zavrsetak unosa: ";
            std::cin &gt;&gt; ime;
            if (ime == "kraj")
                break;
                
            int dan, mjesec, godina;
            std::cout &lt;&lt; "Unesite dan mjesec i godinu pregleda: ";
            std::cin &gt;&gt; dan &gt;&gt; mjesec &gt;&gt; godina;
            
            int sati, minute;
            std::cout &lt;&lt; "Unesite sate i minute pregleda: ";
            std::cin &gt;&gt; sati &gt;&gt; minute;
            
            pregledi.RegistrirajPregled(ime, dan, mjesec, godina, sati, minute);
        }
        
        std::cout &lt;&lt; "Trenutno su registrovani sljedeci pregledi" &lt;&lt; std::endl;
        pregledi.IspisiSvePreglede();
        
        for (;;)
        {
            int opcija;
            std::cout &lt;&lt; std::endl;
            std::cout &lt;&lt; "Odaberite jednu od sljedecih opcija" &lt;&lt; std::endl;
            std::cout &lt;&lt; "1 - Broj pregleda na datum" &lt;&lt; std::endl;
</font>            std::cout &lt;&lt; "2 - Najraniji pregled" &lt;&lt; std::endl;
            std::cout &lt;&lt; "3 - Obrisi pregled pacijenta" &lt;&lt; std::endl;
            std::cout &lt;&lt; "4 - Obrisi najraniji pregled" &lt;&lt; std::endl;
            std::cout &lt;&lt; "5 - Ispisi sve pregleda na datum" &lt;&lt; std::endl;
<a name="0"></a><font color="#FF0000"><a href="match188-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_74.gif"/></a>

            std::cout &lt;&lt; "6 - Ispisi sve preglede" &lt;&lt; std::endl;
            std::cout &lt;&lt; "7 - Kraj programa" &lt;&lt; std::endl;
            std::cin &gt;&gt; opcija;
            
            if (opcija == 7)
                break;
                
            if (opcija == 1) {
                int dan, mjesec, godina;
                std::cout &lt;&lt; "Unesite dan mjesec i godinu : ";
                std::cin &gt;&gt; dan &gt;&gt; mjesec &gt;&gt; godina;
                
                std::cout &lt;&lt; "Broj pregleda na datum " &lt;&lt; dan &lt;&lt; " " &lt;&lt; mjesec &lt;&lt; " " &lt;&lt; godina &lt;&lt; " je: "
                    &lt;&lt; pregledi.DajBrojPregledaNaDatum(Datum(dan, mjesec, godina)) &lt;&lt; std::endl;
            }
            else if (opcija == 2) {
                std::cout &lt;&lt; "Najraniji pregled je:" &lt;&lt; std::endl;
                pregledi.DajNajranijiPregled().Ispisi();
            }
            else if (opcija == 3) {
                std::string ime;
                std::cout &lt;&lt; "Unesite ime pacijenta: ";
                std::cin &gt;&gt; ime;
                
                int trenutniBroj = pregledi.DajBrojPregleda();
                pregledi.ObrisiPregledePacijenta(ime);
                std::cout &lt;&lt; "Uspjesno obrisano " &lt;&lt; trenutniBroj - pregledi.DajBrojPregleda() &lt;&lt; " pregleda" &lt;&lt; std::endl;
            }
            else if (opcija == 4) {
                pregledi.ObrisiNajranijiPregled();
                std::cout &lt;&lt; "Najraniji pregled uspjesno obrisan" &lt;&lt; std::endl;
            }
            else if (opcija == 5) {
                int dan, mjesec, godina;
                std::cout &lt;&lt; "Unesite dan mjesec i godinu : ";
                std::cin &gt;&gt; dan &gt;&gt; mjesec &gt;&gt; godina;
                
                std::cout &lt;&lt; "Pregledi na datum " &lt;&lt; dan &lt;&lt; " " &lt;&lt; mjesec &lt;&lt; " " &lt;&lt; godina &lt;&lt; " su:" &lt;&lt; std::endl;
                pregledi.IspisiPregledeNaDatum(Datum(dan, mjesec, godina));
            }
            else if (opcija == 6) {
                pregledi.IspisiSvePreglede();
            }
        }
    }
    catch(const std::exception &amp;er) {
        std::cout &lt;&lt; er.what() &lt;&lt; std::endl;
    }
    
	return 0;
}

/**
 * 
 * DATUM
 * 
 **/

constexpr int Datum::brojDana[];

Datum::Datum(int dan, int mjesec, int godina)
{
    Postavi(dan, mjesec, godina);
}

void Datum::Postavi(int dan, int mjesec, int godina)
{
    if (mjesec &lt; 1 || mjesec &gt; 12 || dan &lt; 1 ||
        dan &gt; Datum::brojDana[mjesec - 1] + (mjesec == 2 &amp;&amp; jeLiPrestupna(godina)))
            throw std::domain_error("Neispravan datum");
        
    this-&gt;dan = dan;
    this-&gt;mjesec = mjesec;
    this-&gt;godina = godina;
}

std::tuple&lt;int, int, int&gt; Datum::Ocitaj() const
{
    return std::make_tuple(dan, mjesec, godina);
}

void Datum::Ispisi() const
{
    std::cout &lt;&lt; dan &lt;&lt; "/" &lt;&lt; mjesec &lt;&lt; "/" &lt;&lt; godina/* &lt;&lt; std::endl*/;
}

/**
 * 
 * END DATUM
 * 
 **/
 
/**
 * 
 * VRIJEME
 * 
 **/

Vrijeme::Vrijeme(int sati, int minute) 
{
    Postavi(sati, minute);
}

void Vrijeme::Postavi(int sati, int minute)
{
    if (minute &lt; 0 || minute &gt; 59 || sati &lt; 0 || sati &gt; 23)
        throw std::domain_error("Neispravno vrijeme");
        
    this-&gt;sati = sati;
    this-&gt;minute = minute;
}

std::pair&lt;int, int&gt; Vrijeme::Ocitaj() const
{
    return { sati, minute };
}

void Vrijeme::Ispisi() const
{
    std::cout.fill('0');
    std::cout &lt;&lt; std::setw(2) &lt;&lt; sati &lt;&lt; ":"
        &lt;&lt; std::setw(2) &lt;&lt; minute/* &lt;&lt; std::endl*/;
    std::cout.fill(' ');
}

/**
 * 
 * END VRIJEME
 * 
 **/
 
/**
 * 
 * PREGLED
 * 
 **/

Pregled::Pregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda) :
    datum_pregleda(datum_pregleda), vrijeme_pregleda(vrijeme_pregleda)
{
    this-&gt;ime_pacijenta = ime_pacijenta;
}

Pregled::Pregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda,
    int godina_pregleda, int sati_pregleda, int minute_pregleda) :
    datum_pregleda(Datum(dan_pregleda, mjesec_pregleda, godina_pregleda)),
    vrijeme_pregleda(Vrijeme(sati_pregleda, minute_pregleda))
{
    this-&gt;ime_pacijenta = ime_pacijenta;
}
    
void Pregled::PromijeniPacijenta(const std::string &amp;ime_pacijenta)
{
    this-&gt;ime_pacijenta = ime_pacijenta;
}

void Pregled::PromijeniDatum(const Datum &amp;novi_datum)
{
    this-&gt;datum_pregleda = novi_datum;
}

void Pregled::PromijeniVrijeme(const Vrijeme &amp;novo_vrijeme)
{
    this-&gt;vrijeme_pregleda = novo_vrijeme;
}

void Pregled::PomjeriDanUnaprijed()
{
    int dan_pregleda, mjesec_pregleda, godina_pregleda;
    std::tie(dan_pregleda, mjesec_pregleda, godina_pregleda) = datum_pregleda.Ocitaj();
    
    dan_pregleda++;
    if (dan_pregleda &gt; Datum::brojDana[mjesec_pregleda - 1] + (mjesec_pregleda == 2 &amp;&amp; Datum::jeLiPrestupna(godina_pregleda)))
    {
        dan_pregleda = 1;
        mjesec_pregleda++;
        
        if (mjesec_pregleda &gt; 12)
        {
            mjesec_pregleda = 1;
            godina_pregleda++;
        }
    }
    
    datum_pregleda = Datum(dan_pregleda, mjesec_pregleda, godina_pregleda);
}

void Pregled::PomjeriDanUnazad()
{
    int dan_pregleda, mjesec_pregleda, godina_pregleda;
    std::tie(dan_pregleda, mjesec_pregleda, godina_pregleda) = datum_pregleda.Ocitaj();
    
    dan_pregleda--;
    if (dan_pregleda &lt; 1)
    {
        mjesec_pregleda--;
        if (mjesec_pregleda &lt; 1)
        {
            mjesec_pregleda = 12;
            godina_pregleda--;
        }
        
        dan_pregleda = Datum::brojDana[mjesec_pregleda - 1] + (mjesec_pregleda == 2 &amp;&amp; Datum::jeLiPrestupna(godina_pregleda));
    }
    
    datum_pregleda = Datum(dan_pregleda, mjesec_pregleda, godina_pregleda);
}

std::string Pregled::DajImePacijenta() const
{
    return ime_pacijenta;
}

Datum Pregled::DajDatumPregleda() const
{
    return datum_pregleda;
}

Vrijeme Pregled::DajVrijemePregleda() const
{
    return vrijeme_pregleda;
}

bool Pregled::DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2)
{
    int v1_min, v1_sat, v2_min, v2_sat;
    int d1_dan, d1_mon, d1_god, d2_dan, d2_mon, d2_god;
    
    std::tie(v1_sat, v1_min) = p1.vrijeme_pregleda.Ocitaj();
    std::tie(v2_sat, v2_min) = p2.vrijeme_pregleda.Ocitaj();
    
    std::tie(d1_dan, d1_mon, d1_god) = p1.datum_pregleda.Ocitaj();
    std::tie(d2_dan, d2_mon, d2_god) = p2.datum_pregleda.Ocitaj();
    
    if (d1_god &lt; d2_god)
        return true;
    else if (d1_god &gt; d2_god)
        return false;
        
    if (d1_mon &lt; d2_mon)
        return true;
    else if (d1_mon &gt; d2_mon)
        return false;
        
    if (d1_dan &lt; d2_dan)
        return true;
    else if (d1_dan &gt; d2_dan)
        return false;
        
    
    if (v1_sat &lt; v2_sat)
        return true;
    else if (v1_sat &gt; v2_sat)
        return false;
    
    if (v1_min &lt; v2_min)
        return true;
    else if (v1_min &gt; v2_min)
        return false;
        
    return false;
}

void Pregled::Ispisi() const
{
    std::cout &lt;&lt; std::setw(30) &lt;&lt; std::left &lt;&lt; ime_pacijenta;
    std::cout &lt;&lt; std::right;
    datum_pregleda.Ispisi();
    std::cout &lt;&lt; " ";
    vrijeme_pregleda.Ispisi();
    std::cout &lt;&lt; std::endl;
}

/**
 * 
 * END PREGLED
 * 
 **/
 
/**
 * 
 * PREGLEDI
 * 
 **/

Pregledi::Pregledi(int max_broj_pregleda) : max_br_pregleda(max_broj_pregleda)
{
    br_pregleda = 0;
    pregledi = new Pregled*[max_br_pregleda]{};
}

Pregledi::Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda) : max_br_pregleda(spisak_pregleda.size())
{
    br_pregleda = max_br_pregleda;
    pregledi = new Pregled*[max_br_pregleda]{};
    
    try {
        auto &amp;it = pregledi;
        for (auto pregled : spisak_pregleda)
        {
            *it = new Pregled(pregled);
            it++;
        }
    }
    catch (...) {
        pobrisiPreglede();
        throw;
    }
}

Pregledi::~Pregledi()
{
    pobrisiPreglede();
}

Pregledi::Pregledi(const Pregledi &amp;pregledi) : max_br_pregleda(pregledi.max_br_pregleda)
{
    br_pregleda = pregledi.br_pregleda;
    this-&gt;pregledi = new Pregled*[max_br_pregleda]{};
    
    try {
        for (int i = 0; i &lt; br_pregleda; i++)
            this-&gt;pregledi[i] = new Pregled(*pregledi.pregledi[i]);
    }
    catch (...) {
        pobrisiPreglede();
        throw;
    }
}

Pregledi::Pregledi(Pregledi &amp;&amp;pregledi) : max_br_pregleda(pregledi.max_br_pregleda)
{
    br_pregleda = pregledi.br_pregleda;
    this-&gt;pregledi = pregledi.pregledi;
    
    pregledi.br_pregleda = 0;
    pregledi.pregledi = nullptr;
}

Pregledi &amp;Pregledi::operator=(const Pregledi &amp;pregledi)
{
    if (pregledi.max_br_pregleda != max_br_pregleda)
        throw;
        
    for (int i = 0; i &lt; br_pregleda; i++)
        if (i &gt;= pregledi.br_pregleda)
            delete this-&gt;pregledi[i];
        else
            *(this-&gt;pregledi[i]) = *pregledi.pregledi[i];
    
    try {    
        for (int i = br_pregleda; i &lt; pregledi.br_pregleda; i++)
            this-&gt;pregledi[i] = new Pregled(*pregledi.pregledi[i]);
    }
    catch(...) {
        pobrisiPreglede();
        throw;
    }
    
    br_pregleda = pregledi.br_pregleda;
    return *this;
}

Pregledi &amp;Pregledi::operator=(Pregledi &amp;&amp;pregledi)
{
    if (pregledi.max_br_pregleda != max_br_pregleda)
        throw;
    
    pobrisiPreglede();
    
    br_pregleda = pregledi.br_pregleda;
    this-&gt;pregledi = pregledi.pregledi;
    
    pregledi.br_pregleda = 0;
    pregledi.pregledi = nullptr;
    
    return *this;
}

void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda)
{
    if (br_pregleda &gt;= max_br_pregleda)
        throw std::range_error("Dostignut maksimalni broj pregleda");
    
    Pregled *tmp = new Pregled(ime_pacijenta, datum_pregleda, vrijeme_pregleda);
    
    RegistrirajPregled(tmp);
}

void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda,
    int godina_pregleda, int sati_pregleda, int minute_pregleda)
{
    RegistrirajPregled(ime_pacijenta, Datum(dan_pregleda, mjesec_pregleda, godina_pregleda), Vrijeme(sati_pregleda, minute_pregleda));
}

void Pregledi::RegistrirajPregled(Pregled *pregled)
{
    if (br_pregleda &gt;= max_br_pregleda)
        throw std::range_error("Dostignut maksimalni broj pregleda");
    
    pregledi[br_pregleda] = pregled;
    pregled = nullptr;
    
    br_pregleda++;
}

int Pregledi::DajBrojPregleda() const
{
    return br_pregleda;
}

int Pregledi::DajBrojPregledaNaDatum(const Datum &amp;datum) const
{
    return std::count_if(pregledi, pregledi + br_pregleda, [datum](const Pregled *p) {
        return p-&gt;DajDatumPregleda().Ocitaj() == datum.Ocitaj();
    });
}

Pregled &amp;Pregledi::DajNajranijiPregled()
{
    if (br_pregleda == 0)
        throw std::domain_error("Nema registriranih pregleda");
    
    return **std::min_element(pregledi, pregledi + br_pregleda, [](const Pregled *p1, const Pregled *p2) {
        return Pregled::DolaziPrije(*p1, *p2);
    });
}

Pregled Pregledi::DajNajranijiPregled() const
{
    if (br_pregleda == 0)
        throw std::domain_error("Nema registriranih pregleda");
        
    return **std::min_element(pregledi, pregledi + br_pregleda, [](const Pregled *p1, const Pregled *p2) {
        return Pregled::DolaziPrije(*p1, *p2);
    });
}

void Pregledi::IsprazniKolekciju()
{
    pobrisiPreglede();
}

void Pregledi::ObrisiNajranijiPregled()
{
    if (br_pregleda == 0)
        throw std::range_error("Prazna kolekcija");
    
    auto poz = std::min_element(pregledi, pregledi + br_pregleda, [](const Pregled *p1, const Pregled *p2) {
        return Pregled::DolaziPrije(*p1, *p2);
    });
    
    auto tbd = *poz;
    while (poz + 1 != pregledi + br_pregleda) {
        *poz = *(poz + 1);
        poz++;
    }
    
    br_pregleda--;
    pregledi[br_pregleda] = nullptr;
    delete tbd;
}

void Pregledi::ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta)
{
    Pregled **found;
    while ((found = std::find_if(pregledi, pregledi + br_pregleda, [ime_pacijenta](const Pregled *p) {
        return p-&gt;DajImePacijenta() == ime_pacijenta;
    })) != pregledi + br_pregleda) {
        auto tbd = *found;
        while (found + 1 != pregledi + br_pregleda) {
            *found = *(found + 1);
            found++;
        }
        
        br_pregleda--;
        pregledi[br_pregleda] = nullptr;
        delete tbd;
    }
}

void Pregledi::IspisiPregledeNaDatum(const Datum &amp;datum) const
{
    Pregledi tmp(*this);
    std::sort(tmp.pregledi, tmp.pregledi + br_pregleda, [](const Pregled *p1, const Pregled *p2) {
        return Pregled::DolaziPrije(*p1, *p2);
    });
    
    for (int i = 0; i &lt; br_pregleda; i++)
        if (tmp.pregledi[i]-&gt;DajDatumPregleda().Ocitaj() == datum.Ocitaj())
            tmp.pregledi[i]-&gt;Ispisi();
            
}
void Pregledi::IspisiSvePreglede() const
{
    Pregledi tmp(*this);
    std::sort(tmp.pregledi, tmp.pregledi + br_pregleda, [](const Pregled *p1, const Pregled *p2) {
        return Pregled::DolaziPrije(*p1, *p2);
    });
    
    for (int i = 0; i &lt; br_pregleda; i++)
        tmp.pregledi[i]-&gt;Ispisi();
</font>}</pre>
</body>
</html>
