<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student5287.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student5287.cpp<p></p><pre>
/B2017/2018: ZadaÄ‡a 4, Zadatak 3
#include &lt;iostream&gt;
#include &lt;tuple&gt;
#include &lt;stdexcept&gt;
#include &lt;utility&gt;
#include &lt;iomanip&gt;
#include &lt;string&gt;
#include &lt;initializer_list&gt;
#include &lt;algorithm&gt;

using std::string;

typedef std::tuple&lt;int, int, int&gt; t3i;

class Datum{
    int dan, mjesec, godina;
    void CheckDate(int d, int m, int g){
        int brojDana[12]{31, 28, 31, 30, 31, 30, 31, 31, 30 ,31, 30, 31};
        if(((g % 4 == 0 &amp;&amp; g % 100 != 0) || g % 400 == 0)) brojDana[1]++;
<a name="4"></a><font color="#FF00FF"><a href="match841-1.html#4" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

        if(g &lt; 1 || d &lt; 1 || m &lt; 1 || m &gt; 12 || d &gt; brojDana[m-1])
            throw std::domain_error("Neispravan datum");
    }
public:
    Datum(int dan, int mjesec, int godina){
</font>        Postavi(dan, mjesec, godina);
    }
<a name="7"></a><font color="#0000FF"><a href="match841-1.html#7" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

    void Postavi(int dan, int mjesec, int godina){
        CheckDate(dan, mjesec, godina);
        Datum::dan = dan;
        Datum::mjesec = mjesec;
        Datum::godina = godina;
</font>    }
    t3i Ocitaj() const{
        return std::make_tuple(dan, mjesec, godina);
    }
    void Ispisi() const{
<a name="0"></a><font color="#FF0000"><a href="match841-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_2.gif"/></a>

        std::cout &lt;&lt; dan &lt;&lt; "/" &lt;&lt; mjesec &lt;&lt; "/" &lt;&lt; godina;
    }
};

class Vrijeme{
    int sati, minute;
    void CheckTime(int h, int m){
        if(h &lt; 0 || m &lt; 0 || h &gt; 23 || m &gt; 59)
            throw std::domain_error("Neispravno vrijeme");
    }
public:
    Vrijeme(int sati, int minute){
</font>        Postavi(sati, minute);
    }
<a name="9"></a><font color="#FF00FF"><a href="match841-1.html#9" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_0.gif"/></a>

    void Postavi(int sati, int minute){
        CheckTime(sati, minute);
        Vrijeme::sati = sati;
        Vrijeme::minute = minute;
    }
    std::pair&lt;int, int&gt; Ocitaj() const {
</font>        return std::make_pair(sati, minute);
    }
    void Ispisi() const {
        std::cout &lt;&lt; std::setfill('0') &lt;&lt; std::setw(2) &lt;&lt; std::right &lt;&lt; sati &lt;&lt; ":" &lt;&lt; std::setw(2) &lt;&lt; std::right &lt;&lt; minute &lt;&lt; std::left;
        std::cout &lt;&lt; std::setfill(' ');
    }
};

class Pregled{
    string pacijent;
    Datum datum;
    Vrijeme vrijeme;
public:
    Pregled(const string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda)
    : pacijent(ime_pacijenta), datum(datum_pregleda), vrijeme(vrijeme_pregleda) {}
    Pregled(const string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda)
    : pacijent(ime_pacijenta), datum(dan_pregleda, mjesec_pregleda, godina_pregleda), vrijeme(sati_pregleda, minute_pregleda) {}
    
    void PromijeniPacijenta(const string &amp;ime_pacijenta) { pacijent = ime_pacijenta; }
    void PromijeniDatum(const Datum &amp;novi_datum) { datum = novi_datum; }
    void PromijeniVrijeme(const Vrijeme &amp;novo_vrijeme) { vrijeme = novo_vrijeme; }
    void PomjeriDanUnaprijed();
    void PomjeriDanUnazad();
    string DajImePacijenta() const { return pacijent; }
    Datum DajDatumPregleda() const { return datum; }
    Vrijeme DajVrijemePregleda() const { return vrijeme; }
    static bool DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2);
    void Ispisi() const;
};

class Pregledi{
    int max_br;
    Pregled** pregledi = nullptr;
    int br_pregleda;
    
    Pregled** Alloc(int max_br);
    void DeAlloc();
    void Add(Pregled *pregled);
    void ObrisiPregled(Pregled *pregled, int);
public:
    explicit Pregledi(int max_broj_pregleda) : max_br(max_broj_pregleda), pregledi(Alloc(max_br)), br_pregleda(0) {}
    Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda);
    Pregledi(const Pregledi &amp;pregledi);
    Pregledi(Pregledi &amp;&amp;pregledi);
    ~Pregledi(){ DeAlloc(); }
    
    Pregledi &amp;operator =(const Pregledi &amp;pregledi);
    Pregledi &amp;operator =(Pregledi &amp;&amp;pregledi);
    
    void RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda){
        Add(new Pregled(ime_pacijenta, datum_pregleda, vrijeme_pregleda));
    }
    void RegistrirajPregled(const string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda){
        Add(new Pregled(ime_pacijenta, dan_pregleda, mjesec_pregleda, godina_pregleda, sati_pregleda, minute_pregleda));
    }
    void RegistrirajPregled(Pregled *pregled){
        Add(pregled);
    }
    
    int DajBrojPregleda() const { return br_pregleda; }
    int DajBrojPregledaNaDatum(const Datum &amp;datum) const;
    
    Pregled&amp; DajNajranijiPregled();
    Pregled DajNajranijiPregled() const;
    
    void IsprazniKolekciju();
    void ObrisiNajranijiPregled();
    void ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta);
    void IspisiPregledeNaDatum(const Datum &amp;datum) const;
    void IspisiSvePreglede() const;
};

int main () {
    int n;
    std::cout &lt;&lt; "Unesite maksimalan broj pregleda: ";
    std::cin &gt;&gt; n;
    
    Pregledi p(n);
    
    //Input
    for(int i = 0; i &lt; n; i++){
        std::string s;
        int d,m,g,h,min;
        
        std::cout &lt;&lt; "Unesite ime novog pacijenta ili 'kraj' za zavrsetak unosa: ";
<a name="8"></a><font color="#00FFFF"><a href="match841-1.html#8" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

        std::cin &gt;&gt; s;
        if(s == "kraj") break;
        
        std::cout &lt;&lt; "Unesite dan mjesec i godinu pregleda: ";
        std::cin &gt;&gt; d &gt;&gt; m &gt;&gt; g;
        std::cout &lt;&lt; "Unesite sate i minute pregleda: ";
</font>        std::cin &gt;&gt; h &gt;&gt; min;
        try{
            p.RegistrirajPregled(s, d, m, g, h, min);
        }catch(std::exception &amp;err){
            std::cout &lt;&lt; err.what() &lt;&lt; std::endl;
            i--;
            continue;
        }
    }
    
    std::cout &lt;&lt; "Trenutno su registrovani sljedeci pregledi" &lt;&lt; std::endl;
    p.IspisiSvePreglede();
    std::cout &lt;&lt; std::endl;
    
    while(true){
        int opt;
        std::cout &lt;&lt; "Odaberite jednu od sljedecih opcija" &lt;&lt; std::endl
            &lt;&lt; "1 - Broj pregleda na datum" &lt;&lt; std::endl
            &lt;&lt; "2 - Najraniji pregled" &lt;&lt; std::endl
            &lt;&lt; "3 - Obrisi pregled pacijenta" &lt;&lt; std::endl
<a name="5"></a><font color="#FF0000"><a href="match841-1.html#5" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

            &lt;&lt; "4 - Obrisi najraniji pregled" &lt;&lt; std::endl
            &lt;&lt; "5 - Ispisi sve pregleda na datum" &lt;&lt; std::endl
            &lt;&lt; "6 - Ispisi sve preglede" &lt;&lt; std::endl
            &lt;&lt; "7 - Kraj programa" &lt;&lt; std::endl;
        
        std::cin &gt;&gt; opt;
</font>        
        try{
            if(opt &lt; 1 || opt &gt; 7)
                throw std::domain_error("Neispravna komanda");
            
            if(opt == 1){
                int d,m,g;
<a name="6"></a><font color="#00FF00"><a href="match841-1.html#6" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

                std::cout &lt;&lt; "Unesite dan mjesec i godinu : ";
                std::cin &gt;&gt; d &gt;&gt; m &gt;&gt; g;
                Datum dt(d, m, g);
                std::cout &lt;&lt; "Broj pregleda na datum " &lt;&lt; d &lt;&lt; " " &lt;&lt; m &lt;&lt; " " &lt;&lt; g  &lt;&lt; " je: " &lt;&lt; p.DajBrojPregledaNaDatum(dt);
</font><a name="3"></a><font color="#00FFFF"><a href="match841-1.html#3" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

                std::cout &lt;&lt; std::endl;
            }else if(opt == 2){
                std::cout &lt;&lt; "Najraniji pregled je:" &lt;&lt; std::endl;
                p.DajNajranijiPregled().Ispisi();
            }else if(opt == 3){
                std::string s;
</font>                std::cout &lt;&lt; "Unesite ime pacijenta: ";
                std::cin &gt;&gt; s;
                int br = p.DajBrojPregleda();
                p.ObrisiPregledePacijenta(s);
                std::cout &lt;&lt; "Uspjesno obrisano " &lt;&lt; br-p.DajBrojPregleda() &lt;&lt; " pregleda";
                std::cout &lt;&lt; std::endl;
            }else if(opt == 4){
                p.ObrisiNajranijiPregled();
                std::cout &lt;&lt; "Najraniji pregled uspjesno obrisan";
                std::cout &lt;&lt; std::endl;
            }else if(opt == 5){
                int d,m,g;
                std::cout &lt;&lt; "Unesite dan mjesec i godinu : ";
                std::cin &gt;&gt; d &gt;&gt; m &gt;&gt; g;
                Datum dt(d,m,g);
                std::cout &lt;&lt; "Pregledi na datum 18 12 2018 su:" &lt;&lt; std::endl;
                p.IspisiPregledeNaDatum(dt);
            }else if(opt == 6){
                p.IspisiSvePreglede();
            }else
                break;
            
            std::cout &lt;&lt; std::endl;
        }catch(std::exception &amp;err){
            std::cout &lt;&lt; err.what() &lt;&lt; std::endl;
        }
    }
    
	return 0;
}

void Pregled::PomjeriDanUnaprijed() {
    int dan, mjesec, godina;
    std::tie(dan, mjesec, godina) = datum.Ocitaj();
    int brojDana[12]{31, 28, 31, 30, 31, 30, 31, 31, 30 ,31, 30, 31};
    if(((godina % 4 == 0 &amp;&amp; godina % 100 != 0) || godina % 400 == 0)) brojDana[1]++;
    dan++;
    if(dan &gt; brojDana[mjesec-1]){
        dan = 1;
        mjesec++;
        if(mjesec &gt; 12){
            mjesec = 1;
            godina++;
        }
    }
    datum.Postavi(dan, mjesec, godina);
}

void Pregled::PomjeriDanUnazad() {
    int dan, mjesec, godina;
    std::tie(dan, mjesec, godina) = datum.Ocitaj();
    int brojDana[12]{31, 28, 31, 30, 31, 30, 31, 31, 30 ,31, 30, 31};
    if(((godina % 4 == 0 &amp;&amp; godina % 100 != 0) || godina % 400 == 0)) brojDana[1]++;
    dan--;
    if(dan &lt; 1){
        mjesec--;
        if(mjesec &lt; 1){
            mjesec = 12;
            godina--;
        }
        dan = brojDana[mjesec-1];
    }
    datum.Postavi(dan, mjesec, godina);
}

bool Pregled::DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2){
    int d1, m1, g1, d2, m2, g2;
    std::tie(d1, m1, g1) = p1.DajDatumPregleda().Ocitaj();
    std::tie(d2, m2, g2) = p2.DajDatumPregleda().Ocitaj();
    
    if(g1 &gt; g2) return false;
    else if(g1 == g2){
        if(m1 &gt; m2) return false;
        else if(m1 == m2){
            if(d1 &gt; d2) return false;
            else if(d1 == d2){
                int h1, m1, h2, m2;
                std::tie(h1, m1) = p1.DajVrijemePregleda().Ocitaj();
                std::tie(h2, m2) = p2.DajVrijemePregleda().Ocitaj();
                if(h1 &gt; h2) return false;
                else if(h1 == h2){
                    if(m1 &gt;= m2) return false;
                    return true;
                }
                return true;
            }
            return true;
        }
        return true;
    }
    return true;
}

<a name="1"></a><font color="#00FF00"><a href="match841-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

void Pregled::Ispisi() const {
    std::cout &lt;&lt; std::setw(30) &lt;&lt; std::left &lt;&lt; pacijent;
    datum.Ispisi();
    std::cout &lt;&lt; " ";
    vrijeme.Ispisi();
    std::cout &lt;&lt; std::endl;
</font>}

Pregled** Pregledi::Alloc(int max_br){
    return new Pregled*[max_br]{};
}

void Pregledi::DeAlloc(){
    if(pregledi){
        for(int i = 0; i &lt; max_br; i++){
            delete pregledi[i];
        }
        delete[] pregledi;
        pregledi = nullptr;
    }
}

void Pregledi::Add(Pregled *pregled){
    //Moguca greska!!!!!!!!!
    if(br_pregleda &gt;= max_br){
        delete pregled;
        pregled = nullptr;
        throw std::range_error("Dostignut maksimalni broj pregleda");
    }
    
    //Nadji prvi nullptr (prazno mjesto) te preusmjeri taj pokazivac
    //na novododani objekat
    for(int i = 0; i &lt; max_br; i++){
        if(pregledi[i] == nullptr){
            pregledi[i] = pregled;
            br_pregleda++;
            break;
        }
    }
}

void Pregledi::ObrisiPregled(Pregled *pregled, int idx = 0){
    for(int i = idx; i &lt; br_pregleda; i++){
        if(pregled == pregledi[i]){
            delete pregled;
            //Nakon brisanja, suzbiti sve pokazivace
            for(int j = i; j &lt; br_pregleda-1; j++){
                pregledi[j] = pregledi[j+1];
            }
            pregledi[br_pregleda-1] = nullptr;
            br_pregleda--;
            break;
        }
    }
}

Pregledi::Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda) : max_br(spisak_pregleda.size()), pregledi(Alloc(max_br)){
    std::initializer_list&lt;Pregled&gt;::iterator it;
    int i = 0;
    try{
        for(it = spisak_pregleda.begin(); it != spisak_pregleda.end(); it++, i++)
            pregledi[i] = new Pregled(*it);
    }catch(...){
        for(int j = 0; j &lt; i; j++)
            delete pregledi[j];
        delete[] pregledi;
        throw;
    }
    br_pregleda = i;
}

Pregledi::Pregledi(const Pregledi &amp;pregledi) : max_br(pregledi.max_br), pregledi(Alloc(max_br)), br_pregleda(pregledi.br_pregleda){
    try{
<a name="10"></a><font color="#FF0000"><a href="match841-1.html#10" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_0.gif"/></a>

        for(int i = 0; i &lt; br_pregleda; i++)
            Pregledi::pregledi[i] = new Pregled(*pregledi.pregledi[i]);
    }catch(...){
</font>        for(int j = 0; j &lt; br_pregleda; j++)
            delete Pregledi::pregledi[j];
        delete[] Pregledi::pregledi;
        throw;
    }
}

Pregledi::Pregledi(Pregledi &amp;&amp;pregledi) : max_br(pregledi.max_br), pregledi(pregledi.pregledi), br_pregleda(pregledi.br_pregleda){
    pregledi.pregledi = nullptr;
}

Pregledi&amp; Pregledi::operator =(const Pregledi &amp;pregledi){
    if(&amp;pregledi == this) return *this;
    
    DeAlloc();
    max_br = pregledi.max_br;
    br_pregleda = pregledi.br_pregleda;
    Pregledi::pregledi = Alloc(max_br);
    for(int i = 0; i &lt; br_pregleda; i++){
<a name="11"></a><font color="#00FF00"><a href="match841-1.html#11" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_0.gif"/></a>

        Pregledi::pregledi[i] = new Pregled(*pregledi.pregledi[i]);
    }
    
    return *this;
}

Pregledi&amp; Pregledi::operator =(Pregledi &amp;&amp;pregledi){
    if(&amp;pregledi == this) return *this;
</font>    
    DeAlloc();
    max_br = pregledi.max_br;
    br_pregleda = pregledi.br_pregleda;
    Pregledi::pregledi = pregledi.pregledi;
    pregledi.pregledi = nullptr;
    
    return *this;
}

int Pregledi::DajBrojPregledaNaDatum(const Datum &amp;datum) const {
    return std::count_if(pregledi, pregledi+br_pregleda, [&amp;datum](const Pregled *pregled){
        return datum.Ocitaj() == pregled-&gt;DajDatumPregleda().Ocitaj();
    });
}

Pregled&amp; Pregledi::DajNajranijiPregled(){
    Pregled* it = *std::min_element(pregledi, pregledi+br_pregleda, [](Pregled* p1, Pregled* p2){
        return Pregled::DolaziPrije(*p1, *p2);
    });
    
    if(it == *pregledi+br_pregleda)
        throw std::domain_error("Nema registriranih pregleda");
    
    return *it;
}

Pregled Pregledi::DajNajranijiPregled() const {
    Pregled* it = *std::min_element(pregledi, pregledi+br_pregleda, [](Pregled* p1, Pregled* p2){
        return Pregled::DolaziPrije(*p1, *p2);
    });
    
    if(it == *(pregledi+br_pregleda))
        throw std::domain_error("Nema registriranih pregleda");
    
    return *it;
}

void Pregledi::IsprazniKolekciju(){
    DeAlloc();
    max_br = br_pregleda = 0;
}

void Pregledi::ObrisiNajranijiPregled(){
    if(br_pregleda == 0)
        throw std::range_error("Prazna kolekcija");
    
    Pregled* it = &amp;DajNajranijiPregled();
    ObrisiPregled(it);
}

void Pregledi::ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta){
    for(int i = 0; i &lt; br_pregleda; i++){
        if(pregledi[i]-&gt;DajImePacijenta()==ime_pacijenta){
            ObrisiPregled(pregledi[i], i);
            i--;
        }
    }
}

void Pregledi::IspisiPregledeNaDatum(const Datum &amp;datum) const{
    //Pravi se novi niz pokazivaca velik tacno onoliko koliko
    //ima pregleda na zadani datum
    Pregled** temp = new Pregled*[DajBrojPregledaNaDatum(datum)]{};
    int j = 0;
    
    for(int i = 0; i &lt; br_pregleda; i++){
        if(pregledi[i]-&gt;DajDatumPregleda().Ocitaj() == datum.Ocitaj()){
            temp[j] = pregledi[i];
            j++;
        }
    }
    
<a name="2"></a><font color="#0000FF"><a href="match841-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

    std::sort(temp, temp+j, [](Pregled* p1, Pregled* p2){
        return Pregled::DolaziPrije(*p1, *p2);
    });
    
    for(int i = 0; i &lt; j; i++)
        temp[i]-&gt;Ispisi();
</font>    
    delete[] temp;
}

void Pregledi::IspisiSvePreglede() const {
    Pregled** temp = new Pregled*[br_pregleda]{};
    
    std::copy(pregledi, pregledi+br_pregleda, temp);
    
    std::sort(temp, temp+br_pregleda, [](Pregled* p1, Pregled* p2){
        return Pregled::DolaziPrije(*p1, *p2);
    });
    
    for(int i = 0; i &lt; br_pregleda; i++)
        temp[i]-&gt;Ispisi();
        
    delete[] temp;
}</pre>
</body>
</html>
