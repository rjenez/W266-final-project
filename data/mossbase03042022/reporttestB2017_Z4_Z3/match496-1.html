<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student6874.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student4740.cpp<p></p><pre>
<a name="1"></a><font color="#00FF00"><a href="match496-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

/B2017/2018: ZadaÄ‡a 4, Zadatak 3
#include &lt;iostream&gt;
#include &lt;iomanip&gt;
#include &lt;new&gt;
#include &lt;stdexcept&gt;
#include &lt;tuple&gt;
#include &lt;utility&gt;
#include &lt;string&gt;
#include &lt;initializer_list&gt;
#include &lt;algorithm&gt;
#include &lt;vector&gt;

class Datum
{
    int dan, mjesec, godina;
public:
    Datum(int d, int m, int g){ Postavi(d,m,g); }
    void Postavi(int d, int m, int g);
    std::tuple&lt;int,int,int&gt; Ocitaj() const;
    void Ispisi() const{ std::cout &lt;&lt; dan &lt;&lt; "/" &lt;&lt; mjesec &lt;&lt; "/" &lt;&lt; godina; }
</font>};
class Vrijeme
{
    int sati, minute;
public:
    Vrijeme(int s, int m){ Postavi(s,m); }
    void Postavi(int s, int m);
    std::pair&lt;int,int&gt; Ocitaj() const;
    void Ispisi() const{ 
        if(sati&lt;10) std::cout &lt;&lt; "0"; std::cout &lt;&lt; sati; std::cout &lt;&lt; ":";
        if(minute&lt;10) std::cout &lt;&lt; "0"; std::cout &lt;&lt; minute; }
};

void Datum::Postavi(int d, int m, int g){
    int br_dana[12]{31,28,31,30,31,30,31,31,30,31,30,31};
<a name="7"></a><font color="#0000FF"><a href="match496-0.html#7" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_0.gif"/></a>

    if(g%4==0 &amp;&amp; g%100!=0 &amp;&amp; g%400==0) br_dana[1]++;
    if(g&lt;1 || d&lt;1 || m&lt;1 || m&gt;12 || d&gt;br_dana[m-1]) throw std::domain_error("Neispravan datum");
</font><a name="9"></a><font color="#FF00FF"><a href="match496-0.html#9" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_0.gif"/></a>

    dan=d; mjesec=m; godina=g;
}
std::tuple&lt;int,int,int&gt; Datum::Ocitaj() const{
    std::tuple&lt;int, int, int&gt; t(dan, mjesec, godina);
</font>    return t;
}

void Vrijeme::Postavi(int s, int m){
    if(s&lt;0 || s&gt;23 || m&lt;0 || m&gt;59) throw std::domain_error("Neispravno vrijeme");
    sati=s; minute=m;
}
std::pair&lt;int,int&gt; Vrijeme::Ocitaj() const{
    std::pair&lt;int,int&gt; par(sati,minute);
    return par;
}
class Pregled{
    std::string ime_pacijenta;
    Datum dat_pregleda;
    Vrijeme v_pregleda;
    public:
    Pregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda): 
        ime_pacijenta(ime_pacijenta), dat_pregleda(datum_pregleda), v_pregleda(vrijeme_pregleda){}
    Pregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda):
        ime_pacijenta(ime_pacijenta), dat_pregleda(dan_pregleda,mjesec_pregleda,godina_pregleda), v_pregleda(sati_pregleda, minute_pregleda){}
    
    void PromijeniPacijenta(const std::string &amp;ime_pacijenta){
        this-&gt;ime_pacijenta=ime_pacijenta;
    }
    void PromijeniDatum(const Datum &amp;novi_datum);
    void PromijeniVrijeme(const Vrijeme &amp;novo_vrijeme);
    void PomjeriDanUnaprijed();
    void PomjeriDanUnazad();
    std::string DajImePacijenta() const { return ime_pacijenta; }
    Datum DajDatumPregleda() const { return dat_pregleda; }
    Vrijeme DajVrijemePregleda() const { return v_pregleda; }
    static bool DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2);
    void Ispisi() const { std::cout &lt;&lt; std::left &lt;&lt; std::setw(30) &lt;&lt; ime_pacijenta; 
    dat_pregleda.Datum::Ispisi(); std::cout &lt;&lt;" "; v_pregleda.Vrijeme::Ispisi(); std::cout &lt;&lt; std::endl;
    }
};

void Pregled::PromijeniDatum(const Datum &amp;novi_datum){
      std::tuple&lt;int,int,int&gt; dat;
      dat=novi_datum.Datum::Ocitaj();
      int d,m,g; std::tie(d,m,g)=dat;
      dat_pregleda.Datum::Postavi(d,m,g);
}
void Pregled::PromijeniVrijeme(const Vrijeme &amp;novo_vrijeme){
    std::pair&lt;int, int&gt; v;
    v=novo_vrijeme.Vrijeme::Ocitaj();
    v_pregleda.Postavi(v.first, v.second);
}
void Pregled::PomjeriDanUnaprijed(){
<a name="6"></a><font color="#00FF00"><a href="match496-0.html#6" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

    int br_dana[12]{31,28,31,30,31,30,31,31,30,31,30,31};
    std::tuple&lt;int,int,int&gt; dat;
</font>    dat=dat_pregleda.Datum::Ocitaj();
    int d,m,g; std::tie(d,m,g)=dat;
    if(g%4==0 &amp;&amp; g%100!=0 &amp;&amp; g%400==0) br_dana[1]++;
    d++; if(d&gt;br_dana[m-1]) d=1, m++;
    if(m&gt;12) m=1, g++;
    dat_pregleda.Datum::Postavi(d,m,g);
}
void Pregled::PomjeriDanUnazad(){
    int br_dana[12]{31,28,31,30,31,30,31,31,30,31,30,31};
    std::tuple&lt;int,int,int&gt; dat;
    dat=dat_pregleda.Datum::Ocitaj();
    int d,m,g; std::tie(d,m,g)=dat;
    if(g%4==0 &amp;&amp; g%100!=0 &amp;&amp; g%400==0) br_dana[1]++;
    d--; if(d&lt;1) d=br_dana[m-2], m--;
    if(m&gt;12) m=1, g++;
    if(m&lt;1) m=12, g--;
    dat_pregleda.Datum::Postavi(d,m,g);
}
bool Pregled::DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2){
    std::tuple&lt;int,int,int&gt; dat; dat=p1.dat_pregleda.Datum::Ocitaj(); int dan1,mj1,god1; std::tie(dan1,mj1,god1)=dat;
    std::pair&lt;int, int&gt; v;  v=p1.v_pregleda.Vrijeme::Ocitaj(); int sat1(v.first), min1(v.second);
    dat=p2.dat_pregleda.Datum::Ocitaj(); int dan2,mj2,god2; std::tie(dan2,mj2,god2)=dat;
    v=p2.v_pregleda.Vrijeme::Ocitaj(); int sat2(v.first), min2(v.second);
    if(god1==god2){
        if(mj1==mj2){
            if(dan1==dan2){
                if(sat1==sat2) return min1&lt;min2;
                return sat1&lt;sat2;
            }
            return dan1&lt;dan2;
        }
        return mj1&lt;mj2;
    }
    return god1&lt;god2;
}

class Pregledi{
  int kapacitet;
  int registrovano;
  Pregled **elementi;
  public: 
<a name="0"></a><font color="#FF0000"><a href="match496-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_2.gif"/></a>

  explicit Pregledi(int max_broj_pregleda): kapacitet(max_broj_pregleda), registrovano(0), elementi(new Pregled*[max_broj_pregleda]{}){}
  Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda);
  ~Pregledi(){ for(int i=0;i&lt;registrovano;i++) delete elementi[i]; delete[] elementi; }
  Pregledi (const Pregledi &amp;pregledi);
  Pregledi (Pregledi &amp;&amp;pregledi);
  Pregledi &amp;operator= (const Pregledi &amp;pregledi);
  Pregledi &amp;operator= (Pregledi &amp;&amp;pregledi);
</font>  void RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda);
  void RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda);
  void RegistrirajPregled(Pregled *pregled);
  int DajBrojPregleda() const{return registrovano;};
  int DajBrojPregledaNaDatum(const Datum &amp;datum) const;
  Pregled &amp;DajNajranijiPregled();
  Pregled DajNajranijiPregled() const;
  void IsprazniKolekciju();
  void ObrisiNajranijiPregled();
  void ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta);
  void IspisiPregledeNaDatum(const Datum &amp;datum) const;
<a name="10"></a><font color="#FF0000"><a href="match496-0.html#10" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_0.gif"/></a>

  void IspisiSvePreglede() const;
};
  Pregledi::Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda): 
  kapacitet(spisak_pregleda.size()), registrovano(spisak_pregleda.size()), elementi(new Pregled*[spisak_pregleda.size()]{}){
</font>      auto it(spisak_pregleda.begin());
    try{ 
         for(int i=0;i&lt;spisak_pregleda.size();i++){
          elementi[i]=new Pregled(*it);
          it++;
      }
    }catch(...){
        for(int i=0;i&lt;spisak_pregleda.size();i++) delete elementi[i];
        delete[] elementi; throw;
    }
  }

  Pregledi::Pregledi (const Pregledi &amp;pregledi): 
  kapacitet(pregledi.kapacitet), registrovano(pregledi.registrovano), elementi(new Pregled*[pregledi.kapacitet]{}){
    try{
        for(int i=0;i&lt;registrovano;i++) elementi[i]=new Pregled(*pregledi.elementi[i]);
    } catch(...){
        for(int i=0;i&lt;registrovano;i++) delete elementi[i]; 
        delete[] elementi; throw;
    }
  }
 
  Pregledi::Pregledi (Pregledi &amp;&amp;pregledi): 
<a name="5"></a><font color="#FF0000"><a href="match496-0.html#5" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

  kapacitet(pregledi.kapacitet), registrovano(pregledi.registrovano), elementi(pregledi.elementi){
      pregledi.elementi=nullptr; pregledi.registrovano=0;
  }
  
  Pregledi &amp;Pregledi::operator= (const Pregledi &amp;pregledi){
      if(&amp;pregledi==this) return *this;
</font>     // if(kapacitet!=pregledi.kapacitet){
          Pregled **novi_prostor(nullptr);
          try{
              novi_prostor=new Pregled*[pregledi.kapacitet]{};
              for(int i(0);i&lt;pregledi.registrovano;i++) novi_prostor[i]=new Pregled(*pregledi.elementi[i]);
              for(int i(0);i&lt;registrovano;i++) delete elementi[i]; delete[] elementi;
                elementi=novi_prostor;
                kapacitet=pregledi.kapacitet;
              }catch(...){
                  for(int i(0);i&lt;pregledi.registrovano;i++) delete novi_prostor[i]; delete[] novi_prostor;
                    throw;
              }
        /*}
          else{
              std::copy(pregledi.elementi, pregledi.elementi+registrovano, elementi);
          }*/
          registrovano=pregledi.registrovano;
          return *this;
  }
  
  Pregledi &amp;Pregledi::operator= (Pregledi &amp;&amp;pregledi){
      if(&amp;pregledi==this) return *this;
      std::swap(kapacitet, pregledi.kapacitet);
<a name="4"></a><font color="#FF00FF"><a href="match496-0.html#4" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

      std::swap(registrovano, pregledi.registrovano);
      std::swap(elementi, pregledi.elementi);
      return *this;
  }
  
  void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda){
</font>        if(registrovano&gt;=kapacitet) throw std::range_error("Dostignut maksimalni broj pregleda");
        Pregled* novi(nullptr);
        try{
        novi=new Pregled(ime_pacijenta, datum_pregleda, vrijeme_pregleda);
        elementi[registrovano++]=novi;
        }catch(...){ delete novi; throw;}
    }
    
  void Pregledi::RegistrirajPregled
  (const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda){
      if(registrovano&gt;=kapacitet) throw std::range_error("Dostignut maksimalni broj pregleda");
      Pregled* novi(nullptr);
     try{
      novi=new Pregled(ime_pacijenta, dan_pregleda,mjesec_pregleda,godina_pregleda,sati_pregleda,minute_pregleda);
      elementi[registrovano++]=novi;
     }catch(...){delete novi; throw;}
  }
  
  void Pregledi::RegistrirajPregled(Pregled *pregled){
      if(registrovano&gt;=kapacitet) throw std::range_error("Dostignut maksimalni broj pregleda");
        elementi[registrovano++]=pregled;
  }
  
int Pregledi::DajBrojPregledaNaDatum(const Datum &amp;datum) const{
        int br;
        std::tuple&lt;int,int,int&gt; datum2(datum.Ocitaj());
        int d2, m2, g2;
        std::tie(d2,m2,g2)=datum2;
        br=std::count_if(elementi, elementi+registrovano, [d2,m2,g2](Pregled* p){
            std::tuple &lt;int,int,int&gt; datum1((p-&gt;DajDatumPregleda()).Ocitaj());
         int d1, m1, g1;
         std::tie(d1,m1,g1)=datum1;
         return (d1==d2 &amp;&amp; m1==m2 &amp;&amp; g1==g2);});
        return br;
    }
    
  Pregled &amp;Pregledi::DajNajranijiPregled(){
<a name="2"></a><font color="#0000FF"><a href="match496-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

   Pregled **najmanji=std::min_element(elementi, elementi+registrovano,[](Pregled* p1, Pregled* p2){
       return Pregled::DolaziPrije(*p1,*p2); });
    return **najmanji;
  }
  
  Pregled Pregledi::DajNajranijiPregled() const{
      if(registrovano==0) throw std::range_error("Nema registriranih pregleda");
    Pregled **najmanji=std::min_element(elementi, elementi+registrovano,[](Pregled* p1, Pregled* p2){
</font><a name="11"></a><font color="#00FF00"><a href="match496-0.html#11" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_0.gif"/></a>

       return Pregled::DolaziPrije(*p1,*p2); });
</font>    return **najmanji;
  }
  
  void Pregledi::IsprazniKolekciju(){
      for(int i(0); i&lt;registrovano; i++){
          delete elementi[i];
          elementi[i]=nullptr;
      }
  }
  
 void Pregledi::ObrisiNajranijiPregled(){
     Pregled **najmanji=std::min_element(elementi, elementi+registrovano,[](Pregled* p1, Pregled* p2){
       return Pregled::DolaziPrije(*p1,*p2); });
       Pregled* pok_na_min(*najmanji);
       for(int i(0);i&lt;registrovano;i++){
           if(elementi[i]==pok_na_min){
              delete pok_na_min; pok_na_min=nullptr;
<a name="8"></a><font color="#00FFFF"><a href="match496-0.html#8" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_0.gif"/></a>

              for(int j=i;j&lt;registrovano-1;j++){
                 elementi[j]=elementi[j+1];
              }
          elementi[registrovano-1]=nullptr;
       registrovano--;}}
       
 }
 
  void Pregledi::ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta){
</font>          for(int i(0); i&lt;registrovano; i++){
              if(elementi[i]-&gt;DajImePacijenta()==ime_pacijenta){
              delete elementi[i]; elementi[i]=nullptr;
            for(int k(i);k&lt;registrovano-1;k++)   elementi[k]=elementi[k+1];
          elementi[registrovano-1]=nullptr;
                registrovano--;
                i--;
              }
          }
  }
  void Pregledi::IspisiPregledeNaDatum(const Datum &amp;datum) const{
      std::vector&lt;Pregled*&gt; v(registrovano, nullptr);
      for(int i(0);i&lt;registrovano;i++) v[i]=elementi[i];
      std::sort(v.begin(), v.end(), [](Pregled* p1, Pregled* p2){return Pregled::DolaziPrije(*p1,*p2);});
      std::tuple&lt;int,int,int&gt; datum2(datum.Ocitaj());
      for(int i(0);i&lt;registrovano;i++){
           std::tuple &lt;int,int,int&gt; datum1((v[i]-&gt;DajDatumPregleda()).Ocitaj());
         if (datum1==datum2) v[i]-&gt;Pregled::Ispisi();
      }
  }
  void Pregledi::IspisiSvePreglede() const{
      std::vector&lt;Pregled*&gt; v(registrovano, nullptr);
      for(int i(0);i&lt;registrovano;i++) v[i]=elementi[i];
      std::sort(v.begin(), v.end(), [](Pregled* p1, Pregled* p2){return Pregled::DolaziPrije(*p1,*p2);});
      for(int i(0);i&lt;registrovano;i++) v[i]-&gt;Pregled::Ispisi();
  }
int main ()
{
    std::cout &lt;&lt; "Unesite maksimalan broj pregleda: ";
    int max(0);
    std::cin &gt;&gt; max;
        Pregledi pregledi(max);
        for(int i(0);i&lt;max;i++){
            std::cout &lt;&lt; "Unesite ime novog pacijenta ili 'kraj' za zavrsetak unosa: ";
            std::string ime;
            std::cin &gt;&gt; ime;
            if(ime=="kraj")     break;
            std::cout &lt;&lt; "Unesite dan mjesec i godinu pregleda: " ;
            int d,m,g;
<a name="3"></a><font color="#00FFFF"><a href="match496-0.html#3" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

            std::cin &gt;&gt; d &gt;&gt; m &gt;&gt; g;
            std::cout &lt;&lt; "Unesite sate i minute pregleda: ";
            int h, min;
            std::cin &gt;&gt; h &gt;&gt; min;
            pregledi.RegistrirajPregled(ime,d,m,g,h,min);
           
        }
    
    std::cout &lt;&lt; "Trenutno su registrovani sljedeci pregledi" &lt;&lt; std::endl;
</font>    pregledi.IspisiSvePreglede();
    
    for(;;){
        std::cout &lt;&lt; std::endl;
        std::cout &lt;&lt; "Odaberite jednu od sljedecih opcija" &lt;&lt; std::endl;
        std::cout &lt;&lt; "1 - Broj pregleda na datum" &lt;&lt; std::endl;
        std::cout &lt;&lt; "2 - Najraniji pregled" &lt;&lt; std::endl;
        std::cout &lt;&lt; "3 - Obrisi pregled pacijenta" &lt;&lt; std::endl;
        std::cout &lt;&lt; "4 - Obrisi najraniji pregled" &lt;&lt; std::endl;
        std::cout &lt;&lt; "5 - Ispisi sve pregleda na datum" &lt;&lt; std::endl;
        std::cout &lt;&lt; "6 - Ispisi sve preglede"&lt;&lt; std::endl;
        std::cout &lt;&lt; "7 - Kraj programa" &lt;&lt; std::endl;
            int izbor(0);
            std::cin &gt;&gt; izbor;
            if(izbor==7) break;
            if(izbor==1){
                std::cout &lt;&lt; "Unesite dan mjesec i godinu : " ;
                int d,m,g; std::cin &gt;&gt; d &gt;&gt; m &gt;&gt;g;
                Datum trazeni(d,m,g);
                std::cout &lt;&lt; "Broj pregleda na datum "&lt;&lt;d&lt;&lt;" "&lt;&lt;m&lt;&lt;" "&lt;&lt;g&lt;&lt;" je: ";
                int broj(pregledi.DajBrojPregledaNaDatum(trazeni));
                std::cout &lt;&lt; broj;
            }
            if(izbor==2){
                std::cout &lt;&lt; "Najraniji pregled je:" &lt;&lt; std::endl;
                Pregled najraniji(pregledi.DajNajranijiPregled());
                najraniji.Pregled::Ispisi();
            }
            if(izbor==3){
                std::cout &lt;&lt; "Unesite ime pacijenta: " ;
                std::string ime;
                std::cin &gt;&gt; ime;
                int br(pregledi.DajBrojPregleda());
                pregledi.ObrisiPregledePacijenta(ime);
                br-=pregledi.DajBrojPregleda();
                std::cout &lt;&lt; "Uspjesno obrisano "&lt;&lt;br&lt;&lt;" pregleda" &lt;&lt; std::endl;
            }
            if(izbor==4){
                pregledi.ObrisiNajranijiPregled();
                std::cout &lt;&lt; "Najraniji pregled uspjesno obrisan" &lt;&lt; std::endl;
            }
            if(izbor==5){
              std::cout &lt;&lt; "Unesite dan mjesec i godinu : " ;
                int d,m,g; std::cin &gt;&gt; d &gt;&gt; m &gt;&gt;g;
                Datum trazeni(d,m,g);
                std::cout &lt;&lt; "Pregledi na datum "&lt;&lt;d&lt;&lt;" "&lt;&lt;m&lt;&lt;" "&lt;&lt;g&lt;&lt;" su:" &lt;&lt; std::endl;
                pregledi.IspisiPregledeNaDatum(trazeni);
            }
            if(izbor==6){
                pregledi.IspisiSvePreglede();
            }
    }
    return 0;
}
</pre>
</body>
</html>
