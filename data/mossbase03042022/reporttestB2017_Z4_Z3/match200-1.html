<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student7597.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z3/student8257.cpp<p></p><pre>
<a name="3"></a><font color="#00FFFF"><a href="match200-0.html#3" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

/B2017/2018: Zadaća 4, Zadatak 3
#include &lt;iostream&gt;
#include &lt;tuple&gt;
#include &lt;utility&gt;
#include &lt;iomanip&gt;
#include &lt;string&gt;
#include &lt;algorithm&gt;
#include &lt;utility&gt;

using std::string;

// DATUM

class Datum {
    int dan,mjesec,godina;
    
  public:
    Datum(int dan, int mjesec, int godina) { Postavi(dan, mjesec, godina); }
</font>    void Postavi(int d, int m, int g);
<a name="4"></a><font color="#FF00FF"><a href="match200-0.html#4" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

    std::tuple&lt;int, int, int&gt; Ocitaj() const { return std::make_tuple(dan,mjesec,godina); }
    void Ispisi() const { std::cout &lt;&lt; dan &lt;&lt; "/" &lt;&lt; mjesec &lt;&lt; "/" &lt;&lt; godina; }
    friend class Pregled;
};

void Datum::Postavi(int d, int m, int g) {
    int broj_dana[12]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
</font>    if(g % 4 == 0 &amp;&amp; g % 100 != 0 || g % 400 == 0) broj_dana[1]++;
<a name="1"></a><font color="#00FF00"><a href="match200-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_31.gif"/></a>

    if(g &lt; 1 || d &lt; 1 || m &lt; 1 || m &gt; 12 || d &gt; broj_dana[m - 1])
        throw std::domain_error("Neispravan datum!");
    dan = d; mjesec = m; godina = g;

}

// VRIJEME

class Vrijeme {
    int sati,minute;
    static bool DaLiJeIspravno(int h, int m) {
	    return (h&gt;=0 &amp;&amp; h&lt;=23 &amp;&amp; m&gt;=0 &amp;&amp; m&lt;=59);
    }
 public:
    Vrijeme(int sati, int minute) { Postavi(sati, minute); }
    void Postavi(int sati, int minute) {
   		if(!DaLiJeIspravno(sati,minute))
   			throw std::domain_error("Neispravno vrijeme");
   		Vrijeme::sati = sati; Vrijeme::minute = minute; 
   	}
    std::pair&lt;int, int&gt; Ocitaj () const { return {sati,minute}; }
    void Ispisi() const { std::cout&lt;&lt;std::setfill('0')&lt;&lt;std::right&lt;&lt;std::setw(2)&lt;&lt;sati&lt;&lt;":"&lt;&lt;std::setw(2)&lt;&lt;minute&lt;&lt;std::setfill(' ');}
    friend class Pregled;
};

// PREGLED 

class Pregled {
    string ime_pacijenta;
    Datum datum_pregleda;
    Vrijeme vrijeme_pregleda;
  
 public:
    // Konstruktori 
    Pregled(const string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda) :
        ime_pacijenta(ime_pacijenta), datum_pregleda(datum_pregleda), vrijeme_pregleda(vrijeme_pregleda) { };

    Pregled(const string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda,
        int godina_pregleda, int sati_pregleda, int minute_pregleda) : 
            ime_pacijenta(ime_pacijenta), datum_pregleda({dan_pregleda,mjesec_pregleda,godina_pregleda}), vrijeme_pregleda({sati_pregleda,minute_pregleda}) {};
    
    // Mutatori 
    void PromijeniPacijenta(const string &amp;ime_pacijenta) { this-&gt;ime_pacijenta = ime_pacijenta; }
    void PromijeniDatum(const Datum &amp;novi_datum) { datum_pregleda = novi_datum; }
    void PromijeniVrijeme(const Vrijeme &amp;novo_vrijeme) { vrijeme_pregleda = novo_vrijeme; }
    void PomjeriDanUnaprijed();
    void PomjeriDanUnazad();

    // Inspektori 
    string DajImePacijenta() const { return ime_pacijenta; }
    Datum DajDatumPregleda() const { return datum_pregleda; }
    Vrijeme DajVrijemePregleda() const { return vrijeme_pregleda; }
    void Ispisi() const { 
        std::cout&lt;&lt;std::left&lt;&lt;std::setw(30)&lt;&lt;ime_pacijenta; datum_pregleda.Ispisi(); std::cout&lt;&lt;" "; vrijeme_pregleda.Ispisi();
    }
    static bool DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2);
};

void Pregled::PomjeriDanUnaprijed() {
    int broj_dana[]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    if(datum_pregleda.godina % 4 == 0 &amp;&amp; datum_pregleda.godina % 100 != 0 || datum_pregleda.godina % 400 == 0)
        broj_dana[1]++;
    datum_pregleda.dan++;
    if(datum_pregleda.dan &gt; broj_dana[datum_pregleda.mjesec - 1]) datum_pregleda.dan = 1, datum_pregleda.mjesec++;
    if(datum_pregleda.mjesec &gt; 12) datum_pregleda.mjesec = 1, datum_pregleda.godina++;
}
void Pregled::PomjeriDanUnazad() {
    int broj_dana[]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    if(datum_pregleda.godina % 4 == 0 &amp;&amp; datum_pregleda.godina % 100 != 0 || datum_pregleda.godina % 400 == 0)
        broj_dana[1]++;
    datum_pregleda.dan--;
    if(datum_pregleda.dan &lt; 1 ) datum_pregleda.mjesec--;
    if(datum_pregleda.mjesec &lt; 1 ) datum_pregleda.mjesec = 12, datum_pregleda.godina--;
    datum_pregleda.dan = broj_dana[datum_pregleda.mjesec];
}
bool Pregled::DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2) {
    int dan1,dan2,mjesec1,mjesec2,godina1,godina2;
    Vrijeme v1 = p1.vrijeme_pregleda, v2 = p2.vrijeme_pregleda;
    std::tie(dan1,mjesec1,godina1) = p1.datum_pregleda.Ocitaj();
    std::tie(dan2,mjesec2,godina2) = p2.datum_pregleda.Ocitaj();
    
    if(godina1 == godina2) {
        if(mjesec1 == mjesec2) {
            if(dan1==dan2) {
                if(v1.sati == v2.sati) {
                    if(v1.minute == v2.minute)
                        return false ;         // Ako je došlo čak dovde to znači da se termini poklapaju
                    else
                        return v1.minute&lt;v2.minute;
                }
                else 
                    return v1.sati&lt;v2.sati;
            }
            else 
                return dan1&lt;dan2;
        }
        else 
            return mjesec1&lt;mjesec2;
    }
    else
        return godina1&lt;godina2;

}

// PREGLEDI!!


class Pregledi {
    int max_broj_pregleda;
    int broj_evidentiranih;
    Pregled** pregledi;
    
  public:
  
    // Konstruktori
    explicit Pregledi(int max_broj_pregleda) : max_broj_pregleda(max_broj_pregleda) , 
        broj_evidentiranih(0), pregledi(new Pregled*[max_broj_pregleda]{}) {} 
    Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda);
    Pregledi(const Pregledi &amp;pregledi);
    Pregledi(Pregledi &amp;&amp;pregledi);
    
    // Destruktor
    ~Pregledi() { for(int i=0;i&lt;broj_evidentiranih;i++) delete pregledi[i]; delete[] pregledi; }
    
    // Operatori dodjele
    Pregledi &amp;operator =(const Pregledi &amp;pregledi);
    Pregledi &amp;operator =(Pregledi &amp;&amp;pregledi);
    
    // Mutatori
    void RegistrirajPregled(const std::string &amp;ime_pacijenta,const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda);
</font><a name="0"></a><font color="#FF0000"><a href="match200-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_50.gif"/></a>

    void RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda,int mjesec_pregleda,
            int godina_pregleda, int sati_pregleda, int minute_pregleda);
    void RegistrirajPregled(Pregled *pregled);
    void IsprazniKolekciju() { for(int i=0;i&lt;broj_evidentiranih;i++) {delete pregledi[i]; pregledi[i] = nullptr; } }
    void ObrisiNajranijiPregled();
    void ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta);
    
    
    // Inspektori
    int DajBrojPregleda() const { return broj_evidentiranih; }
    int DajBrojPregledaNaDatum(const Datum &amp;datum) const {
        return std::count_if(pregledi, pregledi+broj_evidentiranih, [datum](Pregled* p)-&gt;bool {
            return p-&gt;DajDatumPregleda().Ocitaj() == datum.Ocitaj();
        });
    }
    Pregled &amp;DajNajranijiPregled();
    Pregled DajNajranijiPregled() const;
    void IspisiPregledeNaDatum(const Datum &amp;datum) const;
    void IspisiSvePreglede() const;
    
    
    
};

Pregledi::Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda) : max_broj_pregleda(spisak_pregleda.size()), 
        broj_evidentiranih(0) , pregledi(new Pregled*[spisak_pregleda.size()]{}) {
            try {
                auto it = spisak_pregleda.begin();
                for(int i=0;i&lt;spisak_pregleda.size();i++) {
                    pregledi[i] = new Pregled(*it++);
                }
            }
            catch(...) {
                for(int i=0;i&lt;spisak_pregleda.size();i++) delete pregledi[i];
                delete[] pregledi;
                throw;
            }
           
        }
    
    // Kopirajuci konstruktor
Pregledi::Pregledi(const Pregledi &amp;pregledi) : max_broj_pregleda(pregledi.max_broj_pregleda),   
    broj_evidentiranih(pregledi.broj_evidentiranih) , pregledi(new Pregled*[max_broj_pregleda]{}) {
        try {
            for(int i=0;i&lt;pregledi.broj_evidentiranih;i++) 
                this-&gt;pregledi[i] = new Pregled(*(pregledi.pregledi[i]));
        }
        catch(...) {
            for(int i=0;i&lt;pregledi.broj_evidentiranih;i++) delete this-&gt;pregledi[i];
            delete[] this-&gt;pregledi;
            throw;
        }
}
// Pomjerajuci konstruktor
Pregledi::Pregledi(Pregledi &amp;&amp;pregledi) : max_broj_pregleda(pregledi.max_broj_pregleda),
    broj_evidentiranih(pregledi.broj_evidentiranih) , pregledi(pregledi.pregledi) {
        pregledi.broj_evidentiranih = 0; pregledi.pregledi = nullptr; 
    }
   
// Kopirajuci operator dodjele 
Pregledi &amp;Pregledi::operator =(const Pregledi &amp;pregledi) {
    Pregled** novi_prostor = new Pregled*[pregledi.max_broj_pregleda]{};
    for(int i=0;i&lt;pregledi.broj_evidentiranih;i++) 
        novi_prostor[i] = new Pregled(*(pregledi.pregledi[i]));
        
    for(int i=0;i&lt;max_broj_pregleda;i++) delete this-&gt;pregledi[i];
    delete[] this-&gt;pregledi;
    
    max_broj_pregleda = pregledi.max_broj_pregleda; broj_evidentiranih = pregledi.broj_evidentiranih;
    this-&gt;pregledi = novi_prostor;
    return *this;
}

// Pomjerajuci operator dodjele
Pregledi &amp;Pregledi::operator =(Pregledi &amp;&amp;pregledi) {
    for(int i=0;i&lt;broj_evidentiranih;i++) delete this-&gt;pregledi[i];
    delete[] this-&gt;pregledi;
    broj_evidentiranih = pregledi.broj_evidentiranih;
    max_broj_pregleda = pregledi.max_broj_pregleda;
    this-&gt;pregledi = pregledi.pregledi;  pregledi.pregledi = nullptr; 
    pregledi.broj_evidentiranih = 0;
    return *this;
}

void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta,const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda) {
    if(broj_evidentiranih&gt;=max_broj_pregleda) throw std::range_error("Dostignut maksimalni broj pregleda");
    pregledi[broj_evidentiranih++] = new Pregled(ime_pacijenta,datum_pregleda,vrijeme_pregleda);
}
void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda,int mjesec_pregleda, 
    int godina_pregleda, int sati_pregleda,int minute_pregleda)  {
        if(broj_evidentiranih&gt;=max_broj_pregleda) throw std::range_error("Dostignut maksimalni broj pregleda");
        pregledi[broj_evidentiranih++] = new Pregled(ime_pacijenta, dan_pregleda, mjesec_pregleda, godina_pregleda, sati_pregleda, minute_pregleda);
    }
void Pregledi::RegistrirajPregled(Pregled *pregled) {
    if(broj_evidentiranih&gt;=max_broj_pregleda) throw std::range_error("Dostignut maksimalni broj pregleda");
    pregledi[broj_evidentiranih++] = pregled;
} 

Pregled &amp;Pregledi::DajNajranijiPregled() {
    if(broj_evidentiranih&lt;=0) throw std::domain_error("Nema registriranih");
    return **(std::min_element(pregledi, pregledi+broj_evidentiranih, [](Pregled* p1, Pregled* p2)-&gt;bool{
        return Pregled::DolaziPrije(*p1,*p2);
    }));
}
Pregled Pregledi::DajNajranijiPregled() const {
    if(broj_evidentiranih&lt;=0) throw std::domain_error("Nema registriranih");
        return **(std::min_element(pregledi, pregledi+broj_evidentiranih, [](Pregled* p1, Pregled* p2)-&gt;bool{
            return Pregled::DolaziPrije(*p1,*p2);
        }));
}
void Pregledi::ObrisiNajranijiPregled() {
    if(broj_evidentiranih&lt;=0) throw std::range_error("Prazna kolekcija");
    auto p_min = std::min_element(pregledi, pregledi+broj_evidentiranih, [](Pregled* p1, Pregled* p2)-&gt;bool{
        return Pregled::DolaziPrije(*p1,*p2);
    });
    delete *p_min; *p_min = nullptr;
    for(auto p = p_min; p&lt;pregledi+broj_evidentiranih-1; p++) {
        std::swap(*p, *(p+1));          // Pomjeram sve elemente unazad da popunim rupu kad se izbrise pregled
    }
    broj_evidentiranih--;
}
void Pregledi::ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta) {
    for(int i=0;i&lt;broj_evidentiranih;i++) {
        if(pregledi[i]==nullptr)
            continue;
        if(pregledi[i]-&gt;DajImePacijenta() == ime_pacijenta) {
            delete pregledi[i]; pregledi[i] = nullptr;
            for(auto p = &amp;pregledi[i]; p&lt;pregledi+broj_evidentiranih-1; p++) {
                std::swap(*p, *(p+1));          // Pomjeram sve elemente unazad da popunim rupu kad se izbrise pregled
            }
            broj_evidentiranih--;
            i--;
        }
    }
}
void Pregledi::IspisiPregledeNaDatum(const Datum &amp;datum) const {
    auto kopijaPregleda = *this;
    std::sort(kopijaPregleda.pregledi, kopijaPregleda.pregledi+broj_evidentiranih, [](Pregled* p1, Pregled* p2){
       return Pregled::DolaziPrije(*p1,*p2); 
    });
    std::for_each(kopijaPregleda.pregledi , kopijaPregleda.pregledi+broj_evidentiranih, [datum](Pregled* p)-&gt;void {
        if(p-&gt;DajDatumPregleda().Ocitaj()== datum.Ocitaj()) {
            p-&gt;Ispisi();
            std::cout&lt;&lt;std::endl;
        }
    });
}
void Pregledi::IspisiSvePreglede() const {
    auto kopijaPregleda = *this;
    std::sort(kopijaPregleda.pregledi, kopijaPregleda.pregledi+broj_evidentiranih, [](Pregled* p1, Pregled* p2){
       return Pregled::DolaziPrije(*p1,*p2); 
    });
    for(int i=0;i&lt;broj_evidentiranih;i++) {
        kopijaPregleda.pregledi[i]-&gt;Ispisi();
        std::cout&lt;&lt;std::endl;
    }
}


int main ()
{
    
    std::cout&lt;&lt;"Unesite maksimalan broj pregleda: ";
    int n;
    std::cin&gt;&gt;n;
    Pregledi pregledi(n);
    for(int i=0;i&lt;n;i++) {
        std::cin.ignore(10000,'\n');
        std::cout&lt;&lt;"Unesite ime novog pacijenta ili 'kraj' za zavrsetak unosa: ";
        string ime;
        std::getline(std::cin, ime);
        if(ime=="kraj") break;
        std::cout&lt;&lt;"Unesite dan mjesec i godinu pregleda: ";
        int d,m,g;
        std::cin&gt;&gt;d&gt;&gt;m&gt;&gt;g;
        std::cout&lt;&lt;"Unesite sate i minute pregleda: ";
        int sati,minute;
        std::cin&gt;&gt;sati&gt;&gt;minute;
        pregledi.RegistrirajPregled(ime,d,m,g,sati,minute);
    }
    std::cout&lt;&lt;"Trenutno su registrovani sljedeci pregledi\n";
    pregledi.IspisiSvePreglede();
    int izbor=0;
    while(true) {
        std::cout&lt;&lt;"Odaberite jednu od sljedecih opcija\n";
        std::cout&lt;&lt;"1 - Broj pregleda na datum\n"
            &lt;&lt;"2 - Najraniji pregled\n"
            &lt;&lt;"3 - Obrisi pregled pacijenta\n"
            &lt;&lt;"4 - Obrisi najraniji pregled\n"
            &lt;&lt;"5 - Ispisi sve pregleda na datum\n"
            &lt;&lt;"6 - Ispisi sve preglede\n"
            &lt;&lt;"7 - Kraj programa\n";
        std::cin&gt;&gt;izbor;
        if(izbor==1) {
            std::cout&lt;&lt;"Unesite dan mjesec i godinu : ";
            int dan,mjes,god; std::cin&gt;&gt;dan&gt;&gt;mjes&gt;&gt;god;
</font><a name="2"></a><font color="#0000FF"><a href="match200-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_7.gif"/></a>

            std::cout&lt;&lt;"Broj pregleda na datum "&lt;&lt;dan&lt;&lt;" "&lt;&lt;
            mjes&lt;&lt;" "&lt;&lt;god&lt;&lt;" je: "&lt;&lt;pregledi.DajBrojPregledaNaDatum({dan,mjes,god})&lt;&lt;"\n";
        }
        else if(izbor==2) {
            std::cout&lt;&lt;"Najraniji pregled je:\n";
            pregledi.DajNajranijiPregled().Ispisi();
            std::cout&lt;&lt;"\n";
        }
        else if(izbor==3) {
            int brojPrijeBrisanja = pregledi.DajBrojPregleda();
            std::cout&lt;&lt;"Unesite ime pacijenta: ";
            string ime;
            std::cin.ignore(10000,'\n');
            std::getline(std::cin, ime);
            pregledi.ObrisiPregledePacijenta(ime);
            std::cout&lt;&lt;"Uspjesno obrisano "&lt;&lt;brojPrijeBrisanja-pregledi.DajBrojPregleda()&lt;&lt;" pregleda\n";
        }
        else if(izbor==4) {
            pregledi.ObrisiNajranijiPregled();
            std::cout&lt;&lt;"Najraniji pregled uspjesno obrisan\n";
        }
        else if(izbor==5) {
            std::cout&lt;&lt;"Unesite dan mjesec i godinu : ";
            int dan,mjes,god; std::cin&gt;&gt;dan&gt;&gt;mjes&gt;&gt;god;
            std::cout&lt;&lt;"Pregledi na datum 18 12 2018 su:\n";
            pregledi.IspisiPregledeNaDatum({dan,mjes,god});
        }
        else if(izbor==6) {
            pregledi.IspisiSvePreglede();
        }
        else 
</font>            break;
    }
	return 0;
}
</pre>
</body>
</html>
