<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z4/student9081.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z4/student8863.cpp<p></p><pre>
#include &lt;iostream&gt;
#include &lt;stdexcept&gt;
#include &lt;iomanip&gt;
#include &lt;memory&gt;
#include &lt;tuple&gt;
#include &lt;utility&gt;
#include &lt;string&gt;
#include &lt;initializer_list&gt;
#include &lt;algorithm&gt;
#include &lt;vector&gt;

class Datum {
<a name="6"></a><font color="#00FF00"><a href="match957-0.html#6" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

    int dan, mjesec, godina;
public:
    Datum(int dan, int mjesec, int godina) { Postavi(dan, mjesec, godina); }
    void Postavi(int dan, int mjesec, int godina) {
</font>        int br_dana[12] {31, 28, 31, 30 , 31, 30, 31, 31, 30, 31, 30, 31};
        if (godina % 400 == 0 || (godina % 100 != 0 &amp;&amp; godina % 4 == 0)) br_dana[1]++;
        if (dan &lt; 0 || dan &gt; br_dana[mjesec-1] || mjesec &lt; 0 || mjesec &gt; 12 || godina &lt; 0)
            throw std::domain_error("Neispravan datum");
        Datum::dan = dan; Datum::mjesec = mjesec; Datum::godina = godina;
    }
    std::tuple&lt;int, int, int&gt; Ocitaj() const {
        return std::make_tuple(dan, mjesec, godina);
    }
    void Ispisi() const {
        std::cout &lt;&lt; dan &lt;&lt; "/" &lt;&lt; mjesec &lt;&lt; "/" &lt;&lt; godina;
    }
};

class Vrijeme {
    int sati, minute;
public:
    Vrijeme(int sati, int minute) { Postavi(sati, minute); }
    void Postavi(int sati, int minute) {
        if (sati &lt; 0 || sati &gt; 23 || minute &lt; 0 || minute &gt; 59)
            throw std::domain_error("Neispravno vrijeme");
        Vrijeme::sati = sati; Vrijeme::minute = minute;
    }
    std::pair&lt;int, int&gt; Ocitaj() const {
        return std::make_pair(sati, minute);
    }
    void Ispisi() const {
        std::cout &lt;&lt; std::setw(2) &lt;&lt; std::setfill('0') &lt;&lt; std::right
        &lt;&lt; sati &lt;&lt; ":" &lt;&lt; std::setw(2) &lt;&lt; minute;
    }
};

class Pregled {
    std::string ime_pacijenta;
    Datum datum_pregleda;
    Vrijeme vrijeme_pregleda;
    int DaniUMjesecu(int mjesec, int godina) {
        int br_dana[12] {31, 28, 31, 30 , 31, 30, 31, 31, 30, 31, 30, 31};
        if (godina % 400 == 0 || (godina % 100 != 0 &amp;&amp; godina % 4 == 0)) br_dana[1]++;
        return br_dana[mjesec-1];
    }
public:
    Pregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda,
        const Vrijeme &amp;vrijeme_pregleda) : ime_pacijenta(ime_pacijenta),
        datum_pregleda(datum_pregleda), vrijeme_pregleda(vrijeme_pregleda) { }
    Pregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda,
        int godina_pregleda, int sati_pregleda, int minute_pregleda) :
        ime_pacijenta(ime_pacijenta),
        datum_pregleda(dan_pregleda, mjesec_pregleda, godina_pregleda),
<a name="4"></a><font color="#FF00FF"><a href="match957-0.html#4" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

        vrijeme_pregleda(sati_pregleda, minute_pregleda) {}
    void PromjeniPacijenta(const std::string &amp;novi_pacijent) {
        ime_pacijenta = novi_pacijent;
    }
    void PromjeniDatum(const Datum &amp;novi_datum) {
        datum_pregleda = novi_datum;
    }
    void PromjeniVrijeme(const Vrijeme &amp;novo_vrijeme) {
        vrijeme_pregleda = novo_vrijeme;
    }
    void PomjeriDanUnaprijed() {
</font>        auto dat(datum_pregleda.Ocitaj());
        int d(std::get&lt;0&gt;(dat)+1), m(std::get&lt;1&gt;(dat)), g(std::get&lt;2&gt;(dat));
        if (d &gt; DaniUMjesecu(m,g)) { d = 1; m++; }
        if (m &gt; 12) { m = 1; g++; }
        datum_pregleda.Postavi(d,m,g);
    }
    void PomjeriDanUnazad() {
        auto dat(datum_pregleda.Ocitaj());
        int d(std::get&lt;0&gt;(dat)-1), m(std::get&lt;1&gt;(dat)), g(std::get&lt;2&gt;(dat));
        if (d == 0) { m--; d = DaniUMjesecu(m, g); }
        if (m == 0) { m = 12; g--; }
        datum_pregleda.Postavi(d,m,g);
    }
    std::string DajImePacijenta() const { return ime_pacijenta; }
<a name="1"></a><font color="#00FF00"><a href="match957-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_2.gif"/></a>

    Datum DajDatumPregleda() const { return datum_pregleda; }
    Vrijeme DajVrijemePregleda() const { return vrijeme_pregleda; }
    static bool DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2);
    void Ispisi() const {
        std::cout &lt;&lt; std::left &lt;&lt; std::setw(30) &lt;&lt; std::setfill(' ') &lt;&lt; ime_pacijenta; 
        datum_pregleda.Ispisi();
        std::cout &lt;&lt; " ";
        vrijeme_pregleda.Ispisi() ;
        std::cout &lt;&lt; std::endl;
</font>    }
    static bool IstiTermin(const Pregled &amp;p1, const Pregled &amp;p2) {
        return p1.DajDatumPregleda().Ocitaj() == p2.DajDatumPregleda().Ocitaj()
            &amp;&amp; p1.DajVrijemePregleda().Ocitaj() == p2.DajVrijemePregleda().Ocitaj();
    }
};

class Pregledi{
    std::vector&lt;std::shared_ptr&lt;Pregled&gt;&gt; pregledi;
    int DajSljedeci(int trenutni) const {
        int sljedeci(-1);
        for (int i = 0; i &lt; pregledi.size(); i++) {
            if (i == trenutni || Pregled::DolaziPrije(*pregledi[i], *pregledi[trenutni]) ||
                Pregled::IstiTermin(*pregledi[i], *pregledi[trenutni]) &amp;&amp; i &lt; trenutni) continue;
            if (sljedeci == -1) sljedeci = i;
            else if ((Pregled::DolaziPrije(*pregledi[trenutni], *pregledi[i])
                || Pregled::IstiTermin(*pregledi[trenutni], *pregledi[i]))
                &amp;&amp; Pregled::DolaziPrije(*pregledi[i], *pregledi[sljedeci]))
                sljedeci = i;
        }
        return sljedeci;
    }
public:
    explicit Pregledi() : pregledi(0) { }
    Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda);
    ~Pregledi() = default;
    Pregledi(const Pregledi &amp;pregledi) = default;
    Pregledi(Pregledi &amp;&amp;p) : pregledi(p.pregledi) { p.pregledi.resize(0); }
    Pregledi &amp;operator = (const Pregledi &amp;pregledi) = default;
    Pregledi &amp;operator = (Pregledi &amp;&amp;pregledi) = default;
    void RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;dat, 
        const Vrijeme &amp;vrijeme) {
            pregledi.push_back(std::make_shared&lt;Pregled&gt;(ime_pacijenta, dat, vrijeme));
        }
    void RegistrirajPregled(const std::string &amp;ime_pacijenta, int d, int m, 
        int g, int h, int min) {
            pregledi.push_back(std::make_shared&lt;Pregled&gt;(ime_pacijenta, d, m, g, h, min));
        }
    void RegistrirajPregled(std::shared_ptr&lt;Pregled&gt; pregled) {
        pregledi.push_back(pregled);
    }
<a name="3"></a><font color="#00FFFF"><a href="match957-0.html#3" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

    int DajBrojPregleda() const { return pregledi.size(); }
    int DajBrojPregledaNaDatum(const Datum &amp;datum) const;
    Pregled &amp;DajNajranijiPregled();
    Pregled DajNajranijiPregled() const;
    void IsprazniKolekciju() {
        pregledi.resize(0);
    }
    void ObrisiNajranijiPregled();
    void ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta);
    void IspisiPregledeNaDatum(const Datum &amp;datum) const;
    void IspisiSvePreglede() const;
</font>    
};

bool Pregled::DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2) {
    auto dat1(p1.DajDatumPregleda().Ocitaj());
<a name="2"></a><font color="#0000FF"><a href="match957-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_2.gif"/></a>

    auto dat2(p2.DajDatumPregleda().Ocitaj());
        if (std::get&lt;2&gt;(dat1) == std::get&lt;2&gt;(dat2)) {
            if (std::get&lt;1&gt;(dat1) == std::get&lt;1&gt;(dat2)) {
                if (std::get&lt;0&gt;(dat1) == std::get&lt;0&gt;(dat2)) {
</font>                    auto v1(p1.DajVrijemePregleda().Ocitaj());
                    auto v2(p2.DajVrijemePregleda().Ocitaj());
<a name="0"></a><font color="#FF0000"><a href="match957-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_3.gif"/></a>

                    if (v1.first == v2.first) 
                        return v1.second &lt; v2.second;
                    return v1.first &lt; v2.first;
                }
                return std::get&lt;0&gt;(dat1) &lt; std::get&lt;0&gt;(dat2);
            }
            return std::get&lt;1&gt;(dat1) &lt; std::get&lt;1&gt;(dat2);
        }
        return std::get&lt;2&gt;(dat1) &lt; std::get&lt;2&gt;(dat2);
</font>}

Pregledi::Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda) {
    for (auto it = spisak_pregleda.begin(); it != spisak_pregleda.end(); it++) 
<a name="5"></a><font color="#FF0000"><a href="match957-0.html#5" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

        pregledi.push_back(std::make_shared&lt;Pregled&gt;(*it));
}
    
int Pregledi::DajBrojPregledaNaDatum(const Datum &amp;datum) const {
    return std::count_if(pregledi.begin(), pregledi.end(), 
        [datum](std::shared_ptr&lt;Pregled&gt; p) { 
</font>            return p-&gt;DajDatumPregleda().Ocitaj() == datum.Ocitaj(); 
        });
}

Pregled &amp;Pregledi::DajNajranijiPregled() {
    if (!pregledi.size()) throw std::domain_error("Nema registriranih pregleda");
    return **(std::min_element(pregledi.begin(), pregledi.end(),
        [](std::shared_ptr&lt;Pregled&gt; p1, std::shared_ptr&lt;Pregled&gt; p2) {
            return Pregled::DolaziPrije(*p1,*p2); 
        }));
}

Pregled Pregledi::DajNajranijiPregled() const {
    if (!pregledi.size()) throw std::domain_error("Nema registriranih pregleda");
    return **(std::min_element(pregledi.begin(), pregledi.end(),
        [](std::shared_ptr&lt;Pregled&gt; p1, std::shared_ptr&lt;Pregled&gt; p2) {
            return Pregled::DolaziPrije(*p1,*p2); 
        }));
}

void Pregledi::ObrisiNajranijiPregled() {
    if (!pregledi.size()) throw std::range_error("Prazna kolekcija");
    auto pok(&amp;DajNajranijiPregled());
    int i(0);
    for (; i &lt; pregledi.size(); i++) if (pregledi[i].get() == pok) break;
    pregledi.erase(pregledi.begin() + i);
}

void Pregledi::ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta) {
    for (int i = 0; i &lt; pregledi.size(); i++) {
        if (pregledi[i]-&gt;DajImePacijenta() == ime_pacijenta) {
            pregledi.erase(pregledi.begin()+i);
            i--;
        }
    }
}

void Pregledi::IspisiSvePreglede() const {
    Pregled p(DajNajranijiPregled());
    int x(0);
    while (!Pregled::IstiTermin(*pregledi[x], p) || !(pregledi[x]-&gt;DajImePacijenta() == p.DajImePacijenta())) x++;
    for (int i = 0; i &lt; pregledi.size(); i++) {
        pregledi[x]-&gt;Ispisi();
        int a(DajSljedeci(x));
        if (a != -1) x = a;
    }
}
void Pregledi::IspisiPregledeNaDatum(const Datum &amp;datum) const {
    Pregled p(DajNajranijiPregled());
    int x(0);
    while (!Pregled::IstiTermin(*pregledi[x], p) || !(pregledi[x]-&gt;DajImePacijenta() == p.DajImePacijenta())) x++;
    for (int i = 0; i &lt; pregledi.size(); i++) {
        if (pregledi[x]-&gt;DajDatumPregleda().Ocitaj() == datum.Ocitaj()) pregledi[x]-&gt;Ispisi();
        int a(DajSljedeci(x));
        if (a != -1) x = a;
    }
}


int main() {
    try {
        Pregledi pregledi;
        for (;;) {
            std::cout &lt;&lt; "Unesite ime novog pacijenta ili 'kraj' za zavrsetak unosa: ";
            std::string ime;
            if (std::cin &gt;&gt; ime, ime == "kraj") break;
            std::cout &lt;&lt; "Unesite dan mjesec i godinu pregleda: ";
            int d, m, g, s, min;
<a name="7"></a><font color="#0000FF"><a href="match957-0.html#7" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

            std::cin &gt;&gt; d &gt;&gt; m &gt;&gt; g;
            std::cout &lt;&lt; "Unesite sate i minute pregleda: ";
            std::cin &gt;&gt; s &gt;&gt; min;
</font>            pregledi.RegistrirajPregled(ime, d, m, g, s, min);
        }
        std::cout &lt;&lt; "Trenutno su registrovani sljedeci pregledi" &lt;&lt; std::endl;
        pregledi.IspisiSvePreglede();
        for (;;) {
            std::cout &lt;&lt; std::endl;
            std::cout &lt;&lt; "Odaberite jednu od sljedecih opcija" &lt;&lt; std::endl
            &lt;&lt; "1 - Broj pregleda na datum" &lt;&lt; std::endl
            &lt;&lt; "2 - Najraniji pregled" &lt;&lt; std::endl
            &lt;&lt; "3 - Obrisi pregled pacijenta" &lt;&lt; std::endl
            &lt;&lt; "4 - Obrisi najraniji pregled" &lt;&lt; std::endl
            &lt;&lt; "5 - Ispisi sve pregleda na datum" &lt;&lt; std::endl
            &lt;&lt; "6 - Ispisi sve preglede" &lt;&lt; std::endl
            &lt;&lt; "7 - Kraj programa" &lt;&lt; std::endl;
            int n; std::cin &gt;&gt; n;
            switch(n) {
                case 1: {
                    int d,m,g;
                    std::cout &lt;&lt; "Unesite dan mjesec i godinu : ";
                    std::cin &gt;&gt; d &gt;&gt; m &gt;&gt; g;
                    Datum dat(d,m,g);
                    std::cout &lt;&lt; "Broj pregleda na datum " &lt;&lt; d &lt;&lt; " " &lt;&lt; m 
                    &lt;&lt; " " &lt;&lt; g &lt;&lt; " je: " &lt;&lt; pregledi.DajBrojPregledaNaDatum(dat)
                    &lt;&lt; std::endl;
                    break;
                }
                case 2: {
                    std::cout &lt;&lt; "Najraniji pregled je:" &lt;&lt; std::endl;
                    pregledi.DajNajranijiPregled().Ispisi();
                    break;
                }
                case 3: {
                    std::string ime;
                    std::cout &lt;&lt; "Unesite ime pacijenta: ";
<a name="8"></a><font color="#00FFFF"><a href="match957-0.html#8" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

                    std::cin &gt;&gt; ime;
                    int br(pregledi.DajBrojPregleda());
                    pregledi.ObrisiPregledePacijenta(ime);
                    std::cout &lt;&lt; "Uspjesno obrisano " 
                    &lt;&lt; br - pregledi.DajBrojPregleda() 
                    &lt;&lt; " pregleda" &lt;&lt; std::endl;
</font>                    break;
                }
                case 4: {
                    pregledi.ObrisiNajranijiPregled();
                    std::cout &lt;&lt; "Najraniji pregled uspjesno obrisan" 
                    &lt;&lt; std::endl;
                    break;
                }
                case 5: {
                    int d,m,g;
                    std::cout &lt;&lt; "Unesite dan mjesec i godinu : ";
                    std::cin &gt;&gt; d &gt;&gt; m &gt;&gt; g;
                    Datum dat(d,m,g);
                    std::cout &lt;&lt; "Pregledi na datum " &lt;&lt; d &lt;&lt; " " &lt;&lt; m 
                    &lt;&lt; " " &lt;&lt; g &lt;&lt; " su:" &lt;&lt; std::endl;
                    pregledi.IspisiPregledeNaDatum(dat);
                    break;
                }
                case 6: {
                    pregledi.IspisiSvePreglede();
                    break;
                }
                case 7: return 0;
            }
        }
    }
    catch (std::range_error e) {
        std::cout &lt;&lt; e.what();
    }
    catch (std::domain_error e) {
        std::cout &lt;&lt; e.what();
    }
    catch (std::bad_alloc) {
        std::cout &lt;&lt; "Problemi sa memorijom";
    }
    return 0;
}</pre>
</body>
</html>
