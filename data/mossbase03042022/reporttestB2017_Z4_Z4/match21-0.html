<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z4/student7051.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z4/student7051.cpp<p></p><pre>
<a name="2"></a><font color="#0000FF"><a href="match21-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_11.gif"/></a>

/B2017/2018: ZadaÄ‡a 4, Zadatak 3
#include &lt;iostream&gt;
#include &lt;tuple&gt;
#include &lt;string&gt; 
#include &lt;utility&gt;
#include &lt;stdexcept&gt;
#include &lt;iomanip&gt;
#include &lt;algorithm&gt;
#include &lt;cstring&gt;
#include &lt;vector&gt;
#include &lt;memory&gt;

int br=0;

class Datum{
    int dan;
    int mjesec;
    int godina;
int BrojDana (int mjesec, int godina){
    int broj_dana[]{31,28,31,30,31,30,31,31,30,31,30,31};
    if (godina%4==0 &amp;&amp; godina % 100!=0 || godina % 400==0) broj_dana[1]++;
    return broj_dana[mjesec-1];
}
public:
    Datum(int dan, int mjesec, int godina){Postavi(dan,mjesec,godina);}
    void Postavi(int dan, int mjesec, int godina);
    std::tuple&lt;int, int, int&gt; Ocitaj() const;
    void Ispisi() const; 
};

class Vrijeme{
    int sati;
    int minute;
public:
    Vrijeme(int sati, int minute){Postavi(sati, minute);}
    void Postavi(int sati, int minute);  
    std::pair&lt;int, int&gt; Ocitaj () const;  
    void Ispisi() const; 
};

class Pregled{
    std::string ime_pacijenta;
    Datum datum_pregleda;
    Vrijeme vrijeme_pregleda;
public:
    Pregled(const std::string&amp; ime_pacijenta, const Datum&amp; datum_pregleda,  const Vrijeme&amp;  vrijeme_pregleda);  
    Pregled(const std::string&amp; ime_pacijenta, int dan_pregleda, int mjesec_pregleda,  int godina_pregleda, int sati_pregleda, int minute_pregleda);  
    void PromijeniPacijenta(const std::string&amp;  ime_pacijenta);  
    void PromijeniDatum(const Datum&amp;  novi_datum);  
    void PromijeniVrijeme(const Vrijeme&amp;  novo_vrijeme); 
    void PomjeriDanUnaprijed(); 
    void PomjeriDanUnazad();  
    std::string DajImePacijenta() const {return ime_pacijenta;}
    Datum DajDatumPregleda() const {return datum_pregleda;}  
    Vrijeme DajVrijemePregleda() const {return vrijeme_pregleda;}
    static bool DolaziPrije(const Pregled&amp;  p1, const Pregled&amp;  p2);  
    void Ispisi() const; 
};

class Pregledi{
    std::vector&lt;std::shared_ptr&lt;Pregled&gt;&gt; pregledi;

public:
    explicit Pregledi() { }
    Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda);
    ~Pregledi() {}
    Pregledi(const Pregledi &amp;pregledi);
    Pregledi(Pregledi &amp;&amp;pregledi);
    Pregledi &amp;operator =(const Pregledi &amp;pregledi);
    Pregledi &amp;operator =(Pregledi &amp;&amp;pregledi);
</font>    void RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda);
<a name="0"></a><font color="#FF0000"><a href="match21-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_73.gif"/></a>

    void RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda);
    void RegistrirajPregled(std::shared_ptr&lt;Pregled&gt; pregled);
    int DajBrojPregleda() const { return pregledi.size(); }
    int DajBrojPregledaNaDatum(const Datum &amp;datum) const;
    Pregled &amp;DajNajranijiPregled();
    Pregled DajNajranijiPregled() const;
    void IsprazniKolekciju();
    void ObrisiNajranijiPregled();
    void ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta);
    void IspisiPregledeNaDatum(const Datum &amp;datum) const;
    void IspisiSvePreglede() const;
};

void Datum::Postavi(int dan, int mjesec, int godina){
    if (godina&lt;1 || dan&lt;1 || mjesec&lt;1 || mjesec&gt;12 || dan&gt;BrojDana(mjesec,godina)) throw std::domain_error("Neispravan datum");
    Datum::dan=dan; Datum::mjesec=mjesec; Datum::godina=godina;
}

std::tuple&lt;int,int,int&gt; Datum::Ocitaj () const{
    std::tuple&lt;int, int, int&gt; datum (dan, mjesec, godina);
    return datum;
}

void Datum::Ispisi() const{
    std::cout&lt;&lt;dan&lt;&lt;"/"&lt;&lt;mjesec&lt;&lt;"/"&lt;&lt;godina;
}

void Vrijeme::Postavi(int sati, int minute){
    if (sati&gt;=0 &amp;&amp; sati&lt;=23 &amp;&amp; minute&gt;=0 &amp;&amp; minute&lt;=59){
        Vrijeme::sati=sati;
        Vrijeme::minute=minute;
    }else throw std::domain_error ("Neispravno vrijeme");
}

std::pair&lt;int, int&gt; Vrijeme::Ocitaj () const {
    return std::make_pair (sati, minute);
}

void Vrijeme::Ispisi() const {
    std::cout&lt;&lt;std::setfill('0')&lt;&lt;std::setw(2)&lt;&lt;sati&lt;&lt;":"&lt;&lt;std::setw(2)&lt;&lt;minute;
    std::cout&lt;&lt;std::setfill(' ');
}

Pregled::Pregled(const std::string&amp;  ime_pacijenta, const Datum&amp;  datum_pregleda, const Vrijeme&amp;  vrijeme_pregleda) : datum_pregleda(datum_pregleda), vrijeme_pregleda(vrijeme_pregleda) {
    PromijeniPacijenta(ime_pacijenta);
    
}    
/*kad imas atribut u klasi klasa moras u inic*/
Pregled::Pregled(const std::string&amp; ime_pacijenta, int dan_pregleda, int mjesec_pregleda,  int godina_pregleda, int sati_pregleda, int minute_pregleda) : datum_pregleda(dan_pregleda,mjesec_pregleda,godina_pregleda), vrijeme_pregleda(sati_pregleda, minute_pregleda){
    PromijeniPacijenta(ime_pacijenta);
}
void Pregled::PromijeniPacijenta(const std::string&amp; ime_pacijenta){
    Pregled::ime_pacijenta=ime_pacijenta;
}

void Pregled::PromijeniDatum(const Datum&amp; novi_datum){
    datum_pregleda=novi_datum;
}

void Pregled::PromijeniVrijeme(const Vrijeme&amp; novo_vrijeme){
    vrijeme_pregleda=novo_vrijeme;
}

void Pregled::PomjeriDanUnaprijed () {
    std::tuple &lt;int, int, int&gt; datum;
    datum=(*this).datum_pregleda.Ocitaj();
    std::get&lt;0&gt;(datum)++;
    int broj_dana[]{31,28,31,30,31,30,31,31,30,31,30,31};
    if (std::get&lt;2&gt;(datum)%100!=0 &amp;&amp; std::get&lt;2&gt;(datum)%4==0 || std::get&lt;2&gt;(datum)%400==0) broj_dana[1]++;
    if (std::get&lt;0&gt;(datum)&gt;broj_dana[std::get&lt;1&gt;(datum)-1]){ 
        std::get&lt;0&gt;(datum)=1;
        std::get&lt;1&gt;(datum)++;
    }
    if (std::get&lt;1&gt;(datum)&gt;12) {
        std::get&lt;1&gt;(datum)=1;
        std::get&lt;2&gt;(datum)++;
    }
    Datum pomocni(std::get&lt;0&gt;(datum), std::get&lt;1&gt;(datum), std::get&lt;2&gt;(datum));
    (*this).datum_pregleda=pomocni;
}

void Pregled::PomjeriDanUnazad () {
    std::tuple &lt;int, int, int&gt; datum;
    datum=(*this).datum_pregleda.Ocitaj();
    std::get&lt;0&gt;(datum)--;
    int broj_dana[]{31,28,31,30,31,30,31,31,30,31,30,31};
    if (std::get&lt;2&gt;(datum)%100!=0 &amp;&amp; std::get&lt;2&gt;(datum)%4==0 || std::get&lt;2&gt;(datum)%400==0) broj_dana[1]++;
    if (std::get&lt;0&gt;(datum)==0 &amp;&amp; std::get&lt;1&gt;(datum)==1){
        std::get&lt;0&gt;(datum)=31;
        std::get&lt;2&gt;(datum)--;
        std::get&lt;1&gt;(datum)=12;
    }
    if (std::get&lt;0&gt;(datum)&lt;=0){ 
        std::get&lt;0&gt;(datum)=broj_dana[std::get&lt;1&gt;(datum)-2];
        std::get&lt;1&gt;(datum)--;
    }
    Datum pomocni(std::get&lt;0&gt;(datum), std::get&lt;1&gt;(datum), std::get&lt;2&gt;(datum));
    (*this).datum_pregleda=pomocni;
}

bool Pregled::DolaziPrije(const Pregled&amp; p1, const Pregled&amp; p2){ /*MORAJ DAJ, samo s funkcijama*/
    std::tuple &lt;int, int, int&gt; d1, d2;
    std::pair &lt;int, int&gt; v1, v2;
    d1=p1.DajDatumPregleda().Ocitaj();
    d2=p2.DajDatumPregleda().Ocitaj();
    v1=p1.DajVrijemePregleda().Ocitaj();
    v2=p2.DajVrijemePregleda().Ocitaj();
    if (std::get&lt;2&gt;(d1)!=std::get&lt;2&gt;(d2)) return std::get&lt;2&gt;(d1)&lt;std::get&lt;2&gt;(d2);
    else if (std::get&lt;1&gt;(d1)!=std::get&lt;1&gt;(d2)) return std::get&lt;1&gt;(d1)&lt;std::get&lt;1&gt;(d2);
    else if (std::get&lt;0&gt;(d1)!=std::get&lt;0&gt;(d2)) return std::get&lt;0&gt;(d1)&lt;std::get&lt;0&gt;(d2);
    else if (v1.first!=v2.first) return v1.first&lt;v2.first;
    else return v1.second&lt;v2.second;
}

void Pregled::Ispisi() const{
    std::cout&lt;&lt;std::left&lt;&lt;std::setw(30)&lt;&lt;DajImePacijenta()&lt;&lt;std::right;
    DajDatumPregleda().Ispisi(); /*fja ne moze u tok*/
    std::cout&lt;&lt;" ";
    DajVrijemePregleda().Ispisi();
}

Pregledi::Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda) : pregledi(spisak_pregleda.size()){
    int i(0);

    for (auto pregled : spisak_pregleda) {
        pregledi.at(i) = std::make_shared&lt;Pregled&gt;(pregled);
        i++;
    }
}

Pregledi::Pregledi(const Pregledi &amp;pregledi) : pregledi(pregledi.DajBrojPregleda()) {

    for (int i=0; i&lt;DajBrojPregleda(); i++){
        Pregledi::pregledi.at(i) = std::make_shared&lt;Pregled&gt;(*pregledi.pregledi.at(i));
    }
}

Pregledi::Pregledi(Pregledi &amp;&amp;pregledi) : pregledi(pregledi.pregledi){
    pregledi.pregledi.resize(0);
}

Pregledi&amp; Pregledi::operator =(const Pregledi &amp;pregledi){
    if (this==&amp;pregledi) return *this;
    
    Pregledi::pregledi.resize(0);
    
    
    Pregledi::pregledi.resize(pregledi.DajBrojPregleda());
    for (int i=0; i&lt;DajBrojPregleda(); i++){
        Pregledi::pregledi.at(i) = std::make_shared&lt;Pregled&gt;(*pregledi.pregledi[i]);
    }
    return *this;
}


Pregledi&amp; Pregledi::operator =(Pregledi &amp;&amp;pregledi){
    if (this==&amp;pregledi) return *this;
    
    Pregledi::pregledi = pregledi.pregledi;
    pregledi.pregledi.resize(0);
    return *this;
}

void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda){
    pregledi.push_back(std::make_shared&lt;Pregled&gt;(ime_pacijenta, datum_pregleda, vrijeme_pregleda));
}

void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda){
    pregledi.push_back(std::make_shared&lt;Pregled&gt;(ime_pacijenta, dan_pregleda, mjesec_pregleda, godina_pregleda, sati_pregleda, minute_pregleda));
}

void Pregledi::RegistrirajPregled(std::shared_ptr&lt;Pregled&gt; pregled){
    pregledi.push_back(pregled);
}

int Pregledi::DajBrojPregledaNaDatum(const Datum &amp;datum) const{
    int broj_pregleda_na_datum(0);
    std::tuple&lt;int, int, int&gt; datum2;
    datum2=datum.Ocitaj();
    broj_pregleda_na_datum = std::count_if(pregledi.begin(), pregledi.end(), [datum2] (std::shared_ptr&lt;Pregled&gt; pregled) -&gt; bool {
      std::tuple&lt;int, int, int&gt; datum1;
        datum1=(*pregled).DajDatumPregleda().Ocitaj();
        return std::get&lt;0&gt;(datum1)==std::get&lt;0&gt;(datum2) &amp;&amp; std::get&lt;1&gt;(datum1)==std::get&lt;1&gt;(datum2) &amp;&amp; std::get&lt;2&gt;(datum1)==std::get&lt;2&gt;(datum2);});
    return broj_pregleda_na_datum; 
}

Pregled&amp; Pregledi::DajNajranijiPregled(){
    if (DajBrojPregleda()==0) throw std::domain_error("Nema registriranih pregleda");
    return **std::min_element(pregledi.begin(), pregledi.end(), [] (std::shared_ptr&lt;Pregled&gt; pok1, std::shared_ptr&lt;Pregled&gt; pok2){
        return Pregled::DolaziPrije(*pok1, *pok2);
    });
}
Pregled Pregledi::DajNajranijiPregled() const{ /*Unutar const ne smijes pozivat nekonstantne fje*/
        if (DajBrojPregleda()==0) throw std::domain_error("Nema registriranih pregleda");
    return **std::min_element(pregledi.begin(), pregledi.end(), [] (std::shared_ptr&lt;Pregled&gt; pok1, std::shared_ptr&lt;Pregled&gt; pok2){
        return Pregled::DolaziPrije(*pok1, *pok2);
    }); 
}

void Pregledi::IsprazniKolekciju(){
    pregledi.resize(0); 
}

void Pregledi::ObrisiNajranijiPregled(){
    if (DajBrojPregleda()==0) throw std::range_error ("Prazna kolekcija");
    typename std::vector&lt;std::shared_ptr&lt;Pregled&gt;&gt;::iterator min(std::min_element(pregledi.begin(), pregledi.end(), [] (std::shared_ptr&lt;Pregled&gt; pok1, std::shared_ptr&lt;Pregled&gt; pok2){
        return Pregled::DolaziPrije(*pok1, *pok2);
    })); 
    int indeks (min-pregledi.begin());
    pregledi.at(indeks) = nullptr;
    for (int i=indeks;i&lt;DajBrojPregleda()-1;i++){
        pregledi.at(i)=pregledi.at(i+1);
    }
    pregledi.resize(DajBrojPregleda() - 1);
}
    
void Pregledi::ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta){
    br=0;
    for (int i=0;i&lt;DajBrojPregleda();i++){
         if ((*pregledi.at(i)).DajImePacijenta()==ime_pacijenta){
                pregledi.at(i)=nullptr;
                for (int j=i;j&lt;DajBrojPregleda()-1;j++){
                    pregledi.at(j)=pregledi.at(j+1);
                }
                pregledi.resize(DajBrojPregleda()-1);
                i--;
                br++;
            }
        }
    }
void Pregledi::IspisiPregledeNaDatum(const Datum &amp;datum) const{
    std::vector&lt;Pregled&gt; pomocni;
    std::tuple&lt;int, int, int&gt; d;
    d=datum.Ocitaj();
    for (int i=0;i&lt;DajBrojPregleda();i++){
        std::tuple&lt;int,int,int&gt; p;
        p=(*pregledi.at(i)).DajDatumPregleda().Ocitaj();
        if (std::get&lt;0&gt;(p)==std::get&lt;0&gt;(d) &amp;&amp; std::get&lt;1&gt;(p)==std::get&lt;1&gt;(d) &amp;&amp; std::get&lt;2&gt;(p)==std::get&lt;2&gt;(d)) pomocni.push_back(*pregledi.at(i));
        else;
    }
    
    std::sort(pomocni.begin(), pomocni.end(), [] (Pregled p1, Pregled p2) { 
        std::pair&lt;int, int&gt; v1, v2;
        v1=p1.DajVrijemePregleda().Ocitaj();
        v2=p2.DajVrijemePregleda().Ocitaj();
        if(v1.first!=v2.first)
            return v1.first&lt;v2.first;
        else
            return v1.second&lt;v2.second;
    });
    
    for(int i=0;i&lt;pomocni.size();i++)
        pomocni.at(i).Ispisi();
}
void Pregledi::IspisiSvePreglede() const{
    /*std::sort(pregledi.begin(), pregledi.end(), [] (std::shared_ptr&lt;Pregled&gt; pok1, std::shared_ptr&lt;Pregled&gt; pok2){
        return Pregled::DolaziPrije(*pok1,*pok2);
    });*/
    
   for (int i=0;i&lt;DajBrojPregleda();i++){
        pregledi.at(i)-&gt;Ispisi();
        std::cout&lt;&lt;std::endl;
    }
}
    
int main()
{
    try{
    Pregledi svi_pregledi;
    std::string s;
    int brojac(0);
    while (s!="kraj"){
    brojac++;
    std::cout&lt;&lt;"Unesite ime novog pacijenta ili 'kraj' za zavrsetak unosa: ";
    std::getline(std::cin, s); // cin.ignore treba prije getline
    if (s=="kraj") break;
    std::cout&lt;&lt;"Unesite dan mjesec i godinu pregleda: ";
    int d,m,g;
    std::cin&gt;&gt;d&gt;&gt;m&gt;&gt;g;
    std::cout&lt;&lt;"Unesite sate i minute pregleda: ";
    int h,min;
    std::cin&gt;&gt;h&gt;&gt;min;
    svi_pregledi.RegistrirajPregled(s,d,m,g,h,min);
    std::cin.ignore(1000,'\n');
    };
    std::cout&lt;&lt;"Trenutno su registrovani sljedeci pregledi "&lt;&lt;std::endl;
    svi_pregledi.IspisiSvePreglede();
    int n(0);
    while (n!=7){
    std::cout&lt;&lt;"Odaberite jednu od sljedecih opcija"&lt;&lt;std::endl&lt;&lt;"1 - Broj pregleda na datum"&lt;&lt;std::endl&lt;&lt;
    "2 - Najraniji pregled"&lt;&lt;std::endl&lt;&lt;"3 - Obrisi pregled pacijenta"&lt;&lt;std::endl&lt;&lt;
</font><a name="1"></a><font color="#00FF00"><a href="match21-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_12.gif"/></a>

    "4 - Obrisi najraniji pregled"&lt;&lt;std::endl&lt;&lt;"5 - Ispisi sve pregleda na datum"&lt;&lt;std::endl&lt;&lt;
    "6 - Ispisi sve preglede"&lt;&lt;std::endl&lt;&lt;"7 - Kraj programa"&lt;&lt;std::endl&lt;&lt;std::endl;
    std::cin&gt;&gt;n;
    if (n==1) {
        std::cout&lt;&lt;std::endl&lt;&lt;"Unesite dan mjesec i godinu : ";
        int dan, mjesec, godina;
        std::cin&gt;&gt;dan&gt;&gt;mjesec&gt;&gt;godina;
        Datum datum(dan, mjesec, godina);
        std::cout&lt;&lt;"Broj pregleda na datum "&lt;&lt;dan&lt;&lt;" "&lt;&lt;mjesec&lt;&lt;" "&lt;&lt;godina&lt;&lt;" je: "&lt;&lt;svi_pregledi.DajBrojPregledaNaDatum(datum)&lt;&lt;std::endl&lt;&lt;std::endl;
    } else if (n==2){
        std::cout&lt;&lt;"Najraniji pregled je:"&lt;&lt;std::endl;
        svi_pregledi.DajNajranijiPregled().Ispisi();
        std::cout&lt;&lt;std::endl&lt;&lt;std::endl;
    } else if (n==3){
        std::cout&lt;&lt;"Unesite ime pacijenta: ";
        std::string ime;
        std::cin&gt;&gt;ime;
        svi_pregledi.ObrisiPregledePacijenta(ime);
        std::cout&lt;&lt;"Uspjesno obrisano "&lt;&lt;br&lt;&lt;" pregleda"&lt;&lt;std::endl&lt;&lt;std::endl;
        
    } else if (n==4){
        svi_pregledi.ObrisiNajranijiPregled();
        std::cout&lt;&lt;"Najraniji pregled uspjesno obrisan"&lt;&lt;std::endl&lt;&lt;std::endl;
    } else if (n==5){
        int day, month, year;
        std::cout&lt;&lt;"Unesite dan mjesec i godinu : ";
        std::cin&gt;&gt;day&gt;&gt;month&gt;&gt;year;
        Datum date (day,month,year);
        std::cout&lt;&lt;"Pregledi na datum "&lt;&lt;day&lt;&lt;" "&lt;&lt;month&lt;&lt;" "&lt;&lt;year&lt;&lt;" su:"&lt;&lt;std::endl;
        svi_pregledi.IspisiPregledeNaDatum(date);
        std::cout&lt;&lt;std::endl;
    } else if (n==6){
        svi_pregledi.IspisiSvePreglede();
        std::cout&lt;&lt;std::endl&lt;&lt;std::endl;
    }
    else break;
}
    } catch(std::domain_error e){
        std::cout&lt;&lt;e.what();
    } catch (std::range_error e){
        std::cout&lt;&lt;e.what();
    } catch (...){
</font>        
    }
	return 0;
}



















































</pre>
</body>
</html>
