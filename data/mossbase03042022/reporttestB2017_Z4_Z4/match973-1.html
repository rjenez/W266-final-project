<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z4/student4740.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z4/student8797.cpp<p></p><pre>
<a name="1"></a><font color="#00FF00"><a href="match973-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_2.gif"/></a>

/B2017/2018: ZadaÄ‡a 4, Zadatak 4
#include &lt;iostream&gt;
#include &lt;tuple&gt;
#include &lt;utility&gt;
#include &lt;stdexcept&gt;
#include &lt;algorithm&gt;
#include &lt;string&gt;
#include &lt;iomanip&gt;
#include &lt;initializer_list&gt;
#include &lt;vector&gt;
#include &lt;memory&gt;

class Datum{
    int d, m, g;
    public:
    Datum(int dan, int mjesec, int godina) {Postavi(dan, mjesec, godina);}
    void Postavi(int dan, int mjesec, int godina);
    std::tuple&lt;int, int, int&gt; Ocitaj() const {return std::make_tuple(d, m, g);}
</font><a name="7"></a><font color="#0000FF"><a href="match973-0.html#7" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

    void Ispisi() const {std::cout &lt;&lt; d &lt;&lt; "/" &lt;&lt; m &lt;&lt; "/" &lt;&lt; g;}
};

void Datum::Postavi(int dan, int mjesec, int godina){
    int b_d[12]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
</font>    if((godina%4==0 &amp;&amp; godina%100!=0) || godina%400==0) b_d[1]++;
<a name="6"></a><font color="#00FF00"><a href="match973-0.html#6" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

    if(dan&lt;1 || mjesec&lt;1 || godina&lt;1 || mjesec&gt;12 || dan&gt;b_d[mjesec-1])
        throw std::domain_error("Neispravan datum");
    d=dan; m=mjesec; g=godina;    
</font>}

class Vrijeme{
<a name="5"></a><font color="#FF0000"><a href="match973-0.html#5" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

    int h, min;
    public:
    Vrijeme(int sati, int minute) {Postavi(sati, minute);}
    void Postavi(int sati, int minute);
    std::pair&lt;int, int&gt; Ocitaj() const {return {h, min};}
</font>    void Ispisi() const {
        if(h&lt;10) std::cout &lt;&lt; "0"; std::cout &lt;&lt; h &lt;&lt; ":";
        if(min&lt;10) std::cout &lt;&lt; "0"; std::cout &lt;&lt; min; 
    }
};

<a name="8"></a><font color="#00FFFF"><a href="match973-0.html#8" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

void Vrijeme::Postavi(int sati, int minute){
    if(sati&lt;0 || sati&gt;23 || minute&lt;0 || minute&gt;59)
        throw std::domain_error("Neispravno vrijeme");
    h=sati; min=minute;    
</font>}

class Pregled{
    std::string ime; 
    Datum dat;
    Vrijeme tajm;
    static std::tuple&lt;int, int, int&gt; KorigujDatum(int da, int mj, int go);
    public:
    Pregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda): 
    ime(ime_pacijenta), dat(0, 0, 0), tajm(0, 0) {
        auto t(datum_pregleda.Ocitaj()); auto p(vrijeme_pregleda.Ocitaj());
        dat.Postavi(std::get&lt;0&gt;(t), std::get&lt;1&gt;(t), std::get&lt;2&gt;(t));
        tajm.Postavi(p.first, p.second);
    }
    Pregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda):
    ime(ime_pacijenta), dat(dan_pregleda, mjesec_pregleda, godina_pregleda), tajm(sati_pregleda, minute_pregleda) {}
    void PromijeniPacijenta(const std::string &amp;ime_pacijenta){
        ime=ime_pacijenta;
    }
    void PromijeniDatum(const Datum &amp;novi_datum){
        auto t(novi_datum.Ocitaj());
        dat.Postavi(std::get&lt;0&gt;(t), std::get&lt;1&gt;(t), std::get&lt;2&gt;(t));
    }
    void PromijeniVrijeme(const Vrijeme &amp;novo_vrijeme){
        auto p(novo_vrijeme.Ocitaj());
        tajm.Postavi(p.first, p.second);
    }
    void PomjeriDanUnaprijed();
    void PomjeriDanUnazad();
    std::string DajImePacijenta() const {return ime;}
<a name="2"></a><font color="#0000FF"><a href="match973-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

    Datum DajDatumPregleda() const {return dat;}
    Vrijeme DajVrijemePregleda() const {return tajm;}
    static bool DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2);
    void Ispisi() const{
        std::cout &lt;&lt; std::left &lt;&lt; std::setw(30) &lt;&lt; ime;
</font>        dat.Ispisi(); std::cout &lt;&lt; " "; tajm.Ispisi(); std::cout &lt;&lt; std::endl;
    }
};

std::tuple&lt;int, int, int&gt; Pregled::KorigujDatum(int da, int mj, int go){
    int b_d[12]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    if((go%4==0 &amp;&amp; go%100!=0) || go%400==0) b_d[1]++;
    if(da&gt;b_d[mj-1]){
        mj++; da=1;
        if(mj&gt;12){ mj=1; go++;}
    }
    else if(da&lt;1){
         mj--; da=b_d[mj-1];
        if(mj&lt;1){ mj=12; go--; da=b_d[mj-1];}
    }
    return std::make_tuple(da, mj, go);
}

void Pregled::PomjeriDanUnaprijed(){
    auto t(this-&gt;dat.Ocitaj());
    auto t1(Pregled::KorigujDatum(std::get&lt;0&gt;(t)++, std::get&lt;1&gt;(t), std::get&lt;2&gt;(t)));
    this-&gt;dat.Postavi(std::get&lt;0&gt;(t1), std::get&lt;1&gt;(t1), std::get&lt;2&gt;(t1));
}

void Pregled::PomjeriDanUnazad(){
    auto t(this-&gt;dat.Ocitaj());
    auto t1(Pregled::KorigujDatum(std::get&lt;0&gt;(t)--, std::get&lt;1&gt;(t), std::get&lt;2&gt;(t)));
    this-&gt;dat.Postavi(std::get&lt;0&gt;(t1), std::get&lt;1&gt;(t1), std::get&lt;2&gt;(t1));
}

bool Pregled::DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2){
    auto t1(p1.dat.Ocitaj()); auto t2(p2.dat.Ocitaj());
    if(std::get&lt;2&gt;(t1)&lt;std::get&lt;2&gt;(t2)) return true;
    else if(std::get&lt;1&gt;(t1)&lt;std::get&lt;1&gt;(t2) &amp;&amp; std::get&lt;2&gt;(t1)==std::get&lt;2&gt;(t2))
        return true;
    else if(std::get&lt;0&gt;(t1)&lt;std::get&lt;0&gt;(t2) &amp;&amp; std::get&lt;2&gt;(t1)==std::get&lt;2&gt;(t2) &amp;&amp; std::get&lt;1&gt;(t1)==std::get&lt;1&gt;(t2))
        return true; 
    else if(std::get&lt;0&gt;(t1)==std::get&lt;0&gt;(t2) &amp;&amp; std::get&lt;2&gt;(t1)==std::get&lt;2&gt;(t2) &amp;&amp; std::get&lt;1&gt;(t1)==std::get&lt;1&gt;(t2)){
        auto par1(p1.tajm.Ocitaj()); auto par2(p2.tajm.Ocitaj());
        if(par1.first&lt;par2.first)
            return true; 
        else if(par1.first==par2.first &amp;&amp; par1.second&lt;par2.second)
            return true; 
    } 
    return false;
}

class Pregledi{
    std::vector&lt;std::shared_ptr&lt;Pregled&gt;&gt; v;
    public:
    explicit Pregledi(): v(0) {}
    Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda){
        v.resize(spisak_pregleda.size());
        auto it(spisak_pregleda.begin());
        for(int i=0; i&lt;v.size(); i++){
            v.at(i)=std::make_shared&lt;Pregled&gt;(it-&gt;DajImePacijenta(), it-&gt;DajDatumPregleda(), it-&gt;DajVrijemePregleda());
            it++;
        }
    }
    ~Pregledi(){
        for(int i=0; i&lt;v.size(); i++)
            v.at(i)=nullptr;
    }
    Pregledi(const Pregledi &amp;pregledi);
    Pregledi(Pregledi &amp;&amp;pregledi);
    Pregledi &amp;operator =(const Pregledi &amp;pregledi);
    Pregledi &amp;operator =(Pregledi &amp;&amp;pregledi);
    void RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda);
    void RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda);                 
    void RegistrirajPregled(std::shared_ptr&lt;Pregled&gt; pregled);
    int DajBrojPregleda() const {
        if(v.size()==0)
            throw std::domain_error("Nema registriranih pregleda");
        return v.size();}
    int DajBrojPregledaNaDatum(const Datum &amp;datum) const{
        if(v.size()==0)
            throw std::domain_error("Nema registriranih pregleda");
        auto n(datum.Ocitaj());    
        return std::count_if(v.begin(), v.end(), [n](std::shared_ptr&lt;Pregled&gt; p){
            auto t(p-&gt;DajDatumPregleda().Ocitaj());
            return (std::get&lt;0&gt;(t)==std::get&lt;0&gt;(n) &amp;&amp; std::get&lt;1&gt;(t)==std::get&lt;1&gt;(n) &amp;&amp; std::get&lt;2&gt;(t)==std::get&lt;2&gt;(n));
        });    
    }
    Pregled &amp;DajNajranijiPregled(){
        if(v.size()==0)
            throw std::domain_error("Nema registriranih pregleda");
        return **std::min_element(v.begin(), v.end(), [](std::shared_ptr&lt;Pregled&gt; p1, std::shared_ptr&lt;Pregled&gt; p2){
            return Pregled::DolaziPrije(*p1, *p2);
        });    
    }
    Pregled DajNajranijiPregled() const{
        if(v.size()==0)
            throw std::domain_error("Nema registriranih pregleda");
        return **std::min_element(v.begin(), v.end(), [](std::shared_ptr&lt;Pregled&gt; p1, std::shared_ptr&lt;Pregled&gt; p2){
            return Pregled::DolaziPrije(*p1, *p2);
        });    
    }
    void IsprazniKolekciju(){
        if(v.size()==0)
            throw std::range_error("Prazna kolekcija");
        for(int i=0; i&lt;v.size(); i++)
            v.at(i)=nullptr;
    }
    void ObrisiNajranijiPregled();
    void ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta){
        auto it(v.begin());
        for(int i=0; i&lt;v.size();i++){
            if((*it)-&gt;DajImePacijenta()==ime_pacijenta){
                v.at(i)=nullptr; v.erase(v.begin()+i); i--; it--;
            }
            it++;
        }
    }
    void IspisiPregledeNaDatum(const Datum &amp;datum) const;
    void IspisiSvePreglede() const;
};

void Pregledi::ObrisiNajranijiPregled(){
        if(v.size()==0)
            throw std::range_error("Prazna kolekcija");
        auto p(DajNajranijiPregled());
         auto p1(v.begin());
        for(int i=0; i&lt;v.size(); i++){
            if(p.DajImePacijenta()==(*p1)-&gt;DajImePacijenta()){
                   auto t1(p.DajDatumPregleda().Ocitaj()); auto t2((*p1)-&gt;DajDatumPregleda().Ocitaj());
                   if(std::get&lt;0&gt;(t1)==std::get&lt;0&gt;(t2) &amp;&amp; std::get&lt;1&gt;(t1)==std::get&lt;1&gt;(t2) &amp;&amp; std::get&lt;2&gt;(t1)==std::get&lt;2&gt;(t2)){
                       auto v1(p.DajVrijemePregleda().Ocitaj()); auto v2((*p1)-&gt;DajVrijemePregleda().Ocitaj());
                       if(v1.first==v2.first &amp;&amp; v1.second==v2.second)
                           {v.at(i)=nullptr; v.erase(v.begin()+i); break;}
                   }
               }
            p1++;
        }
    }

Pregledi::Pregledi(const Pregledi &amp;pregledi){
    v.resize(pregledi.v.size());
    for(int i=0; i&lt;v.size(); i++)
        v.at(i)=std::make_shared&lt;Pregled&gt;(pregledi.v.at(i)-&gt;DajImePacijenta(), pregledi.v.at(i)-&gt;DajDatumPregleda(), pregledi.v.at(i)-&gt;DajVrijemePregleda());
}

Pregledi::Pregledi(Pregledi &amp;&amp;pregledi){
    v=pregledi.v; 
}

Pregledi &amp;Pregledi::operator =(const Pregledi &amp;pregledi){
    v=pregledi.v;
    return *this;
}

Pregledi &amp;Pregledi::operator =(Pregledi &amp;&amp;pregledi){
    v=pregledi.v;
    return *this;
}

void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda){
<a name="3"></a><font color="#00FFFF"><a href="match973-0.html#3" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

    auto a(std::make_shared&lt;Pregled&gt;(ime_pacijenta, datum_pregleda, vrijeme_pregleda));
    v.push_back(a);
}

void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda){
</font><a name="4"></a><font color="#FF00FF"><a href="match973-0.html#4" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

    auto a(std::make_shared&lt;Pregled&gt;(ime_pacijenta, dan_pregleda, mjesec_pregleda, 
                      godina_pregleda, sati_pregleda, minute_pregleda));
    v.push_back(a);                  
}

void Pregledi::RegistrirajPregled(std::shared_ptr&lt;Pregled&gt; pregled){
    v.push_back(pregled);    
</font>}

void Pregledi::IspisiPregledeNaDatum(const Datum &amp;datum) const{
    std::vector&lt;Pregled&gt; vek; 
    auto it(v.begin()); auto dat(datum.Ocitaj());
    for(int i=0; i&lt;v.size(); i++){
        auto t((*it)-&gt;DajDatumPregleda().Ocitaj());
        if(std::get&lt;0&gt;(t)==std::get&lt;0&gt;(dat) &amp;&amp; std::get&lt;1&gt;(t)==std::get&lt;1&gt;(dat) 
           &amp;&amp; std::get&lt;2&gt;(t)==std::get&lt;2&gt;(dat))
            vek.push_back(**it);
        it++;    
    }       
    std::sort(vek.begin(), vek.end(), [](Pregled p1, Pregled p2){
        auto t1(p1.DajVrijemePregleda().Ocitaj()); auto t2(p2.DajVrijemePregleda().Ocitaj());   
        if(t1.first&lt;t2.first)
            return true;
        else if(t1.first==t2.first &amp;&amp; t1.second&lt;t2.second)
            return true;
        return false;    
    });       
    for(int i=0; i&lt;vek.size(); i++)
        vek.at(i).Ispisi();
}

void Pregledi::IspisiSvePreglede() const{
    auto vek(v);
<a name="9"></a><font color="#FF00FF"><a href="match973-0.html#9" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_0.gif"/></a>

    std::sort(vek.begin(), vek.end(), [](std::shared_ptr&lt;Pregled&gt; p1, std::shared_ptr&lt;Pregled&gt; p2){
            return Pregled::DolaziPrije(*p1, *p2);
    });
    std::for_each(vek.begin(), vek.end(), [](std::shared_ptr&lt;Pregled&gt; p){
</font>            p-&gt;Ispisi(); 
    });
}

int main(){
    Pregledi pregledi; int evid(0);
    for(;;){
        std::cout &lt;&lt; "Unesite ime novog pacijenta ili 'kraj' za zavrsetak unosa: ";
        std::string s;
<a name="0"></a><font color="#FF0000"><a href="match973-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_2.gif"/></a>

        std::getline(std::cin, s);
        if(s=="kraj") break;
        std::cout &lt;&lt; "Unesite dan mjesec i godinu pregleda: ";
        int d, m, g;
        std::cin &gt;&gt; d &gt;&gt; m &gt;&gt; g;
        std::cout &lt;&lt; "Unesite sate i minute pregleda: ";
        int h, min;
        std::cin &gt;&gt; h &gt;&gt; min;
        pregledi.RegistrirajPregled(s, d, m, g, h, min);
        evid++;
</font>        std::cin.ignore(1000, '\n');
    }
    std::cout &lt;&lt; "Trenutno su registrovani sljedeci pregledi\n";
    pregledi.IspisiSvePreglede();
    int kraj(1); while(kraj){
    std::cout &lt;&lt; "\nOdaberite jednu od sljedecih opcija \n"
              &lt;&lt; "1 - Broj pregleda na datum\n"
              &lt;&lt; "2 - Najraniji pregled\n"
              &lt;&lt; "3 - Obrisi pregled pacijenta\n"
              &lt;&lt; "4 - Obrisi najraniji pregled\n"
              &lt;&lt; "5 - Ispisi sve pregleda na datum\n"
              &lt;&lt; "6 - Ispisi sve preglede\n"
              &lt;&lt; "7 - Kraj programa\n";
    int opcija;
    std::cin &gt;&gt; opcija; int dan, mjes, god;
    switch (opcija){
        case 1:{
        std::cout &lt;&lt; "Unesite dan mjesec i godinu : ";
        std::cin &gt;&gt; dan &gt;&gt; mjes &gt;&gt; god;
        Datum dat(dan, mjes, god);
        std::cout &lt;&lt; "Broj pregleda na datum " &lt;&lt; dan &lt;&lt; " " &lt;&lt; mjes &lt;&lt; " " 
                 &lt;&lt; god &lt;&lt; " je: " &lt;&lt; pregledi.DajBrojPregledaNaDatum(dat) &lt;&lt; std::endl;
        break;}
        
        case 2:
        std::cout &lt;&lt; "Najraniji pregled je:\n";
        pregledi.DajNajranijiPregled().Ispisi();
        break;
        
        case 3:{
        std::string imeee;
        std::cout &lt;&lt; "Unesite ime pacijenta: ";
        std::cin.ignore(1000, '\n'); std::getline(std::cin, imeee);
        pregledi.ObrisiPregledePacijenta(imeee); 
        std::cout &lt;&lt; "Uspjesno obrisano " &lt;&lt; evid-pregledi.DajBrojPregleda() &lt;&lt; " pregleda\n";
        break;}
        
        case 4:
        pregledi.ObrisiNajranijiPregled();
        std::cout &lt;&lt; "Najraniji pregled uspjesno obrisan\n";
        break;
        
        case 5:{
        std::cout &lt;&lt; "Unesite dan mjesec i godinu : ";
        std::cin &gt;&gt; dan &gt;&gt; mjes &gt;&gt; god;
        std::cout &lt;&lt; "Pregledi na datum " &lt;&lt; dan &lt;&lt; " " &lt;&lt; mjes &lt;&lt; " " &lt;&lt; god &lt;&lt; " su:\n";
        Datum dat(dan, mjes, god);
        pregledi.IspisiPregledeNaDatum(dat);
        break;}
        
        case 6:
        pregledi.IspisiSvePreglede();
        break;
        
        case 7:
        kraj=0;
    }}
    
    return 0;
}
</pre>
</body>
</html>
