<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z4/student8705.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z4/student8705.cpp<p></p><pre>
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;tuple&gt;
#include &lt;iomanip&gt;
#include &lt;initializer_list&gt;
#include &lt;algorithm&gt;
#include &lt;memory&gt;
#include &lt;vector&gt;

<a name="1"></a><font color="#00FF00"><a href="match153-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_30.gif"/></a>

class Datum
{
    int d, m, g;
    static int BrojDana(int, int);
    static bool Validan(int d, int m, int g) { return m &gt;= 1 &amp;&amp; m &lt;= 12 &amp;&amp; d &gt;= 1 &amp;&amp; d &lt;= BrojDana(m, g) &amp;&amp; g &gt; 0; }
    bool Prije(const Datum&amp;) const;
    void PomjeriDanUnaprijed();
    void PomjeriDanUnazad();
    bool eq(const Datum &amp;a) const { return a.d == d &amp;&amp; a.m == m &amp;&amp; a.g == g; }
    friend class Pregled;
    friend class Pregledi;
public:
    Datum(int dan, int mjesec, int godina) { Postavi(dan, mjesec, godina); }
    void Postavi(int dan, int mjesec, int godina);
    std::tuple&lt;int, int, int&gt; Ocitaj() const { return std::make_tuple(d, m, g); }
    void Ispisi() const;
};
int Datum::BrojDana(int m, int g)
{ 
    static int br_dana[12] { 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };
    return br_dana[m-1] + (m == 2 &amp;&amp; ((g % 100 != 0 &amp;&amp; g % 4 == 0) || g % 400 == 0));
}
void Datum::Postavi(int dan, int mjesec, int godina)
{
    if (!Validan(dan, mjesec, godina)) throw std::domain_error("Neispravan datum");
    d = dan; m = mjesec; g = godina;
}
void Datum::Ispisi() const { std::cout &lt;&lt; d &lt;&lt; '/' &lt;&lt; m &lt;&lt; '/' &lt;&lt; g; }
bool Datum::Prije(const Datum &amp;x) const { return g &lt; x.g || (g == x.g &amp;&amp; (m &lt; x.m || (m == x.m &amp;&amp; d &lt; x.d))); }
void Datum::PomjeriDanUnaprijed()
{
    if (Validan(d+1, m, g)) Postavi(d+1, m, g);
    else if (Validan(1, m+1, g)) Postavi(1, m+1, g);
    else Postavi(1, 1, g+1);
}
void Datum::PomjeriDanUnazad()
{
    if (Validan(d-1, m, g)) Postavi(d-1, m, g);
    else if (Validan(BrojDana(m-1, g), m-1, g)) Postavi(BrojDana(m-1, g), m-1, g);
    else if (g &gt; 1) Postavi(BrojDana(12, g-1), 12, g-1);
}
class Vrijeme
{
    int h, m;
    friend class Pregled;
public:
    Vrijeme(int sati, int minute) { Postavi(sati, minute); }
    void Postavi(int sati, int minute);
    std::pair&lt;int, int&gt; Ocitaj() const { return std::make_pair(h, m); }
    void Ispisi() const;
};
void Vrijeme::Postavi(int sati, int minute)
{
    if (sati &lt; 0 || sati &gt; 23 || minute &lt; 0 || minute &gt; 59) throw std::domain_error("Neispravno vrijeme");
    h = sati; m = minute;
}
void Vrijeme::Ispisi() const { std::cout &lt;&lt; (h &lt; 10 ? "0" : "") &lt;&lt; h &lt;&lt; ':' &lt;&lt; (m &lt; 10 ? "0" : "") &lt;&lt; m; }

class Pregled
{
    std::string imePacijenta;
    Datum datum;
    Vrijeme vrijeme;
    friend class Pregledi;
    bool IstovremenSa(const Pregled &amp;p) { return datum.eq(p.datum) &amp;&amp; vrijeme.h == p.vrijeme.h &amp;&amp; vrijeme.m == p.vrijeme.m; }
public:
    Pregled(const std::string &amp;ime, const Datum &amp;dat, const Vrijeme &amp;vr) : imePacijenta(ime), datum(dat), vrijeme(vr) {}
</font><a name="0"></a><font color="#FF0000"><a href="match153-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_67.gif"/></a>

    Pregled(const std::string &amp;ime, int dan, int mjesec, int godina, int sati, int minute) : imePacijenta(ime), datum(dan, mjesec, godina), vrijeme(sati, minute) {}
    void PromijeniPacijenta(const std::string &amp;ime) { imePacijenta = ime; }
    void PromijeniDatum(const Datum &amp;dat) { datum = dat; }
    void PromijeniVrijeme(const Vrijeme &amp;vr) { vrijeme = vr; }
    void PomjeriDanUnaprijed() { datum.PomjeriDanUnaprijed(); }
    void PomjeriDanUnazad() { datum.PomjeriDanUnazad(); }
    std::string DajImePacijenta() const { return imePacijenta; }
    Datum DajDatumPregleda() const { return datum; }
    Vrijeme DajVrijemePregleda() const { return vrijeme; }
    static bool DolaziPrije(const Pregled&amp;, const Pregled&amp;);
    void Ispisi() const;
};
bool Pregled::DolaziPrije(const Pregled &amp;a, const Pregled &amp;b)
{
    return a.datum.Prije(b.datum) || (a.datum.eq(b.datum) &amp;&amp; (a.vrijeme.h &lt; b.vrijeme.h || (a.vrijeme.h == b.vrijeme.h &amp;&amp; a.vrijeme.m &lt; b.vrijeme.m)));
}
void Pregled::Ispisi() const { std::cout &lt;&lt; std::setw(30) &lt;&lt; std::left &lt;&lt; imePacijenta; datum.Ispisi(); std::cout &lt;&lt; ' '; vrijeme.Ispisi(); std::cout &lt;&lt; std::endl; }

class Pregledi
{
    std::vector&lt;std::shared_ptr&lt;Pregled&gt;&gt; pregledi;
    int DajNajraniji() const;
public:
    explicit Pregledi() {}
    Pregledi(std::initializer_list&lt;Pregled&gt;);
    ~Pregledi() = default;
    Pregledi(const Pregledi &amp;p) { *this = p; }
    Pregledi(Pregledi &amp;&amp;p) { *this = std::move(p); }
    Pregledi &amp;operator =(const Pregledi &amp;p);
    Pregledi &amp;operator =(Pregledi &amp;&amp;p);
    void RegistrirajPregled(const std::string&amp;, const Datum&amp;, const Vrijeme&amp;);
    void RegistrirajPregled(const std::string &amp;ime, int d, int mj, int g, int h, int m) { RegistrirajPregled(ime, Datum(d, mj, g), Vrijeme(h, m)); }
    void RegistrirajPregled(const std::shared_ptr&lt;Pregled&gt; &amp;p) { pregledi.emplace_back(p); }
    int DajBrojPregleda() const { return pregledi.size(); }
    int DajBrojPregledaNaDatum(const Datum&amp;) const;
    Pregled &amp;DajNajranijiPregled();
    Pregled DajNajranijiPregled() const;
    void IsprazniKolekciju() { pregledi.clear(); }
    void ObrisiNajranijiPregled();
    void ObrisiPregledePacijenta(const std::string&amp;);
    void IspisiPregledeNaDatum(const Datum&amp;) const;
    void IspisiSvePreglede() const;
};
int Pregledi::DajNajraniji() const
{
    return std::min_element(pregledi.begin(), pregledi.end(), [](const std::shared_ptr&lt;Pregled&gt; &amp;a, const std::shared_ptr&lt;Pregled&gt; &amp;b) { return Pregled::DolaziPrije(*a, *b); }) - pregledi.begin();
}
Pregledi::Pregledi(std::initializer_list&lt;Pregled&gt; lista) : pregledi(lista.size())
{
    std::transform(lista.begin(), lista.end(), pregledi.begin(), [](const Pregled &amp;p) { return std::make_shared&lt;Pregled&gt;(p); });
}
Pregledi &amp;Pregledi::operator =(const Pregledi &amp;p)
{
    if (&amp;p == this) return *this;
    std::vector&lt;std::shared_ptr&lt;Pregled&gt;&gt; pomocni(p.DajBrojPregleda());
    std::transform(p.pregledi.begin(), p.pregledi.end(), pomocni.begin(), [](const std::shared_ptr&lt;Pregled&gt; &amp;p) { return std::make_shared&lt;Pregled&gt;(*p); });
    pregledi = std::move(pomocni);
    return *this;
}
Pregledi &amp;Pregledi::operator =(Pregledi &amp;&amp;p)
{
    if (&amp;p != this) pregledi = std::move(p.pregledi);
    p.pregledi.clear();
    return *this;
}
void Pregledi::RegistrirajPregled(const std::string &amp;ime, const Datum &amp;dat, const Vrijeme &amp;vr)
{
    pregledi.emplace_back(std::make_shared&lt;Pregled&gt;(ime, dat, vr));
}
int Pregledi::DajBrojPregledaNaDatum(const Datum &amp;dat) const
{
    return std::count_if(pregledi.begin(), pregledi.end(), [&amp;](const std::shared_ptr&lt;Pregled&gt; &amp;p) { return p-&gt;datum.eq(dat); });
}
Pregled &amp;Pregledi::DajNajranijiPregled() { if (pregledi.empty()) throw std::domain_error("Nema registriranih pregleda"); return **(pregledi.begin() + DajNajraniji()); }
Pregled Pregledi::DajNajranijiPregled() const { if (pregledi.empty()) throw std::domain_error("Nema registriranih pregleda"); return **(pregledi.begin() + DajNajraniji()); }
void Pregledi::ObrisiNajranijiPregled()
{
    if (pregledi.empty()) throw std::range_error("Prazna kolekcija");
    pregledi.erase(pregledi.begin() + DajNajraniji());
}
void Pregledi::ObrisiPregledePacijenta(const std::string &amp;ime)
{
    for(auto it(pregledi.begin()); it != pregledi.end();)
        if ((*it)-&gt;imePacijenta == ime) it = pregledi.erase(it);
        else ++it;
}
void Pregledi::IspisiPregledeNaDatum(const Datum &amp;dat) const
{
    int n(DajBrojPregledaNaDatum(dat));
    if (n == 0) return;
    auto trenutni(*std::min_element(pregledi.begin(), pregledi.end(), [&amp;](const std::shared_ptr&lt;Pregled&gt; &amp;a, const std::shared_ptr&lt;Pregled&gt; &amp;b) {
        return a-&gt;datum.eq(dat) &amp;&amp; Pregled::DolaziPrije(*a, *b);
    })), sljedeci(trenutni);
    for (int br(0); br &lt; n;)
    {
        for (auto &amp;p : pregledi)
            if (p-&gt;datum.eq(dat))
                if (p-&gt;IstovremenSa(*trenutni)) { p-&gt;Ispisi(); if (++br == n) return; }
                else if (Pregled::DolaziPrije(*trenutni, *p) &amp;&amp; (sljedeci == trenutni || Pregled::DolaziPrije(*p, *sljedeci)))
                    sljedeci = p;
        trenutni = sljedeci;
    }
}
void Pregledi::IspisiSvePreglede() const
{
    if (pregledi.empty()) return;
    auto trenutni(*(pregledi.begin() + DajNajraniji())), sljedeci(trenutni);
    for (int br(0); br &lt; pregledi.size();)
    { 
        for (auto &amp;p : pregledi)
            if (p-&gt;IstovremenSa(*trenutni)) { p-&gt;Ispisi(); if (++br == pregledi.size()) return; }
            else if (Pregled::DolaziPrije(*trenutni, *p) &amp;&amp; (sljedeci == trenutni || Pregled::DolaziPrije(*p, *sljedeci)))
                    sljedeci = p;
        trenutni = sljedeci;
    }
}

int main()
{
    int n, d, mj, g, h, m;
	try
	{
	    Pregledi pregledi;
	    std::string s;
	    for(;;)
	    {
	        std::cout &lt;&lt; "Unesite ime novog pacijenta ili 'kraj' za zavrsetak unosa: ";
	        if (std::getline(std::cin, s), s == "kraj") break;
	        std::cout &lt;&lt; "Unesite dan mjesec i godinu pregleda: ";
    	    std::cin &gt;&gt; d &gt;&gt; mj &gt;&gt; g;
    	    std::cout &lt;&lt; "Unesite sate i minute pregleda: ";
    	    std::cin &gt;&gt; h &gt;&gt; m;
    	    pregledi.RegistrirajPregled(s, Datum(d, mj, g), Vrijeme(h, m));
    	    std::cin.ignore(10000, '\n');
    	}
    	std::cout &lt;&lt; "Trenutno su registrovani sljedeci pregledi\n";
    	pregledi.IspisiSvePreglede();
    	for (;;)
    	{
    	    std::cout &lt;&lt; "\nOdaberite jednu od sljedecih opcija\n"
    	    "1 - Broj pregleda na datum\n"
    	    "2 - Najraniji pregled\n"
    	    "3 - Obrisi pregled pacijenta\n"
    	    "4 - Obrisi najraniji pregled\n"
    	    "5 - Ispisi sve pregleda na datum\n"
    	    "6 - Ispisi sve preglede\n"
    	    "7 - Kraj programa\n";
    	    std::cin &gt;&gt; n;
    	    switch (n)
    	    {
    	        case 1:
    	            std::cout &lt;&lt; "Unesite dan mjesec i godinu : ";
    	            std::cin &gt;&gt; d &gt;&gt; mj &gt;&gt; g;
    	            std::cout &lt;&lt; "Broj pregleda na datum " &lt;&lt; d &lt;&lt; ' ' &lt;&lt; mj &lt;&lt; ' ' &lt;&lt; g &lt;&lt; " je: " &lt;&lt; pregledi.DajBrojPregledaNaDatum(Datum(d, mj, g)) &lt;&lt; '\n';
    	            break;
    	        case 2: std::cout &lt;&lt; "Najraniji pregled je:\n"; pregledi.DajNajranijiPregled().Ispisi(); break;
    	        case 3:
    	            std::cout &lt;&lt; "Unesite ime pacijenta: ";
    	            std::cin.ignore(10000, '\n');
    	            std::getline(std::cin, s);
    	            n = pregledi.DajBrojPregleda();
    	            pregledi.ObrisiPregledePacijenta(s);
    	            std::cout &lt;&lt; "Uspjesno obrisano " &lt;&lt; n - pregledi.DajBrojPregleda() &lt;&lt; " pregleda\n";
    	            break;
    	        case 4: pregledi.ObrisiNajranijiPregled(); std::cout &lt;&lt; "Najraniji pregled uspjesno obrisan\n"; break;
    	        case 5:
    	            std::cout &lt;&lt; "Unesite dan mjesec i godinu : ";
    	            std::cin &gt;&gt; d &gt;&gt; mj &gt;&gt; g;
    	            std::cout &lt;&lt; "Pregledi na datum " &lt;&lt; d &lt;&lt; ' ' &lt;&lt; mj &lt;&lt; ' ' &lt;&lt; g &lt;&lt; " su:\n";
    	            pregledi.IspisiPregledeNaDatum(Datum(d, mj, g));
    	            break;
    	        case 6: pregledi.IspisiSvePreglede(); break;
    	        default: return 0;
    	    }
    	}
	}
	catch (...) {}
</font>	return 0;
}</pre>
</body>
</html>
