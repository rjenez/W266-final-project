<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z4/student5957.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z4/student5957.cpp<p></p><pre>
<a name="2"></a><font color="#0000FF"><a href="match56-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_5.gif"/></a>

/B2017/2018: ZadaÄ‡a 4, Zadatak 4
#include &lt;iostream&gt;
#include &lt;iomanip&gt;
#include &lt;stdexcept&gt;
#include &lt;tuple&gt;                //  ZADATAK KOPIRAN SA PRETHODNOG
#include &lt;string&gt;               //  I PREPRAVLJEN
#include &lt;algorithm&gt;
#include &lt;memory&gt;
#include &lt;vector&gt;
using std::vector;
using std::shared_ptr;
using std::string;
using std::cout;
using std::cin;

class Datum{
    int dan,mjesec,godina;
    public:
    Datum(int dan, int mjesec, int godina);
    void Postavi(int dan, int mjesec, int godina);
    std::tuple&lt;int, int, int&gt; Ocitaj() const{ return std::make_tuple(dan,mjesec,godina); }
    void Ispisi() const{ cout&lt;&lt;dan&lt;&lt;"/"&lt;&lt;mjesec&lt;&lt;"/"&lt;&lt;godina; }
};
Datum::Datum(int dan, int mjesec, int godina){
    int broj_dana[]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
</font>    if((godina%4==0 &amp;&amp; godina%100!=0) || godina%400==0) broj_dana[1]++;
<a name="3"></a><font color="#00FFFF"><a href="match56-1.html#3" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_2.gif"/></a>

    if(godina&lt;1 || dan&lt;1 || mjesec&lt;1 || mjesec&gt;12 || dan&gt;broj_dana[mjesec-1])
    throw std::domain_error("Neispravan datum!");
    Datum::dan=dan; Datum::mjesec=mjesec; Datum::godina=godina;
}
void Datum::Postavi(int dan, int mjesec, int godina){
    int broj_dana[]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
</font>    if((godina%4==0 &amp;&amp; godina%100!=0) || godina%400==0) broj_dana[1]++;
<a name="1"></a><font color="#00FF00"><a href="match56-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_39.gif"/></a>

    if(godina&lt;1 || dan&lt;1 || mjesec&lt;1 || mjesec&gt;12 || dan&gt;broj_dana[mjesec-1])
    throw std::domain_error("Neispravan datum!");
    Datum::dan=dan; Datum::mjesec=mjesec; Datum::godina=godina;
}

class Vrijeme{
    int sati,minute;
    public:
    Vrijeme(int sati, int minute);
    void Postavi(int sati, int minute);
    std::pair&lt;int, int&gt; Ocitaj () const{ return std::make_pair(sati,minute); }
    void Ispisi() const{ cout&lt;&lt;std::setw(2)&lt;&lt;std::setfill('0')&lt;&lt;std::right&lt;&lt;sati&lt;&lt;":"&lt;&lt;std::setw(2)&lt;&lt;std::setfill('0')&lt;&lt;std::right&lt;&lt;minute; }
};
Vrijeme::Vrijeme(int sati, int minute){
    if(sati&lt;0 || sati&gt;23 || minute&lt;0 || minute&gt;59)
    throw std::domain_error("Neispravno vrijeme");
    Vrijeme::sati=sati; Vrijeme::minute=minute;
}
void Vrijeme::Postavi(int sati, int minute){
    if(sati&lt;0 || sati&gt;23 || minute&lt;0 || minute&gt;59)
    throw std::domain_error("Neispravno vrijeme");
    Vrijeme::sati=sati; Vrijeme::minute=minute;
}

class Pregled{
    string ime;
    Datum dat;
    Vrijeme vrijeme;
    public:
    Pregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda,const Vrijeme &amp;vrijeme_pregleda);
    Pregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda,int godina_pregleda, int sati_pregleda, int minute_pregleda);
    void PromijeniPacijenta(const std::string &amp;ime_pacijenta){ ime=ime_pacijenta; }
    void PromijeniDatum(const Datum &amp;novi_datum){ dat=Datum(novi_datum); }
    void PromijeniVrijeme(const Vrijeme &amp;novo_vrijeme){ vrijeme=Vrijeme(novo_vrijeme); }
    void PomjeriDanUnaprijed();
    void PomjeriDanUnazad();
    std::string DajImePacijenta() const{ return ime; }
    Datum DajDatumPregleda() const{ return dat; }
    Vrijeme DajVrijemePregleda() const{ return vrijeme; }
    static bool DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2);
    void Ispisi() const{ cout&lt;&lt;std::fixed&lt;&lt;std::setw(30)&lt;&lt;std::setfill(' ')&lt;&lt;std::left&lt;&lt;ime;
    DajDatumPregleda().Ispisi(); cout&lt;&lt;" "; DajVrijemePregleda().Ispisi();  }
};
Pregled::Pregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda,const Vrijeme &amp;vrijeme_pregleda):
    ime(ime_pacijenta),dat(datum_pregleda), vrijeme(vrijeme_pregleda){}
Pregled::Pregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda,int godina_pregleda,
    int sati_pregleda, int minute_pregleda):ime(ime_pacijenta),dat(dan_pregleda,mjesec_pregleda,godina_pregleda),
    vrijeme(sati_pregleda,minute_pregleda){}
void Pregled::PomjeriDanUnaprijed(){
    int broj_dana[]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    auto t(dat.Ocitaj());
    if((std::get&lt;2&gt;(t)%4==0 &amp;&amp; std::get&lt;2&gt;(t)%100!=0) || std::get&lt;2&gt;(t)%400==0) broj_dana[1]++;
    std::get&lt;0&gt;(t)++;
    if(std::get&lt;0&gt;(t)&gt;broj_dana[std::get&lt;1&gt;(t)-1]){ std::get&lt;0&gt;(t)=1; std::get&lt;1&gt;(t)++; }
    if(std::get&lt;1&gt;(t)&gt;12){ std::get&lt;1&gt;(t)=1; std::get&lt;2&gt;(t)++; }
    dat.Postavi(std::get&lt;0&gt;(t),std::get&lt;1&gt;(t),std::get&lt;2&gt;(t));
}
void Pregled::PomjeriDanUnazad(){
    int broj_dana[]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    auto t(dat.Ocitaj());
    if((std::get&lt;2&gt;(t)%4==0 &amp;&amp; std::get&lt;2&gt;(t)%100!=0) || std::get&lt;2&gt;(t)%400==0) broj_dana[1]++;
    std::get&lt;0&gt;(t)--;
    if(std::get&lt;0&gt;(t)&lt;1){
        std::get&lt;1&gt;(t)--;
        if(std::get&lt;1&gt;(t)&lt;1){ std::get&lt;1&gt;(t)=12; std::get&lt;2&gt;(t)--; }
        std::get&lt;0&gt;(t)=broj_dana[std::get&lt;1&gt;(t)-1];
    }
    dat.Postavi(std::get&lt;0&gt;(t),std::get&lt;1&gt;(t),std::get&lt;2&gt;(t));
}
bool Pregled::DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2){
    auto d1(p1.DajDatumPregleda().Ocitaj()),d2(p2.DajDatumPregleda().Ocitaj());
    if(std::get&lt;2&gt;(d1)==std::get&lt;2&gt;(d2)){
        if(std::get&lt;1&gt;(d1)==std::get&lt;1&gt;(d2)){
            if(std::get&lt;0&gt;(d1)==std::get&lt;0&gt;(d2)){
                auto v1(p1.DajVrijemePregleda().Ocitaj()),v2(p2.DajVrijemePregleda().Ocitaj());
                if(std::get&lt;0&gt;(v1)==std::get&lt;0&gt;(v2)){
                    if(std::get&lt;1&gt;(v1)==std::get&lt;1&gt;(v2)) return false;
                    return std::get&lt;1&gt;(v1)&gt;std::get&lt;1&gt;(v2);
                }
                return std::get&lt;0&gt;(v1)&gt;std::get&lt;0&gt;(v2);
            }
            return std::get&lt;0&gt;(d1)&gt;std::get&lt;0&gt;(d2);
        }
        return std::get&lt;1&gt;(d1)&gt;std::get&lt;1&gt;(d2);
    }
    return std::get&lt;2&gt;(d1)&gt;std::get&lt;2&gt;(d2);
}

bool operator ==(const Datum &amp;d1,const Datum &amp;d2){
    return d1.Ocitaj()==d2.Ocitaj();
}

class Pregledi{
    int broj_reg=0;
    mutable vector&lt;shared_ptr&lt;Pregled&gt;&gt; niz_pregleda;
    public:
    explicit Pregledi();
    Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda);
    Pregledi(const Pregledi &amp;pregledi);
    Pregledi(Pregledi &amp;&amp;pregledi);
    Pregledi &amp;operator =(const Pregledi &amp;pregledi);
    Pregledi &amp;operator =(Pregledi &amp;&amp;pregledi);
</font>    void RegistrirajPregled(const std::string &amp;ime_pacijenta,
    const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda);
<a name="0"></a><font color="#FF0000"><a href="match56-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_48.gif"/></a>

    void RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda,
    int mjesec_pregleda, int godina_pregleda, int sati_pregleda,
    int minute_pregleda);
    void RegistrirajPregled(shared_ptr&lt;Pregled&gt; pregled);
    int DajBrojPregleda() const{ return broj_reg; }
    int DajBrojPregledaNaDatum(const Datum &amp;datum) const;
    Pregled &amp;DajNajranijiPregled();
    Pregled DajNajranijiPregled() const;
    void IsprazniKolekciju();
    void ObrisiNajranijiPregled();
    void ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta);
    void IspisiPregledeNaDatum(const Datum &amp;datum) const;
    void IspisiSvePreglede() const;
};
Pregledi::Pregledi():niz_pregleda(0){}
Pregledi::Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda):niz_pregleda(spisak_pregleda.size()){
    int i(0);
    for(auto it(spisak_pregleda.begin());it!=spisak_pregleda.end();it++){
        niz_pregleda[i]=std::make_shared&lt;Pregled&gt;(*it);
        i++;
    }
    broj_reg=spisak_pregleda.size();
}
Pregledi::Pregledi(const Pregledi &amp;pregledi){
    niz_pregleda=pregledi.niz_pregleda;
    broj_reg=pregledi.broj_reg;
}
Pregledi::Pregledi(Pregledi &amp;&amp;pregledi){
    niz_pregleda=pregledi.niz_pregleda;
    broj_reg=pregledi.broj_reg;
}
Pregledi &amp;Pregledi::operator =(const Pregledi &amp;pregledi){
    if(&amp;pregledi!=this){
        niz_pregleda=pregledi.niz_pregleda;
        broj_reg=pregledi.broj_reg;
    }
    return *this;
}
Pregledi &amp;Pregledi::operator =(Pregledi &amp;&amp;pregledi){
    if(&amp;pregledi!=this){
        niz_pregleda=pregledi.niz_pregleda;
        broj_reg=pregledi.broj_reg;
    }
    return *this;
}
void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta,const Datum &amp;datum_pregleda,
const Vrijeme &amp;vrijeme_pregleda){
        for(int i(0);i&lt;niz_pregleda.size();i++){
            if(niz_pregleda[i]==nullptr){
                niz_pregleda[i]=std::make_shared&lt;Pregled&gt;(ime_pacijenta,datum_pregleda,vrijeme_pregleda);
                broj_reg++;
                return;
            }
        }
        auto pom(std::make_shared&lt;Pregled&gt;(ime_pacijenta,datum_pregleda,vrijeme_pregleda));
        niz_pregleda.push_back(pom);
        broj_reg++;
}
void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda,int mjesec_pregleda,
int godina_pregleda, int sati_pregleda,int minute_pregleda){
    for(int i(0);i&lt;niz_pregleda.size();i++){
            if(niz_pregleda[i]==nullptr){
                niz_pregleda[i]=std::make_shared&lt;Pregled&gt;(ime_pacijenta,dan_pregleda,mjesec_pregleda,godina_pregleda,
                sati_pregleda,minute_pregleda);
                broj_reg++;
                return;
            }
        }
    auto pom(std::make_shared&lt;Pregled&gt;(ime_pacijenta,dan_pregleda,mjesec_pregleda,godina_pregleda,
                sati_pregleda,minute_pregleda));
    niz_pregleda.push_back(pom);
    broj_reg++;
}
void Pregledi::RegistrirajPregled(shared_ptr&lt;Pregled&gt; pregled){
    for(int i(0);i&lt;niz_pregleda.size();i++){
            if(niz_pregleda[i]==nullptr){
                niz_pregleda[i]=pregled;
                broj_reg++;
                return;
            }
        }
    niz_pregleda.push_back(pregled);
    broj_reg++;
}
int Pregledi::DajBrojPregledaNaDatum(const Datum &amp;datum) const{
    return std::count_if(niz_pregleda.begin(),niz_pregleda.begin()+broj_reg,[&amp;datum](shared_ptr&lt;Pregled&gt; pregled){
       return datum.Ocitaj()==pregled-&gt;DajDatumPregleda().Ocitaj(); });
}
Pregled &amp;Pregledi::DajNajranijiPregled(){
    if(broj_reg==0) throw std::domain_error("Nema registriranih pregleda");
    return **std::min_element(niz_pregleda.begin(),niz_pregleda.begin()+broj_reg,[](shared_ptr&lt;Pregled&gt; p1,shared_ptr&lt;Pregled&gt; p2){
        return !Pregled::DolaziPrije(*p1,*p2); });
}
Pregled Pregledi::DajNajranijiPregled() const{
    if(broj_reg==0) throw std::domain_error("Nema registriranih pregleda");
    return **std::min_element(niz_pregleda.begin(),niz_pregleda.begin()+broj_reg,[](shared_ptr&lt;Pregled&gt; p1,shared_ptr&lt;Pregled&gt; p2){
        return !Pregled::DolaziPrije(*p1,*p2); });
}
void Pregledi::IsprazniKolekciju(){
    niz_pregleda.resize(0);
    broj_reg=0;
}
void Pregledi::ObrisiNajranijiPregled(){
    if(broj_reg==0) throw std::range_error("Prazna kolekcija");
    shared_ptr&lt;Pregled&gt; min(niz_pregleda[0]);
    for(int i(0);i&lt;broj_reg;i++){
        if(Pregled::DolaziPrije(*min,*niz_pregleda[i])) min=niz_pregleda[i];
    }
    for(int i(0);i&lt;broj_reg;i++){
        if(min==niz_pregleda[i]){
            for(int j(i);j&lt;broj_reg-1;j++) niz_pregleda[j]=niz_pregleda[j+1];
            broj_reg--;
            niz_pregleda[broj_reg]=nullptr;
            i--;
        }
    }
}
void Pregledi::ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta){
    for(int i(0);i&lt;broj_reg;i++){
        if(ime_pacijenta==niz_pregleda[i]-&gt;DajImePacijenta()){
            for(int j(i);j&lt;broj_reg-1;j++) niz_pregleda[j]=niz_pregleda[j+1];
            broj_reg--;
            niz_pregleda[broj_reg]=nullptr;
            i--;
        }
    }
}
void Pregledi::IspisiPregledeNaDatum(const Datum &amp;datum) const{
    std::sort(niz_pregleda.begin(),niz_pregleda.begin()+broj_reg,[](shared_ptr&lt;Pregled&gt; p1,shared_ptr&lt;Pregled&gt; p2){
        return !Pregled::DolaziPrije(*p1,*p2); });
    for(int i(0);i&lt;broj_reg;i++){
        if(datum==niz_pregleda[i]-&gt;DajDatumPregleda()) 
        { niz_pregleda[i]-&gt;Ispisi(); cout&lt;&lt;std::endl; }
    }
}
void Pregledi::IspisiSvePreglede() const{
    std::sort(niz_pregleda.begin(),niz_pregleda.begin()+broj_reg,[](shared_ptr&lt;Pregled&gt; p1,shared_ptr&lt;Pregled&gt; p2){
        return !Pregled::DolaziPrije(*p1,*p2); });
    for(int i(0);i&lt;broj_reg;i++){ niz_pregleda[i]-&gt;Ispisi(); cout&lt;&lt;std::endl; }
}

int main ()
{
    try{
        Pregledi p;
        for(;;){
            string ime;
            cout&lt;&lt;"Unesite ime novog pacijenta ili 'kraj' za zavrsetak unosa: ";
            std::getline(cin,ime);
            if(ime=="kraj") break;
            int d(0),m(0),g(0),h(0),min(0);
            cout&lt;&lt;"Unesite dan mjesec i godinu pregleda: ";
            cin&gt;&gt;d&gt;&gt;m&gt;&gt;g;
            cout&lt;&lt;"Unesite sate i minute pregleda: ";
            cin&gt;&gt;h&gt;&gt;min;
            p.RegistrirajPregled(ime,d,m,g,h,min);
            cin.clear();
            cin.ignore(1000,'\n');
        }
        cout&lt;&lt;"Trenutno su registrovani sljedeci pregledi"&lt;&lt;std::endl;
        p.IspisiSvePreglede(); cout&lt;&lt;std::endl;
        while(true){
            int opcija(0);
            cout&lt;&lt;"Odaberite jednu od sljedecih opcija\n1 - Broj pregleda na datum\n2 - Najraniji pregled\n3 - Obrisi pregled pacijenta";
            cout&lt;&lt;"\n4 - Obrisi najraniji pregled\n5 - Ispisi sve pregleda na datum\n6 - Ispisi sve preglede\n7 - Kraj programa"&lt;&lt;std::endl;
            cin&gt;&gt;opcija;
            if(opcija==1){
                int d(0),m(0),g(0);
                cout&lt;&lt;"Unesite dan mjesec i godinu : ";
                cin&gt;&gt;d&gt;&gt;m&gt;&gt;g;
                Datum dat(d,m,g);
                cout&lt;&lt;"Broj pregleda na datum "&lt;&lt;d&lt;&lt;" "&lt;&lt;m&lt;&lt;" "&lt;&lt;g&lt;&lt;" je: "&lt;&lt;p.DajBrojPregledaNaDatum(dat)&lt;&lt;std::endl;
            }
            if(opcija==2){
                cout&lt;&lt;"Najraniji pregled je:"&lt;&lt;std::endl;
                p.DajNajranijiPregled().Ispisi(); cout&lt;&lt;std::endl;
            }
            if(opcija==3){
                string ime;
                cin.clear();
                cin.ignore(1000,'\n');
                cout&lt;&lt;"Unesite ime pacijenta: ";
                getline(cin,ime);
                int d(p.DajBrojPregleda());
                p.ObrisiPregledePacijenta(ime);
                cout&lt;&lt;"Uspjesno obrisano "&lt;&lt;d-p.DajBrojPregleda()&lt;&lt;" pregleda"&lt;&lt;std::endl;
            }
            if(opcija==4){
                p.ObrisiNajranijiPregled();
                cout&lt;&lt;"Najraniji pregled uspjesno obrisan"&lt;&lt;std::endl;
            }
            if(opcija==5){
                int d(0),m(0),g(0);
                cout&lt;&lt;"Unesite dan mjesec i godinu : ";
                cin&gt;&gt;d&gt;&gt;m&gt;&gt;g;
                Datum dat(d,m,g);
                cout&lt;&lt;"Pregledi na datum "&lt;&lt;d&lt;&lt;" "&lt;&lt;m&lt;&lt;" "&lt;&lt;g&lt;&lt;" su:"&lt;&lt;std::endl;
                p.IspisiPregledeNaDatum(dat); cout&lt;&lt;std::endl;
            }
            if(opcija==6){
                p.IspisiSvePreglede(); cout&lt;&lt;std::endl;
            }
            if(opcija==7) break;
            cout&lt;&lt;std::endl;
        }
    }
    catch(std::range_error izuzetak){
        cout&lt;&lt;izuzetak.what();
    }
    catch(std::domain_error izuzetak){
        cout&lt;&lt;izuzetak.what();
</font>    }
    
	return 0;
}</pre>
</body>
</html>
