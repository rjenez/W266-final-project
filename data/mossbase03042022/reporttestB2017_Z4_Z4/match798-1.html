<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z4/student6363.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z4/student4261.cpp<p></p><pre>
/B2017/2018: ZadaÄ‡a 4, Zadatak 4

#include &lt;iostream&gt;
#include &lt;tuple&gt;
#include &lt;utility&gt;
#include &lt;algorithm&gt;
#include &lt;stdexcept&gt;
#include &lt;iomanip&gt;
#include &lt;string&gt;
#include &lt;cmath&gt;
#include &lt;initializer_list&gt;
#include &lt;vector&gt;
#include &lt;memory&gt;


class Datum {
<a name="0"></a><font color="#FF0000"><a href="match798-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_4.gif"/></a>

    int d, m, g;
    static int BrojDana (int mjesec, int godina) {
        int broj_dana[12]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
        if (godina%4==0 &amp;&amp; (godina%100!=0 || godina%400==0)) broj_dana[1]++;
        return broj_dana[mjesec-1];
    }
  public:
    Datum(int dan, int mjesec, int godina) { Postavi(dan, mjesec, godina); }
    void Postavi(int dan, int mjesec, int godina) {
        if (godina&lt;1 || mjesec&lt;1 || mjesec&gt;12) throw std::domain_error("Neispravan datum");
</font>        if (dan&lt;1 || dan&gt;BrojDana(mjesec, godina)) throw std::domain_error("Neispravan datum");
<a name="8"></a><font color="#00FFFF"><a href="match798-0.html#8" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_0.gif"/></a>

        d=dan; m=mjesec; g=godina;
    }
    std::tuple&lt;int, int, int&gt; Ocitaj() const { return std::make_tuple(d, m, g); }
    void Ispisi() const { std::cout &lt;&lt; d &lt;&lt; "/"  &lt;&lt; m &lt;&lt; "/" &lt;&lt; g; }
</font>};

class Vrijeme {
<a name="3"></a><font color="#00FFFF"><a href="match798-0.html#3" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

    int h, min;
  public:
    Vrijeme(int sati, int minute) { Postavi(sati, minute); }
    void Postavi(int sati, int minute) {
        if (sati&lt;0 || sati&gt;23 || minute&lt;0 || minute&gt;59) throw std::domain_error("Neispravno vrijeme");
</font><a name="1"></a><font color="#00FF00"><a href="match798-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_2.gif"/></a>

        h=sati; min=minute;
    }
    std::pair&lt;int, int&gt; Ocitaj () const { return std::make_pair(h, min); }
    void Ispisi() const { std::cout &lt;&lt; std::setfill('0') &lt;&lt; std::setw(2) &lt;&lt; h &lt;&lt; ":" &lt;&lt; std::setw(2) &lt;&lt; min &lt;&lt; std::setfill(' '); }
};

class Pregled {
</font>    std::string ime_pacijenta;
    Datum datum_pregleda;
    Vrijeme vrijeme_pregleda;
    static int BrojDana (int mjesec, int godina) {
        int broj_dana[12]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
        if (godina%4==0 &amp;&amp; (godina%100!=0 || godina%400==0)) broj_dana[1]++;
        return broj_dana[mjesec-1];
    }
  public:
    Pregled(const std::string &amp;ime, const Datum &amp;datum, const Vrijeme &amp;vrijeme) : ime_pacijenta(ime), datum_pregleda(datum), vrijeme_pregleda(vrijeme) { }
        
<a name="2"></a><font color="#0000FF"><a href="match798-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

    Pregled (const std::string &amp;ime, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda) : 
        ime_pacijenta(ime), datum_pregleda(dan_pregleda, mjesec_pregleda, godina_pregleda), vrijeme_pregleda(sati_pregleda, minute_pregleda) { }
    
    void PromijeniPacijenta(const std::string &amp;ime_pacijenta) { Pregled::ime_pacijenta=ime_pacijenta; }
    void PromijeniDatum(const Datum &amp;novi_datum) { datum_pregleda=novi_datum; }
    void PromijeniVrijeme(const Vrijeme &amp;novo_vrijeme) { vrijeme_pregleda=novo_vrijeme; }
</font>    
    void PomjeriDanUnaprijed() {
        std::tuple&lt;int, int, int&gt; dat(datum_pregleda.Ocitaj());
        int d(std::get&lt;0&gt;(dat)), mj(std::get&lt;1&gt;(dat)), god(std::get&lt;2&gt;(dat));
        d++;
        if (d&gt;BrojDana(mj, god)) { d=1; mj++; }
        if (mj&gt;12) { mj=1; god++; }
        datum_pregleda=Datum(d, mj, god);
    }
    
    void PomjeriDanUnazad() {
        std::tuple&lt;int, int, int&gt; dat(datum_pregleda.Ocitaj());
        int d(std::get&lt;0&gt;(dat)), mj(std::get&lt;1&gt;(dat)), god(std::get&lt;2&gt;(dat));
        d--;
        if (d&lt;1) { mj--; if (mj&gt;0) d=BrojDana(mj, god); }
        if (mj&lt;1) { mj=12; god--; if (god&lt;1) throw std::domain_error("Neispravan datum"); d=31; }
        
<a name="6"></a><font color="#00FF00"><a href="match798-0.html#6" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

        datum_pregleda=Datum(d, mj, god);
    }
    
    std::string DajImePacijenta() const { return ime_pacijenta; }
    Datum DajDatumPregleda() const { return datum_pregleda; }
    Vrijeme DajVrijemePregleda() const { return vrijeme_pregleda; }
    
    static bool DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2) {
</font>        std::tuple&lt;int, int, int&gt; dat1(p1.datum_pregleda.Ocitaj());
        std::tuple&lt;int, int, int&gt; dat2(p2.datum_pregleda.Ocitaj());
        std::pair&lt;int, int&gt; vr1(p1.vrijeme_pregleda.Ocitaj());
        std::pair&lt;int, int&gt; vr2(p2.vrijeme_pregleda.Ocitaj());
        int dan1(std::get&lt;0&gt;(dat1)), dan2(std::get&lt;0&gt;(dat2)), mj1(std::get&lt;1&gt;(dat1)), mj2(std::get&lt;1&gt;(dat2)), god1(std::get&lt;2&gt;(dat1)), god2(std::get&lt;2&gt;(dat2));
        int h1(vr1.first), h2(vr2.first), min1(vr1.second), min2(vr2.second);
        
        return ((god1&lt;god2) || (god1==god2 &amp;&amp; mj1&lt;mj2) || (god1==god2 &amp;&amp; mj1==mj2 &amp;&amp; dan1&lt;dan2) || (god1==god2 &amp;&amp; mj1==mj2 &amp;&amp; dan1==dan2 &amp;&amp; h1&lt;h2) || (god1==god2 &amp;&amp; mj1==mj2 &amp;&amp; dan1==dan2 &amp;&amp; h1==h2 &amp;&amp; min1&lt;min2));
    }
    
    void Ispisi() const { std::cout &lt;&lt; std::setw(30) &lt;&lt; std::setfill(' ') &lt;&lt; std::left &lt;&lt; DajImePacijenta() &lt;&lt; std::right; datum_pregleda.Ispisi(); std::cout &lt;&lt; " "; vrijeme_pregleda.Ispisi(); std::cout &lt;&lt; std::endl; }
};







class Pregledi {
    std::vector&lt;std::shared_ptr&lt;Pregled&gt;&gt; p;
    
    
    static bool JednakiDatumi (const Datum &amp;d1, const Datum &amp;d2) {
        std::tuple&lt;int, int, int&gt; dat1(d1.Ocitaj());
        std::tuple&lt;int, int, int&gt; dat2(d2.Ocitaj());
        int dan1(std::get&lt;0&gt;(dat1)), dan2(std::get&lt;0&gt;(dat2)), mj1(std::get&lt;1&gt;(dat1)), mj2(std::get&lt;1&gt;(dat2)), god1(std::get&lt;2&gt;(dat1)), god2(std::get&lt;2&gt;(dat2));
        return (dan1==dan2 &amp;&amp; mj1==mj2 &amp;&amp; god1==god2);
    }
    
    static bool JednakaVremena (const Vrijeme &amp;v1, const Vrijeme &amp;v2) {
        std::pair&lt;int, int&gt; vr1(v1.Ocitaj());
        std::pair&lt;int, int&gt; vr2(v2.Ocitaj());
        
        int h1(vr1.first), h2(vr2.first), min1(vr1.second), min2(vr2.second);
        return (h1==h2 &amp;&amp; min1==min2);
    }
    
  public:
  
    explicit Pregledi () { }
    
    Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda) {
        
        auto it(spisak_pregleda.begin());
        
        for (int i=0; i&lt;spisak_pregleda.size(); i++) {
            p.push_back(std::make_shared&lt;Pregled&gt;((*it).DajImePacijenta(), (*it).DajDatumPregleda(), (*it).DajVrijemePregleda()));
            it++;
        }
    }
    
    Pregledi(const Pregledi &amp;pregledi) {
        
        for (int i=0; i&lt;pregledi.DajBrojPregleda(); i++) p.push_back(std::make_shared&lt;Pregled&gt;(*(pregledi.p.at(i))));
    }
    
    Pregledi(Pregledi &amp;&amp;pregledi) {
        p=std::move(pregledi.p);
        
    }
    
    Pregledi &amp;operator =(const Pregledi &amp;pregledi) {
        if (&amp;pregledi!=this) {
            p.resize(0);
            
            for (int i=0; i&lt;pregledi.p.size(); i++) p.push_back(std::make_shared&lt;Pregled&gt;(*(pregledi.p.at(i))));
        }
        return *this;
    }
    
    Pregledi &amp;operator =(Pregledi &amp;&amp;pregledi) {
        if (&amp;pregledi!=this) {
<a name="5"></a><font color="#FF0000"><a href="match798-0.html#5" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

            p=std::move(pregledi.p);
            
        }
        return *this;
    }
    
    void RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda) {
</font>        
        try {
            p.push_back(std::make_shared&lt;Pregled&gt;(Pregled(ime_pacijenta, datum_pregleda, vrijeme_pregleda)));
        }
        catch(...) {
            throw;
        }
    }
    
    void RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda) {
        
        try {
            p.push_back(std::make_shared&lt;Pregled&gt;(Pregled(ime_pacijenta, dan_pregleda, mjesec_pregleda, godina_pregleda, sati_pregleda, minute_pregleda)));
        }
        catch(...) {
            throw;
        }
    }
    
    void RegistrirajPregled(std::shared_ptr&lt;Pregled&gt; pregled) { 
        
        try {
            p.push_back(std::make_shared&lt;Pregled&gt;(*pregled));
        }
        catch(...) {
            throw;
        }
    }
    int DajBrojPregleda() const { return p.size(); }
    
    int DajBrojPregledaNaDatum(const Datum &amp;datum) const {
        return std::count_if(p.begin(), p.end(), [datum](std::shared_ptr&lt;Pregled&gt; p1) { return JednakiDatumi((*p1).DajDatumPregleda(), datum); } );
    }
    
<a name="7"></a><font color="#0000FF"><a href="match798-0.html#7" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

    Pregled &amp;DajNajranijiPregled() {
        if (p.size()==0) throw std::domain_error("Nema registriranih pregleda");
        return **(std::min_element(p.begin(), p.end(), [](std::shared_ptr&lt;Pregled&gt; p1, std::shared_ptr&lt;Pregled&gt; p2) { return Pregled::DolaziPrije(*p1, *p2); } ));
</font><a name="4"></a><font color="#FF00FF"><a href="match798-0.html#4" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

    }
    
    Pregled DajNajranijiPregled() const {
        if (p.size()==0) throw std::domain_error("Nema registriranih pregleda");
        return **(std::min_element(p.begin(), p.end(), [](std::shared_ptr&lt;Pregled&gt; p1, std::shared_ptr&lt;Pregled&gt; p2) { return Pregled::DolaziPrije(*p1, *p2); } ));
</font>    }
    
    void IsprazniKolekciju() {
        p.resize(0);
    }
    
    void ObrisiNajranijiPregled() {
        if (p.size()==0) throw std::range_error("Prazna kolekcija");
        auto it(std::find_if(p.begin(), p.end(), [this](std::shared_ptr&lt;Pregled&gt; p1) { return (*p1).DajImePacijenta()==DajNajranijiPregled().DajImePacijenta() &amp;&amp; JednakiDatumi((*p1).DajDatumPregleda(),DajNajranijiPregled().DajDatumPregleda()) &amp;&amp; JednakaVremena((*p1).DajVrijemePregleda(), DajNajranijiPregled().DajVrijemePregleda()); }));
        
        for (auto i=it; i!=p.end()-1; i++) {
            **i=**(i+1);
        }
        
        p.resize(p.size()-1);
    }
    
    void ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta) {
        for (;;) {
            auto it(std::find_if(p.begin(), p.end(), [ime_pacijenta](std::shared_ptr&lt;Pregled&gt; p1) { return (*p1).DajImePacijenta()==ime_pacijenta; }));
            if (it==p.end()) break;
            
            for (auto i=it; i!=p.end()-1; i++) {
                **i=**(i+1);
            }
            
            p.resize(p.size()-1);
        }
    }
    
    void IspisiPregledeNaDatum(const Datum &amp;datum) const {
        
        if (p.size()==0) return;
        
        Pregled** pomocni;
        pomocni=new Pregled*[p.size()]{};
        
        for (int i=0; i&lt;p.size(); i++) pomocni[i]=&amp;*(p.at(i));
        
        std::sort(pomocni, pomocni+p.size(), [](Pregled* p1, Pregled* p2) { return Pregled::DolaziPrije(*p1, *p2); } );
        
        std::for_each(pomocni, pomocni+p.size(), [datum] (Pregled* p1) { if (JednakiDatumi((*p1).DajDatumPregleda(), datum)) (*p1).Ispisi(); });
        
        for (int i=0; i&lt;p.size(); i++) pomocni[i]=nullptr;
        delete[] pomocni;
        
    }
    
    void IspisiSvePreglede() const {
        
        if (p.size()==0) return;
        
        Pregled** pomocni;
        pomocni=new Pregled*[p.size()]{};
        
        for (int i=0; i&lt;p.size(); i++) pomocni[i]=&amp;*(p.at(i));
        
        std::sort(pomocni, pomocni+p.size(), [](Pregled* p1, Pregled* p2) { return Pregled::DolaziPrije(*p1, *p2); } );
        
        std::for_each(pomocni, pomocni+p.size(), [] (Pregled* p1) { (*p1).Ispisi(); });
        
        for (int i=0; i&lt;p.size(); i++) pomocni[i]=nullptr;
        delete[] pomocni;
        
    }
};

int main ()
{
    try {
        int d, m, g, h, min, opcija;
        std::string ime;
        Pregledi pr;
        
        for (;;) {
            std::cout &lt;&lt; "Unesite ime novog pacijenta ili 'kraj' za zavrsetak unosa: ";
            std::getline(std::cin, ime);
            if (ime=="kraj") break;
            std::cout &lt;&lt; "Unesite dan mjesec i godinu pregleda: ";
            std::cin &gt;&gt; d &gt;&gt; m &gt;&gt; g;
            std::cout &lt;&lt; "Unesite sate i minute pregleda: ";
            std::cin &gt;&gt; h &gt;&gt; min;
            try {
                pr.RegistrirajPregled(ime, d, m, g, h, min);
            }
            catch(std::exception &amp;iz) {
                std::cout &lt;&lt; iz.what();
            }
            std::cin.clear(); std::cin.ignore(10000, '\n');
        }
        std::cout &lt;&lt; "Trenutno su registrovani sljedeci pregledi" &lt;&lt; std::endl;
        pr.IspisiSvePreglede();
        
        const char* niz_opcija[7]{"Broj pregleda na datum", "Najraniji pregled", "Obrisi pregled pacijenta", "Obrisi najraniji pregled", "Ispisi sve pregleda na datum", "Ispisi sve preglede", "Kraj programa"};
        for (;;) {
            
            std::cout &lt;&lt; "Odaberite jednu od sljedecih opcija" &lt;&lt; std::endl;
            for (int i=0; i&lt;7; i++) std::cout &lt;&lt; i+1 &lt;&lt; " - " &lt;&lt; niz_opcija[i] &lt;&lt; std::endl; 
            std::cin &gt;&gt; opcija;
            
            if (opcija==1) {
                int dan, mj, god;
                std::cout &lt;&lt; "Unesite dan mjesec i godinu : ";
                std::cin &gt;&gt; dan &gt;&gt; mj &gt;&gt; god;
                std::cout &lt;&lt; "Broj pregleda na datum " &lt;&lt; dan &lt;&lt; " " &lt;&lt; mj &lt;&lt; " " &lt;&lt; god &lt;&lt; " je: " &lt;&lt; pr.DajBrojPregledaNaDatum({dan, mj, god}) &lt;&lt; std::endl; 
            }
            else if (opcija==2) {
                
                try {
                    Pregled pregl(pr.DajNajranijiPregled());
                    std::cout &lt;&lt; "Najraniji pregled je: " &lt;&lt; std::endl;
                    pregl.Ispisi();
                }
                catch(std::domain_error &amp;iz) {
                    std::cout &lt;&lt; iz.what() &lt;&lt; std::endl;
                }
            }
            else if (opcija==3) {
                std::cin.clear(); std::cin.ignore(10000, '\n');
                std::cout &lt;&lt; "Unesite ime pacijenta: ";
                std::getline(std::cin, ime);
                int trenutno(pr.DajBrojPregleda());
                pr.ObrisiPregledePacijenta(ime);
                std::cout &lt;&lt; "Uspjesno obrisano " &lt;&lt; trenutno-pr.DajBrojPregleda() &lt;&lt; " pregleda" &lt;&lt; std::endl;
            }
            else if (opcija==4) {
                try {
                    pr.ObrisiNajranijiPregled();
                    std::cout &lt;&lt; "Najraniji pregled uspjesno obrisan" &lt;&lt; std::endl;
                }
                catch(std::range_error &amp;iz) {
                    std::cout &lt;&lt; iz.what() &lt;&lt; std::endl;
                } 
                
            }
            else if (opcija==5) {
                int dan, mj, god;
                std::cout &lt;&lt; "Unesite dan mjesec i godinu : ";
                std::cin &gt;&gt; dan &gt;&gt; mj &gt;&gt; god;
                std::cout &lt;&lt; "Pregledi na datum " &lt;&lt; dan &lt;&lt; " " &lt;&lt; mj &lt;&lt; " " &lt;&lt; god &lt;&lt; " su:" &lt;&lt; std::endl;
                pr.IspisiPregledeNaDatum({dan, mj, god});
            }
            else if (opcija==6) {
                pr.IspisiSvePreglede();
            }
            else break;
        }
    }
    catch(...) {
        std::cout &lt;&lt; "Problemi sa memorijom";
    }
    
    /*Pregled p1{"Lejla", {21, 11, 1998}, {20, 33}};
    Pregled p2{"Avisa", {12, 11, 1999}, {13, 55}};
    
    Pregledi ppp{p1, p2};
    Pregledi prrrrr(std::move(ppp));
    
    ppp={{"Jaa", {12, 2, 2009}, {13, 11}}};
    
    ppp.IspisiSvePreglede();
    prrrrr.IspisiSvePreglede();
    */
    
    
	return 0;
}</pre>
</body>
</html>
