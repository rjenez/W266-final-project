<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z4/student2704.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z4/student2704.cpp<p></p><pre>
/B2017/2018: ZadaÄ‡a 4, Zadatak 3
#include &lt;iostream&gt;
#include &lt;tuple&gt;
#include &lt;iomanip&gt;
#include &lt;algorithm&gt;
#include &lt;memory&gt;
#include &lt;vector&gt;

using namespace std;

class Datum
{
    int d,m,g;
public:
    Datum(int dan, int mjesec, int godina) {
        Postavi(dan,mjesec,godina);
    }
    void Postavi(int dan, int mjesec, int godina);
    std::tuple&lt;int, int, int&gt; Ocitaj() const {
        return make_tuple(d,m,g);
    }
    void Ispisi() const {
        cout&lt;&lt;d&lt;&lt;"/"&lt;&lt;m&lt;&lt;"/"&lt;&lt;g;
    }
};

void Datum::Postavi(int dan, int mjesec, int godina)
{
    int broj_dana[12] {31,28,31,30,31,30,31,31,30,31,30,31};
    if( (godina%4==0 &amp;&amp; godina%100 !=0 )|| godina%400==0) broj_dana[1]++;
    if( godina &lt;1 or dan &lt;1 or mjesec &lt;1 or mjesec &gt;12 || dan &gt; broj_dana[mjesec-1])
        throw std::domain_error("Neispravan datum");
    d=dan;
    m=mjesec;
    g=godina;
}

class Vrijeme
{
    int h,m;

public:
    Vrijeme(int sati, int minute) {
        Postavi(sati,minute);
    }
    void Postavi(int sati, int minute);
    std::pair&lt;int, int&gt; Ocitaj () const {
        return make_pair(h,m);
    }
    void Ispisi() const {
        cout&lt;&lt;setw(2)&lt;&lt;std::right&lt;&lt;setfill('0')&lt;&lt;h;
        cout&lt;&lt;":";
        cout&lt;&lt;setw(2)&lt;&lt;m;
        cout&lt;&lt;setfill(' ');
    }

};

void Vrijeme::Postavi(int sati, int minute)
{
    if(sati&lt;0 or sati&gt;23 || minute&lt;0 || minute &gt;59)
        throw std::domain_error("Neispravno vrijeme");
    h=sati;
    m=minute;

}


<a name="8"></a><font color="#00FFFF"><a href="match745-1.html#8" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

class Pregled
{
    string ime_pac;
    Datum dat;
    Vrijeme vr;

public:
    Pregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda,
            const Vrijeme &amp;vrijeme_pregleda): ime_pac(ime_pacijenta), dat(datum_pregleda), vr(vrijeme_pregleda) {};
</font>    Pregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda,
<a name="0"></a><font color="#FF0000"><a href="match745-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_2.gif"/></a>

            int godina_pregleda, int sati_pregleda, int minute_pregleda): ime_pac(ime_pacijenta), dat(dan_pregleda,mjesec_pregleda,godina_pregleda), vr(sati_pregleda,minute_pregleda) {};
    void PromijeniPacijenta(const std::string &amp;ime_pacijenta) {
        ime_pac=ime_pacijenta;
    }
    void PromijeniDatum(const Datum &amp;novi_datum) {
        dat=novi_datum;
    }
    void PromijeniVrijeme(const Vrijeme &amp;novo_vrijeme) {
        vr=novo_vrijeme;
    }
    void PomjeriDanUnaprijed();
    void PomjeriDanUnazad();
    std::string DajImePacijenta() const {
        return ime_pac;
    }
    Datum DajDatumPregleda() const {
        return dat;
    }
    Vrijeme DajVrijemePregleda() const {
        return vr;
    }
    static bool DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2);
</font>    void Ispisi() const;

};

bool Pregled::DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2)
{
    auto tr1 = p1.DajDatumPregleda().Ocitaj();
    auto tr2 = p2.DajDatumPregleda().Ocitaj();
    int d1=get&lt;0&gt;(tr1), m1 = get&lt;1&gt;(tr1), g1=get&lt;2&gt;(tr1);
    int d2=get&lt;0&gt;(tr2), m2=get&lt;1&gt;(tr2), g2 = get&lt;2&gt;(tr2);

    if(g1&lt;g2) return true;
    else if (g1&gt;g2) return false;
    else if (g1==g2) {
        if(m1&lt;m2) return true;
        else if(m1&gt;m2) return false;
        else if (m1==m2) {
            if(d1&lt;d2) return true;
            else if(d1&gt;d2) return false;
            else if (d1==d2) {
                auto v1 = p1.DajVrijemePregleda().Ocitaj();
                auto v2 = p2.DajVrijemePregleda().Ocitaj();

                int s1 = v1.first, m1=v1.second;
                int s2 = v2.first, m2=v2.second;

                if(s1&lt;s2) return true;
                else if(s1&gt;s2) return false;
                else if(s1==s2) {
                    if(m1&lt;m2) return true;
                    else return false;
                }
            }
        }

    }
    return false; //da utisamo kompajler za upozorenja
}

void Pregled::Ispisi() const
{
    cout&lt;&lt;left&lt;&lt;setw(30)&lt;&lt;ime_pac;
    dat.Ispisi();
    cout&lt;&lt;" ";
    vr.Ispisi();
    cout&lt;&lt;endl;
}


void Pregled::PomjeriDanUnaprijed()
{
    int broj_dana[12] {31,28,31,30,31,30,31,31,30,31,30,31};
    auto trojka = dat.Ocitaj();

    int dan = std::get&lt;0&gt;(trojka);
    int mjesec = std::get&lt;1&gt;(trojka);
    int godina = std::get&lt;2&gt;(trojka);
    if( (godina%4==0 &amp;&amp; godina%100 !=0 )|| godina%400==0) broj_dana[1]++;


    dan++;
    if(dan&gt; broj_dana[mjesec-1]) {
        dan=1;
        mjesec++;
        if(mjesec&gt;12) {
            mjesec=1;
            godina++;

        }
    }
    dat=Datum(dan,mjesec,godina);

}

void Pregled::PomjeriDanUnazad()
{
    int broj_dana[12] {31,28,31,30,31,30,31,31,30,31,30,31};
    auto trojka = dat.Ocitaj();

    int dan = std::get&lt;0&gt;(trojka);
    int mjesec = std::get&lt;1&gt;(trojka);
    int godina = std::get&lt;2&gt;(trojka);

    if( (godina%4==0 &amp;&amp; godina%100 !=0 )|| godina%400==0) broj_dana[1]++;

    dan--;
    if(dan==0) {
        if(mjesec==1) {
            mjesec=12;
            godina--;
        }

        dan=broj_dana[mjesec-1];

    }

    dat=Datum(dan,mjesec,godina);
}



class Pregledi
{
    vector&lt;shared_ptr&lt;Pregled&gt;&gt; aktivni_pregledi;
    int  br_pregleda;


    void obrisiOstatke(int i) {
        aktivni_pregledi.clear();
    }

    void ObrisiPregled(int indeks) {
        //stavimo na kraj obrisani
        auto pomocni = aktivni_pregledi[br_pregleda-1];
        aktivni_pregledi[br_pregleda-1]=aktivni_pregledi[indeks];
        aktivni_pregledi[indeks]=pomocni;
        //obrisemo ga na kraju
        aktivni_pregledi.erase(aktivni_pregledi.begin()+br_pregleda-1);
        br_pregleda--;
    }
    
    void SoritajPreglede(){
        std::sort(aktivni_pregledi.begin(),aktivni_pregledi.end(), [](shared_ptr&lt;Pregled&gt; pok1,shared_ptr&lt;Pregled&gt; pok2){
           return Pregled::DolaziPrije(*pok1,*pok2);
        });
    }

public:
    explicit Pregledi();
    Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda);
    Pregledi(const Pregledi &amp;pregledi);
    Pregledi(Pregledi &amp;&amp;pregledi);
    Pregledi &amp;operator =(const Pregledi &amp;pregledi);
    Pregledi &amp;operator =(Pregledi &amp;&amp;pregledi);



    void RegistrirajPregled(const std::string &amp;ime_pacijenta,
                            const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda);
    void RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda,
                            int mjesec_pregleda, int godina_pregleda, int sati_pregleda,
                            int minute_pregleda);


    void RegistrirajPregled(Pregled *pregled);


    int DajBrojPregleda() const {
        return br_pregleda;
    }
    int DajBrojPregledaNaDatum(const Datum &amp;datum) const;
    Pregled &amp;DajNajranijiPregled();
    Pregled DajNajranijiPregled() const;
    void IsprazniKolekciju();
    void ObrisiNajranijiPregled();
    void ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta);
    void IspisiPregledeNaDatum(const Datum &amp;datum) const;
    void IspisiSvePreglede() const;

};

void Pregledi::IspisiPregledeNaDatum(const Datum &amp;datum) const
{
    for_each(aktivni_pregledi.begin(),aktivni_pregledi.end(),[&amp;datum](shared_ptr&lt;Pregled&gt; pok) {
        Datum dat = pok-&gt;DajDatumPregleda();
<a name="4"></a><font color="#FF00FF"><a href="match745-1.html#4" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

        if(get&lt;0&gt;(datum.Ocitaj()) == get&lt;0&gt;(dat.Ocitaj()) &amp;&amp; get&lt;1&gt;(datum.Ocitaj()) == get&lt;1&gt;(datum.Ocitaj()) &amp;&amp; get&lt;2&gt;(datum.Ocitaj()) == get&lt;2&gt;(datum.Ocitaj()))
</font>            pok-&gt;Ispisi();
    });
}

void Pregledi::IspisiSvePreglede() const
{
    for_each(aktivni_pregledi.begin(),aktivni_pregledi.end(),[](shared_ptr&lt;Pregled&gt; pok) {
        pok-&gt;Ispisi();
    });
}


void Pregledi::ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta)
{

    for(int i=0; i&lt;br_pregleda; i++){
        string imence = aktivni_pregledi[i]-&gt;DajImePacijenta();
        if(imence==ime_pacijenta){
            this-&gt;ObrisiPregled(i);
            i--; //jer smo sad na njegovo mjesto nakon brisanja stavili posljednji
        }
    }
    
    SoritajPreglede();
    
}



void Pregledi::ObrisiNajranijiPregled()
{
    if(br_pregleda==0) throw range_error("Prazna kolekcija");

    //pronadjemo ga pomocu algoritamske funkcije
    int indeks_najmanjeg(0);
    for(int i=1; i&lt;br_pregleda; i++){
        if(Pregled::DolaziPrije(*aktivni_pregledi[i],*aktivni_pregledi[indeks_najmanjeg]))
            indeks_najmanjeg=i;
    }

    ObrisiPregled(indeks_najmanjeg);
    SoritajPreglede();

}

void Pregledi::IsprazniKolekciju()
{
    aktivni_pregledi.clear();
}


Pregled&amp; Pregledi::DajNajranijiPregled()
{
<a name="6"></a><font color="#00FF00"><a href="match745-1.html#6" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

    if(br_pregleda==0) throw domain_error("Nema registriranih pregleda");
    return **min_element(aktivni_pregledi.begin(),aktivni_pregledi.end(),[](shared_ptr&lt;Pregled&gt; pok1, shared_ptr&lt;Pregled&gt; pok2) {
</font>        return Pregled::DolaziPrije(*pok1,*pok2);
    });
}

Pregled Pregledi::DajNajranijiPregled() const
{
<a name="7"></a><font color="#0000FF"><a href="match745-1.html#7" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

    if(br_pregleda==0) throw domain_error("Nema registriranih pregleda");
    return **min_element(aktivni_pregledi.begin(),aktivni_pregledi.end(),[](shared_ptr&lt;Pregled&gt; pok1, shared_ptr&lt;Pregled&gt; pok2) {
</font>        return Pregled::DolaziPrije(*pok1,*pok2);
    });
}


int Pregledi::DajBrojPregledaNaDatum(const Datum&amp; datum) const
{
    return count_if(aktivni_pregledi.begin(),aktivni_pregledi.end(), [&amp;datum](shared_ptr&lt;Pregled&gt; pok) {
        Datum dat = pok-&gt;DajDatumPregleda();
<a name="5"></a><font color="#FF0000"><a href="match745-1.html#5" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

        return get&lt;0&gt;(datum.Ocitaj()) == get&lt;0&gt;(dat.Ocitaj()) &amp;&amp; get&lt;1&gt;(datum.Ocitaj()) == get&lt;1&gt;(datum.Ocitaj()) &amp;&amp; get&lt;2&gt;(datum.Ocitaj()) == get&lt;2&gt;(datum.Ocitaj());
</font>    });
}



void Pregledi::RegistrirajPregled(Pregled *pregled)
{
    aktivni_pregledi.push_back(make_shared&lt;Pregled&gt;(*pregled));
    delete pregled;
    br_pregleda++;
    SoritajPreglede();
}


void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda,int mjesec_pregleda, int godina_pregleda, int sati_pregleda,int minute_pregleda)
{
    Datum dat(dan_pregleda,mjesec_pregleda,godina_pregleda);
    Vrijeme vr(sati_pregleda,minute_pregleda);

    RegistrirajPregled(ime_pacijenta,dat,vr);

}

<a name="9"></a><font color="#FF00FF"><a href="match745-1.html#9" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta,const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda)
{

    aktivni_pregledi.push_back(make_shared&lt;Pregled&gt;(ime_pacijenta,datum_pregleda,vrijeme_pregleda));
</font>    br_pregleda++;
    SoritajPreglede();

}


Pregledi::Pregledi()
{
    br_pregleda=0;

}

Pregledi::Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda)
{
    int i=0;        //pratimo koliko smo alocirali da mozemo obrisati kasnije
    
    try{

        for(auto pregledcic: spisak_pregleda) {
            aktivni_pregledi.push_back(make_shared&lt;Pregled&gt;(pregledcic));
            i++;
        }
    
        br_pregleda=spisak_pregleda.size();
        
        SoritajPreglede();
    }
    
    catch(std::bad_alloc e){
        obrisiOstatke(i);
    }


}

Pregledi::Pregledi(const Pregledi&amp; izvor_pregledi)
{

    int i=0;

    try {

        for(; i&lt;izvor_pregledi.br_pregleda; i++) {
            aktivni_pregledi.push_back(make_shared&lt;Pregled&gt;(*izvor_pregledi.aktivni_pregledi.at(i)));
        }
        br_pregleda=izvor_pregledi.br_pregleda;
    }

    catch(std::bad_alloc e) {
        obrisiOstatke(i);
        throw;
    }
}


Pregledi::Pregledi(Pregledi&amp;&amp; izvor_pregledi):aktivni_pregledi(izvor_pregledi.aktivni_pregledi),br_pregleda(izvor_pregledi.br_pregleda)
{
    izvor_pregledi.aktivni_pregledi.clear();
    izvor_pregledi.br_pregleda=0;
}



Pregledi&amp; Pregledi::operator =(const Pregledi &amp;izvor_pregledi)
{
    if(&amp;izvor_pregledi==this) return *this;       //samododjela

    int i=0,
        IsprazniKolekciju();

    try {


        for(; i&lt;izvor_pregledi.br_pregleda; i++) {
            aktivni_pregledi.push_back(make_shared&lt;Pregled&gt;(*izvor_pregledi.aktivni_pregledi.at(i)));
        }
        br_pregleda=izvor_pregledi.br_pregleda;

    }

    catch(std::bad_alloc e) {

        obrisiOstatke(i);
        throw;

    }
    return *this;

}

Pregledi&amp; Pregledi::operator =(Pregledi&amp;&amp; pregledi)
{

    if(&amp;pregledi==this) return *this;

    IsprazniKolekciju();
    br_pregleda=pregledi.br_pregleda;
    aktivni_pregledi=pregledi.aktivni_pregledi;

    pregledi.br_pregleda=0;
    pregledi.aktivni_pregledi.clear();

    return *this;
}







int main ()
{
    Pregledi pregledi;
    
    /* Test konstr kopije, operatora dodjele i sl.
    Pregledi pregledi12{Pregled("mujo",2,2,2,2,2), Pregled("haso",3,3,3,3,3),Pregled("elmir",4,4,4,4,4)};
    auto pregledi2(pregledi12);
    auto pregledi3 = pregledi12;
    Pregledi pregledi5={Pregled("mujo",2,2,2,3,3)};
    */
    
    
    
    string ime;

    do {
        try {
            cout&lt;&lt;"Unesite ime novog pacijenta ili 'kraj' za zavrsetak unosa: ";
            getline(cin,ime);
<a name="2"></a><font color="#0000FF"><a href="match745-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_2.gif"/></a>

            if(ime=="kraj")
                break;
            cout&lt;&lt;"Unesite dan mjesec i godinu pregleda: ";
            int d,mj,g;
            cin&gt;&gt;d&gt;&gt;mj&gt;&gt;g;
            cout&lt;&lt;"Unesite sate i minute pregleda: ";
            int h,m;
            cin&gt;&gt;h&gt;&gt;m;
            pregledi.RegistrirajPregled(ime,d,mj,g,h,m);
</font>            cin.ignore(10000,'\n');

        } catch(std::range_error e) {
            cout&lt;&lt;e.what()&lt;&lt;endl;
            break;      //ako je dostignut max broj pregleda nema smisla opet trazit unos jer moramo obrisati nekog sigurno
        } catch(std::domain_error e) {
            cout&lt;&lt;e.what()&lt;&lt;endl;
        }




    } while(true);
    
    cout&lt;&lt;"Trenutno su registrovani sljedeci pregledi"&lt;&lt;endl;
    pregledi.IspisiSvePreglede();

    int unos(0);

    do {
<a name="1"></a><font color="#00FF00"><a href="match745-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_2.gif"/></a>

        cout&lt;&lt;"Odaberite jednu od sljedecih opcija"&lt;&lt;endl;
        cout&lt;&lt;"1 - Broj pregleda na datum"&lt;&lt;endl;
        cout&lt;&lt;"2 - Najraniji pregled"&lt;&lt;endl;
        cout&lt;&lt;"3 - Obrisi pregled pacijenta"&lt;&lt;endl;
        cout&lt;&lt;"4 - Obrisi najraniji pregled"&lt;&lt;endl;
        cout&lt;&lt;"5 - Ispisi sve pregleda na datum"&lt;&lt;endl;
        cout&lt;&lt;"6 - Ispisi sve preglede"&lt;&lt;endl;
        cout&lt;&lt;"7 - Kraj programa"&lt;&lt;endl;

        cin&gt;&gt;unos;
</font>
        try {

            switch(unos) {


    
                    //opcija 1
                case 1: {
                    cout&lt;&lt;"Unesite dan mjesec i godinu : ";
                    int dan,mj,godina;
                    cin&gt;&gt;dan&gt;&gt;mj&gt;&gt;godina;
                    cout&lt;&lt;"Broj pregleda na datum "&lt;&lt;dan&lt;&lt;" "&lt;&lt;mj&lt;&lt;" "&lt;&lt;godina&lt;&lt;" je: "&lt;&lt;pregledi.DajBrojPregledaNaDatum(Datum(dan,mj,godina));
                    break;
                }
    
                //opcija 2
                case 2: {

                    cout&lt;&lt;"Najraniji pregled je:"&lt;&lt;endl;
                    pregledi.DajNajranijiPregled().Ispisi();
                    break;
                }
    
                //opcija 3
                case 3: {
                    cout&lt;&lt;"Unesite ime pacijenta: ";
                    cin.ignore(10000,'\n');
                    getline(cin,ime);
                    int n = pregledi.DajBrojPregleda();
                    pregledi.ObrisiPregledePacijenta(ime);
                    int m = pregledi.DajBrojPregleda();
                    cout&lt;&lt;"Uspjesno obrisano "&lt;&lt;n-m&lt;&lt;" pregleda"&lt;&lt;endl;
                    break;
                }
    
<a name="3"></a><font color="#00FFFF"><a href="match745-1.html#3" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

                case 4: {
                    pregledi.ObrisiNajranijiPregled();
                    cout&lt;&lt;"Najraniji pregled uspjesno obrisan"&lt;&lt;endl;
                    break;
                }
    
                //opcija 4
                case 5: {
                    cout&lt;&lt;"Unesite dan mjesec i godinu : ";
                    int dan,mj,godina;
                    cin&gt;&gt;dan&gt;&gt;mj&gt;&gt;godina;
                    cout&lt;&lt;"Pregledi na datum "&lt;&lt;dan&lt;&lt;" "&lt;&lt;mj&lt;&lt;" "&lt;&lt;godina&lt;&lt;" su:"&lt;&lt;endl;
</font><a name="10"></a><font color="#FF0000"><a href="match745-1.html#10" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

                    pregledi.IspisiPregledeNaDatum(Datum(dan,mj,godina));
</font>                    break;
                }
    
                case 6: {
                    pregledi.IspisiSvePreglede();
                    break;
    
                }

            }
        
        } 
        catch(std::domain_error e) {
            cout&lt;&lt;e.what()&lt;&lt;endl;
        } catch(std::range_error e) {
            cout&lt;&lt;e.what()&lt;&lt;endl;
        }

        cout&lt;&lt;endl;
    } while(unos!=7);
    
    


    return 0;
}
</pre>
</body>
</html>
