<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z4/student2959.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z4/student4860.cpp<p></p><pre>
<a name="4"></a><font color="#FF00FF"><a href="match797-0.html#4" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

/B2017/2018: ZadaÄ‡a 4, Zadatak 3
#include &lt;algorithm&gt;
#include &lt;stdexcept&gt;
#include &lt;iostream&gt;
#include &lt;tuple&gt;
#include &lt;iomanip&gt;
#include &lt;memory&gt;
#include &lt;vector&gt;

class Datum{
    int d, m, g;
public:
    Datum(int dan, int mjesec, int godina);
</font>    void Postavi(int dan, int mjesec, int godina);
    std::tuple&lt;int, int, int&gt; Ocitaj() const;
    void Ispisi() const;
};

void Datum::Postavi(int dan, int mjesec, int godina)
{
    if(dan &lt; 1 || mjesec &lt; 1 || godina &lt; 1 || mjesec &gt; 12)
        throw std::domain_error("Neispravan datum");
    
    int broj_dana[12]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    if((godina % 4 == 0 &amp;&amp; godina % 100 != 0) || godina % 400 == 0)
        broj_dana[1] = 29;
        
    if(dan &gt; broj_dana[mjesec - 1])
        throw std::domain_error("Neispravan datum");
    
    d = dan;
    m = mjesec;
    g = godina;
}

Datum::Datum(int dan, int mjesec, int godina)
{
    Postavi(dan, mjesec, godina);
}

std::tuple&lt;int, int, int&gt; Datum::Ocitaj() const
{
    return std::tuple&lt;int, int, int&gt;{d, m, g};
}

void Datum::Ispisi() const
{
    std::cout &lt;&lt; d &lt;&lt; '/' &lt;&lt; m &lt;&lt; '/' &lt;&lt; g;
}


class Vrijeme
{
    int h, m;
public:
    Vrijeme(int sati, int minute);
    void Postavi(int sati, int minute);
    void Ispisi()const;
    std::pair&lt;int, int&gt; Ocitaj() const;
};

void Vrijeme::Postavi(int sati, int minute)
{
    if(sati &lt; 0 || sati &gt; 23 || minute &lt; 0 || minute &gt; 59)
        throw std::domain_error("Neispravno vrijeme");
        
    h = sati;
    m = minute;
}

Vrijeme::Vrijeme(int sati, int minute)
{
    Postavi(sati, minute);
}

std::pair&lt;int, int&gt; Vrijeme::Ocitaj() const
{
<a name="8"></a><font color="#00FFFF"><a href="match797-0.html#8" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

    return std::pair&lt;int, int&gt;{h, m};
}

void Vrijeme::Ispisi() const
{
    std::cout &lt;&lt; std::right &lt;&lt; std::setw(2) &lt;&lt; std::setfill('0') &lt;&lt; h &lt;&lt; ':' &lt;&lt; std::setw(2) &lt;&lt; m;
</font>    std::cout &lt;&lt; std::setfill(' ');
}

class Pregled
{
    std::string ime;
    Datum d;
    Vrijeme v;
public:
    Pregled(const std::string&amp; ime, const Datum&amp; d, const Vrijeme&amp; v);
    Pregled(const std::string&amp; ime, int dan, int mj, int g, int h, int m);
    void PromijeniPacijenta(const std::string&amp; ime);
    void PromijeniDatum(const Datum&amp; dat);
    void PromijeniVrijeme(const Vrijeme&amp; vr);
    void PomjeriDanUnaprijed(); //
    void PomjeriDanUnazad(); //
    std::string DajImePacijenta() const;
    Datum DajDatumPregleda() const;
    Vrijeme DajVrijemePregleda()const;
    void Ispisi() const;
    
    static bool DolaziPrije(const Pregled&amp; p1, const Pregled&amp; p2);
};

void Pregled::PomjeriDanUnaprijed()
{
    int broj_dana[12]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    
    int dan, m, g;
    std::tie(dan, m, g) = d.Ocitaj();
    
    if((g % 4 == 0 &amp;&amp; g % 100 != 0) || g % 400 == 0)
        broj_dana[1] = 29;
        
    if(dan == 31 || m == 12){
        d.Postavi(1, 1, g+ 1);
    }
    
    else if(dan == broj_dana[m - 1]){
        d.Postavi(1, m + 1, g);
    }
    else {
        d.Postavi(dan + 1, m, g);    
    }
    
    
}

void Pregled::PomjeriDanUnazad()
{
    int broj_dana[12]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    
    int dan, m, g;
    std::tie(dan, m, g) = d.Ocitaj();
    
    if((g % 4 == 0 &amp;&amp; g % 100 != 0) || g % 400 == 0)
        broj_dana[1] = 29;
        
    if(dan == 1 || m == 1){
        d.Postavi(31, 12, g - 1);
    }
    
    else if(dan == 1){
        d.Postavi(broj_dana[m - 2], m - 1, g);
    }
    else {
<a name="1"></a><font color="#00FF00"><a href="match797-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_2.gif"/></a>

        d.Postavi(dan - 1, m, g);
    }
        
}

bool Pregled::DolaziPrije(const Pregled&amp; p1, const Pregled&amp; p2)
{
    int d1, m1, g1, d2, m2, g2;
    std::tie(d1, m1, g1) = p1.DajDatumPregleda().Ocitaj();
    std::tie(d2, m2, g2) = p2.DajDatumPregleda().Ocitaj();
    
    if(d1 == d2 &amp;&amp; m1 == m2 &amp;&amp; g1 == g2){
</font>        return p1.DajVrijemePregleda().Ocitaj() &lt; p2.DajVrijemePregleda().Ocitaj();
    }
    
    if(g1 == g2){
        if(m1 == m2){
            return d1 &lt; d2;
        }
        return m1 &lt; m2;
    }
    return g1 &lt; g2;
}

void Pregled::Ispisi()const
{
    std::cout &lt;&lt; std::setw(30) &lt;&lt;  std::left &lt;&lt; ime;
    d.Ispisi();
    std::cout &lt;&lt; " ";
    v.Ispisi();
    std::cout &lt;&lt; std::endl;
}

Pregled::Pregled(const std::string&amp; ime, const Datum&amp; d, const Vrijeme&amp; v) : ime(ime), d(d), v(v){}
Pregled::Pregled(const std::string&amp; ime, int dan, int mj, int g, int h, int m) : ime(ime), d(dan, mj, g), v(h, m) {}

void Pregled::PromijeniPacijenta(const std::string&amp; ime)
{
    this-&gt;ime = ime;
}

void Pregled::PromijeniDatum(const Datum&amp; dat)
{
    d = dat;
}

void Pregled::PromijeniVrijeme(const Vrijeme&amp; vr)
{
    v = vr;
}


std::string Pregled::DajImePacijenta() const
{
    return ime;
}

Datum Pregled::DajDatumPregleda() const
{
    return this-&gt;d;
}

Vrijeme Pregled::DajVrijemePregleda()const
{
    return v;
}

<a name="2"></a><font color="#0000FF"><a href="match797-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

typedef const std::shared_ptr&lt;Pregled&gt; PokNaPregled;

class Pregledi
{
    std::vector&lt;std::shared_ptr&lt;Pregled&gt;&gt; pregledi;

public:
    explicit Pregledi() = default;
    Pregledi(std::initializer_list&lt;Pregled&gt; sp);
    ~Pregledi() = default;
    Pregledi(const Pregledi&amp; pr);
    Pregledi(Pregledi&amp;&amp; pr);
</font>    Pregledi&amp; operator=(const Pregledi&amp; pr);
    Pregledi&amp; operator=(Pregledi&amp;&amp; pr);
    void RegistrirajPregled(const std::string&amp; ime, const Datum&amp; dat, const Vrijeme&amp; vr);
    void RegistrirajPregled(const std::string&amp; ime, int dat, int mj, int g, int s, int m);
    void RegistrirajPregled(PokNaPregled pr);
    int DajBrojPregleda() const;
    int DajBrojPregledaNaDatum(const Datum&amp; dat) const;
    
    Pregled&amp; DajNajranijiPregled();
<a name="7"></a><font color="#0000FF"><a href="match797-0.html#7" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

    Pregled DajNajranijiPregled() const;
    void IsprazniKolekciju();
    void ObrisiNajranijiPregled();
    void ObrisiPregledePacijenta(const std::string&amp; ime);
    
    void IspisiPregledeNaDatum(const Datum&amp; dat)const;
    void IspisiSvePreglede() const;
};

void Pregledi::IspisiSvePreglede() const
</font>{
    auto n_v = pregledi;
    
    std::sort(n_v.begin(), n_v.end(), [](PokNaPregled p1, PokNaPregled p2){
        return Pregled::DolaziPrije(*p1, *p2);
    });
    
    for(auto start = n_v.begin(); start != n_v.end(); ++start){
        (*start)-&gt;Ispisi();
    }
    
}

void Pregledi::IspisiPregledeNaDatum(const Datum&amp; dat)const
{
    auto n_v = pregledi;
    
    const auto kraj = std::copy_if(pregledi.begin(), pregledi.end(), n_v.begin(), [&amp;dat](PokNaPregled p){
        return p-&gt;DajDatumPregleda().Ocitaj() == dat.Ocitaj();
    });
    
    std::sort(n_v.begin(), kraj, [](PokNaPregled p1, PokNaPregled p2){
        return Pregled::DolaziPrije(*p1, *p2);
    });
    
    for(auto start = n_v.begin(); start != kraj; ++start){
        (*start)-&gt;Ispisi();
    }
}

void Pregledi::ObrisiPregledePacijenta(const std::string&amp; ime)
{
    const auto kraj = std::remove_if(pregledi.begin(), pregledi.end(), [&amp;ime](PokNaPregled p){
        return p-&gt;DajImePacijenta() == ime;
    } );
    
    pregledi.resize(kraj - pregledi.begin()); 
}

void Pregledi::ObrisiNajranijiPregled()
{
    if(pregledi.size() == 0)
        throw std::range_error("Prazna kolekcija");
        
    auto p = *std::min_element(pregledi.begin(), pregledi.end(), [](PokNaPregled p1, PokNaPregled p2){
        return Pregled::DolaziPrije(*p1, *p2);
    } );
    std::remove(pregledi.begin(), pregledi.end(), p);
    pregledi.pop_back();
}

void Pregledi::IsprazniKolekciju()
{
<a name="6"></a><font color="#00FF00"><a href="match797-0.html#6" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

    pregledi.clear();
        
}

Pregled&amp; Pregledi::DajNajranijiPregled()
{
    if(pregledi.size() == 0){
        throw std::domain_error("Nema registriranih pregleda");
    }
    return **std::min_element(pregledi.begin(), pregledi.end(), [](PokNaPregled p1, PokNaPregled p2){
</font><a name="3"></a><font color="#00FFFF"><a href="match797-0.html#3" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

        return Pregled::DolaziPrije(*p1, *p2);
    } );
}

Pregled Pregledi::DajNajranijiPregled() const
{
    if(pregledi.size() == 0){
        throw std::domain_error("Nema registriranih pregleda");
    }
    return **std::min_element(pregledi.begin(), pregledi.end(), [](PokNaPregled p1, PokNaPregled p2){
</font>        return Pregled::DolaziPrije(*p1, *p2);
    } );
}

int Pregledi::DajBrojPregledaNaDatum(const Datum&amp; dat) const
{
    return std::count_if(pregledi.begin(), pregledi.end(), [&amp;dat](PokNaPregled p){
        return dat.Ocitaj() == p-&gt;DajDatumPregleda().Ocitaj();
    });
}

int Pregledi::DajBrojPregleda() const
{
    return pregledi.size();
}

void Pregledi::RegistrirajPregled(const std::string&amp; ime, const Datum&amp; dat, const Vrijeme&amp; vr)
{
<a name="5"></a><font color="#FF0000"><a href="match797-0.html#5" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

    pregledi.emplace_back(new Pregled(ime, dat, vr));
}

void Pregledi::RegistrirajPregled(const std::string&amp; ime, int dat, int mj, int g, int s, int m)
{
    pregledi.emplace_back(new Pregled(ime, {dat, mj, g}, {s, m}));
</font>}

void Pregledi::RegistrirajPregled(PokNaPregled pr)
{
    pregledi.push_back(pr);
}



Pregledi&amp; Pregledi::operator=(const Pregledi&amp; pr)
{
    if(this == &amp;pr)
        return *this;
    
    pregledi.clear();
    pregledi.resize(pr.pregledi.size());
    
    for(int i = 0; i &lt; int(pregledi.size()); ++i){
        pregledi[i] = std::make_shared&lt;Pregled&gt;(*pr.pregledi[i]);
    }
    
    return *this;
    
}

Pregledi&amp; Pregledi::operator=(Pregledi&amp;&amp; pr)
{
    if(this == &amp;pr)
        return *this;
   
    pregledi = std::move(pr.pregledi);
    
    return *this;
}

Pregledi::Pregledi(const Pregledi&amp; pr)
{
   pregledi.resize(pr.pregledi.size());
    
    for(int i = 0; i &lt; int(pregledi.size()); ++i){
        pregledi[i] = std::make_shared&lt;Pregled&gt;(*pr.pregledi[i]);
    }
}

Pregledi::Pregledi(Pregledi&amp;&amp; pr) : pregledi(std::move(pr.pregledi)) {}

Pregledi::Pregledi(std::initializer_list&lt;Pregled&gt; sp)
{
    pregledi.resize(sp.size());
    auto poc = sp.begin();
    for(int i = 0; i &lt; int(sp.size()); ++i){
        pregledi[i] = std::make_shared&lt;Pregled&gt;(*poc);
        ++poc;
    }
}


int main ()
{
    try {
        Pregledi pregledi;
        while(true){
            std::cout &lt;&lt; "Unesite ime novog pacijenta ili 'kraj' za zavrsetak unosa: ";
            std::string ime_pac;
            
<a name="0"></a><font color="#FF0000"><a href="match797-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_3.gif"/></a>

            std::getline(std::cin, ime_pac);
            if(ime_pac == "kraj"){
                break;
            }
            std::cout &lt;&lt; "Unesite dan mjesec i godinu pregleda: ";
            int dan, mjesec, godina;
            std::cin &gt;&gt; dan &gt;&gt; mjesec &gt;&gt; godina;
            std::cout &lt;&lt; "Unesite sate i minute pregleda: ";
            int sati, minute;
            std::cin &gt;&gt; sati &gt;&gt; minute;
            
            pregledi.RegistrirajPregled(ime_pac, dan, mjesec, godina, sati, minute);
            std::cin.ignore(10000, '\n');
        }
        
        std::cout &lt;&lt; "Trenutno su registrovani sljedeci pregledi" &lt;&lt; std::endl;
        
        pregledi.IspisiSvePreglede();
</font>        
        while(true){
            std::cout &lt;&lt; "Odaberite jednu od sljedecih opcija" &lt;&lt; std::endl;
            std::cout &lt;&lt; "1 - Broj pregleda na datum" &lt;&lt; std::endl;
            std::cout &lt;&lt; "2 - Najraniji pregled" &lt;&lt; std::endl;
            std::cout &lt;&lt; "3 - Obrisi pregled pacijenta" &lt;&lt; std::endl;
            std::cout &lt;&lt; "4 - Obrisi najraniji pregled" &lt;&lt; std::endl;
            std::cout &lt;&lt; "5 - Ispisi sve pregleda na datum" &lt;&lt; std::endl;
            std::cout &lt;&lt; "6 - Ispisi sve preglede" &lt;&lt; std::endl;
            std::cout &lt;&lt; "7 - Kraj programa" &lt;&lt; std::endl;
            
            int izbor;
            std::cin &gt;&gt; izbor;
            switch (izbor){
                
            case 1:
                std::cout &lt;&lt; "Unesite dan mjesec i godinu : ";
                int dan, mjesec, godina;
                std::cin &gt;&gt; dan &gt;&gt; mjesec &gt;&gt; godina;
                try {
                    std::cout &lt;&lt; "Broj pregleda na datum " &lt;&lt; dan &lt;&lt; " " &lt;&lt; mjesec &lt;&lt; " " &lt;&lt; godina;
                    std::cout &lt;&lt; " je: " &lt;&lt; pregledi.DajBrojPregledaNaDatum(Datum(dan, mjesec, godina)) &lt;&lt; std::endl;
                } 
                catch (std::domain_error e) {
                    std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
                }
                break;
            
            case 2:
                std::cout &lt;&lt; "Najraniji pregled je:" &lt;&lt; std::endl;
                try {
                    pregledi.DajNajranijiPregled().Ispisi();
                    std::cout  &lt;&lt;  std::endl;
                }
                catch (std::domain_error e) {
                    std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
                }
                break;
            
            case 3:{
                std::cout &lt;&lt; "Unesite ime pacijenta: ";
                std::string ime_pac;
                std::cin.ignore(10000, '\n');
                std::getline(std::cin, ime_pac);
                const int preg_prije = pregledi.DajBrojPregleda();
                pregledi.ObrisiPregledePacijenta(ime_pac);
                std::cout &lt;&lt; "Uspjesno obrisano " &lt;&lt; preg_prije - pregledi.DajBrojPregleda() &lt;&lt; " pregleda" &lt;&lt; std::endl;
                break;
            }
            case 4:
                try {
                    pregledi.ObrisiNajranijiPregled();
                    std::cout &lt;&lt; "Najraniji pregled uspjesno obrisan" &lt;&lt; std::endl;
                }
                catch (std::range_error e) {
                    std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
                }
                break;
                
            case 5:{
                std::cout &lt;&lt; "Unesite dan mjesec i godinu : ";
                int dan, mjesec, godina;
                std::cin &gt;&gt; dan &gt;&gt; mjesec &gt;&gt; godina;
                try {
<a name="9"></a><font color="#FF00FF"><a href="match797-0.html#9" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

                    std::cout &lt;&lt; "Pregledi na datum " &lt;&lt; dan &lt;&lt; " " &lt;&lt; mjesec &lt;&lt; " " &lt;&lt; godina &lt;&lt; " su:" &lt;&lt; std::endl;
                    pregledi.IspisiPregledeNaDatum(Datum(dan, mjesec, godina));
</font>                    std::cout &lt;&lt; std::endl;
                }
                catch (std::domain_error e) {
                    std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
                }
                break;
            }
                
            case 6:
                pregledi.IspisiSvePreglede();
                std::cout &lt;&lt; std::endl;
                break;
            case 7:
                return 0;
            default:
                return 0;
            }
        }
        
    }
    catch (std::bad_alloc ) {
        std::cout &lt;&lt; "Problemi sa memorijom" &lt;&lt; std::endl;
    }
    catch(std::domain_error e){
        std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
    }
    catch(std::range_error e){
        std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
    }
	return 0;
}
</pre>
</body>
</html>
