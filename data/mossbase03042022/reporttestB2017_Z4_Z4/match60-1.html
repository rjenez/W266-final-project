<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z4/student4416.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z4/student1916.cpp<p></p><pre>
<a name="2"></a><font color="#0000FF"><a href="match60-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_2.gif"/></a>

/B2017/2018: ZadaÄ‡a 4, Zadatak 4
#include &lt;iostream&gt;
#include &lt;stdexcept&gt;
#include &lt;tuple&gt;
#include &lt;utility&gt;
#include &lt;iomanip&gt;
#include &lt;initializer_list&gt;
#include &lt;algorithm&gt;
#include &lt;memory&gt;
#include &lt;vector&gt;

//                      Datum

class Datum{
    int dan, mjesec, godina;
    public:
    Datum(int dan, int mjesec, int godina){
        int broj_dana_u_mjesecu[12]={31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30 , 31};
</font>        if((godina%4==0 &amp;&amp; godina%100!=0) || godina%400==0) broj_dana_u_mjesecu[1]++;
<a name="1"></a><font color="#00FF00"><a href="match60-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_23.gif"/></a>

        if(godina&lt;1 || mjesec&lt;1 || mjesec&gt;12 || dan&lt;1 || dan&gt;broj_dana_u_mjesecu[mjesec-1]) throw std::domain_error("Neispravan datum");
        this-&gt;dan=dan; this-&gt;mjesec=mjesec; this-&gt;godina=godina;
    }
    void Postavi(int dan, int mjesec, int godina){
        *this=Datum(dan, mjesec, godina);
    }
    std::tuple&lt;int, int, int&gt; Ocitaj() const { return std::tuple&lt;int, int, int&gt;(dan, mjesec, godina);}
    void Ispisi() const {std::cout &lt;&lt; dan &lt;&lt; "/" &lt;&lt; mjesec &lt;&lt; "/" &lt;&lt; godina;}
};

//                      Vrijeme

class Vrijeme{
    int sati, minute;
    public:
    Vrijeme(int sati, int minute){
        if(sati&lt;0 || sati&gt;23 || minute&lt;0 || minute&gt;59) throw std::domain_error("Neispravno vrijeme");
        this-&gt;sati=sati; this-&gt;minute=minute;
    }
    void Postavi(int sati, int minute){
        *this=Vrijeme(sati, minute);
    }
    std::pair&lt;int, int&gt; Ocitaj() const {return {sati, minute};}
    void Ispisi() const { std::cout &lt;&lt; std::right &lt;&lt; std::setw(2) &lt;&lt; std::setfill('0') &lt;&lt; sati &lt;&lt; ":" &lt;&lt; std::setw(2) &lt;&lt; std::setfill('0') &lt;&lt; minute;}
};

//                      Pregled

class Pregled{
  std::string ime_pacijenta;
  Datum datum_pregleda;
  Vrijeme vrijeme_pregleda;
  public: 
  Pregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda);
  Pregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda);
  void PromijeniPacijenta(const std::string &amp;ime_pacijenta);
  void PromijeniDatum(const Datum &amp;novi_datum);
  void PromijeniVrijeme(const Vrijeme &amp;novo_vrijeme);
  void PomjeriDanUnaprijed();
  void PomjeriDanUnazad();
  std::string DajImePacijenta() const { return ime_pacijenta;}
  Datum DajDatumPregleda() const { return datum_pregleda;}
  Vrijeme DajVrijemePregleda() const { return vrijeme_pregleda;}
  static bool DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2){
      std::tuple&lt;int, int, int&gt; prvi_dat(p1.DajDatumPregleda().Datum::Ocitaj()), drugi_dat(p2.DajDatumPregleda().Datum::Ocitaj());
      std::pair&lt;int, int&gt; prvo_vr(p1.DajVrijemePregleda().Vrijeme::Ocitaj()), drugo_vr(p2.DajVrijemePregleda().Vrijeme::Ocitaj());
      return std::get&lt;2&gt;(prvi_dat)&lt;std::get&lt;2&gt;(drugi_dat) || (std::get&lt;2&gt;(prvi_dat)==std::get&lt;2&gt;(drugi_dat) &amp;&amp; (std::get&lt;1&gt;(prvi_dat)&lt;std::get&lt;1&gt;(drugi_dat) || 
      (std::get&lt;1&gt;(prvi_dat)==std::get&lt;1&gt;(drugi_dat) &amp;&amp; (std::get&lt;0&gt;(prvi_dat)&lt;std::get&lt;0&gt;(drugi_dat) || (std::get&lt;0&gt;(prvi_dat)==std::get&lt;0&gt;(drugi_dat) &amp;&amp; 
      (std::get&lt;1&gt;(prvo_vr)&lt;std::get&lt;1&gt;(drugo_vr) || (std::get&lt;1&gt;(prvo_vr)==std::get&lt;1&gt;(drugo_vr) &amp;&amp; std::get&lt;0&gt;(prvo_vr)&lt;std::get&lt;0&gt;(drugo_vr))))))));
  }
  void Ispisi() const;
};

//                      Pregledi

class Pregledi{
    const int max_broj_pregleda;
    int broj_unesenih;
    std::vector&lt;std::shared_ptr&lt;Pregled&gt;&gt; pregledi;
    public:
    explicit Pregledi() : max_broj_pregleda(0), broj_unesenih(0){}
    Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda);
    ~Pregledi(){
        for(int i(0); i&lt;broj_unesenih; i++) pregledi[i]=nullptr;
        pregledi.resize(0);
    }
    Pregledi(const Pregledi &amp;pregledi);
    Pregledi(Pregledi &amp;&amp;pregledi);
    Pregledi &amp;operator =(const Pregledi &amp;pregledi); 
    Pregledi &amp;operator =(Pregledi &amp;&amp;pregledi);
</font>    void RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda);
    void RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda,
<a name="0"></a><font color="#FF0000"><a href="match60-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_71.gif"/></a>

        int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda);
    void RegistrirajPregled(std::shared_ptr&lt;Pregled&gt; pregled);
    int DajBrojPregleda() const { return broj_unesenih;}
    int DajBrojPregledaNaDatum(const Datum &amp;datum) const;
    Pregled &amp;DajNajranijiPregled();
    Pregled DajNajranijiPregled() const;
    void IsprazniKolekciju();
    void ObrisiNajranijiPregled();
    void ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta);
    void IspisiPregledeNaDatum(const Datum &amp;datum) const;
    void IspisiSvePreglede() const;
};

//                      implementacija Pregled

Pregled::Pregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda) : ime_pacijenta(ime_pacijenta),
    datum_pregleda(datum_pregleda), vrijeme_pregleda(vrijeme_pregleda) {}

Pregled::Pregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda) :
    ime_pacijenta(ime_pacijenta), datum_pregleda(Datum(dan_pregleda, mjesec_pregleda, godina_pregleda)), vrijeme_pregleda(Vrijeme(sati_pregleda, minute_pregleda)) {}

void Pregled::PromijeniPacijenta(const std::string &amp;ime_pacijenta){ this-&gt;ime_pacijenta=ime_pacijenta;}

void Pregled::PromijeniDatum(const Datum &amp;novi_datum){ this-&gt;datum_pregleda=novi_datum;}

void Pregled::PromijeniVrijeme(const Vrijeme &amp;novo_vrijeme){ this-&gt;vrijeme_pregleda=novo_vrijeme;}

void Pregled::PomjeriDanUnaprijed(){
    int dan, mjesec, godina;
    std::tie(dan, mjesec, godina)=datum_pregleda.Ocitaj();
    int broj_dana_u_mjesecu[12]={31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30 , 31};
    if((godina%4==0 &amp;&amp; godina%100!=0) || godina%400==0) broj_dana_u_mjesecu[1]++;
    dan++;
    if(dan&gt;broj_dana_u_mjesecu[mjesec-1]){
        dan=1; mjesec++;
        if(mjesec&gt;12){
            mjesec=1; godina++;
        }
    }
    this-&gt;datum_pregleda=Datum(dan, mjesec, godina);
}

void Pregled::PomjeriDanUnazad(){
    int dan, mjesec, godina;
    std::tie(dan, mjesec, godina)=datum_pregleda.Ocitaj();
    int broj_dana_u_mjesecu[12]={31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30 , 31};
    if((godina%4==0 &amp;&amp; godina%100!=0) || godina%400==0) broj_dana_u_mjesecu[1]++;
    dan--;
    if(dan&lt;1 &amp;&amp; mjesec==1){
        dan=31;
        mjesec=12;
        godina--;
    }
    else if(dan&lt;1 &amp;&amp; mjesec!=1){
        dan=broj_dana_u_mjesecu[mjesec-2];
        mjesec--;
    }
    this-&gt;datum_pregleda=Datum(dan, mjesec, godina);
}

void Pregled::Ispisi() const{
    std::cout &lt;&lt; std::setw(30) &lt;&lt; std::setfill(' ') &lt;&lt; std::left &lt;&lt; ime_pacijenta;
    datum_pregleda.Datum::Ispisi();
    std::cout &lt;&lt; " ";
    vrijeme_pregleda.Vrijeme::Ispisi();
    std::cout &lt;&lt; std::endl;
}

//                      implementacija Pregledi

Pregledi::Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda) : max_broj_pregleda(spisak_pregleda.size()), broj_unesenih(0) {
    try{
        pregledi.resize(spisak_pregleda.size());
        for(auto a: spisak_pregleda){
            pregledi[broj_unesenih]=std::make_shared&lt;Pregled&gt;(a.DajImePacijenta(), a.DajDatumPregleda(), a.DajVrijemePregleda());
            broj_unesenih++;
        }
    } catch(...){
        for(int i(0); i&lt;broj_unesenih; i++) pregledi[i]=nullptr;
        pregledi.resize(0);
    }
}

Pregledi::Pregledi(const Pregledi &amp;pregledi1) : max_broj_pregleda(pregledi1.max_broj_pregleda), broj_unesenih(pregledi1.broj_unesenih),
pregledi(pregledi1.pregledi) {}

Pregledi::Pregledi(Pregledi &amp;&amp;pregledi1) : max_broj_pregleda(pregledi1.max_broj_pregleda), broj_unesenih(pregledi1.broj_unesenih), 
pregledi(pregledi1.pregledi) {}

Pregledi &amp;Pregledi::operator =(const Pregledi &amp;pregledi1){
    if(pregledi1.broj_unesenih&gt;this-&gt;broj_unesenih){
        pregledi.resize(pregledi1.broj_unesenih);
    }
    else{
        for(int i(pregledi1.broj_unesenih); i&lt;this-&gt;broj_unesenih; i++)
            pregledi[i]=nullptr;
        pregledi.resize(pregledi1.broj_unesenih);
    }
    for(int i(0); i&lt;broj_unesenih; i++) pregledi[i]=pregledi1.pregledi[i];
    return *this;
}

Pregledi &amp;Pregledi::operator =(Pregledi &amp;&amp;pregledi1){
    std::swap(broj_unesenih, pregledi1.broj_unesenih);
    std::swap(pregledi, pregledi1.pregledi);
    return *this;
}

void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda){
    pregledi.push_back(std::make_shared&lt;Pregled&gt;(ime_pacijenta, datum_pregleda, vrijeme_pregleda));
    broj_unesenih++;
}

void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda,
int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda){
    pregledi.push_back(std::make_shared&lt;Pregled&gt;(ime_pacijenta, dan_pregleda, mjesec_pregleda, godina_pregleda, sati_pregleda, minute_pregleda));
    broj_unesenih++;
}

void Pregledi::RegistrirajPregled(std::shared_ptr&lt;Pregled&gt; pregled){
    pregledi.push_back(pregled); broj_unesenih++;
}


int Pregledi::DajBrojPregledaNaDatum(const Datum &amp;datum) const {
    return std::count_if(pregledi.begin(), pregledi.end(), [datum](std::shared_ptr&lt;Pregled&gt; a){
        return a-&gt;DajDatumPregleda().Datum::Ocitaj()==datum.Datum::Ocitaj();
    });
}

Pregled &amp;Pregledi::DajNajranijiPregled(){
    if(broj_unesenih==0) throw std::domain_error("Nema registriranih pregleda");
    return **(std::min_element(pregledi.begin(), pregledi.end(), [](std::shared_ptr&lt;Pregled&gt; a, std::shared_ptr&lt;Pregled&gt; b){ return Pregled::DolaziPrije(*a, *b);}));
}

Pregled Pregledi::DajNajranijiPregled() const {
    if(broj_unesenih==0) throw std::domain_error("Nema registriranih pregleda");
    return **(std::min_element(pregledi.begin(), pregledi.end(), [](std::shared_ptr&lt;Pregled&gt; a, std::shared_ptr&lt;Pregled&gt; b){ return Pregled::DolaziPrije(*a, *b);}));
}

void Pregledi::IsprazniKolekciju(){
    for(int i(0); i&lt;broj_unesenih; i++) pregledi[i]=nullptr;
    broj_unesenih=0;
}

void Pregledi::ObrisiNajranijiPregled(){
    if(broj_unesenih==0) throw std::range_error("Prazna kolekcija");
    Pregled pom=Pregledi::DajNajranijiPregled();
    for(auto x(pregledi.begin()); x!=pregledi.end(); x++){
        if((*x)-&gt;DajImePacijenta()==pom.DajImePacijenta() &amp;&amp; (*x)-&gt;DajDatumPregleda().Ocitaj()==pom.DajDatumPregleda().Ocitaj() &amp;&amp;
        (*x)-&gt;DajVrijemePregleda().Ocitaj()==pom.DajVrijemePregleda().Ocitaj()){
            *x=nullptr;
            x=pregledi.erase(x);
            pregledi[--broj_unesenih]=nullptr;
            pregledi.resize(broj_unesenih);
            break;
        }   
    }
}

void Pregledi::ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta){
    if(broj_unesenih==0) return;
    for(auto x(pregledi.begin()); x!=pregledi.end();){
        if((*x)-&gt;DajImePacijenta()==ime_pacijenta){
            *x=nullptr;
            x=pregledi.erase(x);
            pregledi[--broj_unesenih]=nullptr;
            continue;
        }
        x++;
    }
}

void Pregledi::IspisiPregledeNaDatum(const Datum &amp;datum) const{
    if(Pregledi::DajBrojPregledaNaDatum(datum)==0) return;
    try{
        std::vector&lt;std::shared_ptr&lt;Pregled&gt;&gt; pom;
        std::for_each(pregledi.begin(), pregledi.end(), [&amp;pom, datum](std::shared_ptr&lt;Pregled&gt; a){
           if(datum.Datum::Ocitaj()==a-&gt;DajDatumPregleda().Datum::Ocitaj()) pom.push_back(a);
        });
        std::sort(pom.begin(), pom.end(), [](std::shared_ptr&lt;Pregled&gt; a, std::shared_ptr&lt;Pregled&gt; b){ return Pregled::DolaziPrije(*a, *b);});
        std::for_each(pom.begin(), pom.end(), [](std::shared_ptr&lt;Pregled&gt; a){ a-&gt;Ispisi();});
        for(auto x: pom) x=nullptr;
        pom.resize(0);
    }
    catch(...){
        throw;
    }
}

void Pregledi::IspisiSvePreglede() const {
    if(broj_unesenih==0) return;
    try{
        std::vector&lt;std::shared_ptr&lt;Pregled&gt;&gt; pom;
        std::for_each(pregledi.begin(), pregledi.end(), [&amp;pom](std::shared_ptr&lt;Pregled&gt; a){ pom.push_back(a);});
        std::sort(pom.begin(), pom.end(), [](std::shared_ptr&lt;Pregled&gt; a, std::shared_ptr&lt;Pregled&gt; b){ return Pregled::DolaziPrije(*a, *b);});
        std::for_each(pom.begin(), pom.end(), [](std::shared_ptr&lt;Pregled&gt; a){ a-&gt;Ispisi();});
        for(auto x: pom) x=nullptr;
        pom.resize(0);
    }
    catch(...){
        throw;
    }
}

//              pomocne za main

void IspisiPoruku(){
    std::cout &lt;&lt; "\nOdaberite jednu od sljedecih opcija\n1 - Broj pregleda na datum\n2 - Najraniji pregled\n3 - Obrisi pregled pacijenta\n" &lt;&lt;
    "4 - Obrisi najraniji pregled\n5 - Ispisi sve pregleda na datum\n6 - Ispisi sve preglede\n7 - Kraj programa\n";
}

int main ()
{
    try{
        Pregledi raspored;
        for(;;){
            std::cout &lt;&lt; "Unesite ime novog pacijenta ili 'kraj' za zavrsetak unosa: ";
            std::string ime;
            std::getline(std::cin, ime);
            if(ime=="kraj") break;
            std::cout &lt;&lt; "Unesite dan mjesec i godinu pregleda: ";
            int dan, mjesec, godina;
            std::cin &gt;&gt; dan &gt;&gt; mjesec &gt;&gt; godina;
            std::cout &lt;&lt; "Unesite sate i minute pregleda: ";
            int sat, minuta;
            std::cin &gt;&gt; sat &gt;&gt; minuta;
            raspored.RegistrirajPregled(ime, dan, mjesec, godina, sat, minuta);
            std::cin.ignore(20, '\n');
        }
        std::cout &lt;&lt; "Trenutno su registrovani sljedeci pregledi" &lt;&lt; std::endl;
        raspored.IspisiSvePreglede();
        while(true){
            IspisiPoruku();
            int br;
            std::cin &gt;&gt; br;
            if(br==7) break;
            else if(br==1){
                std::cout &lt;&lt; "Unesite dan mjesec i godinu : ";
                int dan, mjesec, godina;
                std::cin &gt;&gt; dan &gt;&gt; mjesec &gt;&gt; godina;
                try{
                    int a=raspored.DajBrojPregledaNaDatum(Datum(dan, mjesec, godina));
                    std::cout &lt;&lt; "Broj pregleda na datum " &lt;&lt; dan &lt;&lt; " " &lt;&lt; mjesec &lt;&lt; " " &lt;&lt;  godina &lt;&lt; " je: " &lt;&lt; a &lt;&lt; std::endl;;
                }
                catch(std::domain_error p){
                    std::cout &lt;&lt; p.what() &lt;&lt; std::endl;
                }
            }
            else if(br==2){
                std::cout &lt;&lt; "Najraniji pregled je:\n";
                try{
                    raspored.DajNajranijiPregled().Pregled::Ispisi();
                }catch(std::domain_error p){
                    std::cout &lt;&lt; p.what() &lt;&lt; std::endl;
                }
            }
            else if(br==3){
                std::cout &lt;&lt; "Unesite ime pacijenta: ";
                std::cin.ignore(1000, '\n');
                std::string a;
                std::getline(std::cin, a);
                int brojp(raspored.DajBrojPregleda());
                raspored.ObrisiPregledePacijenta(a);
                std::cout &lt;&lt; "Uspjesno obrisano " &lt;&lt; brojp-raspored.DajBrojPregleda() &lt;&lt; " pregleda\n";
            }
            else if(br==4){
                try{
                    raspored.ObrisiNajranijiPregled();
                    std::cout &lt;&lt; "Najraniji pregled uspjesno obrisan\n";
                }
                catch(std::domain_error p){
                    std::cout &lt;&lt; p.what() &lt;&lt; std::endl;
                }
            }
            else if(br==5){
                std::cout &lt;&lt; "Unesite dan mjesec i godinu : ";
                int dan, mjesec, godina;
                std::cin &gt;&gt; dan &gt;&gt; mjesec &gt;&gt; godina;
                try{
                    Datum a(dan, mjesec, godina);
                    std::cout &lt;&lt; "Pregledi na datum " &lt;&lt; dan &lt;&lt; " " &lt;&lt; mjesec &lt;&lt; " " &lt;&lt;  godina &lt;&lt; " su:\n";
                    raspored.IspisiPregledeNaDatum(a);
                }
                catch(std::domain_error p){
                    std::cout &lt;&lt; p.what() &lt;&lt; std::endl;
                }
            }
            else if(br==6){
                raspored.IspisiSvePreglede();
            }
        }
    }catch(std::bad_alloc){
        std::cout &lt;&lt; "Problemi sa momorijom";
    }catch(std::domain_error p){
        std::cout &lt;&lt; p.what();
    }catch(std::logic_error p){
        std::cout &lt;&lt; p.what();
    }catch(std::range_error p){
        std::cout &lt;&lt; p.what();
</font>    }
	return 0;
}
</pre>
</body>
</html>
