<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z4/student1597.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z4/student1415.cpp<p></p><pre>
/B2017/2018: Zadaća 4, Zadatak 4
/B2017/2018: Zadaća 4, Zadatak 3
#include &lt;iostream&gt;
#include &lt;tuple&gt;
#include &lt;stdexcept&gt;
#include &lt;utility&gt;
#include &lt;iomanip&gt;
#include &lt;string&gt;
#include &lt;initializer_list&gt;
#include &lt;algorithm&gt;
#include &lt;cstring&gt;
#include &lt;vector&gt;
#include &lt;memory&gt;

class Datum
{
    int dan, mjesec, godina;
    bool Ispravi(int &amp;dan, int &amp;mjesec, int &amp;godina);


public:
<a name="3"></a><font color="#00FFFF"><a href="match445-0.html#3" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

    Datum (int dan, int mjesec, int godina) {
        Postavi(dan, mjesec, godina);
    }
    void Postavi (int dan, int mjesec, int godina);

    std::tuple&lt;int, int, int&gt; Ocitaj() const {
        return std::make_tuple(dan,mjesec,godina);
    }
    void Ispisi() const {
</font>        std::cout &lt;&lt; dan &lt;&lt; "/" &lt;&lt; mjesec &lt;&lt; "/" &lt;&lt; godina;
    }

};

class Vrijeme
{
    int sati, minute;
public:
    Vrijeme (int sati, int minute) {
        Postavi(sati, minute);
    }
    void Postavi(int sati, int minute) {
        if(sati &lt; 0 || sati &gt; 23 || minute &lt; 0 || minute &gt; 59) throw std::domain_error("Neispravno vrijeme");
        Vrijeme::sati = sati;
        Vrijeme::minute = minute;
    }
    std::pair&lt;int, int&gt; Ocitaj() const {
        return std::make_pair(sati, minute);
    }
    void Ispisi() const {
        std::cout &lt;&lt; std::setfill('0') &lt;&lt; std::setw(2) &lt;&lt; std::right &lt;&lt; sati &lt;&lt; ":"
                  &lt;&lt; std::setw(2) &lt;&lt; std::right &lt;&lt; minute &lt;&lt; std::setfill(' ');
    }

};

class Pregled
{
    std::string ime_pacijenta;
    Datum datum_pregleda;
    Vrijeme vrijeme_pregleda;

    bool Ispravi(int &amp;dan, int &amp;mjesec, int &amp;godina);

public:
    Pregled (const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda): datum_pregleda (datum_pregleda),
        vrijeme_pregleda (vrijeme_pregleda),ime_pacijenta(ime_pacijenta) {
    }

    Pregled (const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda):
        datum_pregleda(dan_pregleda, mjesec_pregleda, godina_pregleda), vrijeme_pregleda(sati_pregleda, minute_pregleda), ime_pacijenta(ime_pacijenta) {
    }

<a name="1"></a><font color="#00FF00"><a href="match445-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_2.gif"/></a>

    void PromijeniPacijenta (const std::string &amp;ime_pacijenta) {
        Pregled::ime_pacijenta = ime_pacijenta;
    }

    void PromijeniDatum (const Datum &amp;novi_datum) {
        Pregled::datum_pregleda = novi_datum;
    }
    void PromijeniVrijeme (const Vrijeme &amp;novo_vrijeme) {
        Pregled::vrijeme_pregleda = novo_vrijeme;
    }

    void PomjeriDanUnaprijed();
    void PomjeriDanUnazad();

    std::string DajImePacijenta() const {
        return ime_pacijenta;
    }
    Datum DajDatumPregleda () const {
        return datum_pregleda;
    }
    Vrijeme DajVrijemePregleda() const {
        return vrijeme_pregleda;
    }

    static bool DolaziPrije (const Pregled &amp;p1, const Pregled &amp;p2);
</font>    void Ispisi() const {
        std::cout &lt;&lt; std::left &lt;&lt; std::setw(30) &lt;&lt; DajImePacijenta();
        DajDatumPregleda().Ispisi();
        std::cout &lt;&lt; " ";
        DajVrijemePregleda().Ispisi();
        std::cout &lt;&lt; std::endl;
    }
};

class Pregledi
{
    std::vector&lt;std::shared_ptr&lt;Pregled&gt;&gt; pregledi;

    void Obrisi(std::shared_ptr&lt;Pregled&gt; za_brisanje);

public:

    explicit Pregledi() = default;
    Pregledi (std::initializer_list&lt;Pregled&gt; spisak_pregleda);
<a name="0"></a><font color="#FF0000"><a href="match445-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_4.gif"/></a>

    Pregledi (const Pregledi &amp;pregledi);
    Pregledi (Pregledi &amp;&amp;pregledi) = default;
    Pregledi &amp;operator= (const Pregledi &amp;pregledi);
    Pregledi &amp;operator= (Pregledi &amp;&amp; pregledi) = default;

    void RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda);
    void RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda,
                            int sati_pregleda, int minute_pregleda);
    void RegistrirajPregled(std::shared_ptr&lt;Pregled&gt; pregledi);

    int DajBrojPregleda() const {
        return pregledi.size();
    }
    int DajBrojPregledaNaDatum(const Datum &amp;datum) const;
    Pregled &amp;DajNajranijiPregled();
    Pregled DajNajranijiPregled() const;

    void IsprazniKolekciju();
    void ObrisiNajranijiPregled();
    void ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta);

    void IspisiPregledeNaDatum(const Datum &amp;datum) const;
    void IspisiSvePreglede() const;
};


void Datum::Postavi (int dan, int mjesec, int godina)
</font>{
    if(Ispravi(dan, mjesec, godina)) throw std::domain_error("Neispravan datum");

    Datum::dan = dan;
    Datum::mjesec = mjesec;
    Datum::godina = godina;
}

void Pregled::PomjeriDanUnaprijed()
{

    auto info (datum_pregleda.Ocitaj());
    int  dan_pregleda = std::get&lt;0&gt; (info);
    int mjesec_pregleda = std::get&lt;1&gt; (info);
    int godina_pregleda =std::get&lt;2&gt; (info);

    if(Ispravi(++dan_pregleda, mjesec_pregleda, godina_pregleda)) {
        dan_pregleda = 1;
        if(Ispravi(dan_pregleda, ++mjesec_pregleda, godina_pregleda)) {
            mjesec_pregleda = 1;
            Ispravi(dan_pregleda, mjesec_pregleda, ++godina_pregleda);
        }
    }

}

void Pregled::PomjeriDanUnazad()
{
    auto info (datum_pregleda.Ocitaj());
    int  dan_pregleda = std::get&lt;0&gt; (info);
    int mjesec_pregleda = std::get&lt;1&gt; (info);
    int godina_pregleda =std::get&lt;2&gt; (info);

    if(Ispravi(--dan_pregleda, mjesec_pregleda, godina_pregleda)) {
        dan_pregleda = 31;
        if(mjesec_pregleda &gt; 1) {
            mjesec_pregleda--;
            while (Ispravi(dan_pregleda, mjesec_pregleda, godina_pregleda)) dan_pregleda--;
        } else {
            mjesec_pregleda = 12;
            godina_pregleda--;
        }
        while (Ispravi(dan_pregleda, mjesec_pregleda, godina_pregleda)) dan_pregleda--;


    }
    Pregled::datum_pregleda.Postavi(dan_pregleda, mjesec_pregleda, godina_pregleda);

}
bool Pregled::Ispravi(int &amp;dan, int &amp;mjesec, int &amp;godina)
{
    int broj_dana[12] {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    if((godina % 4 == 0 &amp;&amp; godina % 100 != 0) || godina % 400 == 0) broj_dana[1]++;
    return (godina &lt; 1 || dan &lt; 1 || mjesec &lt; 1 || mjesec &gt; 12 || dan &gt; broj_dana[mjesec - 1]);

}
bool Datum::Ispravi(int &amp;dan, int &amp;mjesec, int &amp;godina)
{
    int broj_dana[12] {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    if((godina % 4 == 0 &amp;&amp; godina % 100 != 0) || godina % 400 == 0) broj_dana[1]++;
    return (godina &lt; 1 || dan &lt; 1 || mjesec &lt; 1 || mjesec &gt; 12 || dan &gt; broj_dana[mjesec - 1]);

}

bool Pregled::DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2)
{

    auto prvi(p1.DajDatumPregleda().Ocitaj());
    auto drugi(p2.DajDatumPregleda().Ocitaj());
    auto vrijeme1(p1.DajVrijemePregleda().Ocitaj());
    auto vrijeme2(p2.DajVrijemePregleda().Ocitaj());

    std::tuple&lt;int, int, int, int, int&gt;  ukupno1 = std::make_tuple(std::get&lt;2&gt;(prvi), std::get&lt;1&gt;(prvi),
            std::get&lt;0&gt;(prvi), std::get&lt;0&gt;(vrijeme1), std::get&lt;1&gt;(vrijeme1));

    std::tuple&lt;int, int, int, int, int&gt;  ukupno2 = std::make_tuple(std::get&lt;2&gt;(drugi),
            std::get&lt;1&gt;(drugi), std::get&lt;0&gt;(drugi),
            std::get&lt;0&gt;(vrijeme2), std::get&lt;1&gt;(vrijeme2));

    return ukupno1 &lt; ukupno2;
}

void Pregledi::Obrisi(std::shared_ptr&lt;Pregled&gt; za_brisanje)
{

    pregledi.erase(std::remove_if(pregledi.begin(), pregledi.end(),[za_brisanje](std::shared_ptr&lt;Pregled&gt; pok) {
        return pok == za_brisanje;
    }));

}

Pregledi::Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda): pregledi(spisak_pregleda.size())
{
    auto it = spisak_pregleda.begin();
    try {
        for(int i = 0; i &lt; spisak_pregleda.size(); i++) {
            pregledi[i] = std::make_shared&lt;Pregled&gt;(*it);
            it++;
        }
    } catch(...) {
        for(int i = 0; i &lt; spisak_pregleda.size(); i++) pregledi[i] = nullptr;
    }

}

Pregledi::Pregledi (const Pregledi &amp;p): pregledi(p.pregledi.size())
{
    for(int i = 0; i &lt; p.pregledi.size(); i++) pregledi[i] = std::make_shared&lt;Pregled&gt;(*p.pregledi[i]);
}

Pregledi &amp;Pregledi:: operator = (const Pregledi &amp;p)
{
    pregledi.resize(p.pregledi.size());
    for(int i = 0; i &lt; p.pregledi.size(); i++)
        pregledi[i] = std::make_shared&lt;Pregled&gt;(*p.pregledi[i]);
<a name="6"></a><font color="#00FF00"><a href="match445-0.html#6" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

    return *this;
}


void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda)
{
    pregledi.push_back(std::make_shared&lt;Pregled&gt;(Pregled(ime_pacijenta, datum_pregleda, vrijeme_pregleda )));
</font><a name="5"></a><font color="#FF0000"><a href="match445-0.html#5" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

}

void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda,
                                  int sati_pregleda, int minute_pregleda)
{
    pregledi.push_back(std::make_shared&lt;Pregled&gt;(Pregled(ime_pacijenta, dan_pregleda, mjesec_pregleda, godina_pregleda,
</font><a name="2"></a><font color="#0000FF"><a href="match445-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_2.gif"/></a>

                       sati_pregleda, minute_pregleda)));
}

void Pregledi::RegistrirajPregled (std::shared_ptr&lt;Pregled&gt; pregled)
{

    pregledi.push_back(pregled);
}

int Pregledi::DajBrojPregledaNaDatum (const Datum &amp;datum) const
{
    return std::count_if(pregledi.begin(), pregledi.end(), [datum](std::shared_ptr&lt;Pregled&gt; pok) {
</font>        auto prva(datum.Ocitaj());
        auto druga(pok-&gt;DajDatumPregleda().Ocitaj());
        return prva == druga;
    });
}

<a name="7"></a><font color="#0000FF"><a href="match445-0.html#7" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

Pregled &amp;Pregledi::DajNajranijiPregled()
{
    if(pregledi.size() == 0) throw std::domain_error("Nema registriranih pregleda");
    return **std::min_element(pregledi.begin(), pregledi.end(), [](std::shared_ptr&lt;Pregled&gt; p1,
</font>    std::shared_ptr&lt;Pregled&gt; p2) {
<a name="4"></a><font color="#FF00FF"><a href="match445-0.html#4" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

        return p1-&gt;DolaziPrije(*p1, *p2);
    });
}
Pregled Pregledi::DajNajranijiPregled() const
{
    if(pregledi.size() == 0) throw std::domain_error("Nema registriranih pregleda");
    return **std::min_element(pregledi.begin(), pregledi.end(), [](std::shared_ptr&lt;Pregled&gt; p1,
</font>    std::shared_ptr&lt;Pregled&gt; p2) {
        return p1-&gt;DolaziPrije(*p1, *p2);
    });
}

void Pregledi::IsprazniKolekciju()

{
    if(pregledi.size() == 0) throw std::range_error("Prazna kolekcija");
    for(int i = 0; i &lt; pregledi.size(); i++) pregledi[i] = nullptr;
}

void Pregledi::ObrisiNajranijiPregled()
{
    if(pregledi.size() == 0) throw std::range_error("Prazna kolekcija");
    auto za_brisanje = std::find_if(pregledi.begin(), pregledi.end(), [this] (std::shared_ptr&lt;Pregled&gt; pok) {
        return pok.get() == &amp;DajNajranijiPregled();
    });
    Obrisi(*za_brisanje);
}

void Pregledi::ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta)
{
    for(;;) {
        auto za_brisanje (std::find_if(pregledi.begin(), pregledi.end(), [ime_pacijenta] (std::shared_ptr&lt;Pregled&gt;pok) {
            return pok -&gt; DajImePacijenta() == ime_pacijenta;
        }));
        if(za_brisanje == pregledi.end()) break;
        Obrisi(*za_brisanje);
    }
}

void Pregledi::IspisiPregledeNaDatum(const Datum &amp;datum) const
{
    std::vector&lt;std::shared_ptr&lt;Pregled&gt;&gt; za_sortiranje(pregledi.size());
    std::copy(pregledi.begin(), pregledi.end(), za_sortiranje.begin());
    std::sort(za_sortiranje.begin(), za_sortiranje.end(), [](std::shared_ptr&lt;Pregled&gt; pok1, std::shared_ptr&lt;Pregled&gt; pok2) {
        return pok1-&gt;DolaziPrije (*pok1, *pok2);
    });

    std::for_each(za_sortiranje.begin(), za_sortiranje.end(), [datum](std::shared_ptr&lt;Pregled&gt; pok) {
        auto pomocni1(datum.Ocitaj());
        auto pomocni2(pok-&gt;DajDatumPregleda().Ocitaj());
        if(pomocni1 == pomocni2) pok-&gt;Ispisi();
    });

}

void Pregledi::IspisiSvePreglede() const
{
    std::vector&lt;std::shared_ptr&lt;Pregled&gt;&gt; za_sortiranje(pregledi.size());
    std::copy(pregledi.begin(), pregledi.end(), za_sortiranje.begin());
    std::sort(za_sortiranje.begin(), za_sortiranje.end(), [](std::shared_ptr&lt;Pregled&gt; pok1, std::shared_ptr&lt;Pregled&gt; pok2) {
        return pok1-&gt;DolaziPrije(*pok1, *pok2);
    });

    std::for_each(za_sortiranje.begin(), za_sortiranje.end(), [](std::shared_ptr&lt;Pregled&gt; pok) {
        pok-&gt;Ispisi();
    });
}
int main ()
{
    Pregledi danasnji;
    for(;;) {

        std::cout &lt;&lt; "Unesite ime novog pacijenta ili 'kraj' za zavrsetak unosa: ";

        std::string temp;
        std::getline(std::cin, temp);
        if(temp == "kraj") break;

        std::cout &lt;&lt; "Unesite dan mjesec i godinu pregleda: ";
        int dan, mjesec, godina;
        std::cin &gt;&gt; dan &gt;&gt; mjesec &gt;&gt; godina;

        std::cout &lt;&lt; "Unesite sate i minute pregleda: ";
        int sati, minute;
        std::cin  &gt;&gt; sati &gt;&gt; minute;

        danasnji.RegistrirajPregled(temp, dan, mjesec, godina, sati, minute);
        std::cin.ignore(10000, '\n');
    }

    std::cout &lt;&lt; "Trenutno su registrovani sljedeci pregledi" &lt;&lt; std::endl;
    danasnji.IspisiSvePreglede();

    for(;;) {

<a name="8"></a><font color="#00FFFF"><a href="match445-0.html#8" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

        std::cout &lt;&lt; std::endl;
        std::cout &lt;&lt; "Odaberite jednu od sljedecih opcija" &lt;&lt; std::endl;
        std::cout &lt;&lt; "1 - Broj pregleda na datum" &lt;&lt; std::endl;
</font>        std::cout &lt;&lt; "2 - Najraniji pregled" &lt;&lt; std::endl;
        std::cout &lt;&lt; "3 - Obrisi pregled pacijenta" &lt;&lt; std::endl;
        std::cout &lt;&lt; "4 - Obrisi najraniji pregled" &lt;&lt; std::endl;
        std::cout &lt;&lt; "5 - Ispisi sve pregleda na datum" &lt;&lt; std::endl;
        std::cout &lt;&lt; "6 - Ispisi sve preglede" &lt;&lt; std::endl;
        std::cout &lt;&lt; "7 - Kraj programa" &lt;&lt; std::endl;

        int x;
        std::cin &gt;&gt; x;
        std::string pomocni;
        int dan, mjesec, godina;
        int prije;

        switch(x) {
        case 1:
            std::cout &lt;&lt; "Unesite dan mjesec i godinu : ";

            std::cin &gt;&gt; dan &gt;&gt; mjesec &gt;&gt; godina;
            std::cout &lt;&lt; "Broj pregleda na datum " &lt;&lt; dan &lt;&lt; " " &lt;&lt; mjesec &lt;&lt; " " &lt;&lt; godina &lt;&lt; " je: "&lt;&lt;
                      danasnji.DajBrojPregledaNaDatum(Datum(dan,mjesec,godina)) &lt;&lt; std::endl;
            continue;
        case 2:
            std::cout &lt;&lt;"Najraniji pregled je: " &lt;&lt; std::endl;
            danasnji.DajNajranijiPregled().Ispisi();
            continue;
        case 3:
            std::cin &gt;&gt; std::ws;
            std::cout &lt;&lt; "Unesite ime pacijenta: ";

            std::getline(std::cin, pomocni);

            prije = danasnji.DajBrojPregleda();
            danasnji.ObrisiPregledePacijenta(pomocni);
            std::cout &lt;&lt; "Uspjesno obrisano " &lt;&lt; prije - danasnji.DajBrojPregleda() &lt;&lt; " pregleda" &lt;&lt; std::endl;
            continue;
        case 4:
            danasnji.ObrisiNajranijiPregled();
            std::cout &lt;&lt; "Najraniji pregled uspjesno obrisan" &lt;&lt; std::endl;
            continue;
        case 5:
            std::cout &lt;&lt; "Unesite dan mjesec i godinu : ";

            std::cin &gt;&gt; dan&gt;&gt; mjesec &gt;&gt; godina;

<a name="9"></a><font color="#FF00FF"><a href="match445-0.html#9" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

            std::cout  &lt;&lt; "Pregledi na datum "&lt;&lt; dan &lt;&lt; " " &lt;&lt; mjesec &lt;&lt; " " &lt;&lt; godina &lt;&lt;" su:" &lt;&lt; std::endl;
            danasnji.IspisiPregledeNaDatum(Datum(dan, mjesec, godina));
</font>            continue;
        case 6:
            danasnji.IspisiSvePreglede();
            continue;
        case 7:
            return 0;
        }
        std::cin.clear();
        std::cin.ignore(10000, '\n');

    }

    return 0;
}</pre>
</body>
</html>
