<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z4/student3136.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z4/student1202.cpp<p></p><pre>
#include &lt;iostream&gt;
#include &lt;tuple&gt;
#include &lt;utility&gt;
#include &lt;stdexcept&gt;
#include &lt;initializer_list&gt;
#include &lt;iomanip&gt;
#include &lt;algorithm&gt;
#include &lt;vector&gt;
#include &lt;memory&gt;
<a name="2"></a><font color="#0000FF"><a href="match45-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_4.gif"/></a>

using std::get;
using std::vector;
using std::string;
using std::cin;
using std::cout;
class Datum
{
    int Dan,Mjesec,Godina;
    static int BrojDana(int mjesec, int godina) {
        int broj_dana[] {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
        if(godina % 4 == 0 &amp;&amp; godina % 100 != 0 || godina % 400 == 0)
            broj_dana[1]++;
        return broj_dana[mjesec - 1];
    }
public:
    Datum(int dan,int mjesec,int godina) {
        Postavi(dan,mjesec,godina);
    }
    void Postavi(int dan,int mjesec,int godina) {
        int broj_dana[12] {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
</font>        if(godina % 4 == 0 &amp;&amp; godina % 100 != 0 || godina % 400 == 0) broj_dana[1]++;
<a name="1"></a><font color="#00FF00"><a href="match45-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_39.gif"/></a>

        if(godina &lt; 1 || dan &lt; 1 || mjesec &lt; 1 || mjesec &gt; 12 || dan &gt; broj_dana[mjesec - 1])
            throw std::domain_error("Neispravan datum!");
        Dan=dan;
        Mjesec=mjesec;
        Godina=godina;
    }
    std::tuple&lt;int, int, int&gt; Ocitaj() const {
        auto t(std::make_tuple(Dan,Mjesec,Godina));
        return t;
    }
    void Ispisi() const {
        // if(Dan&lt;10) std::cout&lt;&lt;"0"&lt;&lt;Dan&lt;&lt;"/";
        std::cout&lt;&lt;Dan&lt;&lt;"/";
        std::cout&lt;&lt;Mjesec&lt;&lt;"/"&lt;&lt;Godina;
    }
};
class Vrijeme
{
    int Sati,Minute;
public:
    Vrijeme(int sati,int minute) {
        Postavi(sati,minute);
    }
    void Postavi(int sati,int minute) {
        if(sati&lt;0 || sati &gt;23 || minute&lt;0 || minute&gt;59) throw std::domain_error("Neispravno vrijeme");
        Sati=sati;
        Minute=minute;
    }
    std::pair&lt;int, int&gt; Ocitaj () const {
        auto par(std::make_pair(Sati,Minute));
        return par;
    }
    void Ispisi() const {
        if(Sati&lt;10) std::cout&lt;&lt;"0"&lt;&lt;Sati&lt;&lt;":";
        else std::cout&lt;&lt;Sati&lt;&lt;":";
        if(Minute&lt;10)
            std::cout&lt;&lt;"0"&lt;&lt;Minute;
        else std::cout&lt;&lt;Minute;
    }
};

class Pregled
{
    string ime;
    Datum dat;
    Vrijeme vr;
    int dan,mjesec,godina,sat,min;
    static int BrojDana(int mjesec, int godina) {
        int broj_dana[] {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
        if(godina % 4 == 0 &amp;&amp; godina % 100 != 0 || godina % 400 == 0)
            broj_dana[1]++;
        return broj_dana[mjesec - 1];
    }
public:
    Pregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda,const Vrijeme &amp;vrijeme_pregleda):
        dat(get&lt;0&gt;(datum_pregleda.Ocitaj()),get&lt;1&gt;(datum_pregleda.Ocitaj()),get&lt;2&gt;(datum_pregleda.Ocitaj())),
        vr(vrijeme_pregleda.Ocitaj().first,vrijeme_pregleda.Ocitaj().second),ime(ime_pacijenta) {

        dan=get&lt;0&gt;(datum_pregleda.Ocitaj());
        mjesec=get&lt;1&gt;(datum_pregleda.Datum::Ocitaj());
        godina=get&lt;2&gt;(datum_pregleda.Datum::Ocitaj());
        sat=vrijeme_pregleda.Vrijeme::Ocitaj().first;
        min=vrijeme_pregleda.Vrijeme::Ocitaj().second;
    }



    Pregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda,int godina_pregleda, int sati_pregleda, int minute_pregleda): ime(ime_pacijenta),dan(dan_pregleda),
        mjesec(mjesec_pregleda),godina(godina_pregleda), sat(sati_pregleda),min(minute_pregleda), dat(dan,mjesec,godina),
        vr(sat,min) {}
    void PromijeniPacijenta(const std::string &amp;ime_pacijenta) {
        ime=ime_pacijenta;
    }
    void PromijeniDatum(const Datum &amp;novi_datum) {
        //dat=novi_datum;
        //da li je ok..
        //OBRATITI PAZNJU
        dat.Datum::Postavi(get&lt;0&gt;(novi_datum.Ocitaj()),get&lt;1&gt;(novi_datum.Ocitaj()),get&lt;2&gt;(novi_datum.Ocitaj()));

    }
    void PromijeniVrijeme(const Vrijeme &amp;novo_vrijeme) {
        //vr=novo_vrijeme;
        vr.Vrijeme::Postavi(novo_vrijeme.Ocitaj().first,novo_vrijeme.Ocitaj().second);
    }
    void PomjeriDanUnaprijed() {
        dan++;
        if(dan &gt;BrojDana(mjesec, godina)) dan = 1, mjesec++;
        if(mjesec &gt; 12) mjesec = 1, godina++;
    }
    void PomjeriDanUnazad() {
        dan--; //da li treba --mj ili mj--
        if(dan&lt;1) {
            --mjesec;
            dan=BrojDana(mjesec,godina);
        }
        if(mjesec&lt;1) {
            mjesec=12;
            godina--;
        }
    }
    std::string DajImePacijenta() const {
        return ime;
    }
    Datum DajDatumPregleda() const {
        return dat;
    }
    Vrijeme DajVrijemePregleda() const {
        return vr;
    }
    static bool DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2) {
        //ako je prvi prije drugog true
        if(p1.godina==p2.godina) {
            if(p1.mjesec==p2.mjesec) {
                if(p1.dan==p2.dan) {
                    if(p1.sat==p2.sat) {
                        return p1.min&lt;p2.min;
                    } else if(p1.sat&lt;p2.sat) return true;
                    else return false;

                } else if(p1.dan&lt;p2.dan) return true;
                else return false;
            } else if(p1.mjesec&lt;p2.mjesec) return true;
            else return false;
        } else if(p1.godina&lt;p2.godina) return true;
        else return false;
    }

    void Ispisi() const {
        std::cout&lt;&lt;std::setw(30)&lt;&lt;std::left&lt;&lt;ime;
        dat.Datum::Ispisi();
        std::cout&lt;&lt;" ";
        vr.Vrijeme::Ispisi();
        std::cout&lt;&lt;std::endl;
    }
};
class Pregledi
{
    std::vector&lt;std::shared_ptr&lt;Pregled&gt;&gt; pregledii;
public:
    explicit Pregledi(){}
    Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda){
        for(auto it(spisak_pregleda.begin()); it!=spisak_pregleda.end(); it++) {
            pregledii.push_back(std::make_shared&lt;Pregled&gt;(*it));
        }
        // Brojac++;
    }
    ~Pregledi() {for(int i(0);i&lt;pregledii.size();i++) pregledii[i]=nullptr;}

    Pregledi(const Pregledi &amp;pregledi) {
        try {
            for(int i(0); i&lt;pregledii.size(); i++)
                if(pregledii[i] != nullptr)
                    pregledii.push_back(std::make_shared&lt;Pregled&gt;(*pregledi.pregledii[i]));
            //  Brojac++;

        } catch(...) {
            for(int i(0); i&lt;pregledii.size(); i++)  pregledii[i]=nullptr;
            
            throw;
        }
    }
    Pregledi(Pregledi &amp;&amp;pregledi):pregledii(pregledi.pregledii) {
       pregledi.pregledii.resize(0);
    }
    Pregledi &amp;operator =(const Pregledi &amp;pregledi) {
        if(pregledi.pregledii.size()&gt;pregledii.size()) {
            int pocetna(pregledii.size());
            try {
                for(int i=pregledii.size(); i&lt;pregledi.pregledii.size(); i++)
pregledii.push_back(std::make_shared&lt;Pregled&gt;(*pregledi.pregledii[i]));

            } catch(...) {
                pregledii.resize(pocetna);
                throw;
            }

        } else {
            pregledii.resize(pregledi.pregledii.size());
        }
        for(int i(0); i&lt;pregledii.size(); i++) {
            pregledii[i]=nullptr;
            pregledii[i]=std::make_shared&lt;Pregled&gt;(*pregledi.pregledii[i]);
        }
 return *this;
    }

    Pregledi &amp;operator =(Pregledi &amp;&amp;pregledi) {
        std::swap(pregledii,pregledi.pregledii);
       // std::swap(broj,pregledi.broj);
        pregledi.pregledii.resize(0);
        return *this;
    }
    void RegistrirajPregled(const std::string &amp;ime_pacijenta,const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda);
    void RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda,int mjesec_pregleda, int godina_pregleda, int sati_pregleda,int minute_pregleda);
</font><a name="0"></a><font color="#FF0000"><a href="match45-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_52.gif"/></a>

    void RegistrirajPregled(std::shared_ptr&lt;Pregled&gt; pregled);
    int DajBrojPregleda() const;
    int DajBrojPregledaNaDatum(const Datum &amp;datum) const;
    Pregled &amp;DajNajranijiPregled();
    Pregled DajNajranijiPregled() const;
    void IsprazniKolekciju();
    void ObrisiNajranijiPregled();
    void ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta);
    void IspisiPregledeNaDatum(const Datum &amp;datum) const;
    void IspisiSvePreglede() const;
};

//int Pregledi::Brojac = 0;
void Pregledi:: RegistrirajPregled(const std::string &amp;ime_pacijenta,const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda)
{
   try{ std::shared_ptr&lt;Pregled&gt; p(std::make_shared&lt;Pregled&gt;(ime_pacijenta,datum_pregleda,vrijeme_pregleda));
    /*for(int i(0); i&lt;pregledii.size(); i++) {
        if(pregledii[i]==nullptr) {
            pregledii[i]=p;
            break;
        }
    } */
    pregledii.push_back(p);
   }catch(...){throw;}
    
}
void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda,int mjesec_pregleda, int godina_pregleda, int sati_pregleda,int minute_pregleda)
{
   std::shared_ptr&lt;Pregled&gt; p(std::make_shared&lt;Pregled&gt;(ime_pacijenta,dan_pregleda,mjesec_pregleda,godina_pregleda,sati_pregleda,minute_pregleda));
   /*
    for(int i(0); i&lt;pregledii.size(); i++) {
        if(pregledii[i]==nullptr) {
            pregledii[i]=p;
            break;
        }
    }*/
    //broj++;
    pregledii.push_back(p);
}
/*objektom, tj. preuzima odgovornost za njegovo brisanje.*/
void Pregledi::RegistrirajPregled(std::shared_ptr&lt;Pregled&gt; pregled)
{
    //if(broj&gt;=max_broj) throw std::range_error("Dostignut maksimalni broj pregleda");
    // pregledii[broj++]=pregled;
    /*for(int i(0); i&lt;max_broj; i++) {
        if(pregledii[i]==nullptr) {
            pregledii[i]=pregled;
            break;
        }
    }*/
    //broj++;
    pregledii.push_back(pregled);
}

int Pregledi::DajBrojPregleda() const
{
    return int(pregledii.size());
}
int Pregledi::DajBrojPregledaNaDatum(const Datum &amp;datum) const
{
    auto datum1(datum.Ocitaj());
    int rez=std::count_if(pregledii.begin(),pregledii.end(),[datum1](std::shared_ptr&lt;Pregled&gt; p1) {
        auto datum2((p1-&gt;DajDatumPregleda()).Ocitaj()); //vraca se datum pa se onda ocitava
        if(get&lt;0&gt;(datum1)==get&lt;0&gt;(datum2) &amp;&amp; get&lt;1&gt;(datum1)==get&lt;1&gt;(datum2) &amp;&amp; get&lt;2&gt;(datum1)==get&lt;2&gt;(datum2) )
            return true;
        else return false;
    });
    return rez;
}
Pregled &amp;Pregledi:: DajNajranijiPregled()
{
    if(pregledii.size()==0) throw std::domain_error("Nema registriranih pregleda");
    Pregled &amp;rez(**std::min_element(pregledii.begin(),pregledii.end(),[](std::shared_ptr&lt;Pregled&gt; p1,std::shared_ptr&lt;Pregled&gt; p2) {
        auto pomoc1((p1-&gt;DajDatumPregleda()).Ocitaj()); //datum trenutnog pregledda
        auto pomoc2((p2-&gt;DajDatumPregleda()).Ocitaj());
        //datum organiziran kao tuple
        if(std::get&lt;2&gt;(pomoc1)==std::get&lt;2&gt;(pomoc2)) {
            if(std::get&lt;1&gt;(pomoc1)==std::get&lt;1&gt;(pomoc2)) {
                return std::get&lt;0&gt;(pomoc1)&lt;std::get&lt;0&gt;(pomoc2);

            } else if(std::get&lt;1&gt;(pomoc1)&lt;std::get&lt;1&gt;(pomoc2)) return true;
            else return false;

        } else if(std::get&lt;2&gt;(pomoc1)&lt;std::get&lt;2&gt;(pomoc2)) return true;
        else return false;

    }));
    return rez;
}
void Pregledi::IsprazniKolekciju()
{
    for(int i(0); i&lt;pregledii.size(); i++) {
        //delete pregledii[i];
        pregledii[i]=nullptr;
    }
    pregledii.resize(0);
    //broj = 0;//brisu se samo pregledi
}
void Pregledi::ObrisiNajranijiPregled()
{
    if(pregledii.size()==0) throw std::range_error("Prazna kolekcija");
    auto rez(std::min_element(pregledii.begin(),pregledii.end(),[](std::shared_ptr&lt;Pregled&gt; p1,std::shared_ptr&lt;Pregled&gt; p2) {
        if(p1 == nullptr &amp;&amp; p2 != nullptr)
            return false;
        if(p2 == nullptr &amp;&amp; p1 != nullptr)
            return true;
        if(p1 == nullptr &amp;&amp; p2 == nullptr)
            return true;
        auto pomoc1((p1-&gt;DajDatumPregleda()).Ocitaj()); //datum trenutnog pregledda
        auto pomoc2((p2-&gt;DajDatumPregleda()).Ocitaj());
        //datum organiziran kao tuple
        if(std::get&lt;2&gt;(pomoc1)==std::get&lt;2&gt;(pomoc2)) {
            if(std::get&lt;1&gt;(pomoc1)==std::get&lt;1&gt;(pomoc2)) {
                return std::get&lt;0&gt;(pomoc1)&lt;std::get&lt;0&gt;(pomoc2);

            } else if(std::get&lt;1&gt;(pomoc1)&lt;std::get&lt;1&gt;(pomoc2)) return true;
            else return false;

        } else if(std::get&lt;2&gt;(pomoc1)&lt;std::get&lt;2&gt;(pomoc2)) return true;
        else return false;

    }));
   int n(rez-pregledii.begin());
    pregledii.erase(pregledii.begin()+n);

}

void Pregledi:: ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta)
{
    int brojac = 0;
   // for(int i(0); i&lt;max_broj; i++)
   for(int i(0);i&lt;pregledii.size();i++)
        if(pregledii[i] != nullptr)
            if(pregledii[i]-&gt;DajImePacijenta()==ime_pacijenta) {
                pregledii.erase(pregledii.begin()+i);
                i--;
                brojac++;
            }
    cout &lt;&lt; "Uspjesno obrisano " &lt;&lt; brojac &lt;&lt; " pregleda\n";
}

void Pregledi:: IspisiPregledeNaDatum(const Datum &amp;datum) const
{
    std::vector&lt;Pregled&gt; vektor;
    for(int i(0); i&lt;pregledii.size(); i++) {
        if(pregledii[i] != nullptr) {
            auto pomoc5((pregledii[i]-&gt;DajDatumPregleda()).Ocitaj()); //tuple
            auto pomoc6(datum.Ocitaj());
            if(get&lt;0&gt;(pomoc5)==get&lt;0&gt;(pomoc6) &amp;&amp; get&lt;1&gt;(pomoc5)==get&lt;1&gt;(pomoc6) &amp;&amp; get&lt;2&gt;(pomoc5)==get&lt;2&gt;(pomoc6) )
                vektor.push_back(*pregledii[i]);
        }
    }
    std::sort(vektor.begin(),vektor.end(),[](Pregled p1,Pregled p2) {
        auto vr1((p1.DajVrijemePregleda()).Ocitaj());
        auto vr2((p2.DajVrijemePregleda()).Ocitaj());
        if(vr1.first==vr2.first) {
            return vr1.second&lt;vr2.second;
        } else if(vr1.first&lt;vr2.first) return true;
        else return false;
    });
    for(int i(0); i&lt;vektor.size(); i++)
        vektor[i].Pregled::Ispisi();
}

void Pregledi::IspisiSvePreglede()const
{
    std::vector&lt;Pregled&gt; vektor;
    for(int i(0); i&lt;pregledii.size(); i++)
        if(pregledii[i] != nullptr)
            vektor.push_back(*pregledii[i]);
    std::sort(vektor.begin(),vektor.end(),[](Pregled p1,Pregled p2) {
        auto datum1((p1.DajDatumPregleda()).Ocitaj());
        auto datum2((p2.DajDatumPregleda()).Ocitaj());
        auto vr1((p1.DajVrijemePregleda()).Ocitaj());
        auto vr2((p2.DajVrijemePregleda()).Ocitaj());
        if(get&lt;0&gt;(datum1)==get&lt;0&gt;(datum2) &amp;&amp; get&lt;1&gt;(datum1)==get&lt;1&gt;(datum2) &amp;&amp; get&lt;2&gt;(datum1)==get&lt;2&gt;(datum2)) {
            if(vr1.first==vr2.first) {
                return vr1.second&lt;vr2.second;
            } else if(vr1.first&lt;vr2.first) return true;
            else return false;
        } else if(Pregled::DolaziPrije(p1,p2)) return true;
        else return false;
    });
    for(int i(0); i&lt;vektor.size(); i++)
        vektor[i].Ispisi();

}
int main ()
{
 Pregledi p;
   // Pregledi p2;
    //Pregledi p2(maxi);
    for(; ; ) {
        std:: cout&lt;&lt;"Unesite ime novog pacijenta ili 'kraj' za zavrsetak unosa: ";
        string ime;
        //cin.ignore(1000, '\n');
        std::getline(cin,ime);
        if(ime == "kraj") break;
        cout&lt;&lt;"Unesite dan mjesec i godinu pregleda: ";
        int dan,mjesec,godina;
        cin&gt;&gt;dan&gt;&gt;mjesec&gt;&gt;godina;
        Datum d(dan,mjesec,godina);
        cout&lt;&lt;"Unesite sate i minute pregleda: ";
        int satii,minutee;
        cin&gt;&gt;satii&gt;&gt;minutee;
        Vrijeme v(satii,minutee);
        p.RegistrirajPregled(ime,d,v);
        cin.ignore(1000, '\n');
    }
    cout&lt;&lt;"Trenutno su registrovani sljedeci pregledi\n";
    p.IspisiSvePreglede();
  //  p.ObrisiNajranijiPregled();
  //cout&lt;&lt;  p.DajBrojPregleda()&lt;&lt;std::endl;
  //  p.IsprazniKolekciju();
 // cout&lt;&lt; p.DajBrojPregleda()&lt;&lt;std::endl;
   // p2=p;
   // p.IsprazniKolekciju();
//try{  p.ObrisiNajranijiPregled();}catch(std::range_error e){cout&lt;&lt;e.what();}
    //p2.IspisiSvePreglede();
    while(true) {
        cout&lt;&lt;"\nOdaberite jednu od sljedecih opcija\n"
            &lt;&lt;"1 - Broj pregleda na datum\n"
            &lt;&lt;"2 - Najraniji pregled\n"
            &lt;&lt;"3 - Obrisi pregled pacijenta\n"
            &lt;&lt;"4 - Obrisi najraniji pregled\n"
            &lt;&lt;"5 - Ispisi sve pregleda na datum\n"
            &lt;&lt;"6 - Ispisi sve preglede\n"
            &lt;&lt;"7 - Kraj programa\n";
        int opcija;
        cin &gt;&gt; opcija;
        switch(opcija) {
        case 1: {
            cout&lt;&lt;"Unesite dan mjesec i godinu : ";
            int d,mj,gd;
            cin&gt;&gt;d&gt;&gt;mj&gt;&gt;gd;
            Datum dat(d,mj,gd);
            cout&lt;&lt;"Broj pregleda na datum "&lt;&lt;d&lt;&lt;" "&lt;&lt;mj&lt;&lt;" "&lt;&lt;gd&lt;&lt;" je: "&lt;&lt;p.DajBrojPregledaNaDatum(dat) &lt;&lt; "\n";
            break;
        }
        case 2: {
            cout&lt;&lt;"Najraniji pregled je:\n";
            (p.DajNajranijiPregled()).Ispisi();
            break;
        }
        case 3: {
            cin.ignore(1000, '\n');
            cout&lt;&lt;"Unesite ime pacijenta: ";
            string imee;
            std::getline(cin,imee);
            p.ObrisiPregledePacijenta(imee);
            break;

        }
        case 4: {
            try {
                p.ObrisiNajranijiPregled();
                cout&lt;&lt;"Najraniji pregled uspjesno obrisan\n";
            } catch(std::range_error e) {
                cout&lt;&lt;e.what();
            }
            break;
        }
        case 5: {
            int d,m,g;
            cout&lt;&lt;"Unesite dan mjesec i godinu :";
            cin&gt;&gt;d&gt;&gt;m&gt;&gt;g;
            //cout&lt;&lt;"Broj pregleda na datum"&lt;&lt;d&lt;&lt;" "&lt;&lt;m&lt;&lt;" "&lt;&lt;g;
            Datum datumm(d,m,g);
            cout&lt;&lt;" Pregledi na datum "&lt;&lt;d&lt;&lt;" "&lt;&lt;m&lt;&lt;" "&lt;&lt;g&lt;&lt;" su:"&lt;&lt;std::endl;
            p.IspisiPregledeNaDatum(datumm);
            break;
        }
        case 6: {
            p.IspisiSvePreglede();
            break;
        }
        case 7: {
            break;
        }
        }
        if(opcija == 7)
            break;
</font>    }

    return 0;
}
</pre>
</body>
</html>
