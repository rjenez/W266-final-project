<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z4/student7346.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z4/Z4/student6168.cpp<p></p><pre>
<a name="3"></a><font color="#00FFFF"><a href="match111-0.html#3" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_5.gif"/></a>

/B2017/2018: ZadaÄ‡a 4, Zadatak 4
#include &lt;iostream&gt;
#include &lt;algorithm&gt;
#include &lt;iomanip&gt;
#include &lt;utility&gt;
#include &lt;tuple&gt;
#include &lt;stdexcept&gt;
#include &lt;initializer_list&gt;
#include &lt;string&gt; 
#include &lt;vector&gt;
#include &lt;iterator&gt;
#include &lt;memory&gt;

using std::cin;
using std::cout;
using std::endl;
using std::string;
using std::get;

class Datum {
    int dan, mjesec, godina;
public:
    Datum(int dan, int mjesec, int godina) { Postavi(dan, mjesec, godina); }
    void Postavi(int dan, int mjesec, int godina);
    std::tuple&lt;int, int, int&gt; Ocitaj() const { return std::make_tuple(dan, mjesec, godina); }
    void Ispisi() const { cout &lt;&lt; dan &lt;&lt; "/" &lt;&lt; mjesec &lt;&lt; "/" &lt;&lt; godina; }
};

void Datum::Postavi(int dan, int mjesec, int godina) {
    int broj_dana[12]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
</font>    if(godina%4==0 &amp;&amp; godina%100!=0 || godina%400==0) broj_dana[1]++;
<a name="2"></a><font color="#0000FF"><a href="match111-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_7.gif"/></a>

    if(godina &lt; 1 || dan &lt; 1 || mjesec &lt; 1 || mjesec &gt; 12 || dan &gt; broj_dana[mjesec - 1]) throw std::domain_error("Neispravan datum");
    Datum::dan = dan; Datum::mjesec = mjesec; Datum::godina = godina;
}

class Vrijeme {
    int sati, minute;
public:
    Vrijeme (int sati, int minute) { Postavi(sati, minute); }
    void Postavi (int sati, int minute);
    std::pair&lt;int, int&gt; Ocitaj () const { return std::make_pair(sati, minute); }
    void Ispisi() const { cout &lt;&lt; std::setw(2) &lt;&lt; std::setfill('0') &lt;&lt; std::right &lt;&lt; sati &lt;&lt; ":" &lt;&lt; std::setw(2) &lt;&lt; minute &lt;&lt; std::setfill(' '); } 
};

void Vrijeme::Postavi (int sati, int minute) {
    if (sati&lt;0 || sati&gt;23 || minute&lt;0 || minute&gt;59) throw std::domain_error("Neispravno vrijeme");
    Vrijeme::sati = sati; Vrijeme::minute = minute;
}

class Pregled {
    std::string ime_pacijenta;
    Datum datum_pregleda;
    Vrijeme vrijeme_pregleda;
public:
    Pregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda): ime_pacijenta(ime_pacijenta), datum_pregleda(datum_pregleda), vrijeme_pregleda(vrijeme_pregleda) {} 
</font><a name="1"></a><font color="#00FF00"><a href="match111-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_26.gif"/></a>

    Pregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda): ime_pacijenta(ime_pacijenta), datum_pregleda(dan_pregleda, mjesec_pregleda, godina_pregleda), vrijeme_pregleda(sati_pregleda, minute_pregleda) {}
    void PromijeniPacijenta(const std::string &amp;ime_pacijenta) { Pregled::ime_pacijenta = ime_pacijenta; }
    void PromijeniDatum(const Datum &amp;novi_datum) { auto Parametri = novi_datum.Ocitaj(); datum_pregleda.Postavi(get&lt;0&gt;(Parametri), get&lt;1&gt;(Parametri), get&lt;2&gt;(Parametri));}
    void PromijeniVrijeme(const Vrijeme &amp;novo_vrijeme) { auto Parametri = novo_vrijeme.Ocitaj(); vrijeme_pregleda.Postavi(get&lt;0&gt;(Parametri), get&lt;1&gt;(Parametri));} 
    void PomjeriDanUnaprijed();
    void PomjeriDanUnazad();
    std::string DajImePacijenta() const { return ime_pacijenta; }
    Datum DajDatumPregleda () const { return datum_pregleda; }
    Vrijeme DajVrijemePregleda() const { return vrijeme_pregleda; }
    static bool DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2);
    void Ispisi() const { cout &lt;&lt; std::left &lt;&lt; std::setw(30) &lt;&lt; ime_pacijenta; datum_pregleda.Ispisi(); cout &lt;&lt; " "; vrijeme_pregleda.Ispisi(); cout &lt;&lt; endl; }
};

void Pregled::PomjeriDanUnaprijed() {
    int broj_dana[12]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    auto Parametri = datum_pregleda.Ocitaj();
    int d = get&lt;0&gt;(Parametri), m = get&lt;1&gt;(Parametri), g = get&lt;2&gt;(Parametri);
    if(g%4==0 &amp;&amp; (g%100!=0 || g%400==0)) broj_dana[1]++;
    d++;
    if(d&gt;broj_dana[m-1]) {
        if(m&lt;12) { d=1; m+=1; }
        else { d=1; m=1; g+=1; }
    }
    Pregled::datum_pregleda.Postavi(d, m, g);
}

void Pregled::PomjeriDanUnazad() {
    int broj_dana[12]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    auto Parametri = datum_pregleda.Ocitaj();
    int d = get&lt;0&gt;(Parametri), m = get&lt;1&gt;(Parametri), g = get&lt;2&gt;(Parametri);
    if(g%4==0 &amp;&amp; (g%100!=0 || g%400==0)) broj_dana[1]++;
    d--;
    if(d==0) {
        if(m&gt;1) { m-=1; d=broj_dana[m-1]; }
        else { g-=1; m=12; d=broj_dana[m-1];  }
    }
    Pregled::datum_pregleda.Postavi(d, m, g);
}

bool Pregled::DolaziPrije(const Pregled &amp;p1, const Pregled &amp;p2) {
    auto p1_datum = p1.datum_pregleda.Ocitaj(); auto p2_datum = p2.datum_pregleda.Ocitaj();
    auto p1_vrijeme = p1.vrijeme_pregleda.Ocitaj(); auto p2_vrijeme = p2.vrijeme_pregleda.Ocitaj();
    if(get&lt;2&gt;(p1_datum)&lt;get&lt;2&gt;(p2_datum)) return true; 
    if(get&lt;2&gt;(p1_datum)==get&lt;2&gt;(p2_datum)){
        if(get&lt;1&gt;(p1_datum)&lt;get&lt;1&gt;(p2_datum)) return true;
        if(get&lt;1&gt;(p1_datum)==get&lt;1&gt;(p2_datum)) {
            if(get&lt;0&gt;(p1_datum)&lt;get&lt;0&gt;(p2_datum)) return true;
            if(get&lt;0&gt;(p1_datum)==get&lt;0&gt;(p2_datum)) {
                if(p1_vrijeme.first&lt;p2_vrijeme.first) return true;
                if(p1_vrijeme.first==p2_vrijeme.first) {
                    if(p1_vrijeme.second&lt;p2_vrijeme.second) return true;
                }
            }
        }
    }
    return false;
}

class Pregledi {
    std::vector&lt;std::shared_ptr&lt;Pregled&gt;&gt; spisak;
public:
    explicit Pregledi () {};
    Pregledi (std::initializer_list&lt;Pregled&gt; spisak_pregleda);
    ~Pregledi() {
        for(int i(0); i&lt;spisak.size(); i++)
           spisak[i]=nullptr;
    }
    Pregledi(const Pregledi &amp;pregledi);
    Pregledi(Pregledi &amp;&amp;pregledi);
    Pregledi &amp;operator=(const Pregledi &amp;pregledi);
    Pregledi &amp;operator=(Pregledi &amp;&amp;pregledi);
</font>    void RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda);
<a name="0"></a><font color="#FF0000"><a href="match111-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_54.gif"/></a>

    void RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda);
    void RegistrirajPregled(Pregled *pregled);
    int DajBrojPregleda() const { return spisak.size(); }
    int DajBrojPregledaNaDatum(const Datum &amp;datum) const;
    Pregled &amp;DajNajranijiPregled();
    Pregled DajNajranijiPregled() const;
    void IsprazniKolekciju();
    void ObrisiNajranijiPregled();
    void ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta);
    void IspisiPregledeNaDatum(const Datum &amp;datum) const;
    void IspisiSvePreglede() const;
};

Pregledi::Pregledi(std::initializer_list&lt;Pregled&gt; spisak_pregleda) {
    int i(0);
    for (auto klizeci(spisak_pregleda.begin()); klizeci!=spisak_pregleda.end(); klizeci++) {
        spisak.push_back(std::make_shared&lt;Pregled&gt;(*klizeci)); i++;
    } 
}

Pregledi::Pregledi(const Pregledi &amp;pregledi) {
    for (int i(0); i&lt;pregledi.spisak.size(); i++) 
        spisak.push_back(std::make_shared&lt;Pregled&gt;(*pregledi.spisak[i]));
}

Pregledi::Pregledi(Pregledi &amp;&amp;pregledi) {
    spisak = std::move(pregledi.spisak);
}

Pregledi&amp; Pregledi::operator =(const Pregledi &amp;pregledi) {
    spisak.clear();
    for(int i(0); i&lt;pregledi.spisak.size(); i++)
        spisak.push_back(std::make_shared&lt;Pregled&gt;(*pregledi.spisak[i]));
    return *this;
}

Pregledi &amp;Pregledi::operator =(Pregledi &amp;&amp;pregledi) {
    if(&amp;pregledi!=this) {
        spisak.clear();
        spisak = std::move(pregledi.spisak);
    }
    return *this;
}

void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, const Datum &amp;datum_pregleda, const Vrijeme &amp;vrijeme_pregleda) {
    spisak.push_back(std::make_shared&lt;Pregled&gt;(Pregled(ime_pacijenta, datum_pregleda, vrijeme_pregleda)));
}

void Pregledi::RegistrirajPregled(const std::string &amp;ime_pacijenta, int dan_pregleda, int mjesec_pregleda, int godina_pregleda, int sati_pregleda, int minute_pregleda) {
    spisak.push_back(std::make_shared&lt;Pregled&gt;(Pregled(ime_pacijenta, dan_pregleda, mjesec_pregleda, godina_pregleda, sati_pregleda, minute_pregleda)));
}

void Pregledi::RegistrirajPregled(Pregled *pregled) {
    spisak.push_back(std::make_shared&lt;Pregled&gt;(*pregled)); 
}

int Pregledi::DajBrojPregledaNaDatum(const Datum &amp;datum) const {
    int brojac(0);
    for(int i(0); i&lt;spisak.size(); i++) {
        if(spisak[i]-&gt;DajDatumPregleda().Ocitaj()==datum.Ocitaj()) brojac++; 
    }
    return brojac;
}

Pregled&amp; Pregledi::DajNajranijiPregled() {
    if(!spisak.size()) throw std::domain_error("Nema registriranih pregleda");
    auto lokacija(std::min_element(spisak.begin(), spisak.end(), [=](std::shared_ptr&lt;Pregled&gt; p1, std::shared_ptr&lt;Pregled&gt; p2) { return Pregled::DolaziPrije(*p1, *p2); }));
    return **lokacija;
}

Pregled Pregledi::DajNajranijiPregled() const {
    if(!spisak.size()) throw std::domain_error("Nema registriranih pregleda");
    auto lokacija(std::min_element(spisak.begin(), spisak.end(), [=](std::shared_ptr&lt;Pregled&gt; p1, std::shared_ptr&lt;Pregled&gt; p2) { return Pregled::DolaziPrije(*p1, *p2); }));
    return **lokacija;
}

void Pregledi::IsprazniKolekciju () {
    for(int i(0); i&lt;spisak.size(); i++)
        spisak[i] = nullptr;
    spisak.resize(0);
}


void Pregledi::ObrisiNajranijiPregled() {  
    if (!spisak.size()) throw std::range_error("Prazna kolekcija");
    auto lokacija(std::min_element(spisak.begin(), spisak.end(), [=](std::shared_ptr&lt;Pregled&gt; p1, std::shared_ptr&lt;Pregled&gt; p2) { return Pregled::DolaziPrije(*p1, *p2); }));
    *lokacija = nullptr;
    std::swap(*lokacija, spisak[spisak.size()-1]);
    int trenutna = spisak.size();
    spisak.resize(trenutna-1);
}

void Pregledi::ObrisiPregledePacijenta(const std::string &amp;ime_pacijenta) {
    if (spisak.size()&gt;0) {
        std::vector&lt;std::shared_ptr&lt;Pregled&gt;&gt; Krajnji;
        std::copy_if(spisak.begin(), spisak.end(), back_inserter(Krajnji), [=](std::shared_ptr&lt;Pregled&gt; p) { return p-&gt;DajImePacijenta()!=ime_pacijenta; });
        IsprazniKolekciju();
        std::copy(Krajnji.begin(), Krajnji.end(), back_inserter(spisak));
    }
}

void Pregledi::IspisiPregledeNaDatum(const Datum &amp;datum) const {
    std::vector&lt;std::shared_ptr&lt;Pregled&gt;&gt; PNTD (DajBrojPregledaNaDatum(datum));
    std::copy_if(spisak.begin(), spisak.end(), PNTD.begin(), [=](std::shared_ptr&lt;Pregled&gt; trenutni) { return datum.Ocitaj()==trenutni-&gt;DajDatumPregleda().Ocitaj(); });
    std::sort(PNTD.begin(), PNTD.end(), [=](std::shared_ptr&lt;Pregled&gt; p1, std::shared_ptr&lt;Pregled&gt; p2) { return Pregled::DolaziPrije(*p1, *p2); });
    std::for_each(PNTD.begin(), PNTD.end(), [](std::shared_ptr&lt;Pregled&gt; nekipregled){ nekipregled-&gt;Ispisi(); });
}

void Pregledi::IspisiSvePreglede() const {
    std::vector&lt;std::shared_ptr&lt;Pregled&gt;&gt; SP (spisak.size());
    std::copy(spisak.begin(), spisak.end(), SP.begin());
    std::sort(SP.begin(), SP.end(), [](std::shared_ptr&lt;Pregled&gt; p1, std::shared_ptr&lt;Pregled&gt; p2) { return Pregled::DolaziPrije(*p1, *p2); });
    std::for_each(SP.begin(), SP.end(), [](std::shared_ptr&lt;Pregled&gt; nekipregled){ nekipregled-&gt;Ispisi(); });
}

void IspisInterfejsa() {
    cout &lt;&lt; endl &lt;&lt; "Odaberite jednu od sljedecih opcija" &lt;&lt; endl &lt;&lt; "1 - Broj pregleda na datum" &lt;&lt; endl &lt;&lt; "2 - Najraniji pregled" &lt;&lt; endl &lt;&lt; "3 - Obrisi pregled pacijenta" &lt;&lt; endl &lt;&lt; "4 - Obrisi najraniji pregled" &lt;&lt; endl &lt;&lt; "5 - Ispisi sve pregleda na datum" &lt;&lt; endl &lt;&lt; "6 - Ispisi sve preglede" &lt;&lt; endl &lt;&lt; "7 - Kraj programa" &lt;&lt; endl;
}

int main ()
{
    Pregledi bazapregleda;
    for(;;) {
        cout &lt;&lt; "Unesite ime novog pacijenta ili 'kraj' za zavrsetak unosa: ";
        std::string ime; std::getline(cin, ime);
        if(ime=="kraj") break;
        int dan, mjesec, godina, sati, minute;
        cout &lt;&lt; "Unesite dan mjesec i godinu pregleda: ";
        cin &gt;&gt; dan &gt;&gt; mjesec &gt;&gt; godina;
        cout &lt;&lt; "Unesite sate i minute pregleda: ";
        cin &gt;&gt; sati &gt;&gt; minute;
        bazapregleda.RegistrirajPregled(ime, dan, mjesec, godina, sati, minute);
        cin.ignore(5, '\n');
    }
    cout &lt;&lt; "Trenutno su registrovani sljedeci pregledi" &lt;&lt; endl;
    bazapregleda.IspisiSvePreglede();
    for (;;) {  
        IspisInterfejsa();
        int izbor; cin &gt;&gt; izbor;
        try {
            switch(izbor) {
                case 1: {
                    cout &lt;&lt; "Unesite dan mjesec i godinu : ";
                    int d, m, g; cin&gt;&gt;d&gt;&gt;m&gt;&gt;g; 
                    cout&lt;&lt;"Broj pregleda na datum "&lt;&lt;d&lt;&lt;" "&lt;&lt;m&lt;&lt;" "&lt;&lt;g&lt;&lt;" je: "&lt;&lt;bazapregleda.DajBrojPregledaNaDatum(Datum(d, m, g));
                    break; }
                case 2: {
                    Pregled najraniji_pregled(bazapregleda.DajNajranijiPregled());
                    cout &lt;&lt; "Najraniji pregled je: " &lt;&lt; endl; najraniji_pregled.Ispisi();
                    break; }
                case 3: {
                    cout &lt;&lt; endl &lt;&lt; "Unesite ime pacijenta: ";
                    cin.ignore(std::numeric_limits&lt;std::streamsize&gt;::max(), '\n');
                    std::string ime2;
                    std::getline(cin, ime2);
                    int BrojPregledaPrijeBrisanja = bazapregleda.DajBrojPregleda();
                    bazapregleda.ObrisiPregledePacijenta(ime2);
                    int BrojObrisanih = BrojPregledaPrijeBrisanja-bazapregleda.DajBrojPregleda();
                    cout &lt;&lt; "Uspjesno obrisano " &lt;&lt; BrojObrisanih &lt;&lt; " pregleda" &lt;&lt; endl;
                    break; }
                case 4: {
                    bazapregleda.ObrisiNajranijiPregled();
                    cout &lt;&lt; "Najraniji pregled uspjesno obrisan";
                    break; }
                case 5: {
                    cout &lt;&lt; "Unesite dan mjesec i godinu : ";
                    int d2, m2, g2; cin &gt;&gt; d2 &gt;&gt; m2 &gt;&gt; g2;
                    cout &lt;&lt; "Pregledi na datum " &lt;&lt; d2 &lt;&lt; " " &lt;&lt; m2 &lt;&lt; " " &lt;&lt; g2 &lt;&lt; " su: " &lt;&lt; endl;
                    bazapregleda.IspisiPregledeNaDatum(Datum(d2, m2, g2));
                    break; }
                case 6:
                    bazapregleda.IspisiSvePreglede();
                    break; 
                case 7:
                    break;
            }
            if(izbor==7) break;
            if(izbor!=6) cout &lt;&lt; endl;
        } catch(std::exception &amp;izuzetak) {
            cout &lt;&lt; izuzetak.what() &lt;&lt; endl;
        }
    }
	return 0;
</font>}
 </pre>
</body>
</html>
