<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z3/Z5/student5829.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2017/Z3/Z5/student5829.cpp<p></p><pre>
<a name="0"></a><font color="#FF0000"><a href="match32-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_99.gif"/></a>

/B2017/2018: ZadaÄ‡a 3, Zadatak 5
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;vector&gt;
#include &lt;stdexcept&gt;
#include &lt;map&gt;                      //  NEKE FUNKCIJE SU KOPIRANE
#include &lt;vector&gt;                   //  IZ PRETHODNOG ZADATKA
#include &lt;stack&gt;
using std::vector;
using std::string;
using std::cout;
using std::cin;
enum class Boje
{
    Pik, Tref, Herc, Karo
};
typedef std::multimap&lt;Boje,string&gt; MAPA;
typedef std::stack&lt;std::pair&lt;string,string&gt;&gt; STEK;

struct Karta {
    Boje boja;
    string vrijednost;
};

struct Cvor {
    Karta karta;
    Cvor *sljedeci;
};

Cvor *KreirajSpil()
{
    std::vector&lt;string&gt; vec {"2","3","4","5","6","7","8","9","10","J","Q","K","A"};
    Cvor *pocetni(nullptr),*prethodni;
    try {
        for(int i(0); i&lt;13; i++) {
            Cvor *novi(new Cvor {{Boje::Pik,vec[i]},nullptr});
            if(!pocetni) pocetni=novi;
            else prethodni-&gt;sljedeci=novi;
            prethodni=novi;
        }
        for(int i(0); i&lt;13; i++) {
            Cvor *novi(new Cvor {{Boje::Tref,vec[i]},nullptr});
            if(!pocetni) pocetni=novi;
            else prethodni-&gt;sljedeci=novi;
            prethodni=novi;
        }
        for(int i(0); i&lt;13; i++) {
            Cvor *novi(new Cvor {{Boje::Herc,vec[i]},nullptr});
            if(!pocetni) pocetni=novi;
            else prethodni-&gt;sljedeci=novi;
            prethodni=novi;
        }
        for(int i(0); i&lt;13; i++) {
            Cvor *novi(new Cvor {{Boje::Karo,vec[i]},nullptr});
            if(!pocetni) pocetni=novi;
            else prethodni-&gt;sljedeci=novi;
            prethodni=novi;
        }
        prethodni-&gt;sljedeci=pocetni;
    } catch(...) {
        for(;;) {
            auto it1(pocetni);
            if(pocetni-&gt;sljedeci==nullptr || pocetni==nullptr) {
                delete it1;
                break;
            }
            pocetni=pocetni-&gt;sljedeci;
            delete it1;
        }
        throw;
    }
    return pocetni;
}

int BrojEl(Cvor *pocetni)
{
    if(pocetni==nullptr) return 0;
    auto it(pocetni);
    int brojac(1);
    while(it-&gt;sljedeci!=pocetni) {
        brojac++;
        it=it-&gt;sljedeci;
    }
    return brojac;
}

bool PoBojama(Boje boja1,Boje boja2)
{
    if(boja1==boja2) return true;
    if(boja1==Boje::Pik) return true;
    if(boja1==Boje::Tref &amp;&amp; (boja2==Boje::Herc || boja2==Boje::Karo)) return true;
    if(boja1==Boje::Herc &amp;&amp; boja2==Boje::Karo) return true;
    return false;
}

bool TestKarte(Boje &amp;boja,string &amp;s)
{
    if(!(boja==Boje::Pik || boja==Boje::Tref || boja==Boje::Herc || boja==Boje::Karo)) return true;
    if(s!="2" &amp;&amp; s!="3" &amp;&amp; s!="4" &amp;&amp; s!="5" &amp;&amp; s!="6" &amp;&amp; s!="7" &amp;&amp; s!="8"
            &amp;&amp; s!="9" &amp;&amp; s!="10" &amp;&amp; s!="J" &amp;&amp; s!="Q" &amp;&amp; s!="K" &amp;&amp; s!="A") return true;
    return false;
}

bool PoVelicini(string s1,string s2)
{
    vector&lt;string&gt; vec {"2","3","4","5","6","7","8","9","10","J","Q","K","A"};
    int a(0),b(0);
    for(int i(0); i&lt;vec.size(); i++) {
        if(s1==vec[i]) a=i;
        if(s2==vec[i]) b=i;
    }
    return a&lt;=b;
}

void Zamijeni(Cvor *(&amp;pok1),Cvor *(&amp;pok2))
{
    if(pok1==pok2) return;
    Cvor *it1(pok1),*it2(pok2),*it3(nullptr);
    while(it1-&gt;sljedeci!=pok1) it1=it1-&gt;sljedeci;
    while(it2-&gt;sljedeci!=pok2) it2=it2-&gt;sljedeci;
    if(pok1-&gt;sljedeci==pok2) {
        it1-&gt;sljedeci=pok2;
        pok1-&gt;sljedeci=pok2-&gt;sljedeci;
        pok2-&gt;sljedeci=pok1;
    } else if(pok2-&gt;sljedeci==pok1) {
        it2-&gt;sljedeci=pok1;
        pok2-&gt;sljedeci=pok1-&gt;sljedeci;
        pok1-&gt;sljedeci=pok2;
    } else {
        it3=pok2-&gt;sljedeci;
        pok2-&gt;sljedeci=pok1-&gt;sljedeci;
        it2-&gt;sljedeci=pok1;
        pok1-&gt;sljedeci=it3;
        it1-&gt;sljedeci=pok2;
    }
    it3=pok1;
    pok1=pok2;
    pok2=it3;
}

void SortirajBoje(Cvor *(&amp;pocetni))
{
    auto it1(pocetni),it2(pocetni);
    do {
        it2=it1;
        do {
            if(!PoBojama(it1-&gt;karta.boja,it2-&gt;karta.boja)) {
                if(it1==pocetni) pocetni=it2;
                Zamijeni(it1,it2);
            }
            it2=it2-&gt;sljedeci;
        } while(it2!=pocetni);
        it1=it1-&gt;sljedeci;
    } while(it1!=pocetni);
}

void SortirajSpil(Cvor *(&amp;pocetni))
{
    if(BrojEl(pocetni)==1) return;
    SortirajBoje(pocetni);
    auto it(pocetni);
    do {
        auto it1(it);
        do {
            if(PoVelicini(it1-&gt;karta.vrijednost,it-&gt;karta.vrijednost)) {
                if(it==pocetni) pocetni=it1;
                Zamijeni(it,it1);
            }
            it1=it1-&gt;sljedeci;
        } while(it1!=pocetni &amp;&amp; it1-&gt;karta.boja==Boje::Pik);
        it=it-&gt;sljedeci;
    } while(it!=pocetni &amp;&amp; it-&gt;karta.boja==Boje::Pik);
    do {
        auto it1(it);
        do {
            if(PoVelicini(it1-&gt;karta.vrijednost,it-&gt;karta.vrijednost)) {
                if(it==pocetni) pocetni=it1;
                Zamijeni(it,it1);
            }
            it1=it1-&gt;sljedeci;
        } while(it1!=pocetni &amp;&amp; it1-&gt;karta.boja==Boje::Tref);
        it=it-&gt;sljedeci;
    } while(it!=pocetni &amp;&amp; it-&gt;karta.boja==Boje::Tref);
    do {
        auto it1(it);
        do {
            if(PoVelicini(it1-&gt;karta.vrijednost,it-&gt;karta.vrijednost)) {
                if(it==pocetni) pocetni=it1;
                Zamijeni(it,it1);
            }
            it1=it1-&gt;sljedeci;
        } while(it1!=pocetni &amp;&amp; it1-&gt;karta.boja==Boje::Herc);
        it=it-&gt;sljedeci;
    } while(it!=pocetni &amp;&amp; it-&gt;karta.boja==Boje::Herc);
    do {
        auto it1(it);
        do {
            if(PoVelicini(it1-&gt;karta.vrijednost,it-&gt;karta.vrijednost)) {
                if(it==pocetni) pocetni=it1;
                Zamijeni(it,it1);
            }
            it1=it1-&gt;sljedeci;
        } while(it1!=pocetni &amp;&amp; it1-&gt;karta.boja==Boje::Karo);
        it=it-&gt;sljedeci;
    } while(it!=pocetni &amp;&amp; it-&gt;karta.boja==Boje::Karo);
}

void TestirajSpil(Cvor *pocetni)
{
    int br_el(BrojEl(pocetni));
    if(br_el&gt;52) throw std::logic_error("Neispravna lista!");
    if(br_el==1) return;
    auto it1(pocetni),it(pocetni);
    if(TestKarte(it1-&gt;karta.boja,it1-&gt;karta.vrijednost)) throw std::logic_error("Neispravna lista!");
    it1=it1-&gt;sljedeci;
    do {
        if(!PoBojama(it-&gt;karta.boja,it1-&gt;karta.boja))
            throw std::logic_error("Neispravna lista!");
        if(TestKarte(it1-&gt;karta.boja,it1-&gt;karta.vrijednost)) throw std::logic_error("Neispravna lista!");
        it=it-&gt;sljedeci;
        it1=it1-&gt;sljedeci;
    } while(it1!=pocetni);
    it1=pocetni;
    it1=it1-&gt;sljedeci;
    it=pocetni;
    do {
        if(!(PoVelicini(it-&gt;karta.vrijednost,it1-&gt;karta.vrijednost))) {
            if(!PoBojama(it-&gt;karta.boja,it1-&gt;karta.boja))
                throw std::logic_error("Neispravna lista!");
        } else if(it-&gt;karta.vrijednost==it1-&gt;karta.vrijednost &amp;&amp; it-&gt;karta.boja==it1-&gt;karta.boja)
            throw std::logic_error("Neispravna lista!");
        it=it-&gt;sljedeci;
        it1=it1-&gt;sljedeci;
    } while(it1!=pocetni);
    it1=pocetni;
    do {
        auto it2(it1);
        it2=it2-&gt;sljedeci;
        if(it2==pocetni) return;
        do {
            if((it1-&gt;karta.boja==it2-&gt;karta.boja) &amp;&amp; (it1-&gt;karta.vrijednost==it2-&gt;karta.vrijednost))
                throw std::logic_error("Neispravna lista!");
            it2=it2-&gt;sljedeci;
        } while(it2!=pocetni);
        it1=it1-&gt;sljedeci;
    } while(it1!=pocetni);
}

STEK IzbaciKarteRazbrajanjem(Cvor *(&amp;pocetni),const short int r,const int b)
{
    if(r&lt;1 || r&gt;52 || b&lt;1) throw std::logic_error("Neispravni elementi za izbacivanje!");
    TestirajSpil(pocetni);
    STEK stek;
    auto it(pocetni);
    for(int i(0); i&lt;b &amp;&amp; it!=nullptr; i++) {
        for(int j(0); j&lt;r-1; j++) {
            it=it-&gt;sljedeci;
        }
        string pom;
        if(it-&gt;karta.boja==Boje::Pik) pom="Pik";
        if(it-&gt;karta.boja==Boje::Tref) pom="Tref";
        if(it-&gt;karta.boja==Boje::Herc) pom="Herc";
        if(it-&gt;karta.boja==Boje::Karo) pom="Karo";
        stek.push(std::make_pair(pom,it-&gt;karta.vrijednost));
        if(it-&gt;sljedeci==it) {
            delete it;
            it=nullptr;
            pocetni=nullptr;
            break;
        }
        auto pom_it(pocetni);
        while(pom_it-&gt;sljedeci!=it) pom_it=pom_it-&gt;sljedeci;
        pom_it-&gt;sljedeci=it-&gt;sljedeci;
        if(it==pocetni) pocetni=it-&gt;sljedeci;
        delete it;
        it=pom_it-&gt;sljedeci;
    }
    return stek;
}

void VratiPosljednjihNKarata(Cvor *(&amp;pocetni),STEK &amp;stek,int n)
{
    if(n&lt;0) throw std::domain_error("Broj n je besmislen!");
    if(n&gt;stek.size()) throw std::range_error("Nedovoljno karata u steku!");
    for(int i(0); i&lt;n; i++) {
        Boje boje;
        if(stek.top().first=="Pik") boje=Boje::Pik;
        if(stek.top().first=="Tref") boje=Boje::Tref;
        if(stek.top().first=="Herc") boje=Boje::Herc;
        if(stek.top().first=="Karo") boje=Boje::Karo;
        if(TestKarte(boje,stek.top().second)) throw std::logic_error("Neispravne karte!");
        Cvor *novi(new Cvor {{boje,stek.top().second},nullptr});
        novi-&gt;sljedeci=pocetni-&gt;sljedeci;
        pocetni-&gt;sljedeci=novi;
        stek.pop();
    }
    SortirajSpil(pocetni);
    TestirajSpil(pocetni);
}

void IzbaciKarte(Cvor *(&amp;pocetni),MAPA &amp;mapa)
{
    TestirajSpil(pocetni);
    auto it2(pocetni);
    for(auto it1(mapa.begin()); it1!=mapa.end(); it1++) {
        do {
            if((it1-&gt;first==it2-&gt;karta.boja) &amp;&amp; (it1-&gt;second==it2-&gt;karta.vrijednost)) {
                if(it2-&gt;sljedeci==it2) {
                    delete it2;
                    pocetni=nullptr;
                    return;
                }
                it1=mapa.erase(it1);
                auto pom1(pocetni);
                while(pom1-&gt;sljedeci!=it2) pom1=pom1-&gt;sljedeci;
                pom1-&gt;sljedeci=it2-&gt;sljedeci;
                delete it2;
                it2=pom1;
            }
            it2=it2-&gt;sljedeci;
        } while(it2!=pocetni &amp;&amp; it2-&gt;sljedeci!=it2);
    }
}

void IspisiSpil(Cvor *pocetni)
{
    auto it(pocetni);
    cout&lt;&lt;"Pik: ";
    do {
        if(it-&gt;karta.boja==Boje::Pik) cout&lt;&lt;it-&gt;karta.vrijednost&lt;&lt;" ";
        it=it-&gt;sljedeci;
    } while(it!=pocetni);
    cout&lt;&lt;"\nTref: ";
    it=pocetni;
    do {
        if(it-&gt;karta.boja==Boje::Tref) cout&lt;&lt;it-&gt;karta.vrijednost&lt;&lt;" ";
        it=it-&gt;sljedeci;
    } while(it!=pocetni);
    cout&lt;&lt;"\nHerc: ";
    it=pocetni;
    do {
        if(it-&gt;karta.boja==Boje::Herc) cout&lt;&lt;it-&gt;karta.vrijednost&lt;&lt;" ";
        it=it-&gt;sljedeci;
    } while(it!=pocetni);
    cout&lt;&lt;"\nKaro: ";
    it=pocetni;
    do {
        if(it-&gt;karta.boja==Boje::Karo) cout&lt;&lt;it-&gt;karta.vrijednost&lt;&lt;" ";
        it=it-&gt;sljedeci;
    } while(it!=pocetni);
}

void UnistiSpil(Cvor *pocetni)
{
    auto it(pocetni);
    while(it-&gt;sljedeci!=pocetni) it=it-&gt;sljedeci;
    it-&gt;sljedeci=nullptr;
    while(pocetni!=nullptr) {
        auto it1(pocetni);
        pocetni=pocetni-&gt;sljedeci;
        delete it1;
    }
}

int main ()
{
    short int r(0);
    int b(0);
    Cvor *pocetni(nullptr);
    try {
        pocetni=KreirajSpil();
        cout&lt;&lt;"Unesite korak razbrajanja: ";
        cin&gt;&gt;r;
        cout&lt;&lt;"Unesite broj karata koje zelite izbaciti: ";
        cin&gt;&gt;b;
        auto stek(IzbaciKarteRazbrajanjem(pocetni,r,b));
        int br_el(BrojEl(pocetni));
        cout&lt;&lt;"U spilu trenutno ima "&lt;&lt;br_el&lt;&lt;" karata, i to:"&lt;&lt;std::endl;
        IspisiSpil(pocetni);
        int n(0);
        cout&lt;&lt;"\nUnesite broj karata koje zelite vratiti u spil: ";
        cin&gt;&gt;n;
        VratiPosljednjihNKarata(pocetni,stek,n);
        br_el=BrojEl(pocetni);
        cout&lt;&lt;"U spilu trenutno ima "&lt;&lt;br_el&lt;&lt;" karata, i to:"&lt;&lt;std::endl;
        IspisiSpil(pocetni);
    } catch(std::domain_error izuzetak) {
        cout&lt;&lt;"Izuzetak: "&lt;&lt;izuzetak.what();
    } catch(std::logic_error izuzetak) {
        cout&lt;&lt;"Izuzetak: "&lt;&lt;izuzetak.what();
    } catch(std::range_error izuzetak) {
        cout&lt;&lt;"Izuzetak: "&lt;&lt;izuzetak.what();
    } catch(std::bad_alloc) {
        cout&lt;&lt;"Izuzetak: Problemi sa memorijom!";
</font>    }
    UnistiSpil(pocetni);

    return 0;
}
</pre>
</body>
</html>
