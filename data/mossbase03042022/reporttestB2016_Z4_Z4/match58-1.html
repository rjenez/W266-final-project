<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z4/Z4/student1044.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z4/Z4/student4095.cpp<p></p><pre>
<a name="1"></a><font color="#00FF00"><a href="match58-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_34.gif"/></a>

/B 2016/2017, ZadaÄ‡a 4, Zadatak 3
//Napomena: testovi ce biti dostupni dan pred rok!

#include &lt;iostream&gt;
#include &lt;stdexcept&gt;
#include &lt;cctype&gt;
#include &lt;string&gt;
#include &lt;algorithm&gt;
#include &lt;iomanip&gt;
#include &lt;vector&gt;
#include &lt;memory&gt;

class Datum
{
    int _d, _m, _g;
public:
    Datum(int d, int m, int g)
    {
        Postavi(d, m, g);
    }
    int DajDan()const
    {
        return _d;
    }
    int DajMjesec()const
    {
        return _m;
    }
    int DajGodinu()const
    {
        return _g;
    }
    void Ispisi()const
    {
        std::cout &lt;&lt; _d &lt;&lt; '/' &lt;&lt; _m &lt;&lt; '/' &lt;&lt; _g;
    }
    void Postavi(int d, int m, int g);
    
};

void Datum::Postavi(int d, int m, int g)
{
    int broj_dana[]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    if((g % 4 == 0 &amp;&amp; g % 100 != 0) || g % 400 == 0)
        ++broj_dana[1];
    if(d &lt; 1 || m &lt; 1 || g &lt; 1 || m &gt; 12 || d &gt; broj_dana[m - 1])
        throw std::domain_error("Neispravan datum");
    _m = m;
    _d = d;
    _g = g;
}

class Kupac
{
    std::string _ime;
    Datum _datum;
    static void provjeri_ime(const std::string&amp; ime);
public:
    Kupac(const std::string&amp; ime, const Datum&amp; datum) : _ime(ime), _datum(datum)
    {
        provjeri_ime(ime);
    }
    void Postavi(const std::string&amp; ime, const Datum&amp; datum);
    
    std::string DajImeIPrezime()const
    {
        return _ime;
    }
    
    Datum DajDatumRodjenja()const
    {
        return _datum;
    }
    void Ispisi()const
    {
        std::cout &lt;&lt; _ime &lt;&lt; " (";
        _datum.Ispisi();
        std::cout &lt;&lt; ")\n";
    }
};

void Kupac::provjeri_ime(const std::string&amp; ime)
{
    for(const auto&amp; z : ime)
        if( !std::islower(std::tolower(z)) &amp;&amp; z != ' ' &amp;&amp; z != '-' &amp;&amp; z != 39 )
            throw std::domain_error("Neispravno ime i prezime");
}

void Kupac::Postavi(const std::string&amp; ime, const Datum&amp; datum)
{
    provjeri_ime(ime);
    _ime = ime;
    _datum = datum;
}

class Stan
{
    std::string _adresa;
    int _sprat, _broj_soba;
    bool _namjesten;
    double _kvadratura;
public:
    Stan(const std::string&amp; adresa, int s, int bs, bool n, double k)
    {
        Postavi(adresa, s, bs, n, k);
    }
    void Postavi(const std::string&amp; adresa, int s, int bs, bool n, double k);
    
    std::string DajAdresu()const
    {
        return _adresa;
    }
    
    int DajSprat() const
    {
        return _sprat;
    }
    
    bool DajNamjesten() const
    {
        return _namjesten;
    }
    
    double DajKvadraturu() const
    {
        return _kvadratura;
    }
    
    int DajBrojSoba()const
    {
        return _broj_soba;
    }
    
    void Ispisi()const
    {
        std::cout &lt;&lt; "Stan se nalazi na adresi " &lt;&lt; _adresa &lt;&lt; " na " &lt;&lt; _sprat
            &lt;&lt; " i ima " &lt;&lt; _broj_soba;
       if(_broj_soba &gt;= 2 &amp;&amp; _broj_soba &lt;= 4 || _broj_soba &gt; 20 &amp;&amp; _broj_soba % 10 &gt;= 2 &amp;&amp; _broj_soba % 10 &lt;= 4)
            std::cout &lt;&lt; " sobe. ";
        else
            std::cout &lt;&lt; " soba. ";
        std::cout &lt;&lt; "Kvadratura stana je " &lt;&lt; _kvadratura
            &lt;&lt; " (m^2) i stan " &lt;&lt; (_namjesten ? "je" : "nije" ) &lt;&lt; " namjesten.";
        
    }
};


void Stan::Postavi(const std::string&amp; adresa, int s, int bs, bool n, double k)
{
    if(s &lt; 0 || bs &lt; 0 || k &lt; 0 )
        throw std::domain_error("Neispravan unos podataka");
    _adresa = adresa;
    _sprat = s;
    _broj_soba = bs;
    _namjesten = n;
    _kvadratura = k;
}

class Prodaje;

class Prodaja
{
    std::string _ime_agenta;
    double _cijena;
    Datum _datum;
    Kupac _kupac;
    Stan _stan;
    friend Prodaje;
public:
    Prodaja(const std::string ia, double cs, const Datum&amp; d, const Kupac&amp; k, const Stan&amp; s) 
        : _ime_agenta(ia), _cijena(cs), _datum(d), _kupac(k), _stan(s) {}
    
    Prodaja(const std::string ia, double cs, 
        int d, int m, int g, 
        const std::string ime, const Datum&amp; d_kupca, 
        const std::string&amp; adresa, int ss, int bs, bool n, double k) 
            : _ime_agenta(ia), _cijena(cs), _datum(d, m, g), 
              _kupac(ime, d_kupca), _stan(adresa, ss, bs, n, k) {}
    
    void PromijeniStan(const Stan&amp; s)
    {
        _stan = s;
    }
    
    void PrimijeniDatumKupovine(const Datum&amp; d)
    {
        _datum = d;
    }
    
    void PromijeniCijenuProdaje(const double&amp; nova_cijena)
    {
        _cijena = nova_cijena;
    }
    
    void PomjeriDanUnaprijed();
    void PomjeriDanUnazad();
    
    std::string DajImeAgenta() const
    {
        return _ime_agenta;
    }
    
    std::string DajImeKupca() const
    {
        return _kupac.DajImeIPrezime();
</font>    }
    
    Datum DajDatumProdaje() const
    {
        return _datum;
    }
    
    double DajCijenuStana() const
    {
<a name="0"></a><font color="#FF0000"><a href="match58-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_64.gif"/></a>

        return _cijena;
    }
    
    friend bool ProdatPrije(const Prodaja&amp; s1, const Prodaja&amp; s2);
    friend bool SkupljiStan(const Prodaja&amp; s1, const Prodaja&amp; s2)
    {
        return s1.DajCijenuStana() &lt; s2.DajCijenuStana();
    }
    
    void Ispisi() const;
};

bool ProdatPrije(const Prodaja&amp; s1, const Prodaja&amp; s2)
{
    if(s1._datum.DajGodinu() == s2._datum.DajGodinu())
    {
        if(s1._datum.DajMjesec() == s2._datum.DajMjesec())    
            return s1._datum.DajDan() &lt; s2._datum.DajDan();
        return s1._datum.DajMjesec() &lt; s2._datum.DajMjesec();
    }
    return s1._datum.DajGodinu() &lt; s2._datum.DajGodinu();
}

void Prodaja::PomjeriDanUnaprijed()
{
    int g = _datum.DajGodinu();
    int m = _datum.DajMjesec();
    int d = _datum.DajDan();
    
    int broj_dana[]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    if((g % 4 == 0 &amp;&amp; g % 100 != 0) || g % 400 == 0)
        ++broj_dana[1];
        
    if(d == broj_dana[m - 1])
    {
        d = 1;
        if(m == 12)
        {
            ++g;
            m = 1;
        }
        else
         ++m;
    }
    else
        ++d;
    _datum.Postavi(d, m, g);
    
}
void Prodaja::PomjeriDanUnazad()
{
    int g = _datum.DajGodinu();
    int m = _datum.DajMjesec();
    int d = _datum.DajDan();
    
    int broj_dana[]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    if((g % 4 == 0 &amp;&amp; g % 100 != 0) || g % 400 == 0)
        ++broj_dana[1];
        
    if(d == 1)
    {
      if(m == 1)
      {
          --g;
          m = 12;
          d = 31;
      }
      else
      {
          --m;
          d = broj_dana[m - 1];
      }
    }
    else
        --d;
    _datum.Postavi(d, m, g);
}

void Prodaja::Ispisi() const
{
    std::cout &lt;&lt; std::setw(32) &lt;&lt; std::left&lt;&lt; "Ime agenta: " &lt;&lt; _ime_agenta &lt;&lt; "\n";
    std::cout &lt;&lt; std::setw(32) &lt;&lt; std::left&lt;&lt; "Ime kupca: " &lt;&lt; _kupac.DajImeIPrezime() &lt;&lt; " (";
    _kupac.DajDatumRodjenja().Ispisi();
    std::cout &lt;&lt; ")\n";
    std::cout &lt;&lt; std::setw(32) &lt;&lt; std::left&lt;&lt; "Zakazani datum prodaje: ";
    _datum.Ispisi();
    std::cout &lt;&lt; "\nInforamcije o stanu:\n";
    _stan.Ispisi();
}


class Prodaje
{
    std::vector&lt;std::shared_ptr&lt;Prodaja&gt;&gt; _pr;
public:
    Prodaje() {}
    Prodaje(std::initializer_list&lt;Prodaja&gt; sp);
    
    Prodaje(const Prodaje&amp; p)
    {
        _pr.reserve(p._pr.size());
        for(const auto&amp; elem : p._pr)
            _pr.emplace_back(std::make_shared&lt;Prodaja&gt;(*elem) );
    }
    
    Prodaje(Prodaje&amp;&amp; p) : _pr(std::move(p._pr))
    {
        p._pr.resize(0);
    }
    
    Prodaje&amp; operator= (const Prodaje&amp; p);
    Prodaje&amp; operator= (Prodaje&amp;&amp; p);
    
    void RegistrirajProdaju(const std::string ia, double cs, const Datum&amp; d, const Kupac&amp; k, const Stan&amp; s)
    {
        _pr.emplace_back(std::make_shared&lt;Prodaja&gt;(ia, cs, d, k, s));
    }
    
    void RegistrirajProdaju(const std::string ia, double cs, 
        int d, int m, int g, 
        const std::string ime, const Datum&amp; d_kupca, 
        const std::string&amp; adresa, int ss, int bs, bool n, double k) 
    {
        _pr.emplace_back(std::make_shared&lt;Prodaja&gt;
            (ia, cs, Datum{d, m, g}, Kupac{ime, d_kupca}, Stan{adresa, ss, bs, n, k}));
    }
    
    void RegistrirajProdaju(std::shared_ptr&lt;Prodaja&gt; p)
    {
        _pr.push_back(p);
    }
    
    int DajBrojProdaja() const
    {
        return _pr.size();
    }
    
    int DajBrojProdajaNaDatum(const Datum&amp; d) const;
    int DajBrojProdajaOdAgenta(const std::string&amp; s)const
    {
        return std::count_if(_pr.end(), _pr.end(), [&amp;](const std::shared_ptr&lt;Prodaja&gt;&amp; p) {
        return s == p-&gt;DajImeAgenta();
        });
    }
    
    Prodaja&amp; DajNajranijuProdaju()
    {
        return **std::min_element(_pr.begin(), _pr.end(), 
            [](const std::shared_ptr&lt;Prodaja&gt;&amp; p1, const std::shared_ptr&lt;Prodaja&gt;&amp; p2){
                return ProdatPrije(*p1, *p2);
        } );
    }
    
    Prodaja DajNajranijuProdaju() const
    {
        return **std::min_element(_pr.begin(), _pr.end() , 
            [](const std::shared_ptr&lt;Prodaja&gt;&amp; p1, const std::shared_ptr&lt;Prodaja&gt;&amp; p2){
                return ProdatPrije(*p1, *p2);
        } );
    }
    
    Prodaja&amp; DajNajSkupljuProdaju()
    {
        return (**std::max_element(_pr.begin(), _pr.end(), 
            [](const std::shared_ptr&lt;Prodaja&gt;&amp; p1, const std::shared_ptr&lt;Prodaja&gt;&amp; p2){
                return p1-&gt;DajCijenuStana() &lt; p2-&gt;DajCijenuStana();
        } ));
    }
    
    Prodaja DajNajSkupljuProdaju() const
    {
        return (**std::max_element(_pr.begin(), _pr.end(), 
            [](const std::shared_ptr&lt;Prodaja&gt;&amp; p1, const std::shared_ptr&lt;Prodaja&gt;&amp; p2){
                return p1-&gt;DajCijenuStana() &lt; p2-&gt;DajCijenuStana();
        } ));
    }
    
    void IsprazniKolekciju();
    void ObrisiNajRanijuProdaju()
    {
        if(_pr.size() == 0)
            throw std::range_error("Prazna kolekcija");
        auto&amp; r = DajNajranijuProdaju();
        std::remove_if(_pr.begin(), _pr.end(), [&amp;](const std::shared_ptr&lt;Prodaja&gt;&amp; p){
            return p.get() == &amp;r;
        } );
    }
    
    void ObrisiProdajeAgenta(const std::string&amp; ime);
    void ObrisiProdajeNaDatum(const Datum&amp; d);
    
    Prodaja&amp; DajProdaju(int i)
    {
        if( i &lt; 0 &amp;&amp;  i &gt; _pr.size())
            throw std::domain_error("Pogresan parametar"); 
        return *_pr[i];
    }
    
    
    void IspisiProdajuNaDatum(const Datum&amp; d) const;
    
    void IspisiSveProdaje() const;
    
};

void Prodaje::IspisiSveProdaje() const
{
    std::for_each(_pr.begin(), _pr.end(), [] (const std::shared_ptr&lt;Prodaja&gt;&amp; p){
       p-&gt;Ispisi();
       std::cout &lt;&lt; '\n';
    });
}

void Prodaje::IspisiProdajuNaDatum(const Datum&amp; d) const
{
    std::for_each(_pr.begin(), _pr.end(), [&amp;] (const std::shared_ptr&lt;Prodaja&gt;&amp; p){
       const auto&amp; da = p-&gt;DajDatumProdaje();
       if(da.DajDan() == d.DajDan() &amp;&amp; da.DajMjesec() == d.DajMjesec() 
            &amp;&amp; da.DajGodinu() == d.DajGodinu())
       {
           p-&gt;Ispisi();
           std::cout &lt;&lt; '\n';
       }
    });
}

void Prodaje::ObrisiProdajeNaDatum(const Datum&amp; d)
{
    auto it = std::remove_if(_pr.begin(), _pr.end(), [&amp;] (const std::shared_ptr&lt;Prodaja&gt;&amp; p){
       const auto&amp; da = p-&gt;DajDatumProdaje();
       if(da.DajDan() == d.DajDan() &amp;&amp; da.DajMjesec() == d.DajMjesec() 
            &amp;&amp; da.DajGodinu() == d.DajGodinu())
           return true;
       return false;
    });
    _pr.resize(it - _pr.begin());
}

void Prodaje::ObrisiProdajeAgenta(const std::string&amp; ime)
{
    auto it = std::remove_if(_pr.begin(), _pr.end(), [&amp;] (const std::shared_ptr&lt;Prodaja&gt;&amp; p){
       return p-&gt;DajImeAgenta() == ime;
    });
    _pr.resize(it - _pr.begin());
}

void Prodaje::IsprazniKolekciju()
{
    _pr.clear();
}

int Prodaje::DajBrojProdajaNaDatum(const Datum&amp; d) const
{
    return std::count_if(_pr.begin(), _pr.end(), [&amp;](const std::shared_ptr&lt;Prodaja&gt;&amp; p) {
        return d.DajDan() == p-&gt;DajDatumProdaje().DajDan() &amp;&amp; d.DajMjesec() == p-&gt;DajDatumProdaje().DajMjesec() &amp;&amp;
            d.DajGodinu() == p-&gt;DajDatumProdaje().DajGodinu();
    });
}

Prodaje&amp; Prodaje::operator= (Prodaje&amp;&amp; p)
{
    if(&amp;p == this)
        return *this;
    
    _pr = std::move(p._pr);
    
    p._pr.resize(0);

    return *this;
}

Prodaje&amp; Prodaje::operator= (const Prodaje&amp; p)
{
    if(&amp;p == this)
        return *this;
        
    _pr.resize(0);
    _pr.reserve(p._pr.size());
    for(const auto&amp; elem : p._pr)
        _pr.emplace_back(std::make_shared&lt;Prodaja&gt;(*elem) );
            
    return *this;
}



Prodaje::Prodaje(std::initializer_list&lt;Prodaja&gt; p)
{
    _pr.reserve(p.size());
    for(const auto&amp; elem : p)
        _pr.emplace_back(std::make_shared&lt;Prodaja&gt;(elem) );
</font>}

int main ()
{
 	return 0;
}</pre>
</body>
</html>
