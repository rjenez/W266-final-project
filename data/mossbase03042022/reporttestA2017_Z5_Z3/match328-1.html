<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/A2017/Z5/Z3/student3567.c</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/A2017/Z5/Z3/student7080.c<p></p><pre>
#include &lt;stdio.h&gt;

#include &lt;stdlib.h&gt;



#include &lt;stdbool.h&gt;

#include &lt;string.h&gt;



#define KAPACITET           200

#define datoteka            "C:\\Users\\ramiz\\Desktop\\raspored.dat"

#define MAX_SAT				23

#define MAX_MINUT			59

#define MAX_SEKUND			59



#define POCETNO_VRIJEME		9

#define KRAJNJE_VRIJEME		14

#define ZADNJE_VRIJEME		19



char* DAN[6] = {"PON", "UTO", "SRI", "CET", "PET", "SUB"};

int TEMP = -1;





struct Vrijeme {

    int sati, minute, sekunde;

};



struct Cas {

    char predmet[10];

    int dan_u_sedmici;

    struct Vrijeme pocetak, kraj;

};





/////////////////////////////////////////////////// functions

/* 		validnost vremena		*/

bool valid_time(int sat, int minut, int sekund) {

	if(	sat &lt;= MAX_SAT &amp;&amp; sat &gt;= 0 &amp;&amp; 

		minut &lt;= MAX_MINUT &amp;&amp; minut &gt;= 0 &amp;&amp;

		sekund &lt;= MAX_SEKUND &amp;&amp; sekund &gt;= 0)

			return true;

	else

		return false;

}



/* 		ispis reda tabele		*/

void ispisi_red(struct Cas raspored[], int broj_casova, int sat) {

	int i, dan;

	bool postavljen;

	struct Cas cas_ispis;

	for(dan = 1; dan &lt;= 6; dan++) {

		strcpy(cas_ispis.predmet , "");

		postavljen = false;

		

		for(i = 0; i &lt; broj_casova; i++) {

			if(raspored[i].dan_u_sedmici == dan &amp;&amp; raspored[i].pocetak.sati &lt;= sat) {

				if (!postavljen) 

					if(raspored[i].pocetak.sati == sat) {

						cas_ispis = raspored[i];

						postavljen;

					}

				else {

					if((raspored[i].pocetak.sati &lt;= cas_ispis.pocetak.sati &amp;&amp; raspored[i].kraj.sati &gt;= cas_ispis.kraj.sati &amp;&amp; raspored[i].pocetak.minute &lt; cas_ispis.pocetak.minute) ||

<a name="1"></a><font color="#00FF00"><a href="match328-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

						(raspored[i].pocetak.sati == cas_ispis.pocetak.sati &amp;&amp; raspored[i].pocetak.minute &lt; cas_ispis.pocetak.minute) ||
</font>
						(raspored[i].pocetak.sati == cas_ispis.pocetak.sati &amp;&amp; raspored[i].kraj.minute == 0) ||

						(raspored[i].pocetak.sati &lt;= sat &amp;&amp; raspored[i].kraj.minute &lt;= cas_ispis.pocetak.minute &amp;&amp; raspored[i].kraj.minute &gt; 0) ||

						(raspored[i].pocetak.sati &lt;= sat &amp;&amp; raspored[i].kraj.sati &gt; sat &amp;&amp; raspored[i].pocetak.sati != raspored[i].kraj.sati))

							cas_ispis = raspored[i];

				}

			}

		}

		printf("%-9s", cas_ispis.predmet);

	}

}



/////////////////////////////////////////////// !functions

/* 		citanje datoteke		*/

int ucitaj_datoteku(struct Cas raspored[]) {

    int i = 0;

    FILE *fp;

    if((fp = fopen(datoteka, "r+")) == NULL) {

        printf("Ne postoji takva datoteka.\n");

        exit(1);

    }

    int ucitanih;

    while ((ucitanih = fscanf(fp, "%9s %d %d %d %d %d %d %d\n",   &amp;raspored[i].predmet, &amp;raspored[i].dan_u_sedmici,

        &amp;raspored[i].pocetak.sati, &amp;raspored[i].pocetak.minute, &amp;raspored[i].pocetak.sekunde,

        &amp;raspored[i].kraj.sati, &amp;raspored[i].kraj.minute, &amp;raspored[i].kraj.sekunde)) != EOF) {

        

		if(i &gt;= KAPACITET)

            break;

            

        if(ucitanih == 8)

        	if(raspored[i].dan_u_sedmici &gt;= 1 &amp;&amp; raspored[i].dan_u_sedmici &lt;= 6 &amp;&amp;

	        	raspored[i].pocetak.sati &lt;= raspored[i].kraj.sati &amp;&amp;

	        	raspored[i].pocetak.sati &gt;= POCETNO_VRIJEME &amp;&amp; raspored[i].pocetak.sati &lt;= KRAJNJE_VRIJEME &amp;&amp;

	        	raspored[i].kraj.sati &gt;= POCETNO_VRIJEME &amp;&amp; raspored[i].kraj.sati &lt;= ZADNJE_VRIJEME &amp;&amp;

				valid_time(raspored[i].pocetak.sati, raspored[i].pocetak.minute, raspored[i].pocetak.sekunde) &amp;&amp;

				valid_time(raspored[i].kraj.sati, raspored[i].kraj.minute, raspored[i].kraj.sekunde)) 

        			i++;

    }

    return i;

}



/* 		spremanje datoteke		*/

int zapisi_datoteku(struct Cas raspored[], int broj_casova) {

	FILE *fp = fopen(datoteka, "ab+");

	if (fp == NULL)

	{

	    printf("Greska pri otvaranju datoteke.\n");

	    exit(1);

	}

	int i;

	int spremljeno = 0;

	for(i = 0; i &lt; broj_casova; i++) {

		fprintf(fp, "%-9s %d %d %d %d %d %d %d\n", raspored[i].predmet, raspored[i].dan_u_sedmici,

    	raspored[i].pocetak.sati, raspored[i].pocetak.minute, raspored[i].pocetak.sekunde,

        raspored[i].kraj.sati, raspored[i].kraj.minute, raspored[i].kraj.sekunde);

        fprintf(fp, "\n");

        spremljeno++;

	}

	printf("Spremljeno %d casova.\n", i);

	fclose(fp);

}



/* 		dodavanje casa		*/

int dodaj_cas(struct Cas raspored[], int broj_casova,

    const char* predmet, int trajanje) {

	

	int i, j;

	int dan, vrijeme;

	

	/// reset

	bool zauzeti[7][20];

	for(i = POCETNO_VRIJEME; i &lt;= ZADNJE_VRIJEME; i++) 

		for(j = 1; j &lt;= 6; j++) 

			zauzeti[j][i] = false;	

			

	/// postavka

	for(i = 0; i &lt; broj_casova; i++) {

		if(raspored[i].predmet != "") {

			zauzeti[raspored[i].dan_u_sedmici][raspored[i].pocetak.sati] = true;

			

			if(raspored[i].kraj.sati &gt; raspored[i].pocetak.sati) {

				int j;

				for(j = raspored[i].pocetak.sati; j &lt; raspored[i].kraj.sati; j++) 

					zauzeti[raspored[i].dan_u_sedmici][j] = true;

				if(raspored[i].kraj.minute &gt; 0) 

					zauzeti[raspored[i].dan_u_sedmici][raspored[i].kraj.sati] = true;	

			}

			else {

				if(raspored[i].kraj.minute &gt; 0) 

					zauzeti[raspored[i].dan_u_sedmici][raspored[i].kraj.sati] = true;

			}

		}

	}

	

	/// search

	for(dan = 1; dan &lt;= 6; dan++) {

		int duzina = 0;

		vrijeme = POCETNO_VRIJEME;

		while(vrijeme &lt;= KRAJNJE_VRIJEME)

		{

			duzina = 0;

			while(!zauzeti[dan][vrijeme] &amp;&amp; vrijeme-trajanje &lt;= KRAJNJE_VRIJEME) {

				duzina++;

				vrijeme++;

				if(duzina == trajanje &amp;&amp; vrijeme-trajanje &lt;= KRAJNJE_VRIJEME) {

					if(broj_casova+1 &lt; KAPACITET) {

						

						struct Cas n_cas;

						strcpy(n_cas.predmet, predmet);

						n_cas.dan_u_sedmici = dan;

						n_cas.pocetak.sati = vrijeme-trajanje; n_cas.pocetak.minute = 0; n_cas.pocetak.sekunde = 0;

						n_cas.kraj.sati = vrijeme; n_cas.kraj.minute = 0; n_cas.kraj.sekunde = 0;

				

						raspored[broj_casova] = n_cas;

						return 1;

					}

					else {

						printf("Kapacitet popunjen!\n");

						return 0;

					}

				}

			}

			vrijeme++;

		}

	}

	return 0;

}



/* 		provjera preklapanja		*/

int preklapanje(struct Cas raspored[], int broj_casova,

    struct Cas cas) {

	int i;

	int dan = cas.dan_u_sedmici;

	for(i = 0; i &lt; broj_casova; i++) {

		if(raspored[i].dan_u_sedmici == dan) {

			//// logicko rje≈°enje zbog jednostavnosti (negacija nepoklapanja)

			if(!(((cas.kraj.sati &lt; raspored[i].pocetak.sati) || ((cas.kraj.sati == raspored[i].pocetak.sati) &amp;&amp; (cas.kraj.minute &lt;= raspored[i].pocetak.minute))) ||

			((raspored[i].kraj.sati &lt; cas.pocetak.sati) || ((cas.pocetak.sati == raspored[i].kraj.sati) &amp;&amp; (cas.pocetak.minute &gt;= raspored[i].kraj.minute)))))

			{

				TEMP = i;

				return 1;

			}

		}

	}

	return 0;    	

}



/* 		ispis rasporeda		*/

void ispis_rasporeda(struct Cas raspored[], int broj_casova) {

	//// header

	int i;

	printf("\n%-6s", "");

	for(i = 1; i &lt;= 6; i++) {

		printf("%-9s", DAN[i-1]);

	}

	printf("\n");

	

	/// ispis za dane

	int sati;

	for(sati = POCETNO_VRIJEME; sati &lt;= KRAJNJE_VRIJEME; sati++) {

		if(sati == POCETNO_VRIJEME) 

			printf("%d:00  ", sati);

		else

			printf("%d:00 ", sati);

			

		ispisi_red(raspored, broj_casova, sati);

		printf("\n");

	}

	printf("\n");

}



/* 		ispis dana		*/

void ispisi_dan(struct Cas raspored[], int broj_casova, int dan) {

	int i;

	int poredak = 0;

	printf("Uneseni su casovi:\n");

	for(i = 0; i &lt; broj_casova; i++)

		if(raspored[i].dan_u_sedmici == dan)  {

			poredak++;

<a name="0"></a><font color="#FF0000"><a href="match328-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

			printf("%d) %-9s (%d:%d - %d:%d)\n", poredak, raspored[i].predmet, raspored[i].pocetak.sati, raspored[i].pocetak.minute, raspored[i].kraj.sati, raspored[i].kraj.minute);

		}

}



/* 		funkcija promjene casa		*/

void promijeni_cas(struct Cas raspored[], int broj_casova, int dan,

    int redni_broj, struct Cas promjena) {
</font>
    int i = 0;

	int pozicija = 0;

	bool postoji = false;

	for(i = 0; i &lt; broj_casova; i++) {

		if(raspored[i].dan_u_sedmici == dan) {

			pozicija++;

			if(pozicija == redni_broj) {

				postoji = true;

				if(preklapanje(raspored, broj_casova, promjena) == 0) {

					raspored[i] = promjena;

					printf("Cas izmijenjen.\n");

				}

				else if(TEMP == i) {

					raspored[i] = promjena;

					printf("Cas izmijenjen.\n");

				}

				else 

					printf("Cas nije izmijenjen (preklapanje).\n");

				break;

			} 

		} 	

	}

	if(!postoji) {

		printf("Neispravan redni broj casa.\n");

	}

}



/* 		brisanje casa		*/

void obrisi_cas(struct Cas raspored[], int broj_casova, int dan,

    int redni_broj) {

    int i = 0;

	int pozicija = 0;

	bool postoji = false;

	for(i = 0; i &lt; broj_casova; i++) {

		if(raspored[i].dan_u_sedmici == dan) {

			pozicija++;

			if(pozicija == redni_broj) {

				int j;

				for(j = i; j &lt; broj_casova-1; j++)

					raspored[j]=raspored[j+1];

				postoji = true;

				printf("Cas obrisan.\n");

				TEMP = 1;

				break;

			} 

		} 	

	}

	if(!postoji) {

		printf("Neispravan redni broj casa.\n");

	}	

}



/* 		KREIRAJ GLAVNI MENI		*/

void kreiraj_menu(struct Cas raspored[], int broj_casova) {

	int opcija;

	int dan, cas;

	

	printf("1) Ispis rasporeda\n2) Dodavanje casa\n3) Promjena casa\n4) Brisanje casa\n0) Kraj rada\nIzaberite opciju: ");

	scanf("%d", &amp;opcija);

	

	if(opcija == 1) {

		ispis_rasporeda(raspored, broj_casova);

		kreiraj_menu(raspored, broj_casova);

	}

	else if(opcija == 2) {

		char naziv[10];

		int duzina;

		printf("Unesite naziv predmeta: "); scanf("%9s", &amp;naziv);

		printf("Unesite broj casova: "); scanf("%d", &amp;duzina);

		if(duzina &lt; 1 || duzina &gt; 10 || naziv == "") {

			printf("Pogresan unos.\n");

			kreiraj_menu(raspored, broj_casova);

		}

		else {

			int dodano = dodaj_cas(raspored, broj_casova, naziv, duzina);

			if(dodano == 1) broj_casova++;

			else printf("Nema dovoljno mjesta u rasporedu za %d casova.", duzina);

			ispis_rasporeda(raspored, broj_casova);

			kreiraj_menu(raspored, broj_casova);

		}

	}

	else if(opcija == 3) {

		char naziv[10];

		int poc_h, poc_min, kraj_h, kraj_min;

		

		printf("Unesite dan (1=ponedjeljak, 2=utorak..., 6=subota): "); scanf("%d", &amp;dan);

		if(dan &gt;= 1 &amp;&amp; dan &lt;= 6) {

			ispisi_dan(raspored, broj_casova, dan);

		}

		else {

			printf("Pogresan unos.\n");

			kreiraj_menu(raspored, broj_casova);	

		}

		printf("Izaberite koji cas zelite promijeniti: "); scanf("%d", &amp;cas);

		printf("Naziv predmeta: "); scanf("%s", &amp;naziv);

		printf("Vrijeme pocetka: "); scanf("%d : %d", &amp;poc_h, &amp;poc_min);

		printf("Vrijeme zavrsetka: "); scanf("%d : %d", &amp;kraj_h, &amp;kraj_min);

		if(valid_time(poc_h, poc_min, 0) &amp;&amp; valid_time(kraj_h, kraj_min, 0) &amp;&amp; naziv != "" &amp;&amp; 

			poc_h &gt;= POCETNO_VRIJEME &amp;&amp; poc_h &lt;= KRANJE_VRIJEME &amp;&amp; 

			kraj_h &gt;= POCETNO_VRIJEME &amp;&amp; kraj_h &lt;= ZADNJE_VRIJEME) 

		{

			struct Cas n_cas;

			

			strcpy(n_cas.predmet, naziv);

			n_cas.dan_u_sedmici = dan;

			n_cas.pocetak.sati = poc_h; n_cas.pocetak.minute = poc_min; n_cas.pocetak.sekunde = 0;

			n_cas.kraj.sati = kraj_h; n_cas.kraj.minute = kraj_min; n_cas.kraj.sekunde = 0;

			

			promijeni_cas(raspored, broj_casova, dan, cas, n_cas);	

			kreiraj_menu(raspored, broj_casova);

		}

		else {

			printf("Neispravan redni broj casa.\n");

			kreiraj_menu(raspored, broj_casova);

		}	

	}

	else if(opcija == 4) {

		printf("Unesite dan (1=ponedjeljak, 2=utorak..., 6=subota): "); scanf("%d", &amp;dan);

		if(dan &gt;= 1 &amp;&amp; dan &lt;= 6) {

			ispisi_dan(raspored, broj_casova, dan);

		}

		else {

			printf("Pogresan unos.\n");

			kreiraj_menu(raspored, broj_casova);	

		}



		printf("Izaberite koji cas zelite obrisati: "); scanf("%d", &amp;cas);

		TEMP = 0;

		obrisi_cas(raspored, broj_casova, dan, cas);

		if(TEMP == 1) broj_casova--;

		kreiraj_menu(raspored, broj_casova);

	}

	else if(opcija == 0) {

		zapisi_datoteku(raspored, broj_casova);

		exit(0);

	}

	else {

		printf("Pogresan unos.");

		exit(1);

	}

}



//////////////////////////////

/* 		main function		*/

int main() {

    struct Cas raspored[KAPACITET];

    int broj_casova = ucitaj_datoteku(raspored);

    

    kreiraj_menu(raspored, broj_casova);

    exit(0);

}</pre>
</body>
</html>
