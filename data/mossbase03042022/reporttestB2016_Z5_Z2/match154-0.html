<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student1329.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student1329.cpp<p></p><pre>
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;map&gt;
#include &lt;stdexcept&gt;
#include &lt;algorithm&gt;
#include &lt;memory&gt;

struct Korisnik {
    std::string ime, prezime, adresa, telefon;
};

class Knjiga {
    std::string naslov_knjige, ime_pisca, zanr;
    int godina_izdavanja;
<a name="1"></a><font color="#00FF00"><a href="match154-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_19.gif"/></a>

    Korisnik* kod_koga_je;
public:
    Knjiga(std::string naslov_knjige, std::string ime_pisca, std::string zanr, int godina_izdavanja);
    std::string DajNaslov() const { return naslov_knjige; }
    std::string DajAutora() const { return ime_pisca; }
    std::string DajZanr() const { return zanr; }
    int DajGodinuIzdavanja() const { return godina_izdavanja; }
    Korisnik* DajKodKogaJe() const { return kod_koga_je; }
    void ZaduziKnjigu(Korisnik &amp;k) { kod_koga_je = &amp;k; }
    void RazduziKnjigu() { kod_koga_je = nullptr; }
    bool DaLiJeZaduzena();
};

inline Knjiga::Knjiga(std::string naslov_knjige, std::string ime_pisca, std::string zanr, int godina_izdavanja) : naslov_knjige(naslov_knjige), ime_pisca(ime_pisca), zanr(zanr), godina_izdavanja(godina_izdavanja), kod_koga_je(nullptr) {}

inline bool Knjiga::DaLiJeZaduzena() {
    if(kod_koga_je == nullptr) return false;
    return true;
}

class Biblioteka {
    std::map&lt;int, std::shared_ptr&lt;Korisnik&gt;&gt; mapa_korisnika;
    std::map&lt;int, std::shared_ptr&lt;Knjiga&gt;&gt; mapa_knjiga;
    void PostojiSaClanskim(int clanski_broj) {
        for(auto it = mapa_korisnika.begin(); it != mapa_korisnika.end(); it++) {
            if(it-&gt;first == clanski_broj) throw std::logic_error("Izuzetak");
        }
    }
    void PostojiSaEvid(int evidencijski_broj) {
        for(auto it = mapa_knjiga.begin(); it != mapa_knjiga.end(); it++) {
            if(it-&gt;first == evidencijski_broj) throw std::logic_error("Izuzetak");
        }
    }
public:
    Biblioteka() = default;
    Biblioteka(const Biblioteka &amp;b);
    Biblioteka(Biblioteka &amp;&amp;b);
    Biblioteka &amp;operator = (const Biblioteka &amp;b);
    Biblioteka &amp;operator = (Biblioteka &amp;&amp;b);
    void RegistrirajNovogKorisnika(int clanski_broj, std::string ime, std::string prezime, std::string adresa, std::string telefon);
</font>    void RegistrirajNovuKnjigu(int evidencijski_broj, std::string naslov, std::string ime_pisca, std::string zanr, int godina_izdavanja);
    Korisnik &amp;NadjiKorisnika(int clanski_broj);
<a name="0"></a><font color="#FF0000"><a href="match154-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_36.gif"/></a>

    Knjiga &amp;NadjiKnjigu(int evidencijski_broj);
    void IzlistajKorisnike() const;
    void IzlistajKnjige() const;
    void ZaduziKnjigu(int evidencijski_broj, int clanski_broj);
    void RazduziKnjigu(int evidencijski_broj);
    void PrikaziZaduzenja(int clanski_broj) const;
};

Biblioteka::Biblioteka(const Biblioteka &amp;b) : mapa_korisnika(b.mapa_korisnika), mapa_knjiga(b.mapa_knjiga) {
    for(auto it = mapa_korisnika.begin(); it != mapa_korisnika.end(); it++) {
        std::shared_ptr&lt;Korisnik&gt; novi(std::make_shared&lt;Korisnik&gt;());
        *novi = *(it-&gt;second);
        it-&gt;second = novi;
    }
    for(auto it = mapa_knjiga.begin(); it != mapa_knjiga.end(); it++) {
        it-&gt;second = std::make_shared&lt;Knjiga&gt;(*(it-&gt;second));
    }
}

Biblioteka::Biblioteka(Biblioteka &amp;&amp;b) : mapa_korisnika(std::move(b.mapa_korisnika)), mapa_knjiga(std::move(b.mapa_knjiga)) {}

Biblioteka &amp;Biblioteka::operator = (const Biblioteka &amp;b) {
    mapa_korisnika = b.mapa_korisnika; mapa_knjiga = b.mapa_knjiga;
    
    for(auto it = mapa_korisnika.begin(); it != mapa_korisnika.end(); it++) {
        std::shared_ptr&lt;Korisnik&gt; novi(std::make_shared&lt;Korisnik&gt;());
        *novi = *(it-&gt;second);
        it-&gt;second = novi;
    }
    for(auto it = mapa_knjiga.begin(); it != mapa_knjiga.end(); it++) {
        it-&gt;second = std::make_shared&lt;Knjiga&gt;(*(it-&gt;second));
    }
    return *this;
} 

Biblioteka &amp;Biblioteka::operator = (Biblioteka &amp;&amp;b) {
    mapa_korisnika = std::move(b.mapa_korisnika);
    mapa_knjiga = std::move(b.mapa_knjiga);
    return *this;
}

void Biblioteka::RegistrirajNovogKorisnika(int clanski_broj, std::string ime, std::string prezime, std::string adresa, std::string telefon) {
    std::shared_ptr&lt;Korisnik&gt; pok(std::make_shared&lt;Korisnik&gt;());
    Korisnik k1{ime, prezime, adresa, telefon};
    *pok = k1;
    try {
        PostojiSaClanskim(clanski_broj);
        mapa_korisnika[clanski_broj] = pok;
    }
    catch(...) { throw std::logic_error("Korisnik vec postoji"); }
}

void Biblioteka::RegistrirajNovuKnjigu(int evidencijski_broj, std::string naslov, std::string ime_pisca, std::string zanr, int godina_izdavanja) {
    std::shared_ptr&lt;Knjiga&gt; pok(std::make_shared&lt;Knjiga&gt;(naslov, ime_pisca, zanr, godina_izdavanja));
    try {
        PostojiSaEvid(evidencijski_broj);
        mapa_knjiga[evidencijski_broj] = pok;
    }
    catch(...) { throw std::logic_error("Knjiga vec postoji"); }
}

Korisnik &amp;Biblioteka::NadjiKorisnika(int clanski_broj) {
    for(auto it = mapa_korisnika.begin(); it != mapa_korisnika.end(); it++)
        if(it-&gt;first == clanski_broj) return *(it-&gt;second);
    throw std::logic_error("Korisnik nije nadjen");
}

Knjiga &amp;Biblioteka::NadjiKnjigu(int evidencijski_broj) {
    for(auto it = mapa_knjiga.begin(); it != mapa_knjiga.end(); it++) {
        if(it-&gt;first == evidencijski_broj) return *(it-&gt;second);
    }
    throw std::logic_error("Knjiga nije nadjena");
}

void Biblioteka::IzlistajKorisnike() const {
    for(auto it = mapa_korisnika.begin(); it != mapa_korisnika.end(); it++) {
        std::cout &lt;&lt; "Clanski broj: " &lt;&lt; it-&gt;first &lt;&lt; std::endl;
</font>        std::cout &lt;&lt; "Ime i prezime: " &lt;&lt; it-&gt;second-&gt;ime &lt;&lt; " " &lt;&lt; it-&gt;second-&gt;prezime &lt;&lt; std::endl;
        std::cout &lt;&lt; "Adresa: " &lt;&lt; it-&gt;second-&gt;adresa &lt;&lt; std::endl;
<a name="4"></a><font color="#FF00FF"><a href="match154-1.html#4" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_2.gif"/></a>

        std::cout &lt;&lt; "Broj telefona: " &lt;&lt; it-&gt;second-&gt;telefon &lt;&lt; std::endl;
        std::cout &lt;&lt; std::endl;
    }
}

void Biblioteka::IzlistajKnjige() const {
    for(auto it = mapa_knjiga.begin(); it != mapa_knjiga.end(); it++) {
</font>        std::cout &lt;&lt; "Evidencijski broj: " &lt;&lt; it-&gt;first &lt;&lt; std::endl;
        std::cout &lt;&lt; "Naslov: " &lt;&lt; it-&gt;second-&gt;DajNaslov() &lt;&lt; std::endl;
        std::cout &lt;&lt; "Pisac: " &lt;&lt; it-&gt;second-&gt;DajAutora() &lt;&lt; std::endl;
        std::cout &lt;&lt; "Zanr: " &lt;&lt; it-&gt;second-&gt;DajZanr() &lt;&lt; std::endl;
        std::cout &lt;&lt; "Godina izdavanja: " &lt;&lt; it-&gt;second-&gt;DajGodinuIzdavanja() &lt;&lt; std::endl;
<a name="2"></a><font color="#0000FF"><a href="match154-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_15.gif"/></a>

        if(it-&gt;second-&gt;DaLiJeZaduzena()) std::cout &lt;&lt; "Zaduzena kod korisnika: " &lt;&lt; it-&gt;second-&gt;DajKodKogaJe()-&gt;ime &lt;&lt; " " &lt;&lt; it-&gt;second-&gt;DajKodKogaJe()-&gt;prezime &lt;&lt; std::endl;
        std::cout &lt;&lt; std::endl;
    }
}

void Biblioteka::ZaduziKnjigu(int evidencijski_broj, int clanski_broj) {
    auto it_knjiga(mapa_knjiga.find(evidencijski_broj));
    if(it_knjiga == mapa_knjiga.end()) throw std::logic_error("Knjiga nije nadjena");
    auto it_korisnik(mapa_korisnika.find(clanski_broj));
    if(it_korisnik == mapa_korisnika.end()) throw std::logic_error("Korisnik nije nadjen");
    if(it_knjiga-&gt;second-&gt;DaLiJeZaduzena()) throw std::logic_error("Knjiga vec zaduzena");
    it_knjiga-&gt;second-&gt;ZaduziKnjigu(*(it_korisnik-&gt;second));
}

void Biblioteka::RazduziKnjigu(int evidencijski_broj) {
    auto it_knjiga(mapa_knjiga.find(evidencijski_broj));
    if(it_knjiga == mapa_knjiga.end()) throw std::logic_error("Knjiga nije nadjena");
    if(!it_knjiga-&gt;second-&gt;DaLiJeZaduzena()) throw std::logic_error("Knjiga nije zaduzena");
    it_knjiga-&gt;second-&gt;RazduziKnjigu();
}

void Biblioteka::PrikaziZaduzenja(int clanski_broj) const {
    auto it_korisnik(mapa_korisnika.find(clanski_broj));
    if(it_korisnik == mapa_korisnika.end()) throw std::logic_error("Korisnik nije nadjen");
    bool ima_zaduzenja(false);
    for(auto it = mapa_knjiga.begin(); it != mapa_knjiga.end(); it++) {
        if(it-&gt;second-&gt;DajKodKogaJe() == it_korisnik-&gt;second.get()) {
            std::cout &lt;&lt; "Evidencijski broj: " &lt;&lt; it-&gt;first &lt;&lt; std::endl;
            std::cout &lt;&lt; "Naslov: " &lt;&lt; it-&gt;second-&gt;DajNaslov() &lt;&lt; std::endl;
</font>            std::cout &lt;&lt; "Pisac: " &lt;&lt; it-&gt;second-&gt;DajAutora() &lt;&lt; std::endl;
            std::cout &lt;&lt; "Zanr: " &lt;&lt; it-&gt;second-&gt;DajZanr() &lt;&lt; std::endl;
<a name="3"></a><font color="#00FFFF"><a href="match154-1.html#3" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_3.gif"/></a>

            std::cout &lt;&lt; "Godina izdavanja: " &lt;&lt; it-&gt;second-&gt;DajGodinuIzdavanja() &lt;&lt; std::endl;
            std::cout &lt;&lt; std::endl;
            ima_zaduzenja = true;
        }
    }
    if(!ima_zaduzenja) std::cout &lt;&lt; "Nema zaduzenja za tog korisnika!" &lt;&lt; std::endl;
}

int main() {
</font>    
    
    
    return 0;
}
</pre>
</body>
</html>
