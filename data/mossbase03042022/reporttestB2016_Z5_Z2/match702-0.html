<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student9207.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student9207.cpp<p></p><pre>
/B16/17 (ZadaÄ‡a 5, Zadatak 2)
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;map&gt;
#include &lt;stdexcept&gt;
#include &lt;algorithm&gt;
#include&lt;memory&gt;
struct Korisnik{
  std::string ime,prezime,adresa,telefon;
};
class Knjiga{
  std::string naslov,ime_pisca,zanr;
  int godina_izdavanja;
  Korisnik * kod_koga_je;
  public:
  Knjiga(std::string naslov,std::string ime_pisca,std::string zanr,int godina_izdavanja):kod_koga_je(nullptr){
         Knjiga::naslov=naslov,Knjiga::ime_pisca=ime_pisca;Knjiga::zanr=zanr; Knjiga::godina_izdavanja=godina_izdavanja;
  }
Knjiga(const Knjiga &amp;k):naslov(k.naslov),ime_pisca(k.ime_pisca),zanr(k.zanr),godina_izdavanja(k.godina_izdavanja),kod_koga_je(nullptr){}
 
  std::string DajNaslov() const{return naslov;}
  std::string DajAutora() const{return ime_pisca;}
  std::string DajZanr() const {return zanr;}
  int DajGodinuIzdavanja() const{return godina_izdavanja;}
  Korisnik *DajKodKogaJe() const{return kod_koga_je;}
  void ZaduziKnjigu(Korisnik &amp;k ){kod_koga_je= &amp;k;}
  void RazduziKnjigu(){kod_koga_je=nullptr;}
  bool DaLiJeZaduzena(){return kod_koga_je!=nullptr;}
  
};

class Biblioteka{
<a name="1"></a><font color="#00FF00"><a href="match702-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

  std::map&lt;int,std::shared_ptr&lt;Korisnik&gt;&gt;korisnik;
  std::map&lt;int,std::shared_ptr&lt;Knjiga&gt;&gt; knjiga;
  public:
  Biblioteka(){}
  Biblioteka(const Biblioteka &amp; b);
  Biblioteka(Biblioteka &amp;&amp; b);
  Biblioteka &amp;operator=(const Biblioteka &amp;b);
  Biblioteka &amp;operator=(Biblioteka &amp;&amp;b);
</font>  void RegistrirajNovogKorisnika(int clanskibr,std::string ime,std::string prezime,std::string adresa,std::string telefon);
<a name="0"></a><font color="#FF0000"><a href="match702-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_2.gif"/></a>

  void  RegistrirajNovuKnjigu(int br_knjige,std::string naslov,std::string ime,std::string zanr,int godina);
  Korisnik &amp;NadjiKorisnika(int clanskibr)const;
  Knjiga &amp;NadjiKnjigu(int brojknjige)const;
  void IzlistajKorisnike()const;
  void IzlistajKnjige()const;
  void ZaduziKnjigu(int evidencijski_br,int clanski_br);
  void RazduziKnjigu(int evidencijski_br);
  void PrikaziZaduzenja(int clanski_br)const;
</font>};
<a name="4"></a><font color="#FF00FF"><a href="match702-1.html#4" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

void Biblioteka::RegistrirajNovogKorisnika(int clanskibr,std::string ime,std::string prezime,std::string adresa,std::string telefon){
    auto it (korisnik.find(clanskibr));
    if(it!=korisnik.end()) throw std::logic_error("Korisnik vec postoji");
</font>       std::shared_ptr&lt;Korisnik&gt; k(new Korisnik);
        k-&gt;ime=ime;k-&gt;prezime=prezime;k-&gt;adresa=adresa;k-&gt;telefon=telefon;
        korisnik.insert(std::make_pair(clanskibr,k));
  }
Biblioteka::Biblioteka(const Biblioteka &amp;b){
  for(auto i(b.knjiga.begin());i!=b.knjiga.end();i++){
     Knjiga k(*(i-&gt;second));
     std::shared_ptr&lt;Knjiga &gt; pok(std::make_shared&lt; Knjiga&gt;(k));
     knjiga.insert(std::make_pair(i-&gt;first,pok));
  }
  for(auto it(b.korisnik.begin());it!=b.korisnik.end();it++){
    Korisnik k(*(it-&gt;second));
    std::shared_ptr&lt;Korisnik&gt; p(std::make_shared&lt; Korisnik&gt;(k));
    korisnik.insert(std::make_pair(it-&gt;first,p));
  }
}
Biblioteka::Biblioteka(Biblioteka &amp;&amp; b){
  knjiga=b.knjiga;
  for(auto it(b.knjiga.begin());it!=b.knjiga.end();it++) it-&gt;second=nullptr;
  korisnik=b.korisnik;
  for(auto it (b.korisnik.begin());it!=b.korisnik.end();it++) it-&gt;second=nullptr;
}

Biblioteka &amp;Biblioteka::operator=(const Biblioteka &amp;b){
  if(&amp;b!=this){
    for(auto it(korisnik.begin());it!=korisnik.end();it++)  korisnik.erase(it-&gt;first);
    for(auto it(knjiga.begin());it!=knjiga.end();it++)  knjiga.erase(it-&gt;first);
    
    for(auto it(b.knjiga.begin());it!=b.knjiga.end();it++){
        Knjiga k(*(it-&gt;second));
        std::shared_ptr&lt;Knjiga&gt; p(std::make_shared&lt; Knjiga&gt;(k));
        knjiga.insert(std::make_pair(it-&gt;first,p));
    }
    for(auto it(b.korisnik.begin());it!=b.korisnik.end();it++){
      Korisnik k(*(it-&gt;second));
      std::shared_ptr&lt;Korisnik&gt; p(std::make_shared&lt;Korisnik&gt;(k));
      korisnik.insert(std::make_pair(it-&gt;first,p));
    }
    
  }
  return *this;
}
Biblioteka &amp; Biblioteka::operator =(Biblioteka &amp;&amp;b){
  if(&amp;b!=this){
    for(auto it(korisnik.begin());it!=korisnik.end();it++) korisnik.erase(it-&gt;first);
    for(auto it(knjiga.begin());it!=knjiga.end();it++) knjiga.erase(it-&gt;first);
    knjiga=b.knjiga;
    for(auto it(b.knjiga.begin());it!=knjiga.end();it++)it-&gt;second=nullptr;
      korisnik=b.korisnik;
      for(auto it(b.korisnik.begin());it!=b.korisnik.end();it++) it-&gt;second=nullptr;
    
  }
  return *this;
}

<a name="2"></a><font color="#0000FF"><a href="match702-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

void Biblioteka::RegistrirajNovuKnjigu(int br_knjige,std::string naslov,std::string ime,std::string zanr,int godina){
   auto it(knjiga.find(br_knjige));
  if(it!=knjiga.end()) throw std::logic_error ("Knjiga vec postoji");
</font>   knjiga.insert(std::make_pair(br_knjige,std::make_shared&lt; Knjiga&gt;(naslov,ime,zanr,godina)));
   
}
Korisnik&amp; Biblioteka::NadjiKorisnika(int clanskibr)const{
   auto it(korisnik.find(clanskibr));
   if(it==korisnik.end()) throw std::logic_error("Korisnik nije nadjen");
<a name="5"></a><font color="#FF0000"><a href="match702-1.html#5" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

   else return *(it-&gt;second);
}
Knjiga &amp; Biblioteka::NadjiKnjigu(int brojknjige)const{
  auto it(knjiga.find(brojknjige));
  if(it==knjiga.end()) throw std::logic_error("Knjiga nije nadjena");
</font><a name="6"></a><font color="#00FF00"><a href="match702-1.html#6" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

  else return *(it-&gt;second); 
}
void Biblioteka::IzlistajKorisnike()const{
  for(auto it=korisnik.begin();it!=korisnik.end();it++){
  std::cout&lt;&lt;"Clanski broj: "&lt;&lt;it-&gt;first&lt;&lt;std::endl
</font>  &lt;&lt;"Ime i prezime: "&lt;&lt;(it-&gt;second)-&gt;ime&lt;&lt;" "&lt;&lt;(it-&gt;second)-&gt;prezime&lt;&lt;std::endl
  &lt;&lt;"Adresa: "&lt;&lt;(it-&gt;second)-&gt;adresa&lt;&lt;std::endl
<a name="3"></a><font color="#00FFFF"><a href="match702-1.html#3" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

  &lt;&lt;"Broj telefona: "&lt;&lt;(it-&gt;second)-&gt;telefon&lt;&lt;std::endl;
  std::cout&lt;&lt;std::endl;
    }
 
}

void Biblioteka::IzlistajKnjige()const{
  for(auto it=knjiga.begin();it!=knjiga.end();it++){
</font>    std::cout&lt;&lt;"Evidencijski broj: "&lt;&lt;it-&gt;first&lt;&lt;std::endl
    &lt;&lt;"Naslov: "&lt;&lt;(it-&gt;second)-&gt;DajNaslov()&lt;&lt;std::endl
    &lt;&lt;"Pisac: "&lt;&lt;(it-&gt;second)-&gt;DajAutora()&lt;&lt;std::endl
    &lt;&lt;"Zanr: "&lt;&lt;(it-&gt;second)-&gt;DajZanr()&lt;&lt;std::endl
    &lt;&lt;"Godina izdavanja: "&lt;&lt;(it-&gt;second)-&gt;DajGodinuIzdavanja()&lt;&lt;std::endl;
    if((it-&gt;second)-&gt;DaLiJeZaduzena())
    std::cout&lt;&lt;"Zaduzena kod korisnika: "&lt;&lt;(it-&gt;second)-&gt;DajKodKogaJe()-&gt;ime
<a name="7"></a><font color="#0000FF"><a href="match702-1.html#7" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

    &lt;&lt;" "&lt;&lt;(it-&gt;second)-&gt;DajKodKogaJe()-&gt;prezime&lt;&lt;std::endl;
    std::cout&lt;&lt;std::endl;
  }
}

void Biblioteka::ZaduziKnjigu(int evidencijski_br,int clanski_br){
    NadjiKnjigu(evidencijski_br);
</font>    NadjiKorisnika(clanski_br);
    auto i(knjiga.find(evidencijski_br)); if(i-&gt;second-&gt;DaLiJeZaduzena()) throw std::logic_error("Knjiga vec zaduzena");
    for(auto it(korisnik.begin());it!=korisnik.end();it++){
          if(it-&gt;first ==clanski_br){
            for(auto j(knjiga.begin());j!=knjiga.end();j++)
              if(j-&gt;first==evidencijski_br) (j-&gt;second)-&gt;ZaduziKnjigu(*(it-&gt;second)) ;
          }
      }
}
void Biblioteka::RazduziKnjigu(int evidencijski_br){
    NadjiKnjigu(evidencijski_br);
    auto it(knjiga.find(evidencijski_br));
       if(!((it-&gt;second)-&gt;DaLiJeZaduzena())) throw std::logic_error("Knjiga nije zaduzena");
       (it-&gt;second)-&gt;RazduziKnjigu();
    
}

void Biblioteka::PrikaziZaduzenja(int clanski_br)const{
  NadjiKorisnika(clanski_br);
  auto j (korisnik.find(clanski_br));
  int br(0);
  for(auto it(knjiga.begin());it!=knjiga.end();it++){
      if(((it-&gt;second)-&gt;DajKodKogaJe())==((j-&gt;second)).get()){
          std::cout&lt;&lt;"Evidencijski broj: "&lt;&lt;it-&gt;first&lt;&lt;std::endl
          &lt;&lt;"Naslov: "&lt;&lt;it-&gt;second-&gt;DajNaslov()&lt;&lt;std::endl
          &lt;&lt;"Pisac: "&lt;&lt;it-&gt;second-&gt;DajAutora()&lt;&lt;std::endl
           &lt;&lt;"Zanr: "&lt;&lt;it-&gt;second-&gt;DajZanr()&lt;&lt;std::endl
          &lt;&lt;"Godina izdavanja: "&lt;&lt;it-&gt;second-&gt;DajGodinuIzdavanja()&lt;&lt;std::endl;
          br++;
     }
     std::cout&lt;&lt;std::endl;
  }
  if(br==0) std::cout&lt;&lt;"Nema zaduzenja za tog korisnika!"&lt;&lt;std::endl;
  
}
int main (){
  try{
    
  Biblioteka b1;
  int clanski_br,evidencijski_br,godina_izdavanja,opcija;
  std::string ime,prezime,adresa,telefon,naslov,ime_pisca,zanr;
   std::cout&lt;&lt;"OPCIJE : "&lt;&lt;std::endl;
    std::cout&lt;&lt;"IZLAZ -----&gt; 0"&lt;&lt;std::endl;
    std::cout&lt;&lt;"REGISTRACIJA CLANA   ---&gt; 1 "&lt;&lt;std::endl;
    std::cout&lt;&lt;"REGISTRACIJA KNJIGE  ---&gt; 2 "&lt;&lt;std::endl;
    std::cout&lt;&lt;"ZADUZIVANJE KNJIGE   ---&gt; 3 "&lt;&lt;std::endl;
    std::cout&lt;&lt;"RAZDUZIVANJE KNJIGE  ---&gt; 4 "&lt;&lt;std::endl;
    std::cout&lt;&lt;"IZLISTAJ ZADUZENJA   ---&gt; 5 "&lt;&lt;std::endl;
    std::cout&lt;&lt;"IZLISTAJ SVE CLANOVE ---&gt; 6 "&lt;&lt;std::endl;
    std::cout&lt;&lt;"IZLISTAJ SVE KNJIGE  ---&gt; 7 "&lt;&lt;std::endl&lt;&lt;std::endl;

    while(1){
      std::cout&lt;&lt;"Odaberite opciju: "&lt;&lt;std::endl;
    std::cin&gt;&gt;opcija;
    std::cin.clear();
    std::cin.ignore(1000000,'\n');
    
    switch(opcija){
      
      case(0):
      std::cout&lt;&lt;"Dovidjenja  "&lt;&lt;std::endl&lt;&lt;std::endl;
      return 0;
      
      case 1:
            std::cout&lt;&lt;"Unesite ime korisnika: ";
            std::getline(std::cin,ime);
            std::cout&lt;&lt;"Unesite prezime korisnika: ";
            std::getline(std::cin,prezime);
            std::cout&lt;&lt;"Unesite adresu: ";
            std::getline(std::cin,adresa);
            std::cout&lt;&lt;"Unesite broj telefona: ";
            std::getline(std::cin,telefon);
            std::cout&lt;&lt;"Unesite clanski broj: ";
            std::cin&gt;&gt;clanski_br;
            std::cin.clear();
            std::cin.ignore(1000000,'\n');
            try{
            b1.RegistrirajNovogKorisnika(clanski_br,ime,prezime,adresa,telefon);
            std::cout&lt;&lt;"Uspjesno ste registrirali korisnika "&lt;&lt;std::endl;
            }
            catch(std::logic_error e){
              std::cout&lt;&lt;e.what()&lt;&lt;std::endl;
            }
            break;
            
      case 2:
             std::cout&lt;&lt;"Unesite naslov knjige: ";
             std::getline(std::cin,naslov);
             std::cout&lt;&lt;"Unesite pisca: ";
             std::getline(std::cin,ime_pisca);
             std::cout&lt;&lt;"Unesite zanr: ";
             std::getline(std::cin,zanr);
             std::cout&lt;&lt;"Unesite godinu izdavanja: ";
             std::cin&gt;&gt;godina_izdavanja;
             std::cout&lt;&lt;"Unesite evidencijski broj: ";
             std::cin&gt;&gt;evidencijski_br;
             std::cin.clear();
             std::cin.ignore(100000,'\n');
             try{
             b1.RegistrirajNovuKnjigu(evidencijski_br,naslov,ime_pisca,zanr,godina_izdavanja);
             std::cout&lt;&lt;"Uspjesno ste registrirali knjigu "&lt;&lt;std::endl;
             }
             catch(std::logic_error e){
               std::cout&lt;&lt;e.what()&lt;&lt;std::endl;
             }
             break;
      case 3:
             std::cout&lt;&lt;"Unesite clanski broj korisnika : ";
             std::cin&gt;&gt;clanski_br;
             std::cout&lt;&lt;"Unesite evidencijski broj knjige : ";
             std::cin&gt;&gt;evidencijski_br;
             std::cin.clear();
             std::cin.ignore(100000,'\n');
             try{
             b1.ZaduziKnjigu(evidencijski_br,clanski_br);
             }
             catch(std::logic_error e){
               std::cout&lt;&lt;e.what()&lt;&lt;std::endl;
             }
             break;
      case 4:
            std::cout&lt;&lt;"Unesite evidencijski broj: ";
            std::cin&gt;&gt;evidencijski_br;
            std::cin.clear();
            std::cin.ignore(100000,'\n');
            try{
            b1.RazduziKnjigu(evidencijski_br);
            }
            catch(std::logic_error e){
              std::cout&lt;&lt;e.what()&lt;&lt;std::endl;
              
            }
            break;
            
      case 5:
            std::cout&lt;&lt;"Unesite clanski broj: ";
            std::cin&gt;&gt;clanski_br;
            std::cin.clear();
            std::cin.ignore(10000,'\n');
            try{
            b1.PrikaziZaduzenja(clanski_br);
            }
            catch(std::logic_error e){
              std::cout&lt;&lt;e.what()&lt;&lt;std::endl;
            }
            break;
            
      case 6:
            b1.IzlistajKorisnike();
            break;
            
      case 7:
            b1.IzlistajKnjige();
            break;
    }
 
  }
 
}
  catch(std::logic_error e){
    std::cout&lt;&lt;e.what();
  }
  
	return 0;
}
</pre>
</body>
</html>
