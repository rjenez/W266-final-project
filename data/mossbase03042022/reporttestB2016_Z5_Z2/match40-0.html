<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student6631.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student6631.cpp<p></p><pre>
<a name="0"></a><font color="#FF0000"><a href="match40-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_99.gif"/></a>

/B16/17 (ZadaÄ‡a 5, Zadatak 2)

#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;map&gt;
#include &lt;stdexcept&gt;
#include &lt;memory&gt;

using std::string;
using std::map;
using std::cout;
using std::shared_ptr;
using std::make_shared;
using std::cin;

struct Korisnik{
    string ime, prezime, adresa, telefon;
};

class Knjiga{
    string naslov, pisac, zanr;
    int godina;
    Korisnik* zaduzio = nullptr;
    
public:
    // Konstruktor
    Knjiga(){}
    Knjiga(string n, string p, string z, int god){
        naslov=n;
        pisac=p;
        zanr=z;
        godina=god;
        zaduzio=nullptr;
    }
    
    // Getteri
    string DajNaslov() const { return naslov; }
    string DajAutora() const { return pisac; }
    string DajZanr() const { return zanr; }
    int DajGodinuIzdavanja() const { return godina; }
    Korisnik* DajKodKogaJe() const { return zaduzio; }
    
    // Metode
    void ZaduziKnjigu(Korisnik &amp;k){ zaduzio=&amp;k; }
    void RazduziKnjigu(){ zaduzio=nullptr; }
    bool DaLiJeZaduzena() const { if(zaduzio) return true; return false; }
    
    friend class Biblioteka;
};

class Biblioteka{
    map&lt;int, shared_ptr&lt;Korisnik&gt;&gt; korisnici;
    map&lt;int, shared_ptr&lt;Knjiga&gt;&gt; knjige;
    
public:
    // Konstruktor
    Biblioteka(){}
    Biblioteka(map&lt;int, shared_ptr&lt;Korisnik&gt;&gt; kor, map&lt;int, shared_ptr&lt;Knjiga&gt;&gt; knji){ korisnici=kor; knjige=knji; }
    
    // Kopirajuci konstruktor
    Biblioteka(Biblioteka &amp;b){ korisnici=b.korisnici; knjige=b.knjige; }
    
    // Metode
    void RegistrirajNovogKorisnika(int clanskiBroj, string ime, string prezime, string adresa, string telefon){
        try{
        if(korisnici.find(clanskiBroj)!=korisnici.end()) throw std::logic_error("Korisnik vec postoji");
        shared_ptr&lt;Korisnik&gt; k = make_shared&lt;Korisnik&gt;();
        k-&gt;ime=ime;
        k-&gt;prezime=prezime;
        k-&gt;adresa=adresa;
        k-&gt;telefon=telefon;
        korisnici[clanskiBroj] = k;
        } catch(std::logic_error e){ cout &lt;&lt; e.what(); }
    }
    void RegistrirajNovuKnjigu(int evBroj, string naslov, string pisac, string zanr, int godina){
        try{
        if(knjige.find(evBroj)!=knjige.end()) throw std::logic_error("Knjiga vec postoji");
        shared_ptr&lt;Knjiga&gt; k = make_shared&lt;Knjiga&gt;();
        k-&gt;naslov=naslov;
        k-&gt;pisac=pisac;
        k-&gt;zanr=zanr;
        k-&gt;godina=godina;
        knjige[evBroj] = k;
        } catch(std::logic_error e){ cout &lt;&lt; e.what(); }
    }
    Korisnik &amp;NadjiKorisnika(int clanskiBroj) const {
        if(korisnici.find(clanskiBroj)==korisnici.end()) throw std::logic_error("Korisnik nije nadjen");
        return *(korisnici.find(clanskiBroj)-&gt;second);
    }
    Knjiga &amp;NadjiKnjigu(int evBroj) const {
        if(knjige.find(evBroj)==knjige.end()) throw std::logic_error("Knjiga nije nadjena");
        return *(knjige.find(evBroj)-&gt;second);
    }
    void IzlistajKorisnike() const {
        for(auto it(korisnici.begin()); it!=korisnici.end(); it++){
            cout &lt;&lt; "Clanski broj: " &lt;&lt; it-&gt;first &lt;&lt; std::endl;
            cout &lt;&lt; "Ime i prezime: " &lt;&lt; it-&gt;second-&gt;ime &lt;&lt; " " &lt;&lt; it-&gt;second-&gt;prezime &lt;&lt; std::endl;
            cout &lt;&lt; "Adresa: " &lt;&lt; it-&gt;second-&gt;adresa &lt;&lt; std::endl;
            cout &lt;&lt; "Broj telefona: " &lt;&lt; it-&gt;second-&gt;telefon &lt;&lt; std::endl;
        }
    }
    void IzlistajKnjige() const {
        for(auto it(knjige.begin()); it!=knjige.end(); it++){
            cout &lt;&lt; "Evidencijski broj: " &lt;&lt; it-&gt;first &lt;&lt; std::endl;
            cout &lt;&lt; "Naslov: " &lt;&lt; it-&gt;second-&gt;naslov &lt;&lt; std::endl;
            cout &lt;&lt; "Pisac: " &lt;&lt; it-&gt;second-&gt;pisac &lt;&lt; std::endl;
            cout &lt;&lt; "Zanr: " &lt;&lt; it-&gt;second-&gt;zanr &lt;&lt; std::endl;
            cout &lt;&lt; "Godina izdavanja: " &lt;&lt; it-&gt;second-&gt;godina &lt;&lt; std::endl;
            // Dodatni ispis ako je knjiga zaduzena
            if(it-&gt;second-&gt;zaduzio){
                cout &lt;&lt; "Zaduzena kod korisnika: " &lt;&lt; it-&gt;second-&gt;zaduzio-&gt;ime &lt;&lt; " " &lt;&lt; it-&gt;second-&gt;zaduzio-&gt;prezime &lt;&lt; std::endl;
            }
        }
    }
    void ZaduziKnjigu(int evBroj, int clanskiBroj){
        try{
        // Moguci problemi
        if(knjige.find(evBroj)==knjige.end()) throw std::logic_error("Knjiga nije nadjena");
        if(korisnici.find(clanskiBroj)==korisnici.end()) throw std::logic_error("Korisnik nije nadjen");
        if(knjige[evBroj]-&gt;zaduzio) throw std::logic_error("Knjiga vec zaduzena");
        
        knjige[evBroj]-&gt;zaduzio = korisnici[clanskiBroj].get();
        } catch(std::logic_error e){ cout &lt;&lt; e.what(); }
    }
    void RazaduziKnjigu(int evBroj){
        try{
        // Moguci problemi
        if(knjige.find(evBroj)==knjige.end()) throw std::logic_error("Knjiga nije nadjena");
        if(!(knjige[evBroj]-&gt;zaduzio)) throw std::logic_error("Knjiga nije zaduzena");
        
        knjige[evBroj]-&gt;zaduzio = nullptr;
        } catch(std::logic_error e){ cout &lt;&lt; e.what(); }
    }
    void PrikaziZaduzenja(int clanskiBroj){
        try{
        Korisnik* korisnik = korisnici[clanskiBroj].get();
        if(korisnici.find(clanskiBroj)==korisnici.end()) throw std::logic_error("Korisnik nije nadjen");
        int br(0);
        for(auto it(knjige.begin()); it!=knjige.end(); it++){
            if(it-&gt;second-&gt;zaduzio == korisnik){
                cout &lt;&lt; "Evidencijski broj: " &lt;&lt; it-&gt;first &lt;&lt; std::endl;
                cout &lt;&lt; "Naslov: " &lt;&lt; it-&gt;second-&gt;naslov &lt;&lt; std::endl;
                cout &lt;&lt; "Pisac: " &lt;&lt; it-&gt;second-&gt;pisac &lt;&lt; std::endl;
                cout &lt;&lt; "Zanr: " &lt;&lt; it-&gt;second-&gt;zanr &lt;&lt; std::endl;
                cout &lt;&lt; "Godina izdavanja: " &lt;&lt; it-&gt;second-&gt;godina &lt;&lt; std::endl;
                br++;
            }
        }
        if(br==0) throw std::logic_error("Nema zaduzenja za tog korisnika!");
        } catch(std::logic_error e){ cout &lt;&lt; e.what(); }
    }
};

int main (){
    Biblioteka bibble;
    
    for(;;){
        cout &lt;&lt; "Unesite redni broj komande koju zelite:" &lt;&lt; std::endl;
        cout &lt;&lt; "(0)    " &lt;&lt; "Izlaz iz programa" &lt;&lt; std::endl;
        cout &lt;&lt; "(1)    " &lt;&lt; "Registracija Korisnika" &lt;&lt; std::endl;
        cout &lt;&lt; "(2)    " &lt;&lt; "Registracija Knjige" &lt;&lt; std::endl;
        cout &lt;&lt; "(3)    " &lt;&lt; "Pronadji Korisnika" &lt;&lt; std::endl;
        cout &lt;&lt; "(4)    " &lt;&lt; "Pronadji Knjigu" &lt;&lt; std::endl;
        cout &lt;&lt; "(5)    " &lt;&lt; "Ispisi Korisnike" &lt;&lt; std::endl;
        cout &lt;&lt; "(6)    " &lt;&lt; "Ispisi Knjige" &lt;&lt; std::endl;
        cout &lt;&lt; "(7)    " &lt;&lt; "Zaduzi Knjigu" &lt;&lt; std::endl;
        cout &lt;&lt; "(8)    " &lt;&lt; "Vrati Knjigu" &lt;&lt; std::endl;
        cout &lt;&lt; "(9)    " &lt;&lt; "Prikazi Zaduzene Knjige Korisnika" &lt;&lt; std::endl;
        
        int komanda;
        std::cin &gt;&gt; komanda;
        
        bool van(false);
        switch(komanda){
            case 0:{
                van=true;
                break;
            }
            case 1:{
                try{
                string ime, prezime, adresa, telefon;
                cin.ignore(10000, '\n');
                cout &lt;&lt; "Ime: ";
                getline(cin, ime);
                cout &lt;&lt; "Prezime: ";
                getline(cin, prezime);
                cout &lt;&lt; "Adresa: ";
                getline(cin, adresa);
                cout &lt;&lt; "Kontakt Telefon: ";
                getline(cin, telefon);
                
                int clanskiBroj;
                cout &lt;&lt; "Clanski Broj: ";
                cin &gt;&gt; clanskiBroj;
                
                bibble.RegistrirajNovogKorisnika(clanskiBroj, ime, prezime, adresa, telefon);
                cout &lt;&lt; std::endl;
                break;
                } catch(std::logic_error greska){
                    cout &lt;&lt; greska.what();
                    break;
                }
            }
            case 2:{
                try{
                string naslov, pisac, zanr;
                cin.ignore(10000, '\n');
                cout &lt;&lt; "Naslov: ";
                getline(cin, naslov);
                cout &lt;&lt; "Autor: ";
                getline(cin, pisac);
                cout &lt;&lt; "Zanr: ";
                getline(cin, zanr);
                
                int godina, evBroj;
                cout &lt;&lt; "Godina Izdavanja: ";
                cin &gt;&gt; godina;
                cout &lt;&lt; "Evidencijski Broj: ";
                cin &gt;&gt; evBroj;
                
                bibble.RegistrirajNovuKnjigu(evBroj, naslov, pisac, zanr, godina);
                cout &lt;&lt; std::endl;
                break;
                } catch(std::logic_error greska){
                    cout &lt;&lt; greska.what();
                    break;
                }
            }
            case 3:{
                try{
                cout &lt;&lt; "Unesite Clanski Broj: ";
                int clanskiBroj;
                cin &gt;&gt; clanskiBroj;
                
                Korisnik kor(bibble.NadjiKorisnika(clanskiBroj));
                
                cout &lt;&lt; kor.ime &lt;&lt; " " &lt;&lt; kor.prezime &lt;&lt; std::endl;
                cout &lt;&lt; kor.adresa &lt;&lt; std::endl &lt;&lt; kor.telefon &lt;&lt; std::endl;
                break;
                } catch(std::logic_error greska){
                    cout &lt;&lt; greska.what();
                    break;
                }
            }
            case 4:{
                try{
                cout &lt;&lt; "Unesite Evidencijski Broj: ";
                int evBroj;
                cin &gt;&gt; evBroj;
                
                Knjiga knjiga(bibble.NadjiKnjigu(evBroj));
                
                cout &lt;&lt; knjiga.DajAutora() &lt;&lt;  " - " &lt;&lt; knjiga.DajNaslov() &lt;&lt; ", napisana " &lt;&lt; knjiga.DajGodinuIzdavanja();
                cout &lt;&lt; ". / " &lt;&lt; knjiga.DajZanr() &lt;&lt; std::endl;
                break;
                } catch(std::logic_error greska){
                    cout &lt;&lt; greska.what();
                    break;
                }
            }
            case 5:{
                try{
                bibble.IzlistajKorisnike();
                cout &lt;&lt; std::endl;
                break;
                } catch(std::logic_error greska){
                    cout &lt;&lt; greska.what();
                    break;
                }
            }
            case 6:{
                try{
                bibble.IzlistajKnjige();
                cout &lt;&lt; std::endl;
                break;
                } catch(std::logic_error greska){
                    cout &lt;&lt; greska.what();
                    break;
                }
            }
            case 7:{
                try{
                cout &lt;&lt; "Unesite Evidencijski Broj Knjige: ";
                int evBroj;
                cin &gt;&gt; evBroj;
                
                cout &lt;&lt; "Unesite Clanski Broj Korisnika: ";
                int clanskiBroj;
                cin &gt;&gt; clanskiBroj;
                
                bibble.ZaduziKnjigu(evBroj, clanskiBroj);
                cout &lt;&lt; std::endl;
                break;
                } catch(std::logic_error greska){
                    cout &lt;&lt; greska.what();
                    break;
                }
            }
            case 8:{
                try{
                cout &lt;&lt; "Unesite Evidencijski Broj Knjige: ";
                int evBroj;
                cin &gt;&gt; evBroj;
                
                bibble.RazaduziKnjigu(evBroj);
                cout &lt;&lt; std::endl;
                break;
                } catch(std::logic_error greska){
                    cout &lt;&lt; greska.what();
                    break;
                }
            }
            case 9:{
                try{
                cout &lt;&lt; "Unesite Clanski Broj Korisnika: ";
                int clanskiBroj;
                cin &gt;&gt; clanskiBroj;
                
                bibble.PrikaziZaduzenja(clanskiBroj);
                cout &lt;&lt; std::endl;
                break;
                } catch(std::logic_error greska){
                    cout &lt;&lt; greska.what();
                    break;
                }
            }
            default:{
                cout &lt;&lt; "Pogresan unos komande, pokusajte ponovo.";
                cout &lt;&lt; std::endl;
                break;
            }
        }
        
        if(van) break;
</font>    }
	return 0;
}</pre>
</body>
</html>
