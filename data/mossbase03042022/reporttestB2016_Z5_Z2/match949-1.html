<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student7173.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student7774.cpp<p></p><pre>
#include &lt;iostream&gt;
#include &lt;stdexcept&gt;
#include &lt;string&gt;
#include &lt;map&gt;
#include &lt;memory&gt;

using namespace std;

<a name="0"></a><font color="#FF0000"><a href="match949-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_6.gif"/></a>

struct Korisnik {
    string ime, prezime, adresa, telefon; 
};

class Knjiga {
    string naslov_knjige, ime_pisca, zanr;
    int godina_izdavanja;
    Korisnik *zaduzenik;
public:
    Knjiga(string naslov_knjige,string ime_pisca,string zanr, int godina_izdavanja) :
        naslov_knjige(naslov_knjige), ime_pisca(ime_pisca), zanr(zanr), godina_izdavanja(godina_izdavanja), zaduzenik(nullptr) {}
    string DajNaslov() const { return naslov_knjige; }
    string DajAutora() const { return ime_pisca; }
    string DajZanr() const { return zanr; }
    int DajGodinuIzdavanja() const { return godina_izdavanja; }
    Korisnik* DajKodKogaJe() const { return zaduzenik; }
    void ZaduziKnjigu(Korisnik &amp;korisnik) { zaduzenik = &amp;korisnik; }
    void RazduziKnjigu() { zaduzenik = nullptr; } 
    bool DaLiJeZaduzena() const { return zaduzenik; }
    
};

class Biblioteka {
    map&lt;int, shared_ptr&lt;Korisnik&gt;&gt; mapa_korisnika;
    map&lt;int, shared_ptr&lt;Knjiga&gt;&gt; mapa_knjiga;
    
public:
</font>    Biblioteka() = default;
<a name="1"></a><font color="#00FF00"><a href="match949-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_3.gif"/></a>

    Biblioteka(const Biblioteka &amp;bib);
    Biblioteka(Biblioteka &amp;&amp;bib);
    Biblioteka &amp;operator =(const Biblioteka &amp;bib);
    Biblioteka &amp;operator =(Biblioteka &amp;&amp;bib);
    void RegistrirajNovogKorisnika(int cl_broj, string ime, string prezime, string adresa, string telefon);
    void RegistrirajNovuKnjigu(int ev_broj, string naslov, string ime_pisca, string zanr, int godina_izdavanja);
    Korisnik &amp;NadjiKorisnika (int cl_broj) const;
</font>    Knjiga &amp;NadjiKnjigu (int ev_broj) const;
<a name="2"></a><font color="#0000FF"><a href="match949-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

    void IzlistajKorisnike() const;
    void IzlistajKnjige() const;
    void ZaduziKnjigu(int ev_broj, int cl_broj);
    void RazduziKnjigu(int ev_broj);
    void PrikaziZaduzenja(int cl_broj) const;
};

Biblioteka::Biblioteka(const Biblioteka &amp;bib) {
</font>    try {
        for(auto it = bib.mapa_korisnika.begin(); it != bib.mapa_korisnika.end(); it++) 
            RegistrirajNovogKorisnika(it-&gt;first, it-&gt;second-&gt;ime, it-&gt;second-&gt;prezime, it-&gt;second-&gt;adresa, it-&gt;second-&gt;telefon);
        
        for(auto it = bib.mapa_knjiga.begin(); it != bib.mapa_knjiga.end(); it++)
            RegistrirajNovuKnjigu(it-&gt;first, it-&gt;second-&gt;DajNaslov(), it-&gt;second-&gt;DajAutora(), it-&gt;second-&gt;DajZanr(), it-&gt;second-&gt;DajGodinuIzdavanja());
    }
    catch (std::bad_alloc) {
        throw;
    }
}

Biblioteka::Biblioteka(Biblioteka &amp;&amp;bib) {
    try {
        for(auto it = bib.mapa_korisnika.begin(); it != bib.mapa_korisnika.end(); it++) {
            mapa_korisnika.insert(std::make_pair(it-&gt;first, it-&gt;second));
            it-&gt;second = nullptr;
        }    
        
        for(auto it = bib.mapa_knjiga.begin(); it != bib.mapa_knjiga.end(); it++){
            mapa_knjiga.insert(std::make_pair(it-&gt;first, it-&gt;second));
            it-&gt;second = nullptr;
        }
    }
    catch (std::bad_alloc) {
        throw;
    }
}

Biblioteka &amp;Biblioteka::operator =(const Biblioteka &amp;bib) {
    
    Biblioteka pom;
    
    try {
        for(auto it = bib.mapa_korisnika.begin(); it != bib.mapa_korisnika.end(); it++) 
            pom.RegistrirajNovogKorisnika(it-&gt;first, it-&gt;second-&gt;ime, it-&gt;second-&gt;prezime, it-&gt;second-&gt;adresa, it-&gt;second-&gt;telefon);
        
        for(auto it = bib.mapa_knjiga.begin(); it != bib.mapa_knjiga.end(); it++)
            pom.RegistrirajNovuKnjigu(it-&gt;first, it-&gt;second-&gt;DajNaslov(), it-&gt;second-&gt;DajAutora(), it-&gt;second-&gt;DajZanr(), it-&gt;second-&gt;DajGodinuIzdavanja());
            
        for(auto it = pom.mapa_korisnika.begin(); it != pom.mapa_korisnika.end(); it++) 
            RegistrirajNovogKorisnika(it-&gt;first, it-&gt;second-&gt;ime, it-&gt;second-&gt;prezime, it-&gt;second-&gt;adresa, it-&gt;second-&gt;telefon);
        
        for(auto it = pom.mapa_knjiga.begin(); it != pom.mapa_knjiga.end(); it++)
            RegistrirajNovuKnjigu(it-&gt;first, it-&gt;second-&gt;DajNaslov(), it-&gt;second-&gt;DajAutora(), it-&gt;second-&gt;DajZanr(), it-&gt;second-&gt;DajGodinuIzdavanja());
    }
    catch (std::bad_alloc) {
        throw;
    }
    return *this;
}

Biblioteka &amp;Biblioteka::operator =(Biblioteka &amp;&amp;bib) {
    try {
        for(auto it = bib.mapa_korisnika.begin(); it != bib.mapa_korisnika.end(); it++) {
            mapa_korisnika.insert(std::make_pair(it-&gt;first, it-&gt;second));
            it-&gt;second = nullptr;
        }    
        
        for(auto it = bib.mapa_knjiga.begin(); it != bib.mapa_knjiga.end(); it++){
            mapa_knjiga.insert(std::make_pair(it-&gt;first, it-&gt;second));
            it-&gt;second = nullptr;
        }
    }
    catch (std::bad_alloc) {
        throw;
    }
<a name="3"></a><font color="#00FFFF"><a href="match949-0.html#3" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

    return *this;
}

void Biblioteka::RegistrirajNovogKorisnika(int cl_broj, string ime,
    string prezime, string adresa, string telefon) {
        
    if(mapa_korisnika.count(cl_broj))
        throw std::logic_error("Korisnik vec postoji");
</font>    
    Korisnik k;
    k.ime = ime;
    k.prezime = prezime;
    k.adresa = adresa;
    k.telefon = telefon;
    
    
    std::shared_ptr&lt;Korisnik&gt; pok_na_korisnika = std::make_shared&lt;Korisnik&gt;(k);
    
    
<a name="4"></a><font color="#FF00FF"><a href="match949-0.html#4" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

    mapa_korisnika.insert(std::make_pair(cl_broj, pok_na_korisnika));    
}

void Biblioteka::RegistrirajNovuKnjigu(int ev_broj, string naslov_knjige, 
    string ime_pisca, string zanr, int godina_izdavanja) {
    
    if(mapa_knjiga.count(ev_broj))
        throw std::logic_error("Knjiga vec postoji");
</font>        
    std::shared_ptr&lt;Knjiga&gt; pok_na_knjigu = std::make_shared&lt;Knjiga&gt;(Knjiga(naslov_knjige, ime_pisca, zanr, godina_izdavanja));
    
    mapa_knjiga.insert(make_pair(ev_broj, pok_na_knjigu));
}

Korisnik &amp;Biblioteka::NadjiKorisnika (int cl_broj) const {
    
    auto it = mapa_korisnika.find(cl_broj);
    
    if(it == mapa_korisnika.end())
        throw std::logic_error("Korisnik nije nadjen");
        
    return *it-&gt;second;    
}

Knjiga &amp;Biblioteka::NadjiKnjigu (int ev_broj) const {
    
    auto it = mapa_knjiga.find(ev_broj);
    
    if (it == mapa_knjiga.end())
        throw logic_error("Knjiga nije nadjena");
        
    return *it-&gt;second;    
}

void Biblioteka::IzlistajKorisnike() const {
    
    for (auto it = mapa_korisnika.begin(); it != mapa_korisnika.end(); it++) {
        cout &lt;&lt; "Clanski broj: " &lt;&lt; it-&gt;first &lt;&lt; endl 
            &lt;&lt; "Ime i prezime: " &lt;&lt; it-&gt;second-&gt;ime &lt;&lt; " " &lt;&lt; it-&gt;second-&gt;prezime &lt;&lt; endl
            &lt;&lt; "Adresa: " &lt;&lt; it-&gt;second-&gt;adresa &lt;&lt; endl 
            &lt;&lt; "Broj telefona: " &lt;&lt; it-&gt;second-&gt;telefon &lt;&lt; endl &lt;&lt; endl;
    }
}

void Biblioteka::IzlistajKnjige() const {
    
    for (auto it = mapa_knjiga.begin(); it != mapa_knjiga.end(); it++) {
        cout &lt;&lt; "Evidencijski broj: " &lt;&lt; it-&gt;first &lt;&lt; endl
            &lt;&lt; "Naslov: " &lt;&lt; it-&gt;second-&gt;DajNaslov() &lt;&lt; endl
            &lt;&lt; "Pisac: " &lt;&lt; it-&gt;second-&gt;DajAutora() &lt;&lt; endl
            &lt;&lt; "Zanr: " &lt;&lt; it-&gt;second-&gt;DajZanr() &lt;&lt; endl
            &lt;&lt; "Godina izdavanja: " &lt;&lt; it-&gt;second-&gt;DajGodinuIzdavanja() &lt;&lt; endl;
            
        if(it-&gt;second-&gt;DaLiJeZaduzena())
            cout &lt;&lt; "Zaduzena kod korisnika: " &lt;&lt; it-&gt;second-&gt;DajKodKogaJe()-&gt;ime
                &lt;&lt; " " &lt;&lt; it-&gt;second-&gt;DajKodKogaJe()-&gt;prezime &lt;&lt; endl;
        
        cout &lt;&lt; endl;        
    }
}

void Biblioteka::ZaduziKnjigu(int ev_broj, int cl_broj) {
    NadjiKnjigu(ev_broj);               
    NadjiKorisnika(cl_broj);
    
    if(NadjiKnjigu(ev_broj).DaLiJeZaduzena())
        throw logic_error("Knjiga je vec zaduzena");
        
    NadjiKnjigu(ev_broj).ZaduziKnjigu(NadjiKorisnika(cl_broj));        
}

void Biblioteka::RazduziKnjigu(int ev_broj) {
    if(!NadjiKnjigu(ev_broj).DaLiJeZaduzena())
        throw logic_error("Knjiga nije zaduzena");
        
    NadjiKnjigu(ev_broj).RazduziKnjigu();    
}

void Biblioteka::PrikaziZaduzenja(int cl_broj) const {
    Korisnik k(NadjiKorisnika(cl_broj));
    
    for(auto it = mapa_knjiga.begin(); it != mapa_knjiga.end(); it++) {
        if (it-&gt;second-&gt;DajKodKogaJe()-&gt;ime == k.ime &amp;&amp; it-&gt;second-&gt;DajKodKogaJe()-&gt;prezime == k.prezime 
            &amp;&amp; it-&gt;second-&gt;DajKodKogaJe()-&gt;adresa == k.adresa &amp;&amp; it-&gt;second-&gt;DajKodKogaJe()-&gt;telefon == k.telefon) {
                
            cout &lt;&lt; "Evidencijski broj: " &lt;&lt; it-&gt;first &lt;&lt; endl
            &lt;&lt; "Naslov: " &lt;&lt; it-&gt;second-&gt;DajNaslov() &lt;&lt; endl
            &lt;&lt; "Pisac: " &lt;&lt; it-&gt;second-&gt;DajAutora() &lt;&lt; endl
            &lt;&lt; "Zanr: " &lt;&lt; it-&gt;second-&gt;DajZanr() &lt;&lt; endl
            &lt;&lt; "Godina izdavanja: " &lt;&lt; it-&gt;second-&gt;DajGodinuIzdavanja() &lt;&lt; endl;
            cout &lt;&lt; "Zaduzena kod korisnika: " &lt;&lt; it-&gt;second-&gt;DajKodKogaJe()-&gt;ime
                &lt;&lt; " " &lt;&lt; it-&gt;second-&gt;DajKodKogaJe()-&gt;prezime &lt;&lt; endl;
        }
    }
}

int main ()
{
    Biblioteka bib;
    cout &lt;&lt; endl &lt;&lt; endl;
    cout &lt;&lt; "WILLKOMMEN!" &lt;&lt; endl;
    cout &lt;&lt; "Vasa biblioteka se sove bib :D " &lt;&lt; endl &lt;&lt; endl;
    
    int opcija;
    
    for(;;) {
        try {
            
            cout &lt;&lt; endl 
                &lt;&lt; "Izaberite opciju: " &lt;&lt; endl
                &lt;&lt; "1: RegistrirajNovogKorisnika" &lt;&lt; endl
                &lt;&lt; "2: RegistrirajNovuKnjigu" &lt;&lt; endl
                &lt;&lt; "3: ZaduziKnjigu" &lt;&lt; endl
                &lt;&lt; "4: RazduziKnjigu" &lt;&lt; endl
                &lt;&lt; "5: PrikaziZaduzenja" &lt;&lt; endl
                &lt;&lt; "6: IzlistajKorisnike" &lt;&lt; endl
                &lt;&lt; "7: IzlistajKnjige" &lt;&lt; endl
                &lt;&lt; "0: IZLAZ!" &lt;&lt; endl &lt;&lt; endl;
            
            cin &gt;&gt; opcija;
            
            switch(opcija) {
                case 0:
                    return 0;
                case 1: {
                    int cl_broj;
                    string ime, prezime, adresa, telefon;
                    
                    cout &lt;&lt; "Unesite clanski broj: " &lt;&lt; endl;
                    cin &gt;&gt; cl_broj;
                    
                    cin.ignore(100,'\n');
                    
                    cout &lt;&lt; "Unesite ime korisnika: " &lt;&lt; endl;
                    std::getline(std::cin, ime);
                    
                    cout &lt;&lt; "Unesite prezime korisnika: " &lt;&lt; endl;
                    std::getline(std::cin, prezime);
                    
                    cout &lt;&lt; "Unesite adresu: " &lt;&lt; endl;
                    std::getline(std::cin, adresa);
                    
                    cout &lt;&lt; "Unesite telefon: " &lt;&lt; endl;
                    std::getline(std::cin, telefon);
                    
                    bib.RegistrirajNovogKorisnika(cl_broj, ime, prezime, adresa, telefon);
                    
                    break;
                }
                case 2: {
                    int ev_broj, godina_izdavanja;
                    string naslov, ime_pisca, zanr;
                    
                    cout &lt;&lt; "Unesite evidencijski broj: " &lt;&lt; endl;
                    cin &gt;&gt; ev_broj;
                    cin.ignore(100, '\n');
                    
                    cout &lt;&lt; "Unesite naslov knjige: " &lt;&lt; endl;
                    std::getline(std::cin, naslov);
                    
                    cout &lt;&lt; "Unesite ime pisca: " &lt;&lt; endl;
                    std::getline(std::cin, ime_pisca);
                    
                    cout &lt;&lt; "Unesite zanr: " &lt;&lt; endl;
                    std::getline(std::cin, zanr);
                    
                    cout &lt;&lt; "Unesite godina izdavanja" &lt;&lt; endl;
                    cin &gt;&gt; godina_izdavanja;
                    cin.ignore(100,'\n');
                    
                    bib.RegistrirajNovuKnjigu(ev_broj, naslov, ime_pisca, zanr, godina_izdavanja);
                
                    break;
                }
                case 3: {
                    int ev_broj, cl_broj;
                    
                    cout &lt;&lt; "Unesite evidencijski broj knjige: " &lt;&lt; endl;
                    cin &gt;&gt; ev_broj;
                    cout &lt;&lt; "Unesite clanski broj korisnika: " &lt;&lt; endl;
                    cin &gt;&gt; cl_broj;
                    cin.ignore(100,'\n');
                    
                    bib.ZaduziKnjigu(ev_broj, cl_broj);
                    
                    break;
                }
                case 4: {
                    int ev_broj;
                    
                    cout &lt;&lt; "Unesite evidencijski broj knjige: " &lt;&lt; endl;
                    cin &gt;&gt; ev_broj;
                    cin.ignore(100,'\n');
                    
                    bib.RazduziKnjigu(ev_broj);
                    
                    break;
                }
                case 5: {
                    int cl_broj;
                    
                    cout &lt;&lt; "Unesite clanski broj korisnika: " &lt;&lt; endl;
                    cin &gt;&gt; cl_broj;
                    cin.ignore(100,'\n');
                    
                    bib.PrikaziZaduzenja(cl_broj);
                    
                    break;
                }
                case 6: {
                    bib.IzlistajKorisnike();
                    break;
                }
                case 7: {
                    bib.IzlistajKnjige();
                    break;
                }
                
            }
        } catch (...) {}    
    }
        
    return 0;
}
</pre>
</body>
</html>
