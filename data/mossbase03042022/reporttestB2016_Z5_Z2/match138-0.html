<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student1502.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student1502.cpp<p></p><pre>
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;stdexcept&gt;
#include &lt;map&gt;
#include &lt;memory&gt;

<a name="0"></a><font color="#FF0000"><a href="match138-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_50.gif"/></a>

using std::shared_ptr;
using std::cout;
using std::cin;
using std::endl;
using std::string;
using std::map;


struct Korisnik {
    string ime,prezime,adresa,telefon;
};

class Knjiga
{
    string naslov,ime_p,zanr;
    int godinaiz;
    Korisnik* zaduzenik=nullptr;
public:
    Knjiga(string naslov, string ime_p, string zanr, int godinaiz): naslov(naslov), ime_p(ime_p), zanr(zanr), godinaiz(godinaiz) {};
    string DajNaslov() const {
        return naslov;
    }
    string DajAutora() const {
        return ime_p;
    }
    string DajZanr() const {
        return zanr;
    }
    int DajGodinuIzdavanja() const {
        return godinaiz;
    }
    Korisnik* DajKodKogaJe() const {
        return zaduzenik;
    }
    void ZaduziKnjigu(Korisnik&amp; korisnik) {
        zaduzenik=&amp;korisnik;
    }
    void RazduziKnjigu() {
        zaduzenik=nullptr;
    }
    bool DaLiJeZaduzena() {
        if(!zaduzenik) return false;
        return true;
    }
};

class Biblioteka
{
    map&lt;int,shared_ptr&lt;Korisnik&gt;&gt; korisnici;
    map&lt;int,shared_ptr&lt;Knjiga&gt;&gt; knjige;
public:
    Biblioteka()=default;
    Biblioteka(const Biblioteka&amp; bib);
    Biblioteka(Biblioteka&amp;&amp; bib);
    Biblioteka&amp; operator = (const Biblioteka&amp; bib);
    Biblioteka&amp; operator =(Biblioteka&amp;&amp; bib);
    void RegistrirajNovogKorisnika(int,string,string,string,string);
    void RegistrirajNovuKnjigu(int ev_br, string naslov, string ime_p, string zanr, int godinaiz);
    Korisnik&amp; NadjiKorisnika(int) const;
    Knjiga&amp; NadjiKnjigu(int) const; 
    void IzlistajKorisnike() const;
    void IzlistajKnjige() const;
    void ZaduziKnjigu(int ev_br, int cb);
    void RazduziKnjigu(int);
    void PrikaziZaduzenja(int) const ;
};


void Biblioteka::ZaduziKnjigu(int ev_br, int cb)
{
    if(!knjige.count(ev_br)) throw std::logic_error("Knjiga nije nadjena");
    if(!korisnici.count(cb)) throw std::logic_error("Korisnik nije nadjen");
    if(knjige[ev_br]-&gt;DaLiJeZaduzena()) throw std::logic_error("Knjiga vec zaduzena");
    knjige[ev_br]-&gt;ZaduziKnjigu(*korisnici[cb]);
}

void Biblioteka::RazduziKnjigu(int ev_br)
{
    if(!knjige.count(ev_br)) throw std::logic_error("Knjiga nije nadjena");
    if(!knjige[ev_br]-&gt;DaLiJeZaduzena()) throw std::logic_error("Knjiga nije zaduzena");
    knjige[ev_br]-&gt;RazduziKnjigu();
}

void Biblioteka::PrikaziZaduzenja(int cb) const
{
    if(!korisnici.count(cb)) throw std::logic_error("Korisnik nije nadjen");
    bool ima(false);
    for(auto it=knjige.begin(); it!=knjige.end(); it++) {
        if(it-&gt;second-&gt;DajKodKogaJe()==korisnici.at(cb).get()) {
            ima=true;
            cout&lt;&lt;"Evidencijski broj: "&lt;&lt;it-&gt;first&lt;&lt;endl;
            cout&lt;&lt;"Pisac: "&lt;&lt;it-&gt;second-&gt;DajAutora()&lt;&lt;" "&lt;&lt;endl;
            cout&lt;&lt;"Zanr: "&lt;&lt;it-&gt;second-&gt;DajZanr()&lt;&lt;endl;
            cout&lt;&lt;"Godina izdavanja: "&lt;&lt;it-&gt;second-&gt;DajGodinuIzdavanja()&lt;&lt;endl;
        }
    }
    if(!ima) cout&lt;&lt;"Nema zaduzenja kod korisnika"&lt;&lt;endl;
    cout&lt;&lt;endl;
}

void Biblioteka::IzlistajKorisnike() const
{
    for(auto it=korisnici.begin(); it!=korisnici.end(); it++) {
        cout&lt;&lt;"Clanski broj: "&lt;&lt;it-&gt;first&lt;&lt;endl;
        cout&lt;&lt;"Ime i prezime: "&lt;&lt;it-&gt;second-&gt;ime&lt;&lt;" "&lt;&lt;it-&gt;second-&gt;prezime&lt;&lt;endl;
        cout&lt;&lt;"Adresa: "&lt;&lt;it-&gt;second-&gt;adresa&lt;&lt;endl;
        cout&lt;&lt;"Broj telefona: "&lt;&lt;it-&gt;second-&gt;telefon&lt;&lt;endl;
        cout&lt;&lt;endl;
    }
}


void Biblioteka::IzlistajKnjige() const
{
    for(auto it=knjige.begin(); it!=knjige.end(); it++) {
        cout&lt;&lt;"Evidencijski broj: "&lt;&lt;it-&gt;first&lt;&lt;endl;
</font><a name="1"></a><font color="#00FF00"><a href="match138-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_47.gif"/></a>

        cout&lt;&lt;"Naslov: "&lt;&lt;it-&gt;second-&gt;DajNaslov()&lt;&lt;endl;
        cout&lt;&lt;"Pisac: "&lt;&lt;it-&gt;second-&gt;DajAutora()&lt;&lt;" "&lt;&lt;endl;
        cout&lt;&lt;"Zanr: "&lt;&lt;it-&gt;second-&gt;DajZanr()&lt;&lt;endl;
        cout&lt;&lt;"Godina izdavanja: "&lt;&lt;it-&gt;second-&gt;DajGodinuIzdavanja()&lt;&lt;endl;
        if(it-&gt;second-&gt;DaLiJeZaduzena()) {
            cout&lt;&lt;"Zaduzena kod korisnika: "&lt;&lt;it-&gt;second-&gt;DajKodKogaJe()-&gt;ime&lt;&lt;" "&lt;&lt;it-&gt;second-&gt;DajKodKogaJe()-&gt;prezime&lt;&lt;endl;
        }
        cout&lt;&lt;endl;
    }
}

Korisnik&amp; Biblioteka::NadjiKorisnika(int cb) const
{
    if(!korisnici.count(cb)) throw std::logic_error("Korisnik nije nadjen");
    return *(*korisnici.find(cb)).second;
}

Knjiga&amp; Biblioteka::NadjiKnjigu(int ev_br) const
{
    if(!knjige.count(ev_br)) throw std::logic_error("Knjiga nije nadjena");
    return *(*knjige.find(ev_br)).second;
}

void Biblioteka::RegistrirajNovogKorisnika(int cb,string ime, string prezime, string adresa, string telefon)
{
    if (korisnici.count(cb)) throw std::logic_error("Korisnik vec postoji");
    korisnici[cb]=std::make_shared&lt;Korisnik&gt;();
    *korisnici[cb]=std::move(Korisnik {ime,prezime,adresa,telefon});
}

void Biblioteka::RegistrirajNovuKnjigu(int ev_br, string naslov, string ime_p, string zanr, int godinaiz)
{
    if(knjige.count(ev_br)) throw std::logic_error("Knjiga vec postoji");
    knjige[ev_br] = std::make_shared&lt;Knjiga&gt;(naslov,ime_p,zanr,godinaiz);
}

Biblioteka::Biblioteka(const Biblioteka&amp; bib)
{
    for(auto it = bib.korisnici.begin(); it!= bib.korisnici.end(); it++) {
        korisnici[it-&gt;first] = std::make_shared&lt;Korisnik&gt;();
        *korisnici[it-&gt;first] = *it-&gt;second;
    }
    for(auto it = bib.knjige.begin(); it!= bib.knjige.end(); it++) {
        knjige[it-&gt;first] = std::make_shared&lt;Knjiga&gt;(*it-&gt;second);
    }

}
Biblioteka::Biblioteka(Biblioteka&amp;&amp; bib)
{
    std::swap(korisnici,bib.korisnici);
    std::swap(knjige,bib.knjige);
}
Biblioteka&amp; Biblioteka::operator = (const Biblioteka&amp; bib)
{
    *this=Biblioteka(bib);
    return *this;
}
Biblioteka&amp; Biblioteka::operator =(Biblioteka&amp;&amp; bib)
{
    *this=Biblioteka(std::move(bib));
    return *this;
}
#define TestirajIzuzetak(izuzetak, tijelo) \
  try tijelo catch(izuzetak e) { std::cout &lt;&lt; e.what() &lt;&lt; std::endl; }
int main ()
{
Biblioteka b;
b.RegistrirajNovogKorisnika(1234, "Petar", "Petrovic",
"Zmaja od Bosne 30", "032/444-555");
b.RegistrirajNovogKorisnika(4312, "Hasan", "Hasanovic",
"Trg neznalica 111", "030/111-222");
b.RegistrirajNovogKorisnika(3124, "Mehmed", "Mehmedovic",
"Studenata etfovaca 3b", "037/654-321");
b.RegistrirajNovuKnjigu(231, "Prokleta avlija", "Ivo Andric", "Roman", 1955);
b.RegistrirajNovuKnjigu(555, "Grimove Bajke", "Braca Grim", "Bajke", 1927);
b.RegistrirajNovuKnjigu(136, "Kameni spavac", "Mak Dizdar", "Poezija", 1960);
const Biblioteka b2(b);                                           
TestirajIzuzetak(std::logic_error, { std::cout &lt;&lt; b2.NadjiKnjigu(1234).DajNaslov() &lt;&lt; std::endl;
 })
    return 0;
</font>}</pre>
</body>
</html>
