<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student8863.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student8863.cpp<p></p><pre>
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;map&gt;
#include &lt;utility&gt;
#include &lt;algorithm&gt;

using std::cin;
using std::cout;

struct Korisnik{
    std::string ime, prezime, adresa, telefon;
};
class Knjiga{
    std::string naslov, pisac, zanr;
    int godina_izdavanja;
    Korisnik *zaduzenik;
public:
    Knjiga(std::string naslov, std::string pisac, std::string zanr, int godina) : naslov(naslov), pisac(pisac), zanr(zanr), godina_izdavanja(godina), zaduzenik(nullptr) {}
    std::string DajNaslov() const { return naslov; }
    std::string DajAutora() const { return pisac; }
    std::string DajZanr() const { return zanr; }
    int DajGodinuIzdavanja() const { return godina_izdavanja; }
    Korisnik* DajKodKogaJe() const { return zaduzenik; }
    void ZaduziKnjigu(Korisnik &amp;k) { zaduzenik = &amp;k; }
    void RazduziKnjigu() { zaduzenik = nullptr; }
    bool DaLiJeZaduzena() { return zaduzenik; }
};
class Biblioteka{
    std::map&lt;int, Korisnik*&gt; korisnik;
    std::map&lt;int, Knjiga*&gt; knjiga;
public:
    Biblioteka() {}
    ~Biblioteka() { for(auto it = korisnik.begin(); it != korisnik.end(); it++) delete it -&gt; second; 
        for(auto it = knjiga.begin(); it != knjiga.end(); it++) delete it -&gt; second; }
    Biblioteka(const Biblioteka &amp;biblio);
    Biblioteka(Biblioteka &amp;&amp;biblio);
    Biblioteka &amp;operator = (const Biblioteka &amp;biblio);
    Biblioteka &amp;operator = (Biblioteka &amp;&amp;biblio);
    void RegistrirajNovogKorisnika(int cl_broj, std::string ime, std::string prezime, std::string adresa, std::string br_telefona);
    void RegistrirajNovuKnjigu(int br_knjige, std::string naslov_knjige, std::string ime_pisca, std::string zanr_knjige, int god_izdavanja);
    Korisnik &amp;NadjiKorisnika(int cl_broj);
    Knjiga &amp;NadjiKnjigu(int br_knjige);
    void IzlistajKorisnike();
    void IzlistajKnjige();
    void ZaduziKnjigu(int br_knjige, int cl_broj);
    void RazduziKnjigu(int br_knjige);
    void PrikaziZaduzenja(int cl_broj);
};
Biblioteka::Biblioteka(const Biblioteka &amp;biblio){
    try{
        for(auto it = biblio.korisnik.begin(); it != biblio.korisnik.end(); it++) korisnik.insert(std::pair&lt;int, Korisnik*&gt;(it -&gt; first, new Korisnik(*(it -&gt; second))));
    } catch(...){
        for(auto it = korisnik.begin(); it != korisnik.end(); it++) delete it -&gt; second; throw;
    }
    try{
        for(auto it = biblio.knjiga.begin(); it != biblio.knjiga.end(); it++) knjiga.insert(std::pair&lt;int, Knjiga*&gt;(it -&gt; first, new Knjiga(*(it -&gt; second))));
    } catch(...){
        for(auto it = knjiga.begin(); it != knjiga.end(); it++) delete it -&gt; second; throw;
    }        
} // kopirajuci 1
Biblioteka::Biblioteka(Biblioteka &amp;&amp;biblio){
    for(auto it = biblio.korisnik.begin(); it != biblio.korisnik.end(); it++) {
        korisnik.insert(std::pair&lt;int, Korisnik*&gt;(it -&gt; first, it -&gt; second));
        it -&gt; second = nullptr;
    }
    for(auto it = biblio.knjiga.begin(); it != biblio.knjiga.end(); it++) {
        knjiga.insert(std::pair&lt;int, Knjiga*&gt;(it -&gt; first, it -&gt; second));
        it -&gt; second = nullptr;
    }
} // kopirajuci 2
Biblioteka &amp;Biblioteka::operator = (const Biblioteka &amp;biblio){
    std::map&lt;int, Korisnik*&gt; novi_korisnik;
    std::map&lt;int, Knjiga*&gt; nova_knjiga;
    try{
<a name="3"></a><font color="#00FFFF"><a href="match948-1.html#3" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

        for(auto it = biblio.korisnik.begin(); it != biblio.korisnik.end(); it++) novi_korisnik.insert(std::pair&lt;int, Korisnik*&gt;(it -&gt; first, new Korisnik(*(it -&gt; second))));
        for(auto it = biblio.knjiga.begin(); it != biblio.knjiga.end(); it++) nova_knjiga.insert(std::pair&lt;int, Knjiga*&gt;(it -&gt; first, new Knjiga(*(it -&gt; second))));   
</font>    } catch(...){
        for(auto it = novi_korisnik.begin(); it != novi_korisnik.end(); it++) delete it -&gt; second;
        for(auto it = nova_knjiga.begin(); it != nova_knjiga.end(); it++) delete it -&gt; second;
        throw;
    }
    for(auto it = korisnik.begin(); it != korisnik.end(); it++){ delete it -&gt; second; korisnik.erase(it); }
    for(auto it = knjiga.begin(); it != knjiga.end(); it++){ delete it -&gt; second; knjiga.erase(it); }
    for(auto it = novi_korisnik.begin(); it != novi_korisnik.end(); it++) korisnik.insert(std::pair&lt;int, Korisnik*&gt;(it -&gt; first, it -&gt; second));
    for(auto it = nova_knjiga.begin(); it != nova_knjiga.end(); it++) knjiga.insert(std::pair&lt;int, Knjiga*&gt;(it -&gt; first, it -&gt; second));
    return *this;
} // opreator dodjele 1
Biblioteka &amp;Biblioteka::operator = (Biblioteka &amp;&amp;biblio){
    std::swap(korisnik, biblio.korisnik);
    std::swap(knjiga, biblio.knjiga);
    return *this;
} // operator dodjele 2
void Biblioteka::RegistrirajNovogKorisnika(int cl_broj, std::string ime, std::string prezime, std::string adresa, std::string br_telefona){
    if(korisnik.find(cl_broj) != korisnik.end()) throw std::logic_error("Korisnik vec postoji");
    Korisnik pomocni; pomocni.ime = ime; pomocni.prezime = prezime; pomocni.adresa = adresa; pomocni.telefon = br_telefona;
    korisnik.insert(std::pair&lt;int, Korisnik*&gt;(cl_broj, new Korisnik(pomocni)));
} // registracija korisnika
void Biblioteka::RegistrirajNovuKnjigu(int br_knjige, std::string naslov, std::string pisac, std::string zanr, int godina){
    if(knjiga.find(br_knjige) != knjiga.end()) throw std::logic_error("Knjiga vec postoji");
<a name="2"></a><font color="#0000FF"><a href="match948-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_4.gif"/></a>

    knjiga.insert(std::pair&lt;int, Knjiga*&gt;(br_knjige, new Knjiga(naslov, pisac, zanr, godina)));
} // registracija knjige
Korisnik &amp;Biblioteka::NadjiKorisnika(int cl_broj){
    auto it(korisnik.find(cl_broj));
    if(it == korisnik.end()) throw std::logic_error("Korisnik nije nadjen");
    return *(it -&gt; second);
} // pretraga korisnika
Knjiga &amp;Biblioteka::NadjiKnjigu(int br_knjige){
    auto it(knjiga.find(br_knjige));
    if(it == knjiga.end()) throw std::logic_error("Knjiga nije nadjena");
    return *(it -&gt; second);
} // pretraga knjiga
void Biblioteka::IzlistajKorisnike(){
</font>    for(auto it = korisnik.begin(); it != korisnik.end(); it++)
<a name="0"></a><font color="#FF0000"><a href="match948-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_4.gif"/></a>

        cout &lt;&lt; "Clanski broj: " &lt;&lt; it -&gt; first &lt;&lt; std::endl &lt;&lt; "Ime i prezime: " &lt;&lt; it -&gt; second -&gt; ime &lt;&lt; " " &lt;&lt; it -&gt; second -&gt; prezime &lt;&lt; std::endl 
        &lt;&lt; "Adresa: " &lt;&lt; it -&gt; second -&gt; adresa &lt;&lt; std::endl &lt;&lt; "Broj telefona: " &lt;&lt; it -&gt; second -&gt; telefon &lt;&lt; std::endl &lt;&lt; std::endl;
} // ispis korisnika
void Biblioteka::IzlistajKnjige(){
</font>    for(auto it = knjiga.begin(); it != knjiga.end(); it++){
        cout &lt;&lt; "Evidencijski broj: " &lt;&lt; it -&gt; first &lt;&lt; std::endl &lt;&lt; "Naslov: " &lt;&lt; it -&gt; second -&gt; DajNaslov() &lt;&lt; std::endl &lt;&lt; "Pisac: " &lt;&lt; it -&gt; second -&gt; DajAutora() &lt;&lt; std::endl
        &lt;&lt; "Zanr: " &lt;&lt; it -&gt; second -&gt; DajZanr() &lt;&lt; std::endl &lt;&lt; "Godina izdavanja: " &lt;&lt; it -&gt; second -&gt; DajGodinuIzdavanja() &lt;&lt; std::endl;
        if(it -&gt; second -&gt; DaLiJeZaduzena()) cout &lt;&lt; "Zaduzena kod korisnika: " &lt;&lt; it -&gt; second -&gt; DajKodKogaJe() -&gt; ime &lt;&lt; " " &lt;&lt; it -&gt; second -&gt; DajKodKogaJe() -&gt; prezime &lt;&lt; std::endl;
        cout &lt;&lt; std::endl;
    }
} // ispis knjiga
void Biblioteka::ZaduziKnjigu(int br_knjige, int cl_broj){
    auto it1(knjiga.find(br_knjige));
    auto it2(korisnik.find(cl_broj));
    if(it1 == knjiga.end()) throw std::logic_error("Knjiga nije nadjena");
<a name="1"></a><font color="#00FF00"><a href="match948-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_4.gif"/></a>

    if(it2 == korisnik.end()) throw std::logic_error("Korisnik nije nadjen");
    if(it1 -&gt; second -&gt; DaLiJeZaduzena()) throw std::logic_error("Knjiga vec zaduzena");
    it1 -&gt; second -&gt; ZaduziKnjigu(*(it2 -&gt; second));
} // zaduzivanje knjige
void Biblioteka::RazduziKnjigu(int br_knjige){
    auto it(knjiga.find(br_knjige));
    if(it == knjiga.end()) throw std::logic_error("Knjiga nije nadjena");
    if(!(it -&gt; second -&gt; DaLiJeZaduzena())) throw std::logic_error("Knjiga nije zaduzena");
    it -&gt; second -&gt; RazduziKnjigu();
} // razduzivanje knjige
void Biblioteka::PrikaziZaduzenja(int cl_broj){
</font>    auto user(korisnik.find(cl_broj));
    if(user == korisnik.end()) throw std::logic_error("Korisnik nije nadjen");
    bool zaduzena;
    for(auto book = knjiga.begin(); book != knjiga.end(); book++){
        if((book -&gt; second -&gt; DajKodKogaJe()) == &amp;(*(user -&gt; second))) cout &lt;&lt; "Evidencijski broj: " &lt;&lt; book -&gt; first &lt;&lt; std::endl 
        &lt;&lt; "Naslov: " &lt;&lt; book -&gt; second -&gt; DajNaslov() &lt;&lt; std::endl &lt;&lt; "Pisac: " &lt;&lt; book -&gt; second -&gt; DajAutora() &lt;&lt; std::endl
<a name="4"></a><font color="#FF00FF"><a href="match948-1.html#4" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

        &lt;&lt; "Zanr: " &lt;&lt; book -&gt; second -&gt; DajZanr() &lt;&lt; std::endl &lt;&lt; "Godina izdavanja: " &lt;&lt; book -&gt; second -&gt; DajGodinuIzdavanja() &lt;&lt; std::endl &lt;&lt; std::endl;
</font><a name="4"></a><font color="#FF00FF"><a href="match948-1.html#4" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

        zaduzena = true;
</font>    }
    if(!zaduzena) throw std::logic_error("Nema zaduzenja za tog korisnika");
}
int main ()
{
	return 0;
}</pre>
</body>
</html>
