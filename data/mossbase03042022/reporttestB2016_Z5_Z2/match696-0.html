<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student4982.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student4982.cpp<p></p><pre>
/B16/17 (ZadaÄ‡a 5, Zadatak 1)
//Autotestovi by Eldar Kurtic (mail: ekurtic3@etf.unsa.ba)
//Za autotestove se obracati *iskljucivo* osobi koja ih pise
#include &lt;iostream&gt;
#include &lt;new&gt;
#include &lt;stdexcept&gt;
#include &lt;algorithm&gt;
#include &lt;string&gt;
#include &lt;utility&gt;
#include &lt;map&gt;

struct Korisnik
{
  std::string ime, prezime, adresa, telefon;  
};

class Knjiga
{
  std::string naslov,pisac,zanr;
  Korisnik *KodKogaJe;
  int god;
  public:
  Knjiga(std::string ime, std::string imePisca, std::string zanr, int godina) {naslov=ime; pisac=imePisca; Knjiga::zanr=zanr; god=godina; KodKogaJe=nullptr; }
  std::string DajNaslov() const { return naslov; }
  std::string DajAutora() const { return pisac; }
  std::string DajZanr() const { return zanr; }
  int DajGodinuIzdavanja() const { return god; }
<a name="6"></a><font color="#00FF00"><a href="match696-1.html#6" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

  Korisnik *DajKodKogaJe() const { return KodKogaJe; }
  void ZaduziKnjigu(Korisnik &amp;k) { KodKogaJe=&amp;k; }
  void RazduziKnjigu() { KodKogaJe=nullptr; }
  bool DaLiJeZaduzena() { if(KodKogaJe==nullptr) return false; else return true; }
</font>};

class Biblioteka
{
  std::map&lt;int, Knjiga*&gt; knjige;
  std::map&lt;int, Korisnik*&gt; korisnici;
  public:
  void RegistrirajNovogKorisnika(int br, std::string ime, std::string prez, std::string adresa, std::string br_tel);
  void RegistrirajNovuKnjigu(int br, std::string naslov, std::string ime_pisca, std::string zanr, int god);
  Korisnik &amp;NadjiKorisnika(int br);
  Knjiga &amp;NadjiKnjigu(int br);
  Biblioteka() {}
  Biblioteka(const Biblioteka &amp;b)
     {
       auto it1(b.korisnici.begin()); auto it2(b.knjige.begin());
       while(it1!=b.korisnici.end())
       {
         auto temp=*(it1-&gt;second);
         korisnici.insert(std::make_pair(it1-&gt;first,new Korisnik(temp)));
         it1++;
       }
       while(it2!=b.knjige.end())
       {
         auto temp=*(it2-&gt;second);
         knjige.insert(std::make_pair(it2-&gt;first,new Knjiga(temp.DajNaslov(),temp.DajAutora(),temp.DajZanr(),temp.DajGodinuIzdavanja())));
         it2++;
       }
       it1=b.korisnici.begin(); it2=b.knjige.begin();
       while(it1!=b.korisnici.end())
       {
         it2=b.knjige.begin();
         while(it2!=b.knjige.end())
         {
           if(it2-&gt;second-&gt;DajKodKogaJe()==it1-&gt;second) ZaduziKnjigu(it2-&gt;first, it1-&gt;first);
           it2++;
         }
         it1++;
       }
     }
  Biblioteka(Biblioteka &amp;&amp;b)
  {
    auto it(b.korisnici.begin());
    while(it!=b.korisnici.end())
    {
      korisnici.insert(std::make_pair(it-&gt;first,it-&gt;second));
      it-&gt;second=nullptr;
      it++;
    }
    auto it2(b.knjige.begin());
    while(it2!=b.knjige.end())
    {
      knjige.insert(std::make_pair(it2-&gt;first,it2-&gt;second));
      it2-&gt;second=nullptr;
      it2++;
    }
  }
  Biblioteka &amp;operator =(const Biblioteka &amp;b)
  {
    if(&amp;b!=this)
    {
      if(knjige.size()!=0)
      {
        auto it(knjige.begin());
        while(it!=knjige.end())
        {
          delete it-&gt;second;
          knjige.erase(it);
          it++;
        }
        auto it2(b.knjige.begin());
        while(it2!=b.knjige.end())
        {
          auto temp=*(it2-&gt;second);
          knjige.insert(std::make_pair(it2-&gt;first,new Knjiga(temp.DajNaslov(),temp.DajAutora(),temp.DajZanr(),temp.DajGodinuIzdavanja())));
          it2++;
        }
      }
      else
      {
        auto it(b.knjige.begin());
        while(it!=b.knjige.end())
        {
          auto temp=*(it-&gt;second);
          knjige.insert(std::make_pair(it-&gt;first,new Knjiga(temp.DajNaslov(),temp.DajAutora(),temp.DajZanr(),temp.DajGodinuIzdavanja())));
          it++;
        }
      }
      if(korisnici.size()!=0)
      {
        auto it(korisnici.begin());
        while(it!=korisnici.end())
        {
          delete it-&gt;second;
          korisnici.erase(it);
          it++;
        }
        auto it2(b.korisnici.begin());
        while(it2!=b.korisnici.end())
        {
          auto temp=*(it2-&gt;second);
          korisnici.insert(std::make_pair(it2-&gt;first,new Korisnik(temp)));
          it2++;
        }
      }
      else
      {
        auto it(b.korisnici.begin());
        while(it!=b.korisnici.end())
        {
          auto temp=*(it-&gt;second);
          korisnici.insert(std::make_pair(it-&gt;first,new Korisnik(temp)));
          it++;
        }
      }
      auto itt(b.korisnici.begin()); auto ittt(b.knjige.begin());
      {
        while(itt!=b.korisnici.end())
        {
          ittt=b.knjige.begin();
          while(ittt!=b.knjige.end())
          {
            if(ittt-&gt;second-&gt;DajKodKogaJe()==itt-&gt;second) ZaduziKnjigu(ittt-&gt;first,itt-&gt;first);
            ittt++;
          }
          itt++;
        }
        
      }
    }
    return *this;
  }
  void IzlistajKorisnike();
  void IzlistajKnjige();
  void ZaduziKnjigu(int br_knjige, int br_kor);
  void RazduziKnjigu(int br_knjige);
  void PrikaziZaduzenja(int br);
  ~Biblioteka() 
  { 
    auto it(korisnici.begin()); auto it2(knjige.begin());
    while(it2!=knjige.end())
    {
      it2-&gt;second-&gt;RazduziKnjigu();
      delete it2-&gt;second;
      it2++;
    }
    while(it!=korisnici.end())
    {
      delete it-&gt;second;
      it++;
    }
  }
};

void Biblioteka::RegistrirajNovogKorisnika(int br, std::string ime, std::string prez, std::string adresa, std::string br_tel)
{
  auto it(korisnici.find(br));
  if(it==korisnici.end()) korisnici.insert(std::make_pair(br,new Korisnik{ime,prez,adresa,br_tel}));
  else throw std::logic_error("Korisnik vec postoji");
}
void Biblioteka::RegistrirajNovuKnjigu(int br, std::string naslov, std::string ime_pisca, std::string zanr, int god)
{
  auto it(knjige.find(br));
  if(it==knjige.end()) knjige.insert(std::make_pair(br,new Knjiga(naslov,ime_pisca,zanr,god)));
  else throw std::logic_error("Knjiga vec postoji");
}
Knjiga&amp; Biblioteka::NadjiKnjigu(int br)
{
  auto it(knjige.find(br));
  if(it==knjige.end()) throw std::logic_error("Knjiga nije nadjena");
  else return *(it-&gt;second);
}
Korisnik&amp; Biblioteka::NadjiKorisnika(int br)
{
  auto it(korisnici.find(br));
  if(it==korisnici.end()) throw std::logic_error("Korisnik nije nadjen");
  else return *(it-&gt;second);
}
void Biblioteka::IzlistajKorisnike()
{
  auto it(korisnici.begin());
  while(it!=korisnici.end())
  {
    std::cout&lt;&lt;"Clanski broj: "&lt;&lt;it-&gt;first&lt;&lt;std::endl;
    std::cout&lt;&lt;"Ime i prezime: "&lt;&lt;it-&gt;second-&gt;ime&lt;&lt;" "&lt;&lt;it-&gt;second-&gt;prezime&lt;&lt;std::endl;
    std::cout&lt;&lt;"Adresa: "&lt;&lt;it-&gt;second-&gt;adresa&lt;&lt;std::endl;
    std::cout&lt;&lt;"Broj telefona: "&lt;&lt;it-&gt;second-&gt;telefon&lt;&lt;std::endl;
    std::cout&lt;&lt;std::endl;
    it++;
  }
}
void Biblioteka::IzlistajKnjige()
{
  auto it(knjige.begin());
  while(it!=knjige.end())
  {
    std::cout&lt;&lt;"Evidencijski broj: "&lt;&lt;it-&gt;first&lt;&lt;std::endl;
    std::cout&lt;&lt;"Naslov: "&lt;&lt;it-&gt;second-&gt;DajNaslov()&lt;&lt;std::endl;
    std::cout&lt;&lt;"Pisac: "&lt;&lt;it-&gt;second-&gt;DajAutora()&lt;&lt;std::endl;
    std::cout&lt;&lt;"Zanr: "&lt;&lt;it-&gt;second-&gt;DajZanr()&lt;&lt;std::endl;
    std::cout&lt;&lt;"Godina izdavanja: "&lt;&lt;it-&gt;second-&gt;DajGodinuIzdavanja()&lt;&lt;std::endl;
    if(it-&gt;second-&gt;DaLiJeZaduzena()) std::cout&lt;&lt;"Zaduzena kod korisnika: "&lt;&lt;it-&gt;second-&gt;DajKodKogaJe()-&gt;ime&lt;&lt;" "&lt;&lt;it-&gt;second-&gt;DajKodKogaJe()-&gt;prezime&lt;&lt;std::endl;
    std::cout&lt;&lt;std::endl;
    it++;
  }
}
<a name="5"></a><font color="#FF0000"><a href="match696-1.html#5" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

void Biblioteka::ZaduziKnjigu(int br_knjige,int br_kor)
{
  auto it(knjige.find(br_knjige));
  auto it2(korisnici.find(br_kor));
  if(it==knjige.end()) throw std::logic_error("Knjiga nije nadjena");
</font>  if(it2==korisnici.end()) throw std::logic_error("Korisnik nije nadjen");
<a name="3"></a><font color="#00FFFF"><a href="match696-1.html#3" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

  if(it-&gt;second-&gt;DaLiJeZaduzena()==true) throw std::logic_error("Knjiga vec zaduzena");
  it-&gt;second-&gt;ZaduziKnjigu(*(it2-&gt;second));
}
void Biblioteka::RazduziKnjigu(int br_knjige)
{
  auto it(knjige.find(br_knjige));
  if(it==knjige.end()) throw std::logic_error("Knjiga nije nadjena");
</font>  if(it-&gt;second-&gt;DaLiJeZaduzena()==false) throw std::logic_error("Knjiga nije zaduzena");
  it-&gt;second-&gt;RazduziKnjigu();
}
void Biblioteka::PrikaziZaduzenja(int br)
{
  auto it(korisnici.find(br));
  if(it==korisnici.end()) throw std::logic_error("Korisnik nije nadjen");
  auto it2=knjige.begin();
  int broj=0;
  while(it2!=knjige.end())
  {
    if(it2-&gt;second-&gt;DajKodKogaJe()==it-&gt;second)
    {
      std::cout&lt;&lt;"Evidencijski broj: "&lt;&lt;it2-&gt;first&lt;&lt;std::endl;
      std::cout&lt;&lt;"Naslov: "&lt;&lt;it2-&gt;second-&gt;DajNaslov()&lt;&lt;std::endl;
      std::cout&lt;&lt;"Pisac: "&lt;&lt;it2-&gt;second-&gt;DajAutora()&lt;&lt;std::endl;
      std::cout&lt;&lt;"Zanr: "&lt;&lt;it2-&gt;second-&gt;DajZanr()&lt;&lt;std::endl;
      std::cout&lt;&lt;"Godina izdavanja: "&lt;&lt;it2-&gt;second-&gt;DajGodinuIzdavanja()&lt;&lt;std::endl&lt;&lt;std::endl;
      broj++;
    }
    it2++;
  }
  if(broj==0) std::cout&lt;&lt;"Nema zaduzenja za tog korisnika!"&lt;&lt;std::endl;
}
int main ()
{
  Biblioteka b;
  while(1) {
  std::cout&lt;&lt;"Odaberite opciju:"&lt;&lt;std::endl;
  std::cout&lt;&lt;"1 - Unos nove knjige"&lt;&lt;std::endl
  &lt;&lt;"2 - Unos novog korisnika"&lt;&lt;std::endl
  &lt;&lt;"3 - Zaduzenje knjige"&lt;&lt;std::endl
  &lt;&lt;"4 - Razduzenje knjige"&lt;&lt;std::endl
  &lt;&lt;"5 - Lista knjiga"&lt;&lt;std::endl
  &lt;&lt;"6 - Lista korisnika"&lt;&lt;std::endl
  &lt;&lt;"7 - Zaduzenja korisnika"&lt;&lt;std::endl
  &lt;&lt;"0 - Kraj"&lt;&lt;std::endl;
  int n;
  std::cin&gt;&gt;n;
  if(n==0) break;
  if(n==1)
  {
    std::string naziv, autor, zanr;
    int br_knj;
    std::cout&lt;&lt;"Unesite broj knjige: ";
    std::cin&gt;&gt;br_knj;
    std::cin.ignore(1000,'\n');
    std::cout&lt;&lt;"Unesite naziv knjige: ";
    int god;
    std::getline(std::cin, naziv);
    std::cout&lt;&lt;"Unesite ime autora: ";
<a name="0"></a><font color="#FF0000"><a href="match696-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_2.gif"/></a>

    std::getline(std::cin, autor);
    std::cout&lt;&lt;"Unesite zanr knjige: ";
    std::getline(std::cin, zanr);
    std::cout&lt;&lt;"Unesite godinu izdavanja: ";
    std::cin&gt;&gt;god;
    std::cin.ignore(1000,'\n');
    try {
    b.RegistrirajNovuKnjigu(br_knj,naziv,autor,zanr,god);
    }
    catch (std::logic_error l)
</font>    {
      std::cout&lt;&lt;l.what()&lt;&lt;std::endl;
    }
    catch (std::bad_alloc)
    {
      std::cout&lt;&lt;"Alokacija nije uspjela"&lt;&lt;std::endl;
    }
  }
  if(n==2)
  {
    std::string ime, prezime, adresa, tel;
    int br;
<a name="2"></a><font color="#0000FF"><a href="match696-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

    std::cout&lt;&lt;"Unesite korisnicki broj: ";
    std::cin&gt;&gt;br;
    std::cin.ignore(1000,'\n');
    std::cout&lt;&lt;"Unesite ime korisnika: ";
    std::getline(std::cin,ime);
    std::cout&lt;&lt;"Unesite prezime korisnika: ";
    std::getline(std::cin,prezime);
</font>    std::cout&lt;&lt;"Unesite adresu: ";
<a name="4"></a><font color="#FF00FF"><a href="match696-1.html#4" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

    std::getline(std::cin,adresa);
    std::cout&lt;&lt;"Unesite broj telefona: ";
    std::getline(std::cin,tel);
    try {
    b.RegistrirajNovogKorisnika(br,ime,prezime,adresa,tel);
</font>    }
    catch(std::logic_error l)
    {
      std::cout&lt;&lt;l.what()&lt;&lt;std::endl;
    }
    catch(std::bad_alloc)
    {
      std::cout&lt;&lt;"Alokacija nije uspjela"&lt;&lt;std::endl;
    }
  }
  if(n==3)
  {
<a name="1"></a><font color="#00FF00"><a href="match696-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_2.gif"/></a>

    int br_knj, br_kor;
    std::cout&lt;&lt;"Unesite broj knjige koju zelite zaduziti: ";
    std::cin&gt;&gt;br_knj;
    std::cin.ignore(1000,'\n');
    std::cout&lt;&lt;"Unesite broj korisnika koji zeli zaduziti knjigu: ";
    std::cin&gt;&gt;br_kor;
    std::cin.ignore(1000,'\n');
    try {
    b.ZaduziKnjigu(br_knj,br_kor);
</font>    }
    catch (std::logic_error l)
    {
      std::cout&lt;&lt;l.what()&lt;&lt;std::endl;
    }
  }
  if(n==4)
  {
<a name="7"></a><font color="#0000FF"><a href="match696-1.html#7" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

    int br_knj;
    std::cout&lt;&lt;"Unesite broj knjige koju zelite razduziti: ";
    std::cin&gt;&gt;br_knj;
    std::cin.ignore(1000,'\n');
    try {
    b.RazduziKnjigu(br_knj);
</font>    }
    catch (std::logic_error l)
    {
      std::cout&lt;&lt;l.what()&lt;&lt;std::endl;
    }
  }
  if(n==5) b.IzlistajKnjige();
  if(n==6) b.IzlistajKorisnike();
  if(n==7)
  {
    std::cout&lt;&lt;"Unesite broj korisnika: ";
    int br;
    std::cin&gt;&gt;br;
    std::cin.ignore(1000,'\n');
    try {
    b.PrikaziZaduzenja(br);
    }
    catch(std::logic_error l)
    {
      std::cout&lt;&lt;l.what()&lt;&lt;std::endl;
    }
  }
  }
	return 0;
}</pre>
</body>
</html>
