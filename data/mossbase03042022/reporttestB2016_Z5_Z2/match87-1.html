<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student4659.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student1324.cpp<p></p><pre>
/B16/17 (ZadaÄ‡a 5, Zadatak 2)
//Autotestovi by Eldar Kurtic (mail: ekurtic3@etf.unsa.ba)
//Za autotestove se obracati *iskljucivo* osobi koja ih pise
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;map&gt;
#include &lt;memory&gt;

<a name="3"></a><font color="#00FFFF"><a href="match87-0.html#3" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_3.gif"/></a>

struct Korisnik {
    std::string ime,prezime,adresa,telefon;
};

class Knjiga{
    std::string naslov,ime_pisca,zanr;
    int godina;
    std::shared_ptr&lt;Korisnik&gt; pok;
    public:
        //KONSTRUKTOR SA 4 PARAMETRA
        Knjiga(std::string s1,std::string s2,std::string s3,int g):naslov(s1),ime_pisca(s2),zanr(s3),godina(g),pok(nullptr) {}
</font>        
        //PRISTUPNE METODE
        std::string DajNaslov() const { return naslov; }
<a name="1"></a><font color="#00FF00"><a href="match87-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_18.gif"/></a>

        std::string DajAutora() const { return ime_pisca; }
        std::string DajZanr() const { return zanr; }
        int DajGodinuIzdavanja() const { return godina; }
        std::shared_ptr&lt;Korisnik&gt; DajKodKogaJe() const { return pok; }
        
        //METODE 
        void ZaduziKnjigu(Korisnik &amp;k){ pok=std::make_shared&lt;Korisnik&gt;(k); }
        void RazduziKnjigu(){ pok=nullptr; }
        bool DaLiJeZaduzena(){
            if(pok==nullptr)return false;
            return true;
        }
};

class Biblioteka {
    std::map&lt;int,std::shared_ptr&lt;Knjiga&gt;&gt; m1;
    std::map&lt;int,std::shared_ptr&lt;Korisnik&gt;&gt; m2;
    public:
        //KONSTRUKTOR BEZ PARAMETARA
        Biblioteka()= default;
        
        //KOPIRAJUCI KONSTRUKTOR I OPERATOR DODJELE(DUBOKO KOPIRANJE)
        Biblioteka(const Biblioteka &amp;b);
        Biblioteka &amp;operator =(const Biblioteka &amp;b);
        
        //POMJERAJUCI KONSTRUKTOR I OPERATOR DODJELE(PRIVREMENE OBJEKTE)
        Biblioteka(Biblioteka &amp;&amp;b);
        Biblioteka &amp;operator =(Biblioteka &amp;&amp;b);
        
        //DESTRUKTOR
        ~Biblioteka()=default;
        
        //METODE ZA MANIPULACIJU SA PODACIMA
        void RegistrirajNovogKorisnika(int clanski_broj,std::string s1, std::string s2, std::string s3,std::string s4){
            if(!m2.count(clanski_broj))m2[clanski_broj]=std::make_shared&lt;Korisnik&gt;(Korisnik{s1,s2,s3,s4});
            else throw std::logic_error("Korisnik vec postoji");
        }
        void RegistrirajNovuKnjigu(int broj,std::string s1,std::string s2,std::string s3,int god){
            if(!m1.count(broj))m1[broj]=std::make_shared&lt;Knjiga&gt; (Knjiga(s1,s2,s3,god));
            else throw std::logic_error("Knjiga vec postoji");
        }
        Korisnik &amp;NadjiKorisnika(int clanski_broj){
            if(!m2.count(clanski_broj))throw std::logic_error("Korisnik nije nadjen");
            else return *m2[clanski_broj];
        }
        Knjiga &amp;NadjiKnjigu(int evidencijski_broj){
            if(!m1.count(evidencijski_broj))throw std::logic_error("Knjiga nije nadjena");
            else return *m1[evidencijski_broj];
        }
        void IzlistajKorisnike()const {
            for(auto it=m2.begin();it!=m2.end();it++){
                std::cout &lt;&lt; "Clanski broj: " &lt;&lt; it-&gt;first &lt;&lt; std::endl;
</font>                std::cout &lt;&lt; "Ime i prezime: " &lt;&lt; it-&gt;second-&gt;ime &lt;&lt; " " &lt;&lt; it-&gt;second-&gt;prezime &lt;&lt; std::endl;
                std::cout &lt;&lt; "Adresa: " &lt;&lt; it-&gt;second-&gt;adresa &lt;&lt; std::endl;
<a name="4"></a><font color="#FF00FF"><a href="match87-0.html#4" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_2.gif"/></a>

                std::cout &lt;&lt; "Broj telefona: " &lt;&lt; it-&gt;second-&gt;telefon &lt;&lt; std::endl;
                std::cout &lt;&lt; std::endl;
            }
        }
        void IzlistajKnjige() const {
            for(auto it=m1.begin();it!=m1.end();it++){
                std::cout &lt;&lt; "Evidencijski broj: " &lt;&lt; it-&gt;first &lt;&lt; std::endl;
</font>                std::cout &lt;&lt; "Naslov: " &lt;&lt; it-&gt;second-&gt;DajNaslov() &lt;&lt; std::endl;
                std::cout &lt;&lt; "Pisac: " &lt;&lt; it-&gt;second-&gt;DajAutora() &lt;&lt; std::endl;
                std::cout &lt;&lt; "Zanr: " &lt;&lt; it-&gt;second-&gt;DajZanr() &lt;&lt; std::endl;
                std::cout &lt;&lt; "Godina izdavanja: " &lt;&lt; it-&gt;second-&gt;DajGodinuIzdavanja() &lt;&lt; std::endl;
                if(it-&gt;second-&gt;DaLiJeZaduzena()){
<a name="2"></a><font color="#0000FF"><a href="match87-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_11.gif"/></a>

                    std::cout &lt;&lt; "Zaduzena kod korisnika: " &lt;&lt; it-&gt;second-&gt;DajKodKogaJe()-&gt;ime &lt;&lt; " " &lt;&lt; it-&gt;second-&gt;DajKodKogaJe()-&gt;prezime &lt;&lt; std::endl;
                }    
                std::cout &lt;&lt; std::endl;
            }
        }
        void ZaduziKnjigu(int evidencijski_broj,int clanski_broj){
            try{
                if(NadjiKnjigu(evidencijski_broj).DaLiJeZaduzena()) throw std::logic_error("Knjiga vec zaduzena");
                else NadjiKnjigu(evidencijski_broj).ZaduziKnjigu(NadjiKorisnika(clanski_broj));
            }
            catch(std::logic_error e){
                std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
            }
        }
        void RazduziKnjigu(int evidencijski_broj){
            try{
                std::shared_ptr&lt;Knjiga&gt; p (&amp;NadjiKnjigu(evidencijski_broj));
                if(!p-&gt;DaLiJeZaduzena()) throw std::logic_error("Knjiga nije zaduzena");
                else p-&gt;RazduziKnjigu();
            }
            catch(std::logic_error e){
                std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
            }
        }
        void PrikaziZaduzenja(int clanski_broj) {
            try{
                std::shared_ptr&lt;Korisnik&gt; p(&amp;NadjiKorisnika(clanski_broj));
                if(!m2.count(clanski_broj)) std::cout &lt;&lt; "Nema zaduzenja za tog korisnik!" &lt;&lt; std::endl;
                for(auto it=m1.begin();it!=m1.end();it++){
                    if(it-&gt;second-&gt;DajKodKogaJe()==p){
                        std::cout &lt;&lt; "Evidencijski broj: " &lt;&lt; it-&gt;first &lt;&lt; std::endl;
                        std::cout &lt;&lt; "Naslov: " &lt;&lt; it-&gt;second-&gt;DajNaslov() &lt;&lt; std::endl;
</font>                        std::cout &lt;&lt; "Pisac: " &lt;&lt; it-&gt;second-&gt;DajAutora() &lt;&lt; std::endl;
<a name="0"></a><font color="#FF0000"><a href="match87-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_45.gif"/></a>

                        std::cout &lt;&lt; "Zanr: " &lt;&lt; it-&gt;second-&gt;DajZanr() &lt;&lt; std::endl;
                        std::cout &lt;&lt; "Godina izdavanja: " &lt;&lt; it-&gt;second-&gt;DajGodinuIzdavanja() &lt;&lt; std::endl;
                    }
                }    
            }
            catch(std::logic_error e){
                std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
            }
        }
};

Biblioteka::Biblioteka(const Biblioteka &amp;b){
    try{
        for(auto it=b.m1.begin();it!=b.m1.end();it++) m1.insert(std::pair&lt;int,std::shared_ptr&lt;Knjiga&gt;&gt;(it-&gt;first,std::make_shared&lt;Knjiga&gt;(Knjiga(*(it-&gt;second)))));
        for(auto it=b.m2.begin();it!=b.m2.end();it++) m2.insert(std::pair&lt;int,std::shared_ptr&lt;Korisnik&gt;&gt;(it-&gt;first,std::make_shared&lt;Korisnik&gt;(Korisnik(*(it-&gt;second)))));    
    }
    catch(...){
        throw;
    }
}

Biblioteka &amp;Biblioteka::operator=(const Biblioteka &amp;b){
    try{
        if(b.m1.size() &gt;= m1.size()){                                // BRISE I KNJIGE I MIJENJA IH SA NOVIM //
            for(auto it=m1.begin();it!=m1.end();it++){
                it-&gt;second=nullptr;
                m1.erase(it);
            }
            try{
                for(auto it=b.m1.begin();it!=b.m1.end();it++){
                    RegistrirajNovuKnjigu(it-&gt;first,it-&gt;second-&gt;DajNaslov(),it-&gt;second-&gt;DajAutora(),it-&gt;second-&gt;DajZanr(),it-&gt;second-&gt;DajGodinuIzdavanja());
                }
            }
            catch(...){
                for(auto it=m1.begin();it!=m1.end();it++){ 
                    it-&gt;second=nullptr;
                }
                throw;
            }
        }
        else {
            for(auto it=m1.begin();it!=m1.end();it++){
                it-&gt;second=nullptr;
                m1.erase(it);
            }
            try{
                for(auto it=b.m1.begin();it!=b.m1.end();it++){
                    RegistrirajNovuKnjigu(it-&gt;first,it-&gt;second-&gt;DajNaslov(),it-&gt;second-&gt;DajAutora(),it-&gt;second-&gt;DajZanr(),it-&gt;second-&gt;DajGodinuIzdavanja());
                }
            }
            catch(...){
                for(auto it=m1.begin();it!=m1.end();it++){ 
                    it-&gt;second=nullptr;
                }
                throw;
            }
        }
    }
    catch(...){
        throw;
    }
    try{
        if(b.m2.size() &gt;= m2.size()){                                   // BRISE KORSINIKE I MIJENJA IH SA NOVIM //
            for(auto it=m2.begin();it!=m2.end();it++){
                it-&gt;second=nullptr;
                m2.erase(it);
            }
            try{
                for(auto it=b.m2.begin();it!=b.m2.end();it++){
                    RegistrirajNovogKorisnika(it-&gt;first,it-&gt;second-&gt;ime,it-&gt;second-&gt;prezime,it-&gt;second-&gt;adresa,it-&gt;second-&gt;telefon);
                }
            }
            catch(...){
                for(auto it=m2.begin();it!=m2.end();it++){ 
                    it-&gt;second=nullptr;
                }
                throw;
            }
        }
        else {
            for(auto it=m2.begin();it!=m2.end();it++){
                it-&gt;second=nullptr;
                m2.erase(it);
            }
            try{
                for(auto it=b.m2.begin();it!=b.m2.end();it++){
                    RegistrirajNovogKorisnika(it-&gt;first,it-&gt;second-&gt;ime,it-&gt;second-&gt;prezime,it-&gt;second-&gt;adresa,it-&gt;second-&gt;telefon);
                }
            }
            catch(...){
                for(auto it=m2.begin();it!=m2.end();it++){ 
                    it-&gt;second=nullptr;
                } 
                throw;
            }
        }
    }
    catch(...){
        throw;
    }
    return *this;
}

Biblioteka::Biblioteka(Biblioteka &amp;&amp;b){
    m1=b.m1;
    m2=b.m2;
    for(auto it=b.m1.begin();it!=b.m1.end();it++) it-&gt;second=nullptr;
    for(auto it=b.m2.begin();it!=b.m2.end();it++) it-&gt;second=nullptr;
}

Biblioteka &amp;Biblioteka::operator =(Biblioteka &amp;&amp;b){
    std::swap(m1,b.m1);
    std::swap(m2,b.m2);
    return *this;
}

int main ()
{
    Biblioteka bib8;
bib8.RegistrirajNovogKorisnika(1, "Niko", "Nikic", "Zmaja od Bosne bb", "123 456");
bib8.RegistrirajNovuKnjigu(1, "Vlak u snijegu2", "Mato Lovrak2", "Roman2", 1941);
bib8.RegistrirajNovuKnjigu(2, "Vlak u snijegu", "Mato Lovrak", "Roman", 1931);
bib8.ZaduziKnjigu(2, 1);
bib8.IzlistajKnjige();
</font>
    return 0;
}</pre>
</body>
</html>
