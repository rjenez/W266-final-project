<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student3701.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student7001.cpp<p></p><pre>
/B16/17 (ZadaÄ‡a 5, Zadatak 2)
//Autotestovi by Eldar Kurtic (mail: ekurtic3@etf.unsa.ba)
//Za autotestove se obracati *iskljucivo* osobi koja ih pise
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;stdexcept&gt;
#include &lt;map&gt;
#include &lt;utility&gt;
#include &lt;memory&gt;

struct Korisnik {
    std::string ime, prezime, adresa, telefon;
};

class Knjiga {
    std::string naslov, ime_pisca, zanr;
    int godina_izdavanja;
    Korisnik* korisnik;
public:
    Knjiga (std::string naslov, std::string ime_pisca, std::string zanr, int godina_izdavanja, Korisnik* korisnik=nullptr) : 
        naslov(naslov), ime_pisca(ime_pisca), zanr(zanr), godina_izdavanja(godina_izdavanja), korisnik(korisnik) {}
    std::string DajNaslov() const { return naslov; }
    std::string DajAutora() const { return ime_pisca; }
    std::string DajZanr() const { return zanr; }
    int DajGodinuIzdavanja() const { return godina_izdavanja; }
    Korisnik* DajKodKogaJe() const { return korisnik; }
<a name="3"></a><font color="#00FFFF"><a href="match781-0.html#3" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

    void ZaduziKnjigu(Korisnik &amp;k) { korisnik=&amp;k; }
    void RazduziKnjigu() { korisnik=nullptr; }
    bool DaLiJeZaduzena() { if (DajKodKogaJe()==nullptr) return false; return true; }
};

class Biblioteka {
    std::map&lt;int,std::shared_ptr&lt;Korisnik&gt;&gt; mapa_korisnika;
</font>    std::map&lt;int,std::shared_ptr&lt;Knjiga&gt;&gt; mapa_knjiga;
public:
    explicit Biblioteka()=default;
    ~Biblioteka();
    Biblioteka(const Biblioteka &amp;b);
    Biblioteka(Biblioteka &amp;&amp;b);
    Biblioteka &amp;operator =(const Biblioteka &amp;b);
    Biblioteka &amp;operator =(Biblioteka &amp;&amp;b);
    void RegistrirajNovogKorisnika(int clanski_broj,std::string ime,std::string prezime,std::string adresa,std::string telefon);
<a name="0"></a><font color="#FF0000"><a href="match781-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_2.gif"/></a>

    void RegistrirajNovuKnjigu(int evidencijski_broj,std::string naslov,std::string ime_pisca,std::string zanr,int godina_izdavanja);
    Korisnik &amp;NadjiKorisnika(int clanski_broj) const;
    Knjiga &amp;NadjiKnjigu(int evidencijski_broj) const;
    void IzlistajKorisnike() const;
    void IzlistajKnjige() const;
    void ZaduziKnjigu(int evidencijski_broj,int clanski_broj);
    void RazduziKnjigu(int evidencijski_broj);
    void PrikaziZaduzenja(int clanski_broj) const;
};

Biblioteka::~Biblioteka() {
</font><a name="6"></a><font color="#00FF00"><a href="match781-0.html#6" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

    for (auto it=mapa_korisnika.begin(); it!=mapa_korisnika.end(); it++)
        it-&gt;second=nullptr;
    for (auto it=mapa_knjiga.begin(); it!=mapa_knjiga.end(); it++)
</font>        it-&gt;second=nullptr;
}

Biblioteka::Biblioteka(const Biblioteka &amp;b) {
    try {
        for (auto it=b.mapa_korisnika.begin(); it!=b.mapa_korisnika.end(); it++) {
            Korisnik temp{it-&gt;second-&gt;ime,it-&gt;second-&gt;prezime,it-&gt;second-&gt;adresa,it-&gt;second-&gt;telefon};
            std::shared_ptr&lt;Korisnik&gt; pok=std::make_shared&lt;Korisnik&gt;(temp);
            mapa_korisnika.insert(std::make_pair(it-&gt;first,pok));
        }
        try {
<a name="1"></a><font color="#00FF00"><a href="match781-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

            for (auto it=b.mapa_knjiga.begin(); it!=b.mapa_knjiga.end(); it++) {
                std::shared_ptr&lt;Knjiga&gt; pok=std::make_shared&lt;Knjiga&gt;(it-&gt;second-&gt;DajNaslov(),it-&gt;second-&gt;DajAutora(),it-&gt;second-&gt;DajZanr(),it-&gt;second-&gt;DajGodinuIzdavanja(),it-&gt;second-&gt;DajKodKogaJe());
</font>                mapa_knjiga.insert(std::make_pair(it-&gt;first,pok));
            }
        }
        catch(...) {
            for (auto it=mapa_knjiga.begin(); it!=mapa_knjiga.end(); it++)
                it-&gt;second=nullptr;
            for (auto it=mapa_korisnika.begin(); it!=mapa_korisnika.end(); it++)
                it-&gt;second=nullptr;
            throw;
        }
    }
    catch(...) {
        for (auto it=mapa_korisnika.begin(); it!=mapa_korisnika.end(); it++)
            it-&gt;second=nullptr;
        throw;
    }
}

Biblioteka::Biblioteka(Biblioteka &amp;&amp;b) {
    mapa_korisnika=std::move(b.mapa_korisnika);
    mapa_knjiga=std::move(b.mapa_knjiga);
}

Biblioteka &amp;Biblioteka::operator =(const Biblioteka &amp;b) {
    Biblioteka temp;
    try {
        for (auto it=b.mapa_korisnika.begin(); it!=b.mapa_korisnika.end(); it++) {
            Korisnik temp1{it-&gt;second-&gt;ime,it-&gt;second-&gt;prezime,it-&gt;second-&gt;adresa,it-&gt;second-&gt;telefon};
            std::shared_ptr&lt;Korisnik&gt; pok=std::make_shared&lt;Korisnik&gt;(temp1);
            temp.mapa_korisnika.insert(std::make_pair(it-&gt;first,pok));
        }
        try {
            for (auto it=b.mapa_knjiga.begin(); it!=b.mapa_knjiga.end(); it++) {
                std::shared_ptr&lt;Knjiga&gt; pok=std::make_shared&lt;Knjiga&gt;(it-&gt;second-&gt;DajNaslov(),it-&gt;second-&gt;DajAutora(),it-&gt;second-&gt;DajZanr(),it-&gt;second-&gt;DajGodinuIzdavanja(),it-&gt;second-&gt;DajKodKogaJe());
                temp.mapa_knjiga.insert(std::make_pair(it-&gt;first,pok));
            }
        }
        catch(...) {
            for (auto it=temp.mapa_knjiga.begin(); it!=temp.mapa_knjiga.end(); it++)
                it-&gt;second=nullptr;
            for (auto it=temp.mapa_korisnika.begin(); it!=temp.mapa_korisnika.end(); it++)
                it-&gt;second=nullptr;
            throw;
        }
    }
    catch(...) {
        for (auto it=temp.mapa_korisnika.begin(); it!=temp.mapa_korisnika.end(); it++)
            it-&gt;second=nullptr;
        throw;
    }
    for (auto it=mapa_korisnika.begin(); it!=mapa_korisnika.end(); it++)
        it-&gt;second=nullptr;
    for (auto it=mapa_knjiga.begin(); it!=mapa_knjiga.end(); it++)
        it-&gt;second=nullptr;
    mapa_korisnika=std::move(temp.mapa_korisnika);
    mapa_knjiga=std::move(temp.mapa_knjiga);
<a name="5"></a><font color="#FF0000"><a href="match781-0.html#5" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

    return *this;
}

Biblioteka &amp;Biblioteka::operator =(Biblioteka &amp;&amp;b) {
    for (auto it=mapa_korisnika.begin(); it!=mapa_korisnika.end(); it++) 
</font>        it-&gt;second=nullptr;
    for (auto it=mapa_knjiga.begin(); it!=mapa_knjiga.end(); it++) 
        it-&gt;second=nullptr;
    mapa_korisnika=std::move(b.mapa_korisnika);
    mapa_knjiga=std::move(b.mapa_knjiga);
    return *this;
}

void Biblioteka::RegistrirajNovogKorisnika(int clanski_broj,std::string ime,std::string prezime,std::string adresa,std::string telefon) {
    auto it(mapa_korisnika.find(clanski_broj));
    if (mapa_korisnika.begin()!=mapa_korisnika.end() &amp;&amp; it!=mapa_korisnika.end()) 
        throw std::logic_error("Korisnik vec postoji");
    try {
        Korisnik tmp{ime,prezime,adresa,telefon};
        std::shared_ptr&lt;Korisnik&gt; pok=std::make_shared&lt;Korisnik&gt;(tmp);
        mapa_korisnika.insert(std::make_pair(clanski_broj,pok));
    }
    catch(...) {
        throw;
    }
}

void Biblioteka::RegistrirajNovuKnjigu(int evidencijski_broj,std::string naslov,std::string ime_pisca,std::string zanr,int godina_izdavanja) {
    auto it(mapa_knjiga.find(evidencijski_broj));
    if (mapa_knjiga.begin()!=mapa_knjiga.end() &amp;&amp; it!=mapa_knjiga.end())
        throw std::logic_error("Knjiga vec postoji");
    try {
<a name="7"></a><font color="#0000FF"><a href="match781-0.html#7" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

        std::shared_ptr&lt;Knjiga&gt; pok=std::make_shared&lt;Knjiga&gt;(naslov,ime_pisca,zanr,godina_izdavanja);
        mapa_knjiga.insert(std::make_pair(evidencijski_broj,pok));
</font>    }
    catch(...) {
        throw;
    }
}

Korisnik &amp;Biblioteka::NadjiKorisnika(int clanski_broj) const {
    auto it(mapa_korisnika.find(clanski_broj));
    if (it==mapa_korisnika.end())
        throw std::logic_error("Korisnik nije nadjen");
    return *it-&gt;second;
}

Knjiga &amp;Biblioteka::NadjiKnjigu(int evidencijski_broj) const {
    auto it(mapa_knjiga.find(evidencijski_broj));
    if (it==mapa_knjiga.end())
        throw std::logic_error("Knjiga nije nadjena");
    return *it-&gt;second;
}

void Biblioteka::IzlistajKorisnike() const {
    for (auto it=mapa_korisnika.begin(); it!=mapa_korisnika.end(); it++) {
        if (it-&gt;second!=nullptr) {
<a name="2"></a><font color="#0000FF"><a href="match781-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

            std::cout &lt;&lt; "Clanski broj: " &lt;&lt; it-&gt;first &lt;&lt; std::endl
            &lt;&lt; "Ime i prezime: " &lt;&lt; it-&gt;second-&gt;ime &lt;&lt; " " &lt;&lt; it-&gt;second-&gt;prezime &lt;&lt; std::endl
            &lt;&lt; "Adresa: " &lt;&lt; it-&gt;second-&gt;adresa &lt;&lt; std::endl
</font>            &lt;&lt; "Broj telefona: " &lt;&lt; it-&gt;second-&gt;telefon &lt;&lt; std::endl &lt;&lt; std::endl;
        }
    }
}

void Biblioteka::IzlistajKnjige() const {
    for (auto it=mapa_knjiga.begin(); it!=mapa_knjiga.end(); it++) {
        if (it-&gt;second!=nullptr) {
            std::cout &lt;&lt; "Evidencijski broj: " &lt;&lt; it-&gt;first &lt;&lt; std::endl
            &lt;&lt; "Naslov: " &lt;&lt; it-&gt;second-&gt;DajNaslov() &lt;&lt; std::endl
            &lt;&lt; "Pisac: " &lt;&lt; it-&gt;second-&gt;DajAutora() &lt;&lt; std::endl
<a name="4"></a><font color="#FF00FF"><a href="match781-0.html#4" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

            &lt;&lt; "Zanr: " &lt;&lt; it-&gt;second-&gt;DajZanr() &lt;&lt; std::endl
            &lt;&lt; "Godina izdavanja: " &lt;&lt; it-&gt;second-&gt;DajGodinuIzdavanja() &lt;&lt; std::endl;
            if (it-&gt;second-&gt;DaLiJeZaduzena()) 
</font>                std::cout &lt;&lt; "Zaduzena kod korisnika: " &lt;&lt; it-&gt;second-&gt;DajKodKogaJe()-&gt;ime &lt;&lt; " " &lt;&lt; it-&gt;second-&gt;DajKodKogaJe()-&gt;prezime &lt;&lt; std::endl &lt;&lt; std::endl;
            else std::cout &lt;&lt; std::endl;
        }
    }
}

void Biblioteka::ZaduziKnjigu(int evidencijski_broj,int clanski_broj) {
    auto it1(mapa_korisnika.find(clanski_broj));
    auto it2(mapa_knjiga.find(evidencijski_broj));
    if (it2==mapa_knjiga.end()) 
        throw std::logic_error("Knjiga nije nadjena");
    else if (it1==mapa_korisnika.end()) 
        throw std::logic_error("Korisnik nije nadjen");
    if (it2-&gt;second-&gt;DaLiJeZaduzena()) 
        throw std::logic_error("Knjiga vec zaduzena");
    it2-&gt;second-&gt;ZaduziKnjigu(*it1-&gt;second);
}

void Biblioteka::RazduziKnjigu(int evidencijski_broj) {
    auto it(mapa_knjiga.find(evidencijski_broj));
    if (it==mapa_knjiga.end())
        throw std::logic_error("Knjiga nije nadjena");
    else if (!it-&gt;second-&gt;DaLiJeZaduzena())
        throw std::logic_error("Knjiga nije zaduzena");
    it-&gt;second-&gt;RazduziKnjigu();
}

void Biblioteka::PrikaziZaduzenja(int clanski_broj) const {
    auto it1(mapa_korisnika.find(clanski_broj));
    if (it1==mapa_korisnika.end())
        throw std::logic_error("Korisnik nije nadjen");
    int brojac_pronadjenih_korisnika=0;
    for (auto it2=mapa_knjiga.begin(); it2!=mapa_knjiga.end(); it2++) {
        if (it2-&gt;second-&gt;DaLiJeZaduzena() &amp;&amp; it2-&gt;second-&gt;DajKodKogaJe()==it1-&gt;second.get()) {
            brojac_pronadjenih_korisnika++;
            std::cout &lt;&lt; "Evidencijski broj: " &lt;&lt; it2-&gt;first &lt;&lt; std::endl
            &lt;&lt; "Naslov: " &lt;&lt; it2-&gt;second-&gt;DajNaslov() &lt;&lt; std::endl
            &lt;&lt; "Pisac: " &lt;&lt; it2-&gt;second-&gt;DajAutora() &lt;&lt; std::endl
            &lt;&lt; "Zanr: " &lt;&lt; it2-&gt;second-&gt;DajZanr() &lt;&lt; std::endl
            &lt;&lt; "Godina izdavanja: " &lt;&lt; it2-&gt;second-&gt;DajGodinuIzdavanja() &lt;&lt; std::endl &lt;&lt; std::endl;
        }
    }
    if (!brojac_pronadjenih_korisnika) std::cout &lt;&lt; "Nema zaduzenja za tog korisnika!";
}

int main () {
    std::cout &lt;&lt; "Dobrodosli u virtualnu biblioteku!" &lt;&lt; std::endl &lt;&lt; std::endl;
    int opcija;
    Biblioteka b;
    do {
        std::cout &lt;&lt; std::endl &lt;&lt; "Izaberite opciju: " &lt;&lt; std::endl
        &lt;&lt; " 0 - kraj" &lt;&lt; std::endl
        &lt;&lt; " 1 - Registriraj novog korisnika" &lt;&lt; std::endl
        &lt;&lt; " 2 - Registriraj novu knjigu" &lt;&lt; std::endl
        &lt;&lt; " 3 - Izlistaj korisnike" &lt;&lt; std::endl
        &lt;&lt; " 4 - Izlistaj knjige" &lt;&lt; std::endl
        &lt;&lt; " 5 - Zaduzi knjigu" &lt;&lt; std::endl 
        &lt;&lt; " 6 - Razduzi knjigu" &lt;&lt; std::endl
        &lt;&lt; " 7 - Prikazi zaduzenja" &lt;&lt; std::endl;
        std::cin &gt;&gt; opcija;
        if (opcija==0) break;
        else if (opcija==1) {
            bool da_li_je_unos_ispravan=false;
            do {
                da_li_je_unos_ispravan=false;
                int clanski_broj;
                std::string ime, prezime, adresa, telefon;
                std::cout &lt;&lt; "Unesite clanski broj: ";
                std::cin &gt;&gt;  clanski_broj;
                std::cin.ignore(10000,'\n');
                std::cout &lt;&lt; "Unesite ime: ";
                std::getline(std::cin,ime);
                std::cout &lt;&lt; "Unesite prezime: ";
                std::getline(std::cin,prezime);
                std::cout &lt;&lt; "Unesite adresu: ";
                std::getline(std::cin,adresa);
                std::cout &lt;&lt; "Unesite telefon: ";
                std::getline(std::cin,telefon);
                try {
                    b.RegistrirajNovogKorisnika(clanski_broj,ime,prezime,adresa,telefon);
                    std::cout &lt;&lt; "Korisnik je uspjesno registrovan!" &lt;&lt; std::endl;
                    da_li_je_unos_ispravan=true;
                }
                catch(std::logic_error izuzetak) {
                    std::cout &lt;&lt; izuzetak.what() &lt;&lt; ". Molimo ponovite unos!" &lt;&lt; std::endl &lt;&lt; std::endl;
                }
            } while(!da_li_je_unos_ispravan);
        }
        else if (opcija==2) {
            bool da_li_je_unos_ispravan=false;
            do {
                da_li_je_unos_ispravan=false;
                int evidencijski_broj, godina_izdavanja;
                std::string naslov, ime_pisca, zanr;
                std::cout &lt;&lt; "Unesite evidencijski broj: ";
                std::cin &gt;&gt; evidencijski_broj;
                std::cin.ignore(10000,'\n');
                std::cout &lt;&lt; "Unesite naslov: ";
                std::getline(std::cin,naslov);
                std::cout &lt;&lt; "Unesite ime pisca: ";
                std::getline(std::cin,ime_pisca);
                std::cout &lt;&lt; "Unesite zanr: ";
                std::getline(std::cin,zanr);
                std::cout &lt;&lt; "Unesite godinu izdavanja: ";
                std::cin &gt;&gt; godina_izdavanja;
                std::cin.ignore(10000,'\n');
                try {
                    b.RegistrirajNovuKnjigu(evidencijski_broj,naslov,ime_pisca,zanr,godina_izdavanja);
                    std::cout &lt;&lt; "Knjiga je uspjesno registrovana!" &lt;&lt; std::endl;
                    da_li_je_unos_ispravan=true;
                }
                catch(std::logic_error izuzetak) {
                    std::cout &lt;&lt; izuzetak.what() &lt;&lt; ". Molimo ponovite unos!" &lt;&lt; std::endl &lt;&lt; std::endl;
                }
            } while(!da_li_je_unos_ispravan);
        }
        else if (opcija==3) {
            std::cout &lt;&lt; "=====Registrovani korisnici=====" &lt;&lt; std::endl;
            b.IzlistajKorisnike();
        }
        else if (opcija==4) {
            std::cout &lt;&lt; "=====Registrovane knjige=====" &lt;&lt; std::endl;
            b.IzlistajKnjige();
        }
        else if (opcija==5) {
            bool da_li_je_unos_ispravan=false;
            do {
                da_li_je_unos_ispravan=false;
                int evidencijski_broj, clanski_broj;
                std::cout &lt;&lt; "Unesite evidencijski broj: ";
                std::cin &gt;&gt; evidencijski_broj;
                std::cin.ignore(10000,'\n');
                std::cout &lt;&lt; "Unesite clanski broj: ";
                std::cin &gt;&gt; clanski_broj;
                std::cin.ignore(10000,'\n');
                try {
                    b.ZaduziKnjigu(evidencijski_broj,clanski_broj);
                    std::cout &lt;&lt; "Knjiga sa evidencijskim brojem " &lt;&lt; evidencijski_broj &lt;&lt; " je uspjesno zaduzena od strane korisnika "
                    &lt;&lt; "sa clanskim brojem " &lt;&lt; clanski_broj &lt;&lt; "!" &lt;&lt; std::endl;
                    da_li_je_unos_ispravan=true;
                }
                catch(std::logic_error izuzetak) {
                    std::cout &lt;&lt; izuzetak.what() &lt;&lt; ". Molimo ponovite unos!" &lt;&lt; std::endl &lt;&lt; std::endl;
                }
            } while (!da_li_je_unos_ispravan);
        }
        else if (opcija==6) {
            bool da_li_je_unos_ispravan=false;
            do {
                da_li_je_unos_ispravan=false;
                int evidencijski_broj;
                std::cout &lt;&lt; "Unesite evidencijski broj: ";
                std::cin &gt;&gt; evidencijski_broj;
                std::cin.ignore(10000,'\n');
                try {
                    b.RazduziKnjigu(evidencijski_broj);
                    std::cout &lt;&lt; "Knjiga sa evidencijskim brojem " &lt;&lt; evidencijski_broj &lt;&lt; " je uspjesno razduzena!" &lt;&lt; std::endl;
                    da_li_je_unos_ispravan=true;
                }
                catch(std::logic_error izuzetak) {
                    std::cout &lt;&lt; izuzetak.what() &lt;&lt; ". Molimo ponovite unos!" &lt;&lt; std::endl &lt;&lt; std::endl;
                }
            } while(!da_li_je_unos_ispravan);
        }
        else if (opcija==7) {
            bool da_li_je_unos_ispravan=false;
            do {
                int clanski_broj;
                std::cout &lt;&lt; "Unesite clanski broj: ";
                std::cin &gt;&gt; clanski_broj;
                std::cin.ignore(10000,'\n');
                try {
                    b.PrikaziZaduzenja(clanski_broj);
                    da_li_je_unos_ispravan=true;
                }
                catch(std::logic_error izuzetak) {
                    std::cout &lt;&lt; izuzetak.what() &lt;&lt; ". Molimo ponovite unos!" &lt;&lt; std::endl &lt;&lt; std::endl;
                }
            } while(!da_li_je_unos_ispravan);
        }
    } while (opcija!=0);
	return 0;
}</pre>
</body>
</html>
