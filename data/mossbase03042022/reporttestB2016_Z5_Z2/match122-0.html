<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student2513.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student2513.cpp<p></p><pre>
<a name="0"></a><font color="#FF0000"><a href="match122-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_99.gif"/></a>

/B16/17 (ZadaÄ‡a 5, Zadatak 1)
//Autotestovi by Eldar Kurtic (mail: ekurtic3@etf.unsa.ba)
//Za autotestove se obracati *iskljucivo* osobi koja ih pise
#include &lt;iostream&gt;
#include &lt;stdexcept&gt;
#include &lt;string&gt;
#include &lt;memory&gt;
#include &lt;map&gt;
using namespace std;

struct Korisnik {
    string ime, prezime, adresa, telefon;
};

class Knjiga
{
    string naslov, ime_pisca, zanr;
    int godina_izdanja;
    shared_ptr&lt;Korisnik&gt; kod_koga_je;
public:
    Knjiga(string ime, string pisac, string zanr_knjige, int godina_izdavanja): naslov(ime), ime_pisca(pisac), zanr(zanr_knjige), godina_izdanja(godina_izdavanja), kod_koga_je(nullptr) {}
    string DajNaslov() const {
        return naslov;
    }
    string DajAutora() const {
        return ime_pisca;
    }
    string DajZanr() const {
        return zanr;
    }
    int DajGodinuIzdavanja() const {
        return godina_izdanja;
    }
    shared_ptr&lt;Korisnik&gt; DajKodKogaJe() const {
        return kod_koga_je;
    }
    void ZaduziKnjigu(Korisnik &amp;osoba) {
        kod_koga_je = make_shared&lt;Korisnik&gt;(osoba);
    }
    void RazduziKnjigu() {
        kod_koga_je = nullptr;
    }
    bool DaLiJeZaduzena() const {
        if(kod_koga_je == nullptr) return false;
        return true;
    }
};

class Biblioteka
{
    map&lt;int, shared_ptr&lt;Korisnik&gt;&gt; mapa_korisnika;
    map&lt;int, shared_ptr&lt;Knjiga&gt;&gt; mapa_knjiga;
public:
    Biblioteka() = default;
    ~Biblioteka() = default;
    Biblioteka(const Biblioteka &amp;original) {
        auto korisnici = original.mapa_korisnika;
        auto knjige = original.mapa_knjiga;
        for(auto it = korisnici.begin(); it != korisnici.end(); it++) {
            it-&gt;second = nullptr;
        }
        for(auto it = knjige.begin(); it != knjige.end(); it++) {
            it-&gt;second = nullptr;
        }
        auto it_originala = original.mapa_korisnika.begin();
        for(auto it_kopije = korisnici.begin(); it_kopije != korisnici.end(); it_kopije++) {
            it_kopije-&gt;second = make_shared&lt;Korisnik&gt;(*(it_originala-&gt;second));
            it_originala++;
        }
        auto it_original = original.mapa_knjiga.begin();
        for(auto it_kopije = knjige.begin(); it_kopije != knjige.end(); it_kopije++) {
            it_kopije-&gt;second = make_shared&lt;Knjiga&gt;(*(it_original-&gt;second));
            it_original++;
        }
        mapa_korisnika = korisnici;
        mapa_knjiga = knjige;
    }
    Biblioteka(Biblioteka &amp;&amp;original) {
        mapa_korisnika = original.mapa_korisnika;
        mapa_knjiga = original.mapa_knjiga;
        for(auto it = original.mapa_korisnika.begin(); it != original.mapa_korisnika.end(); it++) {
            it-&gt;second = nullptr;
        }
        for(auto it = original.mapa_knjiga.begin(); it != original.mapa_knjiga.end(); it++) {
            it-&gt;second = nullptr;
        }
    }
    Biblioteka &amp;operator =(const Biblioteka &amp;original) {
        auto korisnici = original.mapa_korisnika;
        auto knjige = original.mapa_knjiga;
        for(auto it = korisnici.begin(); it != korisnici.end(); it++) {
            it-&gt;second = nullptr;
        }
        for(auto it = knjige.begin(); it != knjige.end(); it++) {
            it-&gt;second = nullptr;
        }
        auto it_originala = original.mapa_korisnika.begin();
        for(auto it_kopije = korisnici.begin(); it_kopije != korisnici.end(); it_kopije++) {
            it_kopije-&gt;second = make_shared&lt;Korisnik&gt;(*(it_originala-&gt;second));
            it_originala++;
        }
        auto it_original = original.mapa_knjiga.begin();
        for(auto it_kopije = knjige.begin(); it_kopije != knjige.end(); it_kopije++) {
            it_kopije-&gt;second = make_shared&lt;Knjiga&gt;(*(it_original-&gt;second));
            it_original++;
        }
        mapa_korisnika = korisnici;
        mapa_knjiga = knjige;
        return *this;
    }
    Biblioteka &amp;operator =(Biblioteka &amp;&amp;original) {
        mapa_korisnika = original.mapa_korisnika;
        mapa_knjiga = original.mapa_knjiga;
        
        for(auto it = original.mapa_korisnika.begin(); it != original.mapa_korisnika.end(); it++) {
            it-&gt;second = nullptr;
        }
        for(auto it = original.mapa_knjiga.begin(); it != original.mapa_knjiga.end(); it++) {
            it-&gt;second = nullptr;
        }
        return *this;
    }
    
    void RegistrirajNovogKorisnika(int clanski_broj, string ime, string prezime, string adresa, string telefon) {
        for(auto a: mapa_korisnika)
            if(a.first == clanski_broj) throw logic_error("Korisnik vec postoji");
        Korisnik neki_korisnik;
        neki_korisnik.ime = ime;
        neki_korisnik.prezime = prezime;
        neki_korisnik.adresa = adresa;
        neki_korisnik.telefon = telefon;
        shared_ptr&lt;Korisnik&gt; korisnik = make_shared&lt;Korisnik&gt;(neki_korisnik);
        mapa_korisnika.insert(make_pair(clanski_broj, make_shared&lt;Korisnik&gt;(neki_korisnik)));
    }

    void RegistrirajNovuKnjigu(int evidencijski_broj, string naslov, string pisac, string zanr, int godina_izdanja) {
        for(auto a: mapa_knjiga)
            if(a.first == evidencijski_broj) throw logic_error("Knjiga vec postoji");
        mapa_knjiga.insert(make_pair(evidencijski_broj, nullptr));
        mapa_knjiga[evidencijski_broj] = make_shared&lt;Knjiga&gt;(naslov, pisac, zanr, godina_izdanja);
    }

    Korisnik &amp;NadjiKorisnika(int clanski_broj) const {
        for(auto &amp;a: mapa_korisnika)
            if(a.first == clanski_broj) return *(a.second); //return mapa_korisnika[clanski_broj];
        throw logic_error("Korisnik nije nadjen");
    }
    Knjiga &amp;NadjiKnjigu(int evidencijski_broj) {
        for(auto &amp;a: mapa_knjiga)
            if(a.first == evidencijski_broj) return *(a.second); //return mapa_knjiga[evidencijski_broj];
        throw logic_error("Knjiga nije nadjena");
    }

    void IzlistajKorisnike() const {
        for(auto it = mapa_korisnika.begin(); it != mapa_korisnika.end(); it++) {
            cout &lt;&lt; "Clanski broj: " &lt;&lt; it -&gt; first &lt;&lt; endl;
            cout &lt;&lt; "Ime i prezime: " &lt;&lt; (it-&gt;second) -&gt; ime  &lt;&lt; " " &lt;&lt; (it -&gt; second) -&gt; prezime &lt;&lt; endl;
            cout &lt;&lt; "Adresa: " &lt;&lt; (it -&gt; second) -&gt; adresa &lt;&lt; endl;
            cout &lt;&lt; "Broj telefona: " &lt;&lt; (it -&gt; second) -&gt; telefon &lt;&lt; endl;
            cout &lt;&lt; endl;
        }
    }

    void IzlistajKnjige() const {
        for(auto it = mapa_knjiga.begin(); it != mapa_knjiga.end(); it++) {
            cout &lt;&lt; "Evidencijski broj: " &lt;&lt; it -&gt; first &lt;&lt; endl;
            cout &lt;&lt; "Naslov: " &lt;&lt; (*(it-&gt;second)).DajNaslov() &lt;&lt; endl;
            cout &lt;&lt; "Pisac: " &lt;&lt; (*(it -&gt; second)).DajAutora() &lt;&lt; endl;
            cout &lt;&lt; "Zanr: " &lt;&lt; (*(it -&gt; second)).DajZanr() &lt;&lt; endl;
            cout &lt;&lt; "Godina izdavanja: " &lt;&lt; (*(it -&gt; second)).DajGodinuIzdavanja() &lt;&lt; endl;
            if((*(it -&gt; second)).DaLiJeZaduzena() == true) {
                shared_ptr&lt;Korisnik&gt; kod_koga_je_trenutno = (*(it -&gt; second)).DajKodKogaJe();
                cout &lt;&lt; "Zaduzena kod korisnika: " &lt;&lt; kod_koga_je_trenutno -&gt; ime &lt;&lt; " " &lt;&lt; kod_koga_je_trenutno -&gt; prezime &lt;&lt; endl;
            }
            cout &lt;&lt; endl;
        }
    }

    void ZaduziKnjigu(int evidencijski_broj, int clanski_broj) {
        Knjiga &amp;knjiga = NadjiKnjigu(evidencijski_broj);
        Korisnik &amp;korisnik = NadjiKorisnika(clanski_broj);
        if(knjiga.DaLiJeZaduzena())
            throw logic_error("Knjiga vec zaduzena");
        knjiga.ZaduziKnjigu(korisnik);
    }

    void RazduziKnjigu(int evidencijski_broj) {
        Knjiga &amp;knjiga = NadjiKnjigu(evidencijski_broj);
        if(knjiga.DaLiJeZaduzena() == false)
            throw logic_error("Knjiga nije zaduzena");
        knjiga.RazduziKnjigu();
    }
    
    void PrikaziZaduzenja(int clanski_broj) const {
        auto korisnik = mapa_korisnika.find(clanski_broj);
        if(korisnik == mapa_korisnika.end())
            throw logic_error("Korisnik nije nadjen");
        bool nema_zaduzenja = true;
        for(auto a = mapa_knjiga.begin(); a != mapa_knjiga.end(); a++) {
            if((*(a-&gt;second)).DajKodKogaJe() == (korisnik -&gt; second)) {
                nema_zaduzenja = false;
                cout &lt;&lt; "Evidencijski broj: " &lt;&lt; a -&gt; first &lt;&lt; endl &lt;&lt; "Naslov: " &lt;&lt; (*(a -&gt; second)).DajNaslov() &lt;&lt; endl &lt;&lt; "Pisac: " &lt;&lt; (*(a -&gt; second)).DajAutora() &lt;&lt; endl &lt;&lt; "Zanr: " &lt;&lt; (*(a -&gt; second)).DajZanr() &lt;&lt; endl 
                &lt;&lt; "Godina izdavanja: " &lt;&lt; (*(a-&gt;second)).DajGodinuIzdavanja() &lt;&lt; endl;
                cout &lt;&lt; endl;
            }
        }
        if(nema_zaduzenja) cout &lt;&lt; "Nema zaduzenja za tog korisnika!" &lt;&lt; endl;
    }

};
int main ()
{
    return 0;
</font>}</pre>
</body>
</html>
