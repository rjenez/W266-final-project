<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student5222.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student5222.cpp<p></p><pre>
<a name="3"></a><font color="#00FFFF"><a href="match566-1.html#3" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_2.gif"/></a>

/B16/17 (ZadaÄ‡a 5, Zadatak 2)
//Autotestovi by Eldar Kurtic (mail: ekurtic3@etf.unsa.ba)
//Za autotestove se obracati *iskljucivo* osobi koja ih pise
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;map&gt;
#include &lt;stdexcept&gt;
#include &lt;algorithm&gt;
#include &lt;memory&gt;

using namespace std;

struct Korisnik {
    string ime, prezime, adresa, telefon;
};

class Knjiga {
</font><a name="1"></a><font color="#00FF00"><a href="match566-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_4.gif"/></a>

    string naslov, pisac, zanr;
    int godinaIzdavanja;
    Korisnik* korisnik;
public:
    Knjiga(string naslov, string pisac, string zanr, int godinaIzdavanja) :
        naslov(naslov), pisac(pisac), zanr(zanr), godinaIzdavanja(godinaIzdavanja), korisnik(nullptr) { }
    string DajNaslov() const { return naslov; }
    string DajAutora() const { return pisac; }
    string DajZanr() const { return zanr; }
    int DajGodinuIzdavanja() const { return godinaIzdavanja; }
</font>    Korisnik * DajKodKogaJe() const { return korisnik; }
    void ZaduziKnjigu(Korisnik&amp; k) { /*provjera ? */ korisnik = &amp;k; }
    void RazduziKnjigu() { korisnik = nullptr; }
    bool DaLiJeZaduzena() const { return korisnik ? true : false; }
};

class Biblioteka {
    map&lt;int, shared_ptr&lt;Korisnik&gt;&gt; korisnici;
    map&lt;int, shared_ptr&lt;Knjiga&gt;&gt; knjige;
    void Dealociraj();
public:
    explicit Biblioteka() : korisnici(), knjige() { }
    Biblioteka(const Biblioteka&amp;);
    Biblioteka(Biblioteka&amp;&amp;);
    Biblioteka&amp; operator=(const Biblioteka&amp;);
    Biblioteka&amp; operator=(Biblioteka&amp;&amp;);
    ~Biblioteka() { Dealociraj(); }
    void RegistrirajNovogKorisnika(int, string, string, string, string);
    void RegistrirajNovuKnjigu(int, string, string, string, int);
    Korisnik&amp; NadjiKorisnika(int) const;
    Knjiga&amp; NadjiKnjigu(int) const;
    void IzlistajKorisnike() const;
    void IzlistajKnjige() const;
    void ZaduziKnjigu(int, int);
    void RazduziKnjigu(int);
    void PrikaziZaduzenja(int) const;
};

void Biblioteka::Dealociraj() {
    korisnici.clear();
    knjige.clear();
}

Biblioteka::Biblioteka(const Biblioteka&amp; b){
    Dealociraj();
    for(auto korisnik : b.korisnici)
        korisnici[korisnik.first] = make_shared&lt;Korisnik&gt;(*(korisnik.second));
    for(auto knjiga : b.knjige)
        knjige[knjiga.first] = make_shared&lt;Knjiga&gt;(*(knjiga.second));
}

Biblioteka&amp; Biblioteka::operator=(const Biblioteka&amp; b){
    if(this != &amp;b){
        Dealociraj();
        for(auto korisnik : b.korisnici)
            korisnici[korisnik.first] = make_shared&lt;Korisnik&gt;(*(korisnik.second));
        for(auto knjiga : b.knjige)
            knjige[knjiga.first] = make_shared&lt;Knjiga&gt;(*(knjiga.second));
    }
    return *this;
}

Biblioteka::Biblioteka(Biblioteka&amp;&amp; b){
    Dealociraj();
    for(auto korisnik : b.korisnici)
        korisnici[korisnik.first] = korisnik.second, korisnik.second = nullptr;
    for(auto knjiga : b.knjige)
        knjige[knjiga.first] = knjiga.second, knjiga.second = nullptr;
}

Biblioteka&amp; Biblioteka::operator=(Biblioteka&amp;&amp; b){
    if(this != &amp;b){
        Dealociraj();
        for(auto korisnik : b.korisnici)
            korisnici[korisnik.first] = korisnik.second, korisnik.second = nullptr;
        for(auto knjiga : b.knjige)
            knjige[knjiga.first] = knjiga.second, knjiga.second = nullptr;
    }
    return *this;
}

void Biblioteka::RegistrirajNovogKorisnika(int id, string ime, string prezime, string adresa, string telefon){
    auto it = find_if(korisnici.begin(), korisnici.end(), [id](pair&lt;int, shared_ptr&lt;Korisnik&gt;&gt; k) {
        return k.first == id;
    });
    if(it != korisnici.end())
        throw logic_error("Korisnik vec postoji");
    Korisnik k;
    k.ime = ime;
    k.prezime = prezime;
    k.adresa = adresa;
    k.telefon = telefon;
    korisnici[id] = make_shared&lt;Korisnik&gt;(k);
}

void Biblioteka::RegistrirajNovuKnjigu(int id, string naslov, string autor, string zanr, int godinaIzdavanja){
    auto it = find_if(knjige.begin(), knjige.end(), [id](pair&lt;int, shared_ptr&lt;Knjiga&gt;&gt; k) {
        return k.first == id;
    });
    if(it != knjige.end())
        throw logic_error("Knjiga vec postoji");
    knjige[id] = make_shared&lt;Knjiga&gt;(naslov, autor, zanr, godinaIzdavanja);
}

Korisnik&amp; Biblioteka::NadjiKorisnika(int id) const {
    auto it = korisnici.find(id);
    if(it == korisnici.end()) 
        throw logic_error("Korisnik nije nadjen");
    return *(it-&gt;second.get());
}

Knjiga&amp; Biblioteka::NadjiKnjigu(int id) const {
    auto it = knjige.find(id);
    if(it == knjige.end())
        throw logic_error("Knjiga nije nadjena");
    return *(it-&gt;second.get());
}

<a name="0"></a><font color="#FF0000"><a href="match566-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_6.gif"/></a>

void Biblioteka::IzlistajKorisnike() const {
    for(auto k : korisnici){
        cout &lt;&lt; "Clanski broj: " &lt;&lt; k.first &lt;&lt; endl;
        cout &lt;&lt; "Ime i prezime: " &lt;&lt; k.second-&gt;ime &lt;&lt; " " &lt;&lt; k.second-&gt;prezime &lt;&lt; endl;
        cout &lt;&lt; "Adresa: " &lt;&lt; k.second-&gt;adresa &lt;&lt; endl;
        cout &lt;&lt; "Broj telefona: " &lt;&lt; k.second-&gt;telefon &lt;&lt; endl &lt;&lt; endl;
    }
} 

void Biblioteka::IzlistajKnjige() const {
</font><a name="2"></a><font color="#0000FF"><a href="match566-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_3.gif"/></a>

    for(auto k : knjige){
        cout &lt;&lt; "Evidencijski broj: " &lt;&lt; k.first &lt;&lt; endl;
        cout &lt;&lt; "Naslov: " &lt;&lt; k.second-&gt;DajNaslov() &lt;&lt; endl;
        cout &lt;&lt; "Pisac: " &lt;&lt; k.second-&gt;DajAutora() &lt;&lt; endl;
</font><a name="5"></a><font color="#FF0000"><a href="match566-1.html#5" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_2.gif"/></a>

        cout &lt;&lt; "Zanr: " &lt;&lt; k.second-&gt;DajZanr() &lt;&lt; endl;
        cout &lt;&lt; "Godina izdavanja: " &lt;&lt; k.second-&gt;DajGodinuIzdavanja() &lt;&lt; endl;
        if(k.second-&gt;DaLiJeZaduzena())
</font><a name="6"></a><font color="#00FF00"><a href="match566-1.html#6" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_2.gif"/></a>

            cout &lt;&lt; "Zaduzena kod korisnika: " &lt;&lt; k.second-&gt;DajKodKogaJe()-&gt;ime &lt;&lt; " " &lt;&lt; k.second-&gt;DajKodKogaJe()-&gt;prezime &lt;&lt; endl;
        cout &lt;&lt; endl;
    }
}

void Biblioteka::ZaduziKnjigu(int idKnjige, int idKorisnika){
</font>    Knjiga &amp;knjiga = NadjiKnjigu(idKnjige);
    Korisnik &amp;korisnik = NadjiKorisnika(idKorisnika);
    if(knjiga.DaLiJeZaduzena()) 
        throw logic_error("Knjiga vec zaduzena");
    knjiga.ZaduziKnjigu(korisnik);
}

void Biblioteka::RazduziKnjigu(int id) {
    Knjiga &amp;knjiga = NadjiKnjigu(id);
    if(!knjiga.DaLiJeZaduzena()) 
        throw logic_error("Knjiga nije zaduzena");
    knjiga.RazduziKnjigu();
}

void Biblioteka::PrikaziZaduzenja(int id) const {
    Korisnik &amp;k = NadjiKorisnika(id);
    bool imaZaduzenja(false);
    for(auto knjiga : knjige){
        if(knjiga.second-&gt;DajKodKogaJe() == &amp;k){
<a name="4"></a><font color="#FF00FF"><a href="match566-1.html#4" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_2.gif"/></a>

            cout &lt;&lt; "Evidencijski broj: " &lt;&lt; knjiga.first &lt;&lt; endl;
            cout &lt;&lt; "Naslov: " &lt;&lt; knjiga.second-&gt;DajNaslov() &lt;&lt; endl;
            cout &lt;&lt; "Pisac: " &lt;&lt; knjiga.second-&gt;DajAutora() &lt;&lt; endl;
</font><a name="7"></a><font color="#0000FF"><a href="match566-1.html#7" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_2.gif"/></a>

            cout &lt;&lt; "Zanr: " &lt;&lt; knjiga.second-&gt;DajZanr() &lt;&lt; endl;
            cout &lt;&lt; "Godina izdavanja: " &lt;&lt; knjiga.second-&gt;DajGodinuIzdavanja() &lt;&lt; endl &lt;&lt; endl;
</font>            imaZaduzenja = true;
        }
    }
    if(!imaZaduzenja)
        cout &lt;&lt; "Nema zaduzenja za tog korisnika!" &lt;&lt; endl;
}

int main ()
{
    try{
    Biblioteka b;
    b.RegistrirajNovogKorisnika(0, "Seno", "Sejdic", "neka adresa", "broj telefona");
    b.RegistrirajNovogKorisnika(5, "Neko", "Nekic", "nekina adresa", "neki broj");
    b.RegistrirajNovuKnjigu(0, "neka knjiga", "neki autor", "neki zanr", 1859);
    b.ZaduziKnjigu(0, 5);
    b.ZaduziKnjigu(0, 0);
    b.IzlistajKnjige();
    b.IzlistajKorisnike();
    cout &lt;&lt; "-------------------" &lt;&lt; endl;
    b.PrikaziZaduzenja(0);
    
    Biblioteka b2(b);
    cout &lt;&lt; "-------------------------------------------------------------------" &lt;&lt; endl;
    b2.RazduziKnjigu(0);
    b2.IzlistajKnjige();
    b2.IzlistajKorisnike();
    b2.PrikaziZaduzenja(0);
    }catch(exception &amp;e){
        cout &lt;&lt; e.what() &lt;&lt; endl;
    }
	return 0;
}</pre>
</body>
</html>
