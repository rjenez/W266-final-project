<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student4296.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student9673.cpp<p></p><pre>
/B16/17 (ZadaÄ‡a 5, Zadatak 2)
//Autotestovi by Eldar Kurtic (mail: ekurtic3@etf.unsa.ba)
//Za autotestove se obracati *iskljucivo* osobi koja ih pise

#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;map&gt;
#include &lt;stdexcept&gt;
#include &lt;memory&gt;

struct Korisnik{
    std::string ime, prezime, adresa, telefon;
};

class Knjiga{
    std::string naslov_knjige, ime_pisca, zanr;
    int godina_izdavanja;
    std::shared_ptr&lt;Korisnik&gt; kod_koga_je;
public:
    Knjiga(std::string naslov_knjige, std::string ime_pisca, std::string zanr, int godina_izdavanja){
        Knjiga::naslov_knjige = naslov_knjige; Knjiga::ime_pisca = ime_pisca;
        Knjiga::zanr = zanr; Knjiga::godina_izdavanja = godina_izdavanja;                               // konstruktor sa 4 parametra
<a name="4"></a><font color="#FF00FF"><a href="match953-0.html#4" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

        kod_koga_je = nullptr;
    }
    ~Knjiga(){ kod_koga_je = nullptr; }
    
    std::string DajNaslov() const{ return naslov_knjige; }
    std::string DajAutora() const{ return ime_pisca; }
    std::string DajZanr() const{ return zanr; }
</font>    int DajGodinuIzdavanja() const{ return godina_izdavanja; }
    std::shared_ptr&lt;Korisnik&gt; DajKodKogaJe() const{ return kod_koga_je; }
    
    void ZaduziKnjigu(Korisnik &amp;k){ kod_koga_je = std::make_shared&lt;Korisnik&gt;(k); }
    void RazduziKnjigu(){ kod_koga_je = nullptr; }
    bool DaLiJeZaduzena() const{ return kod_koga_je != nullptr; }
    
};

class Biblioteka{
    std::map&lt;int, std::shared_ptr&lt;Korisnik&gt;&gt; korisnici;
    std::map&lt;int, std::shared_ptr&lt;Knjiga&gt;&gt; knjige;                              // u obje mape -&gt; first oznacava identifikacioni broj knjige/korisnika
public:
    Biblioteka()=default;
    Biblioteka(const Biblioteka &amp;b){
        for(auto it = b.korisnici.begin(); it != b.korisnici.end(); it++){
<a name="5"></a><font color="#FF0000"><a href="match953-0.html#5" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

            korisnici.insert(std::make_pair(it -&gt; first, std::make_shared&lt;Korisnik&gt;(*(it -&gt; second))));
        }                                                                                           // konstruktor bez parametara i kopirajuci konstruktor
        for(auto it = b.knjige.begin(); it != b.knjige.end(); it++){
</font>            knjige.insert(std::make_pair(it -&gt; first, std::make_shared&lt;Knjiga&gt;(*(it -&gt; second))));
        }
    }
    ~Biblioteka(){
<a name="0"></a><font color="#FF0000"><a href="match953-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

        for(auto it = korisnici.begin(); it != korisnici.end(); it++) it -&gt; second = nullptr;
        for(auto it = knjige.begin(); it != knjige.end(); it++) it -&gt; second = nullptr;
    }
    Biblioteka &amp;operator =(const Biblioteka &amp;b);            // kopirajuci operator dodjele
</font>    
    void RegistrirajNovogKorisnika(int clanski_broj, std::string ime, std::string prezime, std::string adresa, std::string broj_telefona);
    void RegistrirajNovuKnjigu(int evidencijski_broj, std::string naslov_knjige, std::string ime_pisca, std::string zanr, int godina_izdavanja);
    Korisnik &amp;NadjiKorisnika(int clanski_broj);
    Knjiga &amp;NadjiKnjigu(int evidencijski_broj);
    void ZaduziKnjigu(int ev_broj, int cl_broj);
    void RazduziKnjigu(int ev_broj);
    void IzlistajKorisnike() const;
    void IzlistajKnjige() const;
    void PrikaziZaduzenja(int cl_broj) const;
};

Biblioteka &amp;Biblioteka::operator =(const Biblioteka &amp;b){
    std::map&lt;int, std::shared_ptr&lt;Korisnik&gt;&gt; p_korisnici;
    std::map&lt;int, std::shared_ptr&lt;Knjiga&gt;&gt; p_knjige;
    
    for(auto it = b.korisnici.begin(); it != b.korisnici.end(); it++){
<a name="7"></a><font color="#0000FF"><a href="match953-0.html#7" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

        p_korisnici.insert(std::make_pair(it -&gt; first, std::make_shared&lt;Korisnik&gt;(*(it -&gt; second))));
    }                                                                                           
    for(auto it = b.knjige.begin(); it != b.knjige.end(); it++){
</font>        p_knjige.insert(std::make_pair(it -&gt; first, std::make_shared&lt;Knjiga&gt;(*(it -&gt; second))));
    }
    
<a name="6"></a><font color="#00FF00"><a href="match953-0.html#6" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

    for(auto it = korisnici.begin(); it != korisnici.end(); it++) it -&gt; second = nullptr;          // prvo dealociraj stare
    for(auto it = knjige.begin(); it != knjige.end(); it++) it -&gt; second = nullptr;   
    korisnici = p_korisnici; knjige = p_knjige;
</font>    return *this;
}

<a name="1"></a><font color="#00FF00"><a href="match953-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

void Biblioteka::RegistrirajNovogKorisnika(int clanski_broj, std::string ime, std::string prezime, std::string adresa, std::string broj_telefona){
    auto it(korisnici.find(clanski_broj));
    if(it != korisnici.end()) throw std::logic_error ("Korisnik vec postoji");
</font>    korisnici.insert(std::make_pair(clanski_broj, std::make_shared&lt;Korisnik&gt;(Korisnik{ime, prezime, adresa, broj_telefona})));
}

<a name="2"></a><font color="#0000FF"><a href="match953-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

void Biblioteka::RegistrirajNovuKnjigu(int evidencijski_broj, std::string naslov_knjige, std::string ime_pisca, std::string zanr, int godina_izdavanja){
    auto it(knjige.find(evidencijski_broj));
    if(it != knjige.end()) throw std::logic_error ("Knjiga vec postoji");
</font>    auto pok(std::make_shared&lt;Knjiga&gt;(naslov_knjige, ime_pisca, zanr, godina_izdavanja));
    knjige.insert(std::make_pair(evidencijski_broj, pok));
}

<a name="8"></a><font color="#00FFFF"><a href="match953-0.html#8" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

Korisnik &amp;Biblioteka::NadjiKorisnika(int clanski_broj){
    auto it(korisnici.find(clanski_broj));
    if(it == korisnici.end()) throw std::logic_error ("Korisnik nije nadjen");
    return *(it -&gt; second);
}

Knjiga &amp;Biblioteka::NadjiKnjigu(int evidencijski_broj){
</font>    auto it(knjige.find(evidencijski_broj));
    if(it == knjige.end()) throw std::logic_error ("Knjiga vec postoji");
    return *(it -&gt; second);
}

void Biblioteka::IzlistajKorisnike() const{
    for(auto it = korisnici.begin(); it != korisnici.end(); it++){
        std::cout &lt;&lt; "Clanski broj: " &lt;&lt; it -&gt; first &lt;&lt; std::endl &lt;&lt;
        "Ime i prezime: " &lt;&lt; (it -&gt; second) -&gt; ime &lt;&lt; " " &lt;&lt; (it -&gt; second) -&gt; prezime &lt;&lt; std::endl &lt;&lt;
        "Adresa: " &lt;&lt; (it -&gt; second) -&gt; adresa &lt;&lt; std::endl &lt;&lt; "Broj telefona: " &lt;&lt;
        (it -&gt; second) -&gt; telefon &lt;&lt; std::endl &lt;&lt; std::endl;
    }
}

void Biblioteka::PrikaziZaduzenja(int cl_broj) const{
    auto it(korisnici.find(cl_broj));
    if(it == korisnici.end()) throw std::logic_error ("Korisnik nije nadjen");
    bool nasao_bar_jednu(false);
    
    for(auto knjige_it = knjige.begin(); knjige_it != knjige.end(); knjige_it++){
        auto lik((knjige_it -&gt; second) -&gt; DajKodKogaJe());
        if(lik != nullptr and lik -&gt; ime == (it -&gt; second) -&gt; ime){
            nasao_bar_jednu = true;
            std::cout &lt;&lt; "Evidencijski broj: " &lt;&lt; knjige_it -&gt; first &lt;&lt; std::endl &lt;&lt;
            "Naslov: " &lt;&lt; (knjige_it -&gt; second) -&gt; DajNaslov() &lt;&lt;  std::endl &lt;&lt;
            "Pisac: " &lt;&lt; (knjige_it -&gt; second) -&gt; DajAutora() &lt;&lt; std::endl &lt;&lt; "Zanr: " &lt;&lt;
            (knjige_it -&gt; second) -&gt; DajZanr() &lt;&lt; std::endl &lt;&lt; "Godina izdavanja: " &lt;&lt; 
            (knjige_it -&gt; second) -&gt; DajGodinuIzdavanja() &lt;&lt; std::endl &lt;&lt; std::endl; 
        }
    }
    if(!nasao_bar_jednu) std::cout &lt;&lt; "Nema zaduzenja za tog korisnika!" &lt;&lt; std::endl;  
}

void Biblioteka::ZaduziKnjigu(int ev_broj, int cl_broj){
    auto knjige_it(knjige.find(ev_broj));
    if(knjige_it == knjige.end()) throw std::logic_error("Knjiga nije nadjena");
    auto korisnici_it(korisnici.find(cl_broj));
    if(korisnici_it == korisnici.end()) throw std::logic_error("Korisnik nije nadjen");
    if((knjige_it -&gt; second) -&gt; DaLiJeZaduzena()) throw std::logic_error("Knjiga vec zauzeta");
    
    (knjige_it -&gt; second) -&gt; ZaduziKnjigu(*(korisnici_it -&gt; second));
}

void Biblioteka::RazduziKnjigu(int ev_broj){
    auto knjige_it(knjige.find(ev_broj));
    if(knjige_it == knjige.end()) throw std::logic_error("Knjiga nije nadjena");
    if(!(knjige_it -&gt; second) -&gt; DaLiJeZaduzena()) throw std::logic_error("Knjiga nije zaduzena");
    
    (knjige_it -&gt; second) -&gt; RazduziKnjigu();
}

void Biblioteka::IzlistajKnjige() const{
    for(auto it = knjige.begin(); it != knjige.end(); it++){
        std::cout &lt;&lt; "Evidencijski broj: " &lt;&lt; it -&gt; first &lt;&lt; std::endl &lt;&lt;
        "Naslov: " &lt;&lt; (it -&gt; second) -&gt; DajNaslov() &lt;&lt; std::endl &lt;&lt;
        "Pisac: " &lt;&lt; (it -&gt; second) -&gt; DajAutora() &lt;&lt; std::endl &lt;&lt;
        "Zanr: " &lt;&lt; (it -&gt; second) -&gt; DajZanr() &lt;&lt; std::endl &lt;&lt;
        "Godina izdavanja: " &lt;&lt; (it -&gt; second) -&gt; DajGodinuIzdavanja() &lt;&lt; std::endl &lt;&lt; std::endl;
        auto p_it((it -&gt; second) -&gt; DajKodKogaJe());
        if(p_it != nullptr){
            std::cout &lt;&lt; "Zaduzena kod korisnika: " &lt;&lt; p_it -&gt; ime &lt;&lt; " " &lt;&lt; p_it -&gt; prezime &lt;&lt; std::endl &lt;&lt; std::endl;
        }
        else std::cout &lt;&lt; std::endl;
    }
}

int main ()
{
    Biblioteka b;
    
    std::cout &lt;&lt; "Dobrodosli!" &lt;&lt; std::endl;
    int generator_clanskih(1), generator_evidencijskih(1);
    
    for(;;){
        std::cout &lt;&lt; std::endl &lt;&lt; "Odaberite opciju: " &lt;&lt; std::endl &lt;&lt; "1) Azuriranje korisnika " &lt;&lt; std::endl &lt;&lt; "2) Azuriranje knjiga" &lt;&lt; std::endl &lt;&lt; "3) Izlaz" &lt;&lt; std::endl;
        int opcija(0); 
        std::cin &gt;&gt; opcija;
        if(opcija == 1){
            std::cout &lt;&lt; std::endl &lt;&lt; "Izabrali ste opciju 'Azuriranje korisnika'" &lt;&lt; std::endl;
            std::cout &lt;&lt; "Odaberite opciju za rad sa korisnicima: " &lt;&lt; std::endl &lt;&lt; "1) Unos novog korisnika" &lt;&lt; std::endl &lt;&lt; "2) Spisak svih korisnika" &lt;&lt; std::endl &lt;&lt; "3) Sva zaduzenja odredjenog korisnika" &lt;&lt; std::endl;
            int korisnicka_opcija(0);
            std::cin &gt;&gt; korisnicka_opcija;
            if(korisnicka_opcija == 1){
                std::cin.ignore(1000,'\n');
                std::string ime, prezime, adresa, broj_telefona;
                std::cout &lt;&lt; std::endl &lt;&lt; "Unesite podatke: " &lt;&lt; std::endl;
                std::cout &lt;&lt; "Ime: "; std::getline(std::cin, ime);
                std::cout &lt;&lt; "Prezime: "; std::getline(std::cin, prezime);
                std::cout &lt;&lt; "Adresa: "; std::getline(std::cin, adresa);
                std::cout &lt;&lt; "Broj telefona: "; std::getline(std::cin, broj_telefona); 
                try{
                    b.RegistrirajNovogKorisnika(generator_clanskih, ime, prezime, adresa, broj_telefona);
                    generator_clanskih++;
                }
                catch(std::logic_error l){
                    std::cout &lt;&lt; l.what() &lt;&lt; std::endl;
                }
            }
            if(korisnicka_opcija == 2){
                std::cout &lt;&lt; std::endl;
                b.IzlistajKorisnike();
            }
            if(korisnicka_opcija == 3){
                std::cout &lt;&lt; std::endl &lt;&lt; "Unesite clanski broj korisnika: ";
                int cb(0); 
                std::cin &gt;&gt; cb;
                try{
                    b.PrikaziZaduzenja(cb);
                }
                catch(std::logic_error l){
                    std::cout &lt;&lt; l.what() &lt;&lt; std::endl;
                }
            }
        }
        if(opcija == 2){
            std::cout &lt;&lt; std::endl &lt;&lt; "Odabrali ste opciju: 'Azuriranje knjiga' " &lt;&lt; std::endl;
            std::cout &lt;&lt; "Odaberite opciju za rad sa knjigama:" &lt;&lt; std::endl &lt;&lt; "1) Registriranje nove knjige" &lt;&lt; std::endl
            &lt;&lt; "2) Spisak svih knjiga" &lt;&lt; std::endl &lt;&lt; "3) Zaduzivanje knjige" &lt;&lt; std::endl &lt;&lt; "4) Razduzivanje knjige" &lt;&lt; std::endl;
            
            int korisnicka_opcija(0);
            std::cin &gt;&gt; korisnicka_opcija;
            if(korisnicka_opcija == 1){
                std::cin.ignore(1000,'\n');
                int godina_izdavanja(0);
                std::string naslov_knjige, ime_pisca, zanr;
                std::cout &lt;&lt; std::endl &lt;&lt; "Unesite podatke za novu knjigu: " &lt;&lt; std::endl;
                std::cout &lt;&lt; "Naslov knjige: "; std::getline(std::cin, naslov_knjige);
<a name="3"></a><font color="#00FFFF"><a href="match953-0.html#3" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

                std::cout &lt;&lt; "Ime pisca: "; std::getline(std::cin, ime_pisca);
                std::cout &lt;&lt; "Zanr: "; std::getline(std::cin, zanr);
                std::cout &lt;&lt; "Godina izdavanja: "; std::cin &gt;&gt; godina_izdavanja;
                std::cin.ignore(1000, '\n');
</font>                try{
                    b.RegistrirajNovuKnjigu(generator_evidencijskih, naslov_knjige, ime_pisca, zanr, godina_izdavanja);
                    generator_evidencijskih++;
                }
                catch(std::logic_error l){
                    std::cout &lt;&lt; l.what() &lt;&lt; std::endl;
                }
            }
            if(korisnicka_opcija == 2){
                std::cout &lt;&lt; std::endl;
                b.IzlistajKnjige();
            }
            if(korisnicka_opcija == 3){
                int cb(0), eb(0);
                std::cout &lt;&lt; "Unesite evidencijski broj: ";
                std::cin &gt;&gt; eb;
                std::cout &lt;&lt; "Unesite clanski broj: ";
                std::cin &gt;&gt; cb;
                try{
                    b.ZaduziKnjigu(eb, cb);
                }
                catch(std::logic_error l){
                    std::cout &lt;&lt; l.what() &lt;&lt; std::endl;
                }
            }
            if(korisnicka_opcija == 4){
                int eb(0);
                std::cout &lt;&lt; std::endl &lt;&lt; "Unesite evidencijski broj: ";
                std::cin &gt;&gt; eb;
                try{
                    b.RazduziKnjigu(eb);
                }
                catch(std::logic_error l){
                    std::cout &lt;&lt; l.what() &lt;&lt; std::endl;
                }
            }
        }
        if(opcija == 3){
            std::cout &lt;&lt; std::endl &lt;&lt; "Dovidjenja!" &lt;&lt; std::endl;
            break;
        }
    }
	return 0;
}</pre>
</body>
</html>
