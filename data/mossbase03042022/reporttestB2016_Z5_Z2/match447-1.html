<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student8089.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student1671.cpp<p></p><pre>
/B16/17 (ZadaÄ‡a 5, Zadatak 2)
//Autotestovi by Eldar Kurtic (mail: ekurtic3@etf.unsa.ba)
//Za autotestove se obracati *iskljucivo* osobi koja ih pise
#include &lt;iostream&gt;
#include &lt;memory&gt;
#include &lt;string&gt;
#include &lt;map&gt;
#include &lt;vector&gt;
#include &lt;algorithm&gt;
#include &lt;stdexcept&gt;

<a name="0"></a><font color="#FF0000"><a href="match447-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_2.gif"/></a>

struct Korisnik {
    std::string ime, prezime, adresa, telefon;
};
class Knjiga {
    std::string naslov_knjige, ime_pisca, zanr;
    int godina_izdavanja;
    std::shared_ptr&lt;Korisnik&gt; zaduzenje{};
    public:
    Knjiga (std::string naslov_knjige, std::string ime_pisca, std::string zanr, int godina_izdavanja) :
    naslov_knjige(naslov_knjige), ime_pisca(ime_pisca), zanr(zanr), godina_izdavanja(godina_izdavanja), zaduzenje(nullptr) {};
</font>    std::string DajNaslov() const { return naslov_knjige; }
<a name="2"></a><font color="#0000FF"><a href="match447-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_2.gif"/></a>

    std::string DajAutora() const { return ime_pisca; }
    std::string DajZanr() const { return zanr; }
    int DajGodinuIzdavanja() const { return godina_izdavanja; }
    std::shared_ptr&lt;Korisnik&gt; DajKodKogaJe() const { return zaduzenje; } //
    void ZaduziKnjigu(Korisnik &amp;korisnik) { zaduzenje = std::make_shared&lt;Korisnik&gt;(korisnik); }
    void RazduziKnjigu() { zaduzenje = nullptr; }
    bool DaLiJeZaduzena() const { return zaduzenje != nullptr; }
</font>};
class Biblioteka {
    std::map&lt;int, std::shared_ptr&lt;Korisnik&gt;&gt; korisnici;
    std::map&lt;int, std::shared_ptr&lt;Knjiga&gt;&gt; knjige;
    public:
    Biblioteka() = default;
    Biblioteka (const Biblioteka &amp;b);
    Biblioteka (Biblioteka &amp;&amp;b);
    Biblioteka &amp;operator = (const Biblioteka &amp;b);
    Biblioteka &amp;operator = (Biblioteka &amp;&amp;b);
    void RegistrirajNovogKorisnika(int clanski_broj, std::string ime, std::string prezime, std::string adresa, std::string telefon);
    void RegistrirajNovuKnjigu(int evidencijski_broj, std::string naslov_knjige, std::string ime_pisca, std::string zanr, int godina_izdavanja);
    Korisnik &amp;NadjiKorisnika(int clanski_broj);
    Knjiga &amp;NadjiKnjigu(int evidencijski_broj) const;
    void IzlistajKorisnike() const;
    void IzlistajKnjige() const;
    void ZaduziKnjigu(int evidencijski_broj, int clanski_broj);
    void RazduziKnjigu(int evidencijski_broj);
    void PrikaziZaduzenja(int clanski_broj) const;
};
void Biblioteka::PrikaziZaduzenja(int clanski_broj) const {
    auto pom(korisnici.find(clanski_broj));
    bool test_1(false);
    for (auto it = korisnici.begin(); it != korisnici.end(); it++)
        if (it-&gt;first == clanski_broj) { test_1 = true; break; }
    if (!test_1) throw std::logic_error ("Korisnik nije nadjen");
    bool test_2(false);
    for (auto it = knjige.begin(); it != knjige.end(); it++)
        if ((it-&gt;second-&gt;DajKodKogaJe()) == pom-&gt;second) {
            test_2 = true;
            std::cout &lt;&lt; "Evidencijski broj: " &lt;&lt; it-&gt;first &lt;&lt; std::endl &lt;&lt; "Naslov: " &lt;&lt; it-&gt;second-&gt;DajNaslov() &lt;&lt; std::endl &lt;&lt; "Pisac: " &lt;&lt; it-&gt;second-&gt;DajAutora() &lt;&lt; std::endl
            &lt;&lt; "Zanr: " &lt;&lt; it-&gt;second-&gt;DajZanr() &lt;&lt; std::endl &lt;&lt; "Godina izdavanja: " &lt;&lt; it-&gt;second-&gt;DajGodinuIzdavanja() &lt;&lt; std::endl &lt;&lt; std::endl;
        }
    if (!test_2) std::cout &lt;&lt; "Nema zaduzenja za tog korisnika!" &lt;&lt; std::endl;
}
void Biblioteka::RazduziKnjigu(int evidencijski_broj) {
    bool test_broja(false), test_zaduzenja(true);
    for (auto it = knjige.begin(); it != knjige.end(); it++)
        if (it-&gt;first == evidencijski_broj) {
            if (it-&gt;second-&gt;DajKodKogaJe() == nullptr) {
                test_zaduzenja = false;
                break;
            }
            test_broja = true;
            break;
        }
    if (!test_zaduzenja) throw std::logic_error ("Knjiga nije zaduzena");
    if (!test_broja) throw std::logic_error ("Knjiga nije nadjena");
    knjige[evidencijski_broj]-&gt;RazduziKnjigu();
}
void Biblioteka::ZaduziKnjigu(int evidencijski_broj, int clanski_broj) {
    bool test(false);
    for (auto it = knjige.begin(); it != knjige.end(); it++)
        if (it-&gt;first == evidencijski_broj) { test = true; break; }
    if (!test) throw std::logic_error ("Knjiga nije nadjena");
    test = false;
    for (auto it = korisnici.begin(); it != korisnici.end(); it++)
        if (it-&gt;first == clanski_broj) { test = true; break; }
    if (!test) throw std::logic_error ("Korisnik nije nadjen");
    if (knjige[evidencijski_broj]-&gt;DajKodKogaJe()) throw std::logic_error ("Knjiga vec zaduzena");
    knjige[evidencijski_broj]-&gt;ZaduziKnjigu(*korisnici[clanski_broj]);
}
void Biblioteka::IzlistajKnjige() const {
    std::for_each(knjige.begin(), knjige.end(), [](std::pair&lt;int, std::shared_ptr&lt;Knjiga&gt;&gt; k) {
<a name="1"></a><font color="#00FF00"><a href="match447-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_2.gif"/></a>

        std::cout &lt;&lt; "Evidencijski broj: " &lt;&lt; k.first &lt;&lt; std::endl &lt;&lt; "Naslov: " &lt;&lt; k.second-&gt;DajNaslov() &lt;&lt; std::endl &lt;&lt; "Pisac: " &lt;&lt; k.second-&gt;DajAutora()
        &lt;&lt; std::endl &lt;&lt; "Zanr: " &lt;&lt; k.second-&gt;DajZanr() &lt;&lt; std::endl &lt;&lt; "Godina izdavanja: " &lt;&lt; k.second-&gt;DajGodinuIzdavanja() &lt;&lt; std::endl;
</font><a name="3"></a><font color="#00FFFF"><a href="match447-0.html#3" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_2.gif"/></a>

        if (k.second-&gt;DajKodKogaJe()) std::cout &lt;&lt; "Zaduzena kod korisnika: " &lt;&lt; k.second-&gt;DajKodKogaJe()-&gt;ime &lt;&lt; " " &lt;&lt; k.second-&gt;DajKodKogaJe()-&gt;prezime &lt;&lt; std::endl;
        std::cout &lt;&lt; std::endl;
</font>    });
}
void Biblioteka::IzlistajKorisnike() const {
    for (auto it = korisnici.begin(); it != korisnici.end(); it++)
        std::cout &lt;&lt; "Clanski broj: " &lt;&lt; it-&gt;first &lt;&lt; std::endl &lt;&lt; "Ime i prezime: " &lt;&lt; it-&gt;second-&gt;ime &lt;&lt; " " &lt;&lt; it-&gt;second-&gt;prezime &lt;&lt; std::endl
        &lt;&lt; "Adresa: " &lt;&lt; it-&gt;second-&gt;adresa &lt;&lt; std::endl &lt;&lt; "Broj telefona: " &lt;&lt; it-&gt;second-&gt;telefon &lt;&lt; std::endl &lt;&lt; std::endl;
}
Knjiga &amp;Biblioteka::NadjiKnjigu(int evidencijski_broj) const {
    for (auto it = knjige.begin(); it != knjige.end(); it++)
        if (it-&gt;first == evidencijski_broj) return *it-&gt;second;
    throw std::logic_error ("Knjiga nije nadjena");
}
Korisnik &amp;Biblioteka::NadjiKorisnika(int clanski_broj) {
    for (auto it = korisnici.begin(); it != korisnici.end(); it++)
        if (it-&gt;first == clanski_broj) return *it-&gt;second;
    throw std::logic_error ("Korisnik nije nadjen");
}
void Biblioteka::RegistrirajNovogKorisnika(int clanski_broj, std::string ime, std::string prezime, std::string adresa, std::string telefon) {
    auto pom(std::make_shared&lt;Korisnik&gt;());
    pom-&gt;ime = ime; pom-&gt;prezime = prezime; pom-&gt;adresa = adresa; pom-&gt;telefon = telefon;
    auto velicina(korisnici.size());
    korisnici[clanski_broj] = pom;
    if (velicina == korisnici.size()) throw std::logic_error ("Korisnik vec postoji");
}
void Biblioteka::RegistrirajNovuKnjigu(int evidencijski_broj, std::string naslov_knjige, std::string ime_pisca, std::string zanr, int godina_izdavanja) {
    auto pom(std::make_shared&lt;Knjiga&gt;(naslov_knjige, ime_pisca, zanr, godina_izdavanja));
    auto velicina(knjige.size());
    knjige[evidencijski_broj] = pom;
    if (velicina == knjige.size()) throw std::logic_error ("Knjiga vec postoji");
}
Biblioteka::Biblioteka(const Biblioteka &amp;b) {
    for (auto it = b.korisnici.begin(); it != b.korisnici.end(); it++) {
        std::pair&lt;int, std::shared_ptr&lt;Korisnik&gt;&gt; korisnici;
        korisnici.first = it-&gt;first; korisnici.second = std::make_shared&lt;Korisnik&gt;(*(it-&gt;second));
        Biblioteka::korisnici.insert(korisnici);
    }
    for (auto it = b.knjige.begin(); it != b.knjige.end(); it++) 
        knjige.insert(std::make_pair(it-&gt;first, std::make_shared&lt;Knjiga&gt;(*(it-&gt;second))));
}
Biblioteka &amp;Biblioteka::operator =(const Biblioteka &amp;b) {
    if (this != &amp;b) 
        korisnici = b.korisnici, knjige = b.knjige;
    return *this;
}
Biblioteka &amp;Biblioteka::operator =(Biblioteka &amp;&amp;b) {
    std::swap(korisnici, b.korisnici);
    std::swap(knjige, b.knjige);
    return *this;
}

int main () //c/p maina iz prvog zadatka
{
	std::cout &lt;&lt; "Dobrodosli!" &lt;&lt; std::endl &lt;&lt; std::endl;
	try {
	    Biblioteka b;
	    for(;;) { 
	        int n;
	        std::cout &lt;&lt; "Odaberite opciju: " &lt;&lt; std::endl;
	        std::cout &lt;&lt; "  1 - Registrujte novog korisnika" &lt;&lt; std::endl &lt;&lt; "  2 - Registrujte novu knjigu" &lt;&lt; std::endl &lt;&lt; "  3 - Zaduzite knjigu"
	        &lt;&lt; std::endl &lt;&lt; "  4 - Razduzite knjigu" &lt;&lt; std::endl &lt;&lt; "  5 - Prikaz zaduzenja zeljenog korisnika" &lt;&lt; std::endl &lt;&lt; "  6 - Spisak korisnika"
	        &lt;&lt; std::endl &lt;&lt; "  7 - Spisak knjiga" &lt;&lt; std::endl &lt;&lt; "  0 - Kraj" &lt;&lt; std::endl;
	        std::cin &gt;&gt; n;
	        if (n == 1) {
	            for (;;) {
	                try {
	                    int clanski_broj;
	                    std::string ime, prezime, telefon, adresa;
	                    std::cout &lt;&lt; "Unesite trazene podatke:" &lt;&lt; std::endl;
	                    std::cout &lt;&lt; "Clanski broj: "; std::cin &gt;&gt; clanski_broj;
	                    if (!std::cin) throw std::logic_error ("Neispravan unos");
<a name="5"></a><font color="#FF0000"><a href="match447-0.html#5" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

	                    std::cin.ignore(10000, '\n');
	                    std::cout &lt;&lt; "Ime: "; std::getline(std::cin, ime);
	                    std::cout &lt;&lt; "Prezime: "; std::getline(std::cin, prezime);
</font><a name="4"></a><font color="#FF00FF"><a href="match447-0.html#4" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

	                    std::cout &lt;&lt; "Telefon: "; std::getline(std::cin, telefon);
	                    std::cout &lt;&lt; "Adresa: "; std::getline(std::cin, adresa);
	                    b.RegistrirajNovogKorisnika(clanski_broj, ime, prezime, telefon, adresa);
</font>	                    break;
	                }
	                catch(std::logic_error e) {
	                    std::cout &lt;&lt; e.what() &lt;&lt; ". Molimo, ponovite unos:" &lt;&lt; std::endl;
	                    std::cin.clear();
	                    std::cin.ignore(10000, '\n');
	                }
	            }
	        }
	        else if (n == 2) {
	            for(;;) {             
	                try {             
	                    int evidencijski_broj, godina_izdavanja;
	                    std::string naslov_knjige, autor, zanr;
	                    std::cout &lt;&lt; "Unesite trazene podatke:" &lt;&lt; std::endl;
	                    std::cout &lt;&lt; "Evidencijski broj: "; std::cin &gt;&gt; evidencijski_broj;
	                    if (!std::cin) throw std::logic_error ("Neispravan unos");
<a name="6"></a><font color="#00FF00"><a href="match447-0.html#6" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

	                    std::cin.ignore(10000, '\n');
	                    std::cout &lt;&lt; "Naslov knjige: "; std::getline(std::cin, naslov_knjige);
	                    std::cout &lt;&lt; "Zanr: "; std::getline(std::cin, zanr);
</font><a name="7"></a><font color="#0000FF"><a href="match447-0.html#7" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

	                    std::cout &lt;&lt; "Autor: "; std::getline(std::cin, autor);
	                    std::cout &lt;&lt; "Godina izdavanja: "; std::cin &gt;&gt; godina_izdavanja;
	                    b.RegistrirajNovuKnjigu(evidencijski_broj, naslov_knjige, autor, zanr, godina_izdavanja);
</font>	                    break;
	                }
	                catch(std::logic_error e) {
	                    std::cout &lt;&lt; e.what() &lt;&lt; ". Molimo, ponovite unos:" &lt;&lt; std::endl;
	                    std::cin.clear();
	                    std::cin.ignore(10000, '\n');
	                }
	            }
	        }
	        else if (n == 3) {
	            for(;;) {
	                try {
	                    int evidencijski_broj, clanski_broj;
	                    std::cout &lt;&lt; "Unesite trazene podatke:" &lt;&lt; std::endl;
	                    std::cout &lt;&lt; "Unesite evidencijski broj knjige: "; std::cin &gt;&gt; evidencijski_broj;
	                    if (!std::cin) throw std::logic_error ("Neispravan unos");
	                    std::cout &lt;&lt; "Unesite clanski broj: "; std::cin &gt;&gt; clanski_broj;
	                    if (!std::cin) throw std::logic_error ("Neispravan unos");
	                    b.ZaduziKnjigu(evidencijski_broj, clanski_broj);
	                    break;
	                }
	                catch (std::logic_error e) {
	                    std::cout &lt;&lt; e.what() &lt;&lt; ". Molimo, ponovite unos:" &lt;&lt; std::endl;
	                    std::cin.clear();
	                    std::cin.ignore(10000, '\n');
	                }
	            }
	        }
	        else if (n == 4) {
	            for (;;) {
	                try {
	                  int evidencijski_broj;
	                  std::cout &lt;&lt; "Unesite evidencijski broj knjige: "; std::cin &gt;&gt; evidencijski_broj;
	                  if (!std::cin) throw std::logic_error ("Neispravan unos");
	                  b.RazduziKnjigu(evidencijski_broj);
	                  break;
	                }
	                catch(std::logic_error e) {
	                    std::cout &lt;&lt; e.what() &lt;&lt;". Molimo, ponovite unos:" &lt;&lt; std::endl;
	                    std::cin.clear();
	                    std::cin.ignore(10000, '\n');
	                }
	            }
	        }
	        else if (n == 5) {
	            for (;;) {
	                try {
	                    int clanski_broj;
	                    std::cout &lt;&lt; "Unesite clanski broj korisnika: "; std::cin &gt;&gt; clanski_broj;
	                    if (!std::cin) throw std::logic_error ("Neispravan unos");
	                    b.PrikaziZaduzenja(clanski_broj);
	                    break;
	                }
	                catch(std::logic_error e) {
	                    std::cout &lt;&lt; e.what() &lt;&lt; ". Molimo, ponovite unos:" &lt;&lt; std::endl;
	                    std::cin.clear();
	                    std::cin.ignore(10000, '\n');
	                }
	            }
	        }
	        else if (n == 6) {
	            b.IzlistajKorisnike();
	        }
	        else if (n == 7) {
	            b.IzlistajKnjige();
	        }
	        else if (n == 0) break;
<a name="8"></a><font color="#00FFFF"><a href="match447-0.html#8" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

	        else {
	            std::cout &lt;&lt; "Neispravan unos!" &lt;&lt; std::endl;
	            std::cin.clear();
	            std::cin.ignore(10000, '\n');
	        }
	    }
	}
	catch(...) {
</font>	    std::cout &lt;&lt; "Nedovoljno memorije" &lt;&lt; std::endl;
	}
	std::cout &lt;&lt; "Dovidjenja!";
	return 0;
}</pre>
</body>
</html>
