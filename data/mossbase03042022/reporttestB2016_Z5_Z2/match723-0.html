<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student6705.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student6705.cpp<p></p><pre>

#include &lt;iostream&gt;
#include &lt;algorithm&gt;
#include &lt;stdexcept&gt;
#include &lt;string&gt;
#include &lt;map&gt;
#include &lt;memory&gt;

struct Korisnik
{
    std::string ime;
    std::string prezime;
    std::string adresa;
    std::string telefon;
    void UnosKorisnika(std::string i,std::string p,std::string a,std::string t){
        ime = i; prezime = p; adresa = a; telefon = t;
    }
};
class Knjiga    
{
    std::string naslov_knjige;
    std::string ime_pisca;  
    std::string zanr_knjige;
    int godina_izdavanja_knjige;
    Korisnik* zaduzenje = nullptr;
public:
    Knjiga(std::string naslov, std::string ime, std::string zanr, int godina): naslov_knjige(naslov),
        ime_pisca(ime), zanr_knjige(zanr), godina_izdavanja_knjige(godina){}
    std::string DajNaslov() const{ return naslov_knjige;}
    std::string DajAutora() const{ return ime_pisca;}
    std::string DajZanr() const{ return zanr_knjige;}
    int DajGodinuIzdavanja() const{ return godina_izdavanja_knjige;}
    Korisnik* DajKodKogaJe() const{ return zaduzenje;}
    void ZaduziKnjigu(Korisnik&amp; korisnik){
        zaduzenje = &amp;korisnik;
    }
<a name="3"></a><font color="#00FFFF"><a href="match723-1.html#3" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

    void RazduziKnjigu(){
        zaduzenje = nullptr;
    }
    bool DaLiJeZaduzena() const{
        return (zaduzenje != nullptr);
    }
};
class Biblioteka
{
    std::map&lt;int, std::shared_ptr&lt;Korisnik&gt;&gt; korisnici;
    std::map&lt;int, std::shared_ptr&lt;Knjiga&gt;&gt; knjige;
</font>    public:
    Biblioteka() = default;
    ~Biblioteka() {}
<a name="1"></a><font color="#00FF00"><a href="match723-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_2.gif"/></a>

    Biblioteka(const Biblioteka &amp;b);
    Biblioteka(Biblioteka &amp;&amp;b);
    Biblioteka &amp;operator =(const Biblioteka &amp;b);
    Biblioteka &amp;operator =(Biblioteka &amp;&amp;b);
    void RegistrirajNovogKorisnika(int clanski, std::string ime, std::string prezime,
        std::string adresa, std::string telefon);
</font>    void RegistrirajNovuKnjigu(int evidencijski, std::string naslov, std::string ime, 
        std::string zanr, int godina);
    void IzlistajKorisnike() const;
    void IzlistajKnjige() const;
    Korisnik&amp; NadjiKorisnika(int clanski) const;
    Knjiga&amp; NadjiKnjigu(int evidencijski) const;
    void ZaduziKnjigu(int evidencijski, int clanski);
    void RazduziKnjigu(int evidencijski);
    void PrikaziZaduzenja(int clanski) const;
};
void Biblioteka::RegistrirajNovogKorisnika(int clanski, std::string ime, std::string prezime,
        std::string adresa, std::string telefon)
    {
        if(korisnici.count(clanski))
            throw std::logic_error("Korisnik vec postoji");
        std::shared_ptr&lt;Korisnik&gt; novi = std::make_shared&lt;Korisnik&gt;();
        novi-&gt;UnosKorisnika(ime, prezime, adresa, telefon);
        korisnici[clanski] = novi;
    }
void Biblioteka::RegistrirajNovuKnjigu(int evidencijski, std::string naslov, std::string ime, 
        std::string zanr, int godina)
    {
        if(knjige.count(evidencijski))
            throw std::logic_error("Knjiga vec postoji");
        knjige[evidencijski] = std::make_shared&lt;Knjiga&gt;(naslov, ime, zanr, godina);
    }
void Biblioteka::IzlistajKorisnike() const
{
    for(auto it = korisnici.begin(); it != korisnici.end(); it++)
    {
<a name="0"></a><font color="#FF0000"><a href="match723-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_2.gif"/></a>

        std::cout &lt;&lt; "Clanski broj: " &lt;&lt; it-&gt;first &lt;&lt; std::endl &lt;&lt; "Ime i prezime: " &lt;&lt; 
            it-&gt;second-&gt;ime &lt;&lt; " " &lt;&lt; it-&gt;second-&gt;prezime &lt;&lt; std::endl &lt;&lt; "Adresa: " &lt;&lt; 
</font><a name="7"></a><font color="#0000FF"><a href="match723-1.html#7" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

            it-&gt;second-&gt;adresa &lt;&lt; std::endl &lt;&lt; "Broj telefona: " &lt;&lt; it-&gt;second-&gt;telefon
            &lt;&lt; std::endl &lt;&lt; std::endl;
</font>    }
}
void Biblioteka::IzlistajKnjige() const
{
    for(auto it = knjige.begin(); it != knjige.end(); it++)
    {
        std::cout &lt;&lt; "Evidencijski broj: " &lt;&lt; it-&gt;first &lt;&lt; std::endl &lt;&lt; "Naslov: " &lt;&lt; 
            it-&gt;second-&gt;DajNaslov() &lt;&lt; std::endl &lt;&lt; "Pisac: " &lt;&lt; it-&gt;second-&gt;DajAutora()
            &lt;&lt; std::endl &lt;&lt; "Zanr: " &lt;&lt; it-&gt;second-&gt;DajZanr() &lt;&lt; std::endl &lt;&lt;
            "Godina izdavanja: " &lt;&lt; it-&gt;second-&gt;DajGodinuIzdavanja() &lt;&lt; std::endl;
        if(it-&gt;second-&gt;DaLiJeZaduzena())
            std::cout &lt;&lt; "Zaduzena kod korisnika: " &lt;&lt; it-&gt;second-&gt;DajKodKogaJe()-&gt;ime 
            &lt;&lt; " " &lt;&lt; it-&gt;second-&gt;DajKodKogaJe()-&gt;prezime &lt;&lt; std::endl;
        std::cout &lt;&lt; std::endl;
    }
}
Korisnik&amp; Biblioteka::NadjiKorisnika(int clanski) const
{
    auto it = korisnici.begin();
<a name="6"></a><font color="#00FF00"><a href="match723-1.html#6" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

    for(; it != korisnici.end(); it++)
        if(it-&gt;first == clanski)
            return *it-&gt;second;
    throw std::logic_error("Korisnik nije nadjen");
}
Knjiga&amp; Biblioteka::NadjiKnjigu(int evidencijski) const
</font>{
    auto it = knjige.begin();
<a name="8"></a><font color="#00FFFF"><a href="match723-1.html#8" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

    for(; it != knjige.end(); it++)
        if(it-&gt;first == evidencijski)
            return *it-&gt;second;
    throw std::logic_error("Knjiga nije nadjena");
}
void Biblioteka::ZaduziKnjigu(int evidencijski, int clanski)
</font>{
    auto &amp;k = NadjiKnjigu(evidencijski);
    auto &amp;c = NadjiKorisnika(clanski);
    if(k.DaLiJeZaduzena())
        throw std::logic_error("Knjiga vec zaduzena");
    k.ZaduziKnjigu(c);
}
void Biblioteka::RazduziKnjigu(int evidencijski)
{
    auto &amp;k = NadjiKnjigu(evidencijski);
    if(!k.DaLiJeZaduzena())
        throw std::logic_error("Knjiga nije zaduzena");
    k.RazduziKnjigu();
}
void Biblioteka::PrikaziZaduzenja(int clanski) const
{
    auto &amp;k = NadjiKorisnika(clanski);
    int brojac = 0;
    for(auto it = knjige.begin(); it != knjige.end(); it++)
        if(it-&gt;second-&gt;DajKodKogaJe() == &amp;k)
        {
            std::cout &lt;&lt; "Evidencijski broj: " &lt;&lt; it-&gt;first &lt;&lt; std::endl &lt;&lt; "Naslov: " &lt;&lt; 
            it-&gt;second-&gt;DajNaslov() &lt;&lt; std::endl &lt;&lt; "Pisac: " &lt;&lt; it-&gt;second-&gt;DajAutora()
<a name="5"></a><font color="#FF0000"><a href="match723-1.html#5" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

            &lt;&lt; std::endl &lt;&lt; "Zanr: " &lt;&lt; it-&gt;second-&gt;DajZanr() &lt;&lt; std::endl &lt;&lt;
            "Godina izdavanja: " &lt;&lt; it-&gt;second-&gt;DajGodinuIzdavanja() &lt;&lt; std::endl &lt;&lt; std::endl;
            brojac++;
</font>        }
    if(brojac == 0)
        std::cout &lt;&lt; "Nema zaduzenja za tog korisnika!" &lt;&lt; std::endl;
}

Biblioteka::Biblioteka(const Biblioteka &amp;b)
{
    try{
        for(auto it = b.korisnici.begin(); it != b.korisnici.end(); it++)
            korisnici[it-&gt;first] = std::make_shared&lt;Korisnik&gt;(*it-&gt;second);
        for(auto it = b.knjige.begin(); it != b.knjige.end(); it++)
            knjige[it-&gt;first] = std::make_shared&lt;Knjiga&gt;(*it-&gt;second);
    }
    catch(std::bad_alloc){
        korisnici.clear();
        knjige.clear();
        throw;
    }
}
Biblioteka::Biblioteka(Biblioteka &amp;&amp;b)
{
    korisnici = b.korisnici;
    knjige = b.knjige;
    b.korisnici.clear();
    b.knjige.clear();
}
Biblioteka &amp;Biblioteka::operator =(const Biblioteka &amp;b)
{
    if(&amp;b == this) return *this;
    korisnici.clear();
    knjige.clear();
    try{
        for(auto it = b.korisnici.begin(); it != b.korisnici.end(); it++)
            korisnici[it-&gt;first] = std::make_shared&lt;Korisnik&gt;(*it-&gt;second);
        for(auto it = b.knjige.begin(); it != b.knjige.end(); it++)
            knjige[it-&gt;first] = std::make_shared&lt;Knjiga&gt;(*it-&gt;second);
    }
    catch(std::bad_alloc){
        korisnici.clear();
        knjige.clear();
        throw;
    }
    return *this;
}
Biblioteka &amp;Biblioteka::operator =(Biblioteka &amp;&amp;b)
{
    if(&amp;b == this) return *this;
    korisnici.clear();
    knjige.clear();
    korisnici = b.korisnici;
    knjige = b.knjige;
    b.korisnici.clear();
    b.knjige.clear();    
    return *this;
}
int Meni()
{
    int i(0);
    while (i &lt; 1 || i &gt; 8) {
        std::cout &lt;&lt; "Meni: " &lt;&lt; std::endl &lt;&lt; "1. Dodaj novog korisnika!" &lt;&lt; std::endl &lt;&lt; 
            "2. Dodaj novu knjigu!" &lt;&lt; std::endl &lt;&lt; "3. Izlistaj korisnike!" &lt;&lt; std::endl &lt;&lt;
<a name="4"></a><font color="#FF00FF"><a href="match723-1.html#4" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

            "4. Izlistaj knjige!" &lt;&lt; std::endl &lt;&lt; "5. Zaduzi knjigu!" &lt;&lt; std::endl &lt;&lt; 
            "6. Razduzi knjigu!" &lt;&lt; std::endl &lt;&lt; "7. Prikazi zaduzenje" &lt;&lt; std::endl &lt;&lt;
            "8. Kraj Programa!" &lt;&lt; std::endl;
            
        std::cin &gt;&gt; i;
</font>    }
    return i;
}
int main(){
    try
    {
        Biblioteka b;
        int k(1);
        while (k != 8) {
            k = Meni();
            if(k == 1)
            {
                try
                {
                    int clanski;
                    std::cout &lt;&lt; "Unesite clanski broj novog korisnika: ";
                    std::cin &gt;&gt; clanski;
                    std::cin.clear();
                    std::cin.ignore(1000, '\n');
                    std::string ime, prezime, adresa, broj;
                    std::cout &lt;&lt; "Unesite ime pa prezime novog korisnika: ";
                    std::getline(std::cin, ime);
                    std::getline(std::cin, prezime);
                    std::cout &lt;&lt; "Unesite adresu novog korisnika: ";
<a name="2"></a><font color="#0000FF"><a href="match723-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

                    std::getline(std::cin, adresa);
                    std::cout &lt;&lt; "Unesite broj telefona novog korisnika: ";
                    std::getline(std::cin, broj);
                    b.RegistrirajNovogKorisnika(clanski, ime, prezime, adresa, broj);
</font>                }
                catch(std::logic_error e){
                    std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
                }
            }
            else if(k == 2)
            {
                try
                {
                    int evidencijski;
                    std::cout &lt;&lt; "Unesite evidencijski broj nove knjige: ";
                    std::cin &gt;&gt; evidencijski;
                    std::cin.clear();
                    std::cin.ignore(1000, '\n');
                    std::string naziv, pisac, zanr;
                    std::cout &lt;&lt; "Unesite naziv nove knjige: ";
                    std::getline(std::cin, naziv);
                    std::cout &lt;&lt; "Unesite naziv autora nove knjige: ";
                    std::getline(std::cin, pisac);
                    std::cout &lt;&lt; "Unesite zanr nove knjige: ";
                    std::getline(std::cin, zanr);
                    int godina;
                    std::cout &lt;&lt; "Unesite godinu izdavanja knjige: ";
                    std::cin &gt;&gt; godina;
                    b.RegistrirajNovuKnjigu(evidencijski, naziv, pisac, zanr, godina);
                }
                catch(std::logic_error e){
                    std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
                }
            }
            else if(k == 3)
            {
                std::cout &lt;&lt; "Korisnici: " &lt;&lt; std::endl;
                b.IzlistajKorisnike();
                std::cout &lt;&lt; std::endl;
            }
            else if(k == 4)
            {
                std::cout &lt;&lt; "Knjige: " &lt;&lt; std::endl;
                b.IzlistajKnjige();
                std::cout &lt;&lt; std::endl;
            }
            else if(k == 5)
            {
                try
                {
                    int evidencijski, clanski;
                    std::cout &lt;&lt; "Unesite clanski broj korisnika koji zaduzuje knjigu: ";
                    std::cin &gt;&gt; clanski;
                    std::cout &lt;&lt; "Unesite evidencijski broj knjige koja se zaduzuje: ";
                    std::cin &gt;&gt; evidencijski;
                    b.ZaduziKnjigu(evidencijski, clanski);
                }
                catch(std::logic_error e)
                {
                    std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
                }
            }
            else if(k == 6)
            {
                try
                {
                    int evidencijski;
                    std::cout &lt;&lt; "Unesite evidencijski broj knjige koja se razduzuje: ";
                    std::cin &gt;&gt; evidencijski;
                    b.RazduziKnjigu(evidencijski);
                }
                catch(std::logic_error e)
                {
                    std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
                }
            }
            else if(k == 7)
            {
                std::cout &lt;&lt; "Unesite clanski broj korisnika za kojeg zelite prikazati zaduzenja: ";
                int clanski;
                std::cin &gt;&gt; clanski;
                std::cout &lt;&lt; "Zaduzenja: " &lt;&lt; std::endl;
                b.PrikaziZaduzenja(clanski);
                std::cout &lt;&lt; std::endl;
            }
        }
    }
    catch(std::bad_alloc){
        std::cout &lt;&lt; "Problemi sa memorijom!";
    }
    return 0;
}
</pre>
</body>
</html>
