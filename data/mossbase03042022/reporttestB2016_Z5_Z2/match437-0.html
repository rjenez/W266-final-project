<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student4253.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student4253.cpp<p></p><pre>
/B16/17 (ZadaÄ‡a 5, Zadatak 2)
//Autotestovi by Eldar Kurtic (mail: ekurtic3@etf.unsa.ba)
//Za autotestove se obracati *iskljucivo* osobi koja ih pise
#include &lt;iostream&gt;
#include &lt;memory&gt;
#include &lt;string&gt;
#include &lt;map&gt;

struct Korisnik{
    std::string ime, prezime, adresa, telefon;
};

class Knjiga{
    std::string naslov_knjige, ime_pisca, zanr;
    int godina_izdavanja;
    Korisnik *zaduzeno_kod;
    
    public:
    Knjiga(std::string naslov, std::string ime, std::string zanr, int godina): naslov_knjige(naslov), ime_pisca(ime), zanr(zanr), godina_izdavanja(godina), zaduzeno_kod(nullptr) {}
    std::string DajNaslov() const {return naslov_knjige;}
    std::string DajAutora() const {return ime_pisca;}
    std::string DajZanr() const {return zanr;}
    int DajGodinuIzdavanja() const {return godina_izdavanja;}
<a name="3"></a><font color="#00FFFF"><a href="match437-1.html#3" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_2.gif"/></a>

    Korisnik* DajKodKogaJe() const {return zaduzeno_kod;}
    void ZaduziKnjigu(Korisnik &amp;korisnik) {zaduzeno_kod=&amp;korisnik;}
    void RazduziKnjigu(){zaduzeno_kod=nullptr;}
    bool DaLiJeZaduzena() const {if(zaduzeno_kod==nullptr) return false; return true;}
};

class Biblioteka{
    std::map&lt;int, std::shared_ptr&lt;Korisnik&gt;&gt; korisnici;
</font>    std::map&lt;int, std::shared_ptr&lt;Knjiga&gt;&gt; knjige;
    
    public:
    Biblioteka();
   
<a name="4"></a><font color="#FF00FF"><a href="match437-1.html#4" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_2.gif"/></a>

    Biblioteka(const Biblioteka &amp;biblioteka);
    Biblioteka(Biblioteka &amp;&amp;biblioteka);
    Biblioteka &amp;operator=(const Biblioteka &amp;biblioteka);
    Biblioteka &amp;operator=(Biblioteka &amp;&amp;biblioteka);
    void RegistrirajNovogKorisnika(int broj_korisnika, std::string ime, std::string prezime, std::string adresa, std::string broj_telefona);
</font>    void RegistrirajNovuKnjigu(int broj_knjige, std::string naslov, std::string ime_pisca, std::string zanr, int godina_izdavanja);
    Korisnik &amp;NadjiKorisnika(int broj_korisnika) const;
    Knjiga &amp;NadjiKnjigu(int broj_knjige) const;
    void IzlistajKorisnike() const;
    void IzlistajKnjige()const;
    void ZaduziKnjigu(int broj_knjige, int broj_korisnika);
    void RazduziKnjigu(int broj_knjige);
    void PrikaziZaduzenja(int broj_korisnika) const;
};

Biblioteka::Biblioteka(){
    std::map&lt;int, std::shared_ptr&lt;Korisnik&gt;&gt; p1;
    std::map&lt;int, std::shared_ptr&lt;Knjiga&gt;&gt; p2;
    korisnici=p1; knjige=p2;
}

Biblioteka::Biblioteka(const Biblioteka &amp;biblioteka){
    for(auto it=biblioteka.korisnici.begin(); it!=biblioteka.korisnici.end(); it++){
        korisnici.insert(std::make_pair(it-&gt;first, std::make_shared&lt;Korisnik&gt; (*(it-&gt;second))));
    }
    for(auto it=biblioteka.knjige.begin(); it!=biblioteka.knjige.end(); it++){
        knjige.insert(std::make_pair(it-&gt;first, std::make_shared&lt;Knjiga&gt;(*(it-&gt;second))));
    }
}

Biblioteka::Biblioteka(Biblioteka &amp;&amp;biblioteka){
    korisnici=biblioteka.korisnici;
    knjige=biblioteka.knjige;
    
    for(auto it=biblioteka.korisnici.begin(); it!=biblioteka.korisnici.end(); it++) it-&gt;second=nullptr;
    for(auto it=biblioteka.knjige.begin(); it!=biblioteka.knjige.end(); it++) it-&gt;second=nullptr;
}

Biblioteka &amp;Biblioteka::operator=(const Biblioteka &amp;biblioteka){
    for(auto it=korisnici.begin(); it!=korisnici.end(); it++) it-&gt;second=nullptr;
    for(auto it=knjige.begin(); it!=knjige.end(); it++) it-&gt;second=nullptr;
    
    for(auto it=korisnici.begin(); it!=korisnici.end(); it=korisnici.erase(it));
    for(auto it=knjige.begin(); it!=knjige.end(); it=knjige.erase(it));
    
    for(auto it=biblioteka.korisnici.begin(); it!=biblioteka.korisnici.end(); it++){
        korisnici.insert(std::make_pair(it-&gt;first, std::make_shared&lt;Korisnik&gt; (*(it-&gt;second))));
    }
    for(auto it=biblioteka.knjige.begin(); it!=biblioteka.knjige.end(); it++){
        knjige.insert(std::make_pair(it-&gt;first, std::make_shared&lt;Knjiga&gt;(*(it-&gt;second))));
    }
<a name="0"></a><font color="#FF0000"><a href="match437-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_2.gif"/></a>

    return *this;
}

Biblioteka &amp;Biblioteka::operator=(Biblioteka &amp;&amp;biblioteka){
    std::swap(korisnici,biblioteka.korisnici);
    std::swap(knjige,biblioteka.knjige);
    return *this;
}

void Biblioteka::RegistrirajNovogKorisnika(int broj_korisnika, std::string ime, std::string prezime, std::string adresa, std::string broj_telefona){
</font>    auto it(korisnici.find(broj_korisnika));
    if(it!=korisnici.end()) throw std::logic_error("Korisnik vec postoji");
    
    std::shared_ptr&lt;Korisnik&gt; temp(new Korisnik);
    temp-&gt;ime=ime; temp-&gt;prezime=prezime; temp-&gt;adresa=adresa; temp-&gt;telefon=broj_telefona;
    
    korisnici.insert(std::make_pair(broj_korisnika, temp));
    
}

<a name="6"></a><font color="#00FF00"><a href="match437-1.html#6" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

void Biblioteka::RegistrirajNovuKnjigu(int broj_knjige, std::string naslov, std::string ime_pisca, std::string zanr, int godina_izdavanja){
    auto it(knjige.find(broj_knjige));
</font>    if(it!=knjige.end()) throw std::logic_error("Knjiga vec postoji");
    knjige.insert(std::make_pair(broj_knjige, std::make_shared&lt;Knjiga&gt;(naslov, ime_pisca, zanr, godina_izdavanja)));
}

Korisnik &amp;Biblioteka::NadjiKorisnika(int broj_korisnika) const{
    auto it(korisnici.find(broj_korisnika));
    if(it==korisnici.end()) throw std::logic_error("Korisnik nije nadjen");
    return *(it-&gt;second);
}

Knjiga &amp;Biblioteka::NadjiKnjigu(int broj_knjige) const{
    auto it(knjige.find(broj_knjige));
    if(it==knjige.end()) throw std::logic_error("Knjiga nije nadjena");
    return *(it-&gt;second);
}

void Biblioteka::IzlistajKorisnike() const{
    for(auto it=korisnici.begin(); it!=korisnici.end(); it++){
        std::cout&lt;&lt;"Clanski broj: "&lt;&lt;it-&gt;first&lt;&lt;std::endl
                 &lt;&lt;"Ime i prezime: "&lt;&lt;(it-&gt;second)-&gt;ime&lt;&lt;" "&lt;&lt;(it-&gt;second)-&gt;prezime&lt;&lt;std::endl
<a name="7"></a><font color="#0000FF"><a href="match437-1.html#7" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

                 &lt;&lt;"Adresa: "&lt;&lt;(it-&gt;second)-&gt;adresa&lt;&lt;std::endl
                 &lt;&lt;"Broj telefona: "&lt;&lt;(it-&gt;second)-&gt;telefon&lt;&lt;std::endl
                 &lt;&lt;std::endl;
    }
}

void Biblioteka::IzlistajKnjige() const{
</font>    for(auto it=knjige.begin(); it!=knjige.end(); it++){
        std::cout&lt;&lt;"Evidencijski broj: "&lt;&lt;it-&gt;first&lt;&lt;std::endl
                 &lt;&lt;"Naslov: "&lt;&lt;(it-&gt;second)-&gt;DajNaslov()&lt;&lt;std::endl
                 &lt;&lt;"Pisac: "&lt;&lt;(it-&gt;second)-&gt;DajAutora()&lt;&lt;std::endl
                 &lt;&lt;"Zanr: "&lt;&lt;(it-&gt;second)-&gt;DajZanr()&lt;&lt;std::endl
                 &lt;&lt;"Godina izdavanja: "&lt;&lt;(it-&gt;second)-&gt;DajGodinuIzdavanja()&lt;&lt;std::endl;
        if( (it-&gt;second)-&gt;DaLiJeZaduzena() ) std::cout&lt;&lt;"Zaduzena kod korisnika: "&lt;&lt;(it-&gt;second)-&gt;DajKodKogaJe()-&gt;ime&lt;&lt;" "&lt;&lt;(it-&gt;second)-&gt;DajKodKogaJe()-&gt;prezime&lt;&lt;std::endl;
<a name="1"></a><font color="#00FF00"><a href="match437-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_2.gif"/></a>

        std::cout&lt;&lt;std::endl;
    }
}

void Biblioteka::ZaduziKnjigu(int broj_knjige, int broj_korisnika){
    auto it_knjige(knjige.find(broj_knjige));
    if(it_knjige==knjige.end()) throw std::logic_error("Knjiga nije nadjena");
    auto it_korisnika(korisnici.find(broj_korisnika));
    if(it_korisnika==korisnici.end()) throw std::logic_error("Korisnik nije nadjen");
    
    if((it_knjige-&gt;second)-&gt;DaLiJeZaduzena()) throw std::logic_error("Knjiga je vec zaduzena");
</font>    (it_knjige-&gt;second)-&gt;ZaduziKnjigu(*(it_korisnika-&gt;second));
}

<a name="2"></a><font color="#0000FF"><a href="match437-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_2.gif"/></a>

void Biblioteka::RazduziKnjigu(int broj_knjige){
    auto it_knjige(knjige.find(broj_knjige));
    if(it_knjige==knjige.end()) throw std::logic_error("Knjiga nije nadjena");
    if((it_knjige-&gt;second)-&gt;DaLiJeZaduzena()==false) throw std::logic_error("Knjiga nije zaduzena");
    (it_knjige-&gt;second)-&gt;RazduziKnjigu();
}

void Biblioteka::PrikaziZaduzenja(int broj_korisnika) const{
</font>    auto it_k(korisnici.find(broj_korisnika));
    if(it_k==korisnici.end()) throw std::logic_error("Korisnik nije nadjen");
    
    Korisnik *p(it_k-&gt;second.get());
    
    bool nema(true);
    
    for(auto it=knjige.begin(); it!=knjige.end(); it++){
        if((it-&gt;second)-&gt;DajKodKogaJe()==p){
            nema=false;
            std::cout&lt;&lt;"Evidencijski broj: "&lt;&lt;it-&gt;first&lt;&lt;std::endl
                     &lt;&lt;"Naslov: "&lt;&lt;(it-&gt;second)-&gt;DajNaslov()&lt;&lt;std::endl
                     &lt;&lt;"Pisac: "&lt;&lt;(it-&gt;second)-&gt;DajAutora()&lt;&lt;std::endl
                     &lt;&lt;"Zanr: "&lt;&lt;(it-&gt;second)-&gt;DajZanr()&lt;&lt;std::endl
                     &lt;&lt;"Godina izdavanja: "&lt;&lt;(it-&gt;second)-&gt;DajGodinuIzdavanja()&lt;&lt;std::endl
                     &lt;&lt;std::endl;
        }
        if(nema) std::cout&lt;&lt;"Nema zaduzenja za tog korisnika!";
    }
}

int main ()
{
    Biblioteka biblioteka;
    for(;;){
        std::cout&lt;&lt;"Izaberite opciju: "&lt;&lt;std::endl
                 &lt;&lt;"0 - kraj"&lt;&lt;std::endl
                 &lt;&lt;"1 - dodavanje korisnika"&lt;&lt;std::endl
                 &lt;&lt;"2 - dodavanje knjige"&lt;&lt;std::endl
<a name="5"></a><font color="#FF0000"><a href="match437-1.html#5" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

                 &lt;&lt;"3 - zaduzenje knjige"&lt;&lt;std::endl
                 &lt;&lt;"4 - razduzenje knjige"&lt;&lt;std::endl
                 &lt;&lt;"5 - izlistavanje knjiga"&lt;&lt;std::endl
                 &lt;&lt;"6 - izlistavanje korisnika"&lt;&lt;std::endl;
        int opcija;
        std::cin&gt;&gt;opcija;
        if(opcija==0) {std::cout&lt;&lt;"Kraj"; break;}
</font>        if(opcija==1){
            std::cout&lt;&lt;"Unesi clanski broj";
            int broj;
            std::cin&gt;&gt;broj;
            std::cin.ignore(1000,'\n');
            std::cout&lt;&lt;"Unesi ime, prezime, adresu i telefon korisnika (svaki podatak u novom redu): ";
            std::string ime, prezime, adresa, telefon;
<a name="8"></a><font color="#00FFFF"><a href="match437-1.html#8" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

            std::getline(std::cin,ime); std::getline(std::cin,prezime); std::getline(std::cin,adresa); std::getline(std::cin,telefon);
            biblioteka.RegistrirajNovogKorisnika(broj,ime,prezime,adresa,telefon);
        }
        if(opcija==2){
            std::cout&lt;&lt;"Unesi evidencijski broj knjige: ";
</font>            int broj;
            std::cin&gt;&gt;broj;
            std::cin.ignore(1000,'\n');
            std::cout&lt;&lt;"Unesi naslov, pisca, zanr i godinu izdavanja knjige (svaki podatak u novom redu): ";
            std::string naslov, pisac, zanr;
            int godina;
            std::getline(std::cin,naslov); std::getline(std::cin,pisac); std::getline(std::cin,zanr); std::cin&gt;&gt;godina;
            biblioteka.RegistrirajNovuKnjigu(broj,naslov,pisac,zanr,godina);
        }
        if(opcija==3){
            std::cout&lt;&lt;"Unesi evidencijski broj knjige: ";
            int knjiga;
            std::cin&gt;&gt;knjiga;
            std::cout&lt;&lt;"Unesi clanski broj korisnika: ";
            int korisnik;
            std::cin&gt;&gt;korisnik;
            try{
                biblioteka.ZaduziKnjigu(knjiga,korisnik);
            }
            catch(std::logic_error izuzetak){
                std::cout&lt;&lt;izuzetak.what();
            }
        }
        if(opcija==4){
            std::cout&lt;&lt;"Unesi evidencijski broj knjige: ";
            int knjiga;
            std::cin&gt;&gt;knjiga;
            try{
                biblioteka.RazduziKnjigu(knjiga);
            }
            catch(std::logic_error izuzetak){
                std::cout&lt;&lt;izuzetak.what();
            }
        }
        if(opcija==5){
            biblioteka.IzlistajKnjige();
        }
        if(opcija==6){
            biblioteka.IzlistajKorisnike();
        }
        
    }
	return 0;
}</pre>
</body>
</html>
