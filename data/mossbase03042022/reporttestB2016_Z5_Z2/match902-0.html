<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student9097.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student9097.cpp<p></p><pre>
/B16/17 (ZadaÄ‡a 5, Zadatak 2)
//Autotestovi by Eldar Kurtic (mail: ekurtic3@etf.unsa.ba)
//Za autotestove se obracati *iskljucivo* osobi koja ih pise
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;map&gt;
#include &lt;algorithm&gt;
#include &lt;stdexcept&gt;
#include &lt;memory&gt;
struct Korisnik{
    std::string ime,prezime,adresa,telefon;
};
class Knjiga{
    std::string Naslov,Autor,Zanr;
    int GodinaIzdavanja;
    Korisnik* KodKogaJe;
    public:
        Knjiga(std::string Naslov,std::string ImePisca,std::string Zanr, int GodinaIzdavanja): Naslov(Naslov),Autor(ImePisca),Zanr(Zanr),GodinaIzdavanja(GodinaIzdavanja),KodKogaJe(nullptr) {}
        std::string DajNaslov() const{return Naslov;}
        std::string DajAutora() const{return Autor;}
        std::string DajZanr() const{return Zanr;}
        int DajGodinuIzdavanja() const{return GodinaIzdavanja;}
        Korisnik* DajKodKogaJe() const{return KodKogaJe;}
        void ZaduziKnjigu(Korisnik &amp;korisnik){KodKogaJe=&amp;korisnik;}
        void RazduziKnjigu(){KodKogaJe=nullptr;}
<a name="4"></a><font color="#FF00FF"><a href="match902-1.html#4" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_2.gif"/></a>

        bool DaLiJeZaduzena() const{if(!KodKogaJe)return false; return true;}
};
class Biblioteka{
    std::map&lt;int,std::shared_ptr&lt;Korisnik&gt;&gt; Korisnici;
    std::map&lt;int,std::shared_ptr&lt;Knjiga&gt;&gt; Knjige;
</font>    public:
        Biblioteka(){}
        ~Biblioteka(){
            for(auto it=Korisnici.begin();it!=Korisnici.end();it++){ it-&gt;second=nullptr;}
            for(auto it=Knjige.begin();it!=Knjige.end();it++){it-&gt;second=nullptr;}
        }
        Biblioteka(const Biblioteka &amp;b){
            for(auto &amp;x: b.Korisnici){
                auto pok(std::make_shared&lt;Korisnik&gt;());
                *pok=*(x.second);
                Korisnici[x.first]=pok;
            }
            for(auto &amp;x: b.Knjige){
                auto pok(std::make_shared&lt;Knjiga&gt;(x.second-&gt;DajNaslov(),x.second-&gt;DajAutora(),x.second-&gt;DajZanr(),x.second-&gt;DajGodinuIzdavanja()));
                Knjige[x.first]=pok;
                if(x.second-&gt;DaLiJeZaduzena()){
                    for(auto &amp;y :b.Korisnici) if(y.second.get()==x.second-&gt;DajKodKogaJe()) this-&gt;ZaduziKnjigu(x.first,y.first);
                }
            }
        }
        Biblioteka &amp;operator=(const Biblioteka &amp;b){
            if(&amp;b!=this){
                for(auto &amp;x: Korisnici){ x.second=nullptr;}
                for(auto &amp;x: Knjige){ x.second=nullptr;}
                Knjige.erase(Knjige.begin(),Knjige.end());
                Korisnici.erase(Korisnici.begin(),Korisnici.end());
                Korisnici=b.Korisnici;
                Knjige=b.Knjige;
                for(auto &amp;x: Korisnici){
                    auto pok(std::make_shared&lt;Korisnik&gt;());
                    *pok=*(x.second);
                    x.second=pok;
                }
                for(auto &amp;x: Knjige){
                    auto pok(std::make_shared&lt;Knjiga&gt;(x.second-&gt;DajNaslov(),x.second-&gt;DajAutora(),x.second-&gt;DajZanr(),x.second-&gt;DajGodinuIzdavanja()));
                    if(x.second-&gt;DaLiJeZaduzena()){
                        for(auto &amp;y: b.Korisnici) if(y.second.get()==x.second-&gt;DajKodKogaJe()) pok-&gt;ZaduziKnjigu(*(Korisnici[y.first]));
                    }
                    x.second=pok;
                }
            }
            return *this;
        }
        Biblioteka(Biblioteka &amp;&amp;b){
            Korisnici=b.Korisnici;
            Knjige=b.Knjige;
        //    for(auto &amp;x: b.Korisnici){x.second=nullptr;}
        //    for(auto &amp;x: b.Knjige){x.second=nullptr;}
        }
        Biblioteka &amp;operator=(Biblioteka &amp;&amp;b){
            if(&amp;b!=this){
                for(auto &amp;x: Korisnici){ x.second=nullptr;}
                for(auto &amp;x: Knjige){x.second=nullptr;}
                Knjige.erase(Knjige.begin(),Knjige.end());
                Korisnici.erase(Korisnici.begin(),Korisnici.end());
<a name="2"></a><font color="#0000FF"><a href="match902-1.html#2" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_4.gif"/></a>

                Korisnici=b.Korisnici;
                Knjige=b.Knjige;
        //        for(auto &amp;x: b.Korisnici){x.second=nullptr;}
        //        for(auto &amp;x: b.Knjige){x.second=nullptr;}
            }
            return *this;
        }
        void RegistrirajNovogKorisnika(int ClanskiBrojKorisnika,std::string Ime,std::string Prezime, std::string Adresa,std::string BrojTelefona){
            auto it(Korisnici.find(ClanskiBrojKorisnika));
            if(it!=Korisnici.end()) throw std::logic_error("Korisnik vec postoji");
</font>            try{
                auto pok(std::make_shared&lt;Korisnik&gt;());
                pok-&gt;ime=Ime;
                pok-&gt;prezime=Prezime;
                pok-&gt;adresa=Adresa;
                pok-&gt;telefon=BrojTelefona;
                Korisnici[ClanskiBrojKorisnika]=pok;
            }catch(std::bad_alloc){
                std::cout&lt;&lt;"Greska pri alokaciji";
            }
        }
<a name="3"></a><font color="#00FFFF"><a href="match902-1.html#3" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_2.gif"/></a>

        void RegistrirajNovuKnjigu(int EvidencijskiBrojKnjige,std::string Naslov,std::string Autor,std::string Zanr,int GodinaIzdavanja){
            auto it(Knjige.find(EvidencijskiBrojKnjige));
            if(it!=Knjige.end()) throw std::logic_error("Knjiga vec postoji");
            try{
                auto pok(std::make_shared&lt;Knjiga&gt;(Naslov,Autor,Zanr,GodinaIzdavanja));
</font>                Knjige[EvidencijskiBrojKnjige]=pok;
            }catch(std::bad_alloc){
                std::cout&lt;&lt;"Greska pri alokaciji";
            }
        }
<a name="1"></a><font color="#00FF00"><a href="match902-1.html#1" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_4.gif"/></a>

        Korisnik &amp;NadjiKorisnika(int ClanskiBrojKorisnika) const{
            auto it(Korisnici.find(ClanskiBrojKorisnika));
            if(it==Korisnici.end()) throw std::logic_error("Korisnik nije nadjen");
            return *(it-&gt;second);
        }
        Knjiga &amp;NadjiKnjigu(int EvidencijskiBrojKnjige) const{
            auto it(Knjige.find(EvidencijskiBrojKnjige));
            if(it==Knjige.end()) throw std::logic_error("Knjiga nije nadjena");
            return *(it-&gt;second);
</font>        }
        void IzlistajKorisnike() const{
            for(auto &amp;x:Korisnici)
                std::cout&lt;&lt;"\nClanski broj: "&lt;&lt;x.first&lt;&lt;"\nIme i prezime: "&lt;&lt;x.second-&gt;ime&lt;&lt;" "&lt;&lt;x.second-&gt;prezime&lt;&lt;"\nAdresa: "&lt;&lt;x.second-&gt;adresa&lt;&lt;"\nBroj telefona: "&lt;&lt;x.second-&gt;telefon;
        }
        void IzlistajKnjige() const{
            for(auto &amp;x:Knjige){
                std::cout&lt;&lt;"\nEvidencijski broj: "&lt;&lt;x.first&lt;&lt;"\nNaslov: "&lt;&lt;x.second-&gt;DajNaslov()&lt;&lt;"\nPisac: "&lt;&lt;x.second-&gt;DajAutora()&lt;&lt;"\nZanr: "&lt;&lt;x.second-&gt;DajZanr()&lt;&lt;"\nGodina izdavanja: "&lt;&lt;x.second-&gt;DajGodinuIzdavanja();
                if((x.second-&gt;DaLiJeZaduzena())) std::cout&lt;&lt;"\nZaduzena kod korisnika: "&lt;&lt;x.second-&gt;DajKodKogaJe()-&gt;ime&lt;&lt;" "&lt;&lt;x.second-&gt;DajKodKogaJe()-&gt;prezime;
                std::cout&lt;&lt;"\n";
            }
        }
        void ZaduziKnjigu(int EvidencijskiBrojKnjige, int ClanskiBrojKorisnika){
            auto Korisnik(Korisnici.find(ClanskiBrojKorisnika));
            auto Knjiga(Knjige.find(EvidencijskiBrojKnjige));
            if( Knjiga == Knjige.end()) throw std::logic_error("Knjiga nije nadjena");
<a name="0"></a><font color="#FF0000"><a href="match902-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_7.gif"/></a>

            if( Korisnik== Korisnici.end()) throw std::logic_error("Korisnik nije nadjen");
            if( Knjiga-&gt;second-&gt;DaLiJeZaduzena()) throw std::logic_error("Knjiga vec zaduzena");
            Knjiga-&gt;second-&gt;ZaduziKnjigu(*(Korisnik-&gt;second));
        }
        void RazduziKnjigu(int EvidencijskiBrojKnjige){
            auto Knjiga(Knjige.find(EvidencijskiBrojKnjige));
            if(Knjiga==Knjige.end()) throw std::logic_error("Knjiga nije nadjena");
            if(!(Knjiga-&gt;second-&gt;DaLiJeZaduzena())) throw std::logic_error("Knjiga nije zaduzena");
            Knjiga-&gt;second-&gt;RazduziKnjigu();
        }
        void PrikaziZaduzenja(int ClanskiBrojKorisnika) const{
            auto Korisnik(Korisnici.find(ClanskiBrojKorisnika));
            if(Korisnik==Korisnici.end()) throw std::logic_error("Korisnik nije nadjen");
</font>            bool ZaduzioIsta(false);
            for(auto &amp;x:Knjige){
                if(x.second-&gt;DajKodKogaJe()==Korisnik-&gt;second.get()){
                    if(!ZaduzioIsta) ZaduzioIsta=true;
                    std::cout&lt;&lt;"\nEvidencijski broj: "&lt;&lt;x.first&lt;&lt;"\nNaslov: "&lt;&lt;x.second-&gt;DajNaslov()&lt;&lt;"\nPisac: "&lt;&lt;x.second-&gt;DajAutora()&lt;&lt;"\nZanr: "&lt;&lt;x.second-&gt;DajZanr()&lt;&lt;"\nGodina izdavanja: "&lt;&lt;x.second-&gt;DajGodinuIzdavanja()&lt;&lt;"\n";
                }
            }
            if(!ZaduzioIsta) std::cout&lt;&lt;"Nema zaduzenja za tog korisnika!";
        }
};
int main ()
{
	return 0;
}</pre>
</body>
</html>
