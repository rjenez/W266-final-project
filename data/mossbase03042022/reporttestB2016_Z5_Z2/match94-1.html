<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student6507.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student2939.cpp<p></p><pre>
/B16/17 (ZadaÄ‡a 5, Zadatak 2)
//Autotestovi by Eldar Kurtic (mail: ekurtic3@etf.unsa.ba)
//Za autotestove se obracati *iskljucivo* osobi koja ih pise
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;map&gt;
#include &lt;stdexcept&gt;
#include &lt;memory&gt;

struct Korisnik{
    std::string ime, prezime, adresa, telefon;
};

class Knjiga{
    std::string naslov, ime_pisca, zanr;
    int godina_izdavanja;
    Korisnik* info;
    public:
    Knjiga(std::string naslov, std::string ime_pisca, std::string zanr, int godina_izdavanja): naslov(naslov), ime_pisca(ime_pisca), zanr(zanr), godina_izdavanja(godina_izdavanja), info(nullptr){}
    std::string DajNaslov() const {return naslov;}
    std::string DajAutora() const {return ime_pisca;}
    std::string DajZanr() const {return zanr;}
    int DajGodinuIzdavanja() const {return godina_izdavanja;}
<a name="0"></a><font color="#FF0000"><a href="match94-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_92.gif"/></a>

    Korisnik* DajKodKogaJe() const {return info;}
    void ZaduziKnjigu(Korisnik &amp;lik) {info=&amp;lik;}
    void RazduziKnjigu() {info=nullptr;}
    bool DaLiJeZaduzena() {if(!info) return false; return true;}
};

Korisnik KopirajKorisnika(const Korisnik &amp;k){
    auto pok(std::make_shared&lt;Korisnik&gt;());
    pok-&gt;ime=k.ime;
    pok-&gt;prezime=k.prezime;
    pok-&gt;adresa=k.adresa;
    pok-&gt;telefon=k.telefon;
    return *pok;
}

Knjiga KopirajKnjigu(const Knjiga &amp;k){
    auto pok(std::make_shared&lt;Knjiga&gt;(k.DajNaslov(), k.DajAutora(), k.DajZanr(), k.DajGodinuIzdavanja()));
    return *pok;
}

std::shared_ptr&lt;Korisnik&gt; Kopirajkorisnik(std::shared_ptr&lt;Korisnik&gt; k1){
    auto k(std::make_shared&lt;Korisnik);
    k-&gt;ime=k1-&gt;ime;
    k-&gt;prezime=k1-&gt;prezime;
    k-&gt;adresa=k1-&gt;adresa;
    k-&gt;telefon=k1-&gt;telefon;
}

class Biblioteka{
    std::map&lt;int, std::shared_ptr&lt;Korisnik&gt;&gt; mapa_korisnik;
    std::map&lt;int, std::shared_ptr&lt;Knjiga&gt;&gt; mapa_knjiga;
    bool DaLiJeIstiKorisnik(Korisnik* p1, Knjiga* p2){
        if(p1-&gt;ime==p2-&gt;DajKodKogaJe()-&gt;ime &amp;&amp; p1-&gt;prezime==p2-&gt;DajKodKogaJe()-&gt;prezime &amp;&amp; p1-&gt;adresa==p2-&gt;DajKodKogaJe()-&gt;adresa &amp;&amp; p1-&gt;telefon==p2-&gt;DajKodKogaJe()-&gt;telefon)
            return true;
        return false;
    }
    public:
    Biblioteka(){}
    Biblioteka(Biblioteka &amp;&amp;b){
        std::swap(mapa_korisnik, b.mapa_korisnik);
        std::swap(mapa_knjiga, b.mapa_knjiga);
    /*    for(auto it=b.mapa_knjiga.begin(); it!=b.mapa_knjiga.end(); it++)
        {
            (*it).second-&gt;RazduziKnjigu();
            (*it).second=nullptr;
        }
        for(auto it=b.mapa_korisnik.begin(); it!=b.mapa_korisnik.end(); it++)
            (*it).second=nullptr;*/
    }
    Biblioteka &amp;operator= (const Biblioteka &amp;b){
        for(auto it=mapa_korisnik.begin(); it!=mapa_korisnik.end(); it++)
             (*it).second=nullptr;
        for(auto it=mapa_knjiga.begin(); it!=mapa_knjiga.end(); it++){
             (*it).second=nullptr;
        }
        for(auto it=b.mapa_knjiga.begin(); it!=b.mapa_knjiga.end(); it++){
            auto k=std::make_shared&lt;Knjiga&gt;(KopirajKnjigu(*((*it).second)));
            mapa_knjiga.insert(std::make_pair((*it).first, k));
        }
        for(auto it=b.mapa_korisnik.begin(); it!=mapa_korisnik.end(); it++){
            auto k=std::make_shared&lt;Korisnik&gt; (KopirajKorisnika(*((*it).second)));
            mapa_korisnik.insert(std::make_pair((*it).first, k));
        }
        return *this;
    }
    Biblioteka(const Biblioteka &amp;b){
        for(auto it=b.mapa_korisnik.begin(); it!=b.mapa_korisnik.end(); it++){
            auto k(std::make_shared&lt;Korisnik&gt;(KopirajKorisnika(*(*it).second)));
            mapa_korisnik.insert(std::make_pair((*it).first, k));
        }
        for(auto it=b.mapa_knjiga.begin(); it!=b.mapa_knjiga.end(); it++){
            auto k=std::make_shared&lt;Knjiga&gt;(KopirajKnjigu(*((*it).second)));
            mapa_knjiga.insert(std::make_pair((*it).first, k));
        }
    }
    Biblioteka &amp;operator=(Biblioteka &amp;&amp;b){
        for(auto it=mapa_knjiga.begin(); it!=mapa_knjiga.end(); it++){
             (*it).second=nullptr;
        }
        for(auto it=mapa_korisnik.begin(); it!=mapa_korisnik.end(); it++){
             (*it).second=nullptr;
        }
        std::swap(mapa_knjiga, b.mapa_knjiga);
        std::swap(mapa_korisnik, b.mapa_korisnik);
       /* for(auto it=b.mapa_knjiga.begin(); it!=b.mapa_knjiga.end(); it++){
            (*it).second-&gt;RazduziKnjigu();
            (*it).second=nullptr;
        }
        for(auto it=b.mapa_korisnik.begin(); it!=b.mapa_korisnik.end(); it++)
            (*it).second=nullptr;*/
        return *this;
    }
   /* ~Biblioteka(){
        for(auto it=mapa_knjiga.begin(); it!=mapa_knjiga.end(); it++){
            //delete (*it).second-&gt;DajKodKogaJe();
            delete (*it).second;
        }
        for(auto it=mapa_korisnik.begin(); it!=mapa_korisnik.end(); it++)
            delete (*it).second;
    }*/
    void RegistrirajNovogKorisnika(int clanski_broj, std::string ime, std::string prezime, std::string adresa, std::string telefon){
        if(mapa_korisnik.count(clanski_broj)) throw std::logic_error("Korisnik vec postoji");
        auto k(std::make_shared&lt;Korisnik&gt;());
        k-&gt;ime=ime;
        k-&gt;prezime=prezime;
        k-&gt;adresa=adresa;
        k-&gt;telefon=telefon;
        mapa_korisnik.insert(std::make_pair(clanski_broj, k));
    }
    void RegistrirajNovuKnjigu(int ev_br, std::string naslov, std::string autor, std::string zanr, int godina){
        if(mapa_knjiga.count(ev_br)) throw std::logic_error("Knjiga vec postoji");
        auto k(std::make_shared&lt;Knjiga&gt;(naslov, autor, zanr, godina));
        mapa_knjiga.insert(std::make_pair(ev_br, k));
    }
    Korisnik &amp;NadjiKorisnika(int clanski_broj){
        if(!mapa_korisnik.count(clanski_broj)) throw std::logic_error("Korisnik nije nadjen");
        return *(mapa_korisnik.find(clanski_broj)-&gt;second);
    }
    Knjiga &amp;NadjiKnjigu(int broj){
        if(!mapa_knjiga.count(broj)) throw std::logic_error("Knjiga nije nadjena");
        return *(mapa_knjiga.find(broj)-&gt;second);
    }
    void IzlistajKorisnike() const{
        for(auto it=mapa_korisnik.begin(); it!=mapa_korisnik.end(); it++){
            std::cout&lt;&lt;"Clanski broj: "&lt;&lt;(*it).first&lt;&lt;std::endl;
            std::cout&lt;&lt;"Ime i prezime: "&lt;&lt;(*it).second-&gt;ime&lt;&lt;" "&lt;&lt;(*it).second-&gt;prezime&lt;&lt;std::endl;
            std::cout&lt;&lt;"Adresa: "&lt;&lt;(*it).second-&gt;adresa&lt;&lt;std::endl;
            std::cout&lt;&lt;"Broj telefona: "&lt;&lt;(*it).second-&gt;telefon&lt;&lt;std::endl&lt;&lt;std::endl;
        }
    }
    void IzlistajKnjige() const{
        for(auto it=mapa_knjiga.begin(); it!=mapa_knjiga.end(); it++){
            std::cout&lt;&lt;"Evidencijski broj: "&lt;&lt;(*it).first&lt;&lt;std::endl;
            std::cout&lt;&lt;"Naslov: "&lt;&lt;(*it).second-&gt;DajNaslov()&lt;&lt;std::endl;
            std::cout&lt;&lt;"Pisac: "&lt;&lt;(*it).second-&gt;DajAutora()&lt;&lt;std::endl;
            std::cout&lt;&lt;"Zanr: "&lt;&lt;(*it).second-&gt;DajZanr()&lt;&lt;std::endl;
            std::cout&lt;&lt;"Godina izdavanja: "&lt;&lt;(*it).second-&gt;DajGodinuIzdavanja()&lt;&lt;std::endl;
            if((*it).second-&gt;DaLiJeZaduzena()) {
                std::cout&lt;&lt;"Zaduzena kod korisnika: "&lt;&lt;(*it).second-&gt;DajKodKogaJe()-&gt;ime;
                std::cout&lt;&lt;" "&lt;&lt;(*it).second-&gt;DajKodKogaJe()-&gt;prezime&lt;&lt;std::endl;
            }
            std::cout&lt;&lt;std::endl;
        }
    }
    void ZaduziKnjigu(int br_knjige, int clanski){
        if(!mapa_knjiga.count(br_knjige)) throw std::logic_error("Knjiga nije nadjena");
        if(!mapa_korisnik.count(clanski)) throw std::logic_error("Korisnik nije nadjen");
        if(mapa_knjiga.find(br_knjige)-&gt;second-&gt;DaLiJeZaduzena()) throw std::logic_error("Knjiga vec zaduzena");
        mapa_knjiga.find(br_knjige)-&gt;second-&gt;ZaduziKnjigu(*(mapa_korisnik.find(clanski)-&gt;second));
    }
    void RazduziKnjigu(int br_knjige){
        if(!mapa_knjiga.count(br_knjige)) throw std::logic_error("Knjiga nije nadjena");
        if(!mapa_knjiga.find(br_knjige)-&gt;second-&gt;DaLiJeZaduzena()) throw std::logic_error("Knjiga nije zaduzena");
        mapa_knjiga.find(br_knjige)-&gt;second-&gt;RazduziKnjigu();
    }
    void PrikaziZaduzenja(int clanski_br) const{
        if(!mapa_korisnik.count(clanski_br)) throw std::logic_error("Korisnik nije nadjen");
        bool istina(false);
        for(auto it=mapa_knjiga.begin(); it!=mapa_knjiga.end(); it++){
            if((*it).second-&gt;DajKodKogaJe()==mapa_korisnik.find(clanski_br)-&gt;second.get()){
                istina=true;
                std::cout&lt;&lt;"Evidencijski broj: "&lt;&lt;(*it).first&lt;&lt;std::endl;
                std::cout&lt;&lt;"Naslov: "&lt;&lt;(*it).second-&gt;DajNaslov()&lt;&lt;std::endl;
                std::cout&lt;&lt;"Pisac: "&lt;&lt;(*it).second-&gt;DajAutora()&lt;&lt;std::endl;
                std::cout&lt;&lt;"Zanr: "&lt;&lt;(*it).second-&gt;DajZanr()&lt;&lt;std::endl;
                std::cout&lt;&lt;"Godina izdavanja: "&lt;&lt;(*it).second-&gt;DajGodinuIzdavanja()&lt;&lt;std::endl;
            
                std::cout&lt;&lt;std::endl;
            }
        }
        if(!istina) throw std::logic_error("Nema zaduzenja za tog korisnika!");
</font>    }
};/*
int main ()
{
    std::cout&lt;&lt;"Dobro dosli u biblioteku!\n";
    for(;;){
        std::cout&lt;&lt;"Za registraciju korisnika, birajte 1 ~\nZa registraciju knjige, birajte 2 ~\n";
        std::cout&lt;&lt;"Za pronalazak korisnika, birajte 3 ~\nZa pronalazak knjige, birajte 4 ~"&lt;&lt;std::endl;
        std::cout&lt;&lt;"Za prikaz svih korisnika, birajte 5 ~\nZa prikaz svih knjiga, birajte 6 ~"&lt;&lt;std::endl;
        std::cout&lt;&lt;"Za zaduzivanje knjige, birajte 7 ~\nZa razduzivanje knjige, birajte 8 ~"&lt;&lt;std::endl;
        std::cout&lt;&lt;"Za prikaz razduzivanja, birajte 9 ~\nZa kraj, birajte 0 ~"&lt;&lt;std::endl;
        int n;
        std::cin&gt;&gt;n;
        Biblioteka b;
        
            if(n==0)  return 0;
            else if(n==1){ std::cout&lt;&lt;"Unesite clanski broj, ime, prezime, adresu i telefon korisnika, sve u posebnom redu.\n";
                std::string ime, prezime, adresa, telefon;
                int clanski;
                std::cin&gt;&gt;clanski;
                std::cin.ignore(1000,'\n');
                std::getline(std::cin, ime);
                std::getline(std::cin, prezime);
                std::getline(std::cin, adresa);
                std::getline(std::cin, telefon);
                b.RegistrirajNovogKorisnika(clanski, ime, prezime, adresa, telefon);
            }
            else if(n==2){ std::cout&lt;&lt;"Unesite broj knjige, naslov, autora, zanr i godinu izdavanja, sve u zasebnom redu.\n";
                    std::string naslov, autor, zanr;
                    int br_knj, god;
                    std::cin&gt;&gt;br_knj;
                    std::cin.ignore(1000, '\n');
                    std::getline(std::cin, naslov);
                    std::getline(std::cin, autor);
                    std::getline(std::cin, zanr);
                    std::cin&gt;&gt;god;
                    b.RegistrirajNovuKnjigu(br_knj, naslov, autor, zanr, god);
            }
            else if(n==3){
                    std::cout&lt;&lt;"Unesite clanski broj korisnika kojeg zelite naci.\n";
                    int broj;
                    std::cin&gt;&gt;broj;
                    try{
                    Korisnik lik(b.NadjiKorisnika(broj));
                    std::cout&lt;&lt;"Trazili ste korisnika: "&lt;&lt;lik.ime&lt;&lt;" "&lt;&lt;lik.prezime&lt;&lt;", adresa: "&lt;&lt;lik.adresa&lt;&lt;", broj telefona: "&lt;&lt;lik.telefon&lt;&lt;std::endl;}
                    catch(std::logic_error i){
                        std::cout&lt;&lt;i.what()&lt;&lt;std::endl;
                    }
            }
            else if(n==4){ 
                    std::cout&lt;&lt;"Unesite broj knjige koju trazite.\n";
                    int broj1;
                    std::cin&gt;&gt;broj1;
                    try{
                        b.NadjiKnjigu(broj1);
                        std::cout&lt;&lt;"Trazili ste knjigu: "&lt;&lt;b.NadjiKnjigu(broj1).DajNaslov()&lt;&lt;", autora "&lt;&lt;b.NadjiKnjigu(broj1).DajAutora()&lt;&lt;", zanra: "&lt;&lt;b.NadjiKnjigu(broj1).DajZanr()&lt;&lt;", izdatu "&lt;&lt;b.NadjiKnjigu(broj1).DajGodinuIzdavanja()&lt;&lt;std::endl;
                    }catch(std::logic_error i){std::cout&lt;&lt;i.what()&lt;&lt;std::endl;}
            }
            else if(n==5)
                    b.IzlistajKorisnike();

            else if(n==6)
                    b.IzlistajKnjige();
                    
            else if(n==7){
                    std::cout&lt;&lt;"Unesite clanski broj korisnika, i broj knjige koju zaduzuje: ";
                    int br1, br2;
                    std::cin&gt;&gt;br1&gt;&gt;br2;
                    b.ZaduziKnjigu(br1, br2);
            }
            else if(n==8){ std::cout&lt;&lt;"Unesite broj knjige koju zelite razduziti: ";
                    int broj2;
                    std::cin&gt;&gt;broj2;
                    b.RazduziKnjigu(broj2);
            }
            else if(n==9){ std::cout&lt;&lt;"Unesite clanski broj korisnika cije zaduzenje zelite prikazati: ";
                int broj3;
                std::cin&gt;&gt;broj3;
                b.PrikaziZaduzenja(broj3);
            }
            else std::cout&lt;&lt;"Pogresan unos opcije, birajte ponovo."&lt;&lt;std::endl;
        std::cout&lt;&lt;std::endl;
        
    }
	return 0;
}*/</pre>
</body>
</html>
