<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student7810.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student7810.cpp<p></p><pre>
<a name="0"></a><font color="#FF0000"><a href="match69-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_99.gif"/></a>

/B16/17 (ZadaÄ‡a 5, Zadatak 2)
//Autotestovi by Eldar Kurtic (mail: ekurtic3@etf.unsa.ba)
//Za autotestove se obracati *iskljucivo* osobi koja ih pise
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;map&gt;
#include &lt;stdexcept&gt;
#include &lt;memory&gt;
using std::string;
using std::cin;
using std::cout;
using std::endl;
using std::map;
using std::make_shared;
using std::shared_ptr;

struct Korisnik{
    string ime,prezime,adresa,telefon;  
};
class Knjiga{
    string naslov,ime_pisca,zanr;
    int godina_izdavanja;
    Korisnik* zaduzenje;
    public:
    Knjiga(string nas, string pisac, string zanrknjige, int godina) : naslov(nas), ime_pisca(pisac), zanr(zanrknjige), godina_izdavanja(godina), zaduzenje(nullptr) {}
    string DajNaslov ()const{return naslov;}
    string DajAutora ()const{return ime_pisca;}
    string DajZanr ()const{return zanr;}
    int DajGodinuIzdavanja() const{return godina_izdavanja;}
    Korisnik* DajKodKogaJe()const{return zaduzenje;}
    void ZaduziKnjigu(Korisnik &amp;korisnik) {zaduzenje=&amp;korisnik;}
    void RazduziKnjigu (){zaduzenje=nullptr;}
    bool DaLiJeZaduzena (){if (!zaduzenje) return false; else return true;}
};
class Biblioteka{
    map&lt;int, shared_ptr&lt;Korisnik&gt;&gt; korisnici;
    map&lt;int, shared_ptr&lt;Knjiga&gt;&gt; knjige;
    public:
    Biblioteka(){};
    Biblioteka (const Biblioteka&amp; bibloiteka){
        for(auto it : bibloiteka.knjige){
            this-&gt;RegistrirajNovuKnjigu(it.first,(it.second)-&gt;DajNaslov(),(it.second)-&gt;DajAutora(),(it.second)-&gt;DajZanr(),(it.second)-&gt;DajGodinuIzdavanja());
        }
        for(auto it : bibloiteka.korisnici){
            this-&gt;RegistrirajNovogKorisnika(it.first,(it.second)-&gt;ime,(it.second)-&gt;prezime,(it.second)-&gt;adresa,(it.second)-&gt;telefon);
        }
        for(auto it : bibloiteka.korisnici){
            for(auto it1 : bibloiteka.knjige){
                auto novikorisnik((it1.second)-&gt;DajKodKogaJe());
                if (novikorisnik==(it.second).get()){
                    this-&gt;ZaduziKnjigu(it1.first,it.first);
                }
            }
        }
    }
    Biblioteka(Biblioteka&amp;&amp; bibloiteka){
        korisnici=bibloiteka.korisnici;
        knjige=bibloiteka.knjige;
        for(auto it(korisnici.begin());it!=korisnici.end();it++) it-&gt;second=nullptr;
        for(auto it(knjige.begin());it!=knjige.end();it++) it-&gt;second=nullptr;

    }
    Biblioteka&amp; operator =(const Biblioteka&amp; bibloiteka){
        if(&amp;bibloiteka!=this){
            for(auto it : bibloiteka.knjige) it.second=nullptr;
            for(auto it : bibloiteka.korisnici) it.second=nullptr;
            korisnici.erase(korisnici.begin(), korisnici.end());
            knjige.erase(knjige.begin(), knjige.end());
            for(auto it : bibloiteka.knjige){
                this-&gt;RegistrirajNovuKnjigu(it.first,(it.second)-&gt;DajNaslov(),(it.second)-&gt;DajAutora(),(it.second)-&gt;DajZanr(),(it.second)-&gt;DajGodinuIzdavanja());
            }
            for(auto it : bibloiteka.korisnici){
                this-&gt;RegistrirajNovogKorisnika(it.first,(it.second)-&gt;ime,(it.second)-&gt;prezime,(it.second)-&gt;adresa,(it.second)-&gt;telefon);
            }
        }
        for(auto it : bibloiteka.korisnici){
            for(auto it1 : bibloiteka.knjige){
                auto novikorisnik((it1.second)-&gt;DajKodKogaJe());
                if (novikorisnik==(it.second).get()){
                    this-&gt;ZaduziKnjigu(it1.first,it.first);
                }
            }
        }
        return *this;
    }
    Biblioteka&amp; operator =(Biblioteka&amp;&amp; bibloiteka){
        if(&amp;bibloiteka!=this){
            for(auto it : bibloiteka.knjige)  it.second=nullptr;
            for(auto it : bibloiteka.korisnici) it.second=nullptr;
            korisnici.erase(korisnici.begin(), korisnici.end());
            knjige.erase(knjige.begin(), knjige.end());
            for(auto it : bibloiteka.knjige){
                this-&gt;RegistrirajNovuKnjigu(it.first,(it.second)-&gt;DajNaslov(),(it.second)-&gt;DajAutora(),(it.second)-&gt;DajZanr(),(it.second)-&gt;DajGodinuIzdavanja());
            }
            for(auto it : bibloiteka.korisnici){
                this-&gt;RegistrirajNovogKorisnika(it.first,(it.second)-&gt;ime,(it.second)-&gt;prezime,(it.second)-&gt;adresa,(it.second)-&gt;telefon);
            }
        }
        korisnici=bibloiteka.korisnici;
        knjige=bibloiteka.knjige;
        for(auto it(korisnici.begin());it!=korisnici.end();it++) it-&gt;second=nullptr;
        for(auto it(knjige.begin());it!=knjige.end();it++) it-&gt;second=nullptr;
        return *this;
    }
    /*~Biblioteka(){ for(auto it(korisnici.begin());it!=korisnici.end();it++) delete it-&gt;second;
        for(auto it(knjige.begin());it!=knjige.end();it++) delete it-&gt;second;
    }*/
    void RegistrirajNovogKorisnika(int clanski, string i, string p, string adr, string broj){
        for(auto it(korisnici.begin());it!=korisnici.end();it++){
            if(it-&gt;first==clanski) throw std::logic_error ("Korisnik vec postoji");
        }
        auto pok(make_shared&lt; Korisnik&gt;()); pok-&gt;ime=i;pok-&gt;prezime=p;pok-&gt;adresa=adr;pok-&gt;telefon=broj;
        korisnici.insert(std::make_pair(clanski, pok));
    }
    void RegistrirajNovuKnjigu(int evbr, string nas, string pisac, string zanrknjige, int godina){
        for(auto it(knjige.begin());it!=knjige.end();it++){
            if(it-&gt;first==evbr) throw std::logic_error ("Knjiga vec postoji");
        }
        knjige.insert(std::make_pair(evbr,make_shared &lt;Knjiga&gt;(nas,pisac,zanrknjige,godina)));
    }
    Korisnik&amp; NadjiKorisnika(int clanski){
        for(auto it(korisnici.begin());it!=korisnici.end();it++){
            if(it-&gt;first==clanski) return *(it-&gt;second);
        }
        throw std::logic_error ("Korisnik nije nadjen");
    }
    Knjiga&amp; NadjiKnjigu(int evbr){
        for(auto it(knjige.begin());it!=knjige.end();it++){
            if(it-&gt;first==evbr) return *(it-&gt;second);
        }
        throw std::logic_error ("Knjiga nije nadjena");
    }
    void IzlistajKorisnike(){
        for(auto it(korisnici.begin());it!=korisnici.end();it++){
            cout&lt;&lt;"Clanski broj: "&lt;&lt;it-&gt;first&lt;&lt;endl&lt;&lt;"Ime i prezime: "&lt;&lt;(it-&gt;second)-&gt;ime&lt;&lt;" "&lt;&lt;(it-&gt;second)-&gt;prezime&lt;&lt;endl&lt;&lt;"Adresa: "&lt;&lt;(it-&gt;second)-&gt;adresa&lt;&lt;endl&lt;&lt;"Broj telefona: "&lt;&lt;(it-&gt;second)-&gt;telefon&lt;&lt;endl;
        }
    }
    void IzlistajKnjige(){
        for(auto it(knjige.begin());it!=knjige.end();it++){
            cout&lt;&lt;"Evidencijski broj: "&lt;&lt;it-&gt;first&lt;&lt;endl&lt;&lt;"Naslov: "&lt;&lt;(it-&gt;second)-&gt;DajNaslov()&lt;&lt;endl&lt;&lt;"Pisac: "&lt;&lt;(it-&gt;second)-&gt;DajAutora()&lt;&lt;endl&lt;&lt;"Zanr: "&lt;&lt;(it-&gt;second)-&gt;DajZanr()&lt;&lt;endl&lt;&lt;"Godina izdavanja: "&lt;&lt;(it-&gt;second)-&gt;DajGodinuIzdavanja()&lt;&lt;endl;
            if((it-&gt;second)-&gt;DaLiJeZaduzena()){
                cout&lt;&lt;"Zaduzena kod korisnika: "&lt;&lt;(((it-&gt;second)-&gt;DajKodKogaJe())-&gt;ime)&lt;&lt;" "&lt;&lt;(((it-&gt;second)-&gt;DajKodKogaJe())-&gt;prezime)&lt;&lt;endl;
            }
        }
    }
    void ZaduziKnjigu(int evbr, int clanski){
        bool ima(false);
        auto pokkor(korisnici.begin());
        for(auto it(korisnici.begin());it!=korisnici.end();it++){
            if(it-&gt;first==clanski) {ima=true;pokkor=it;break;}
        }
        if(!ima) throw std::logic_error ("Korisnik nije nadjen");
        ima=false;
        auto pokknjig(knjige.begin());
        for(auto it(knjige.begin());it!=knjige.end();it++){
            if(it-&gt;first==evbr) {ima=true;pokknjig=it;break;}
        }
        if(!ima) throw std::logic_error ("Knjiga nije nadjena");
        else if(ima){
            if((pokknjig-&gt;second)-&gt;DaLiJeZaduzena()) throw std::logic_error ("Knjiga vec zaduzena");
            else{
                (pokknjig-&gt;second)-&gt;ZaduziKnjigu(*(pokkor-&gt;second));
            }
        }
        
    }
    void RazduziKnjigu(int evbr){
        bool ima(false);
        auto pokknjig(knjige.begin());
        for(auto it(knjige.begin());it!=knjige.end();it++){
            if(it-&gt;first==evbr) {ima=true;pokknjig=it;break;}
        }
        if(!ima) throw std::logic_error ("Knjiga nije nadjena");
        else if(!(pokknjig-&gt;second)-&gt;DaLiJeZaduzena()) throw std::logic_error ("Knjiga nije zaduzena");
        else{
            (pokknjig-&gt;second)-&gt;RazduziKnjigu();
        }
    }
    void PrikaziZaduzenja(int clanski){
        bool ima(false);
        auto pokkor(korisnici.begin());
        for(auto it(korisnici.begin());it!=korisnici.end();it++){
            if(it-&gt;first==clanski) {ima=true;pokkor=it;break;}
        }
        if(!ima) throw std::logic_error ("Korisnik nije nadjen");
        else{
            for(auto it(knjige.begin());it!=knjige.end();it++){
            if(((it-&gt;second)-&gt;DajKodKogaJe())==(pokkor-&gt;second).get())
            {cout&lt;&lt;"Evidencijski broj: "&lt;&lt;it-&gt;first&lt;&lt;endl&lt;&lt;"Naslov: "&lt;&lt;(it-&gt;second)-&gt;DajNaslov()&lt;&lt;endl&lt;&lt;"Pisac: "&lt;&lt;(it-&gt;second)-&gt;DajAutora()&lt;&lt;endl&lt;&lt;"Zanr: "&lt;&lt;(it-&gt;second)-&gt;DajZanr()&lt;&lt;endl&lt;&lt;"Godina izdavanja: "&lt;&lt;(it-&gt;second)-&gt;DajGodinuIzdavanja()&lt;&lt;endl;}
        }
        }
    }
};
int main ()
{
    Biblioteka bib5;
    bib5.RegistrirajNovogKorisnika(1, "Niko", "Nikic", "Zmaja od Bosne bb", "123 456");
    bib5.RegistrirajNovuKnjigu(2, "Vlak u snijegu", "Mato Lovrak", "Roman", 1931);
    std::cout &lt;&lt; bib5.NadjiKnjigu(2).DajNaslov();
	return 0;
</font>}</pre>
</body>
</html>
