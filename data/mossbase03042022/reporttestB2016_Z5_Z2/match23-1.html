<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student4273.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z5/Z2/student1364.cpp<p></p><pre>
<a name="3"></a><font color="#00FFFF"><a href="match23-0.html#3" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_2.gif"/></a>

/B16/17 (ZadaÄ‡a 5, Zadatak 2)
//Autotestovi by Eldar Kurtic (mail: ekurtic3@etf.unsa.ba)
//Za autotestove se obracati *iskljucivo* osobi koja ih pise
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;stdexcept&gt;
#include &lt;map&gt;
#include &lt;utility&gt;
#include &lt;memory&gt;

using std::cin; using std::cout; using std::endl;

struct Korisnik {
    std::string ime, prezime, adresa, telefon;
};

class Knjiga {
    std::string naslov, ime_pisca, zanr;
</font>    int godina_izdavanja;
    Korisnik *info_o_zaduzenju; //Pok na korisnika koji je zaduzio knjigu
    public:
    Knjiga(std::string naslov, std::string ime_pisca, std::string zanr, int godina_izdavanja) : naslov(naslov), ime_pisca(ime_pisca), zanr(zanr), godina_izdavanja(godina_izdavanja), info_o_zaduzenju(nullptr) {}
    std::string DajNaslov() const { return naslov; }
    std::string DajAutora() const { return ime_pisca; }
<a name="0"></a><font color="#FF0000"><a href="match23-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_49.gif"/></a>

    std::string DajZanr() const { return zanr; }
    int DajGodinuIzdavanja() const { return godina_izdavanja; }
    Korisnik* DajKodKogaJe() const { return info_o_zaduzenju; }
    void ZaduziKnjigu(Korisnik &amp;ref_na_korisnika);
    void RazduziKnjigu() { info_o_zaduzenju=nullptr; } //Da li ce trebati dealokacija
    bool DaLiJeZaduzena() { 
        if (!info_o_zaduzenju) return false; //Ako je nullptr
        return true;
    }
};

void Knjiga::ZaduziKnjigu(Korisnik &amp;ref_na_korisnika) {
    info_o_zaduzenju=&amp;ref_na_korisnika; //?
}


class Biblioteka {
    std::map&lt;int, std::shared_ptr&lt;Korisnik&gt;&gt; mapa_korisnika;
    std::map&lt;int, std::shared_ptr&lt;Knjiga&gt;&gt; mapa_knjiga;
    public:
    Biblioteka () : mapa_korisnika(), mapa_knjiga() {}
    Biblioteka (const Biblioteka &amp;b); //Kopirajuci konstruktor
    Biblioteka (Biblioteka &amp;&amp;b); //Pomjerajuci konstruktor
    Biblioteka &amp;operator=(Biblioteka b);
    Biblioteka &amp;operator=(Biblioteka &amp;&amp;b);
    
    //Kopirajuci konstruktor i konstruktor dodjele -duboke kopije
    ~Biblioteka();
    void RegistrirajNovogKorisnika(int cl_broj, std::string ime, std::string prezime, std::string adresa, std::string telefon);
    void RegistrirajNovuKnjigu(int ev_br, std::string naslov, std::string ime_pisca, std::string zanr, int godina_izdavanja);
    Korisnik &amp;NadjiKorisnika(int cl_broj) const; //inspektor?
    Knjiga &amp;NadjiKnjigu(int ev_broj) const;
    void IzlistajKorisnike() const;
    void IzlistajKnjige() const;
    void ZaduziKnjigu(int ev_broj, int cl_broj);
    void RazduziKnjigu(int ev_broj);
    void PrikaziZaduzenja(int cl_broj) const;
};

//Konstruktori

Biblioteka::~Biblioteka() {
    auto it(mapa_korisnika.begin());
    for (; it!=mapa_korisnika.end(); it++) {
        it-&gt;second=nullptr;
    }
    mapa_korisnika.clear();
    auto it2(mapa_knjiga.begin());
    for ( ; it2!=mapa_knjiga.end(); it2++) {
        auto p(it2-&gt;second-&gt;DajKodKogaJe());
        p=nullptr;
        it2-&gt;second=nullptr;
    }
    mapa_knjiga.clear();
}

Biblioteka::Biblioteka (const Biblioteka &amp;b) {
    //Kopirajmo prvu mapu
    auto it(b.mapa_korisnika.begin());
    for (; it!=b.mapa_korisnika.end(); it++) {
        Korisnik k;
        k.ime=(it-&gt;second)-&gt;ime;
        k.prezime=(it-&gt;second)-&gt;prezime;
        k.adresa=(it-&gt;second)-&gt;adresa;
        k.telefon=(it-&gt;second)-&gt;telefon;
        std::shared_ptr&lt;Korisnik&gt; kopija(std::make_shared&lt;Korisnik&gt;(k));
        mapa_korisnika.insert(std::make_pair(it-&gt;first, kopija));
    }
    //Kopirajmo drugu mapu
    auto it2(b.mapa_knjiga.begin());
    for ( ; it2!=b.mapa_knjiga.end(); it2++) {
        std::shared_ptr&lt;Knjiga&gt; kopija(std::make_shared&lt;Knjiga&gt;(it2-&gt;second-&gt;DajNaslov(), it2-&gt;second-&gt;DajAutora(), it2-&gt;second-&gt;DajZanr(), it2-&gt;second-&gt;DajGodinuIzdavanja()));
        mapa_knjiga.insert(std::make_pair(it2-&gt;first, kopija));
    }
}

Biblioteka::Biblioteka (Biblioteka &amp;&amp;b) {
    auto it(b.mapa_korisnika.begin());
    for (; it!=b.mapa_korisnika.end(); it++) { 
        mapa_korisnika.insert(std::make_pair(it-&gt;first, it-&gt;second));
        it-&gt;second=nullptr;
    }
    auto it2(b.mapa_knjiga.begin());
    for ( ; it2!=b.mapa_knjiga.end(); it2++) { 
        mapa_knjiga.insert(std::make_pair(it2-&gt;first, it2-&gt;second));
        it-&gt;second=nullptr;
    }
}

Biblioteka &amp;Biblioteka::operator=(Biblioteka b) {
    mapa_korisnika.swap(b.mapa_korisnika); mapa_knjiga.swap(b.mapa_knjiga);
    return *this;
}
Biblioteka &amp;Biblioteka::operator=(Biblioteka &amp;&amp;b) {
    mapa_korisnika.swap(b.mapa_korisnika); mapa_knjiga.swap(b.mapa_knjiga);
    return *this;
}

void Biblioteka::RegistrirajNovogKorisnika(int cl_broj, std::string ime, std::string prezime, std::string adresa, std::string telefon) {
    Korisnik novi;
    novi.ime=ime; novi.prezime=prezime; novi.adresa=adresa; novi.telefon=telefon;
    auto pok_na_novog(std::make_shared&lt;Korisnik&gt;(novi));
    //Provjerimo da li ima vec korisnik sa ovim cl_br
    auto it(mapa_korisnika.begin());
    for (; it!=mapa_korisnika.end(); it++) {
        if (it-&gt;first==cl_broj) break;
    }
    if (it!=mapa_korisnika.end()) throw std::logic_error("Korisnik vec postoji");
    mapa_korisnika.insert(std::make_pair(cl_broj, pok_na_novog));
}
  
void Biblioteka::RegistrirajNovuKnjigu(int ev_br, std::string naslov, std::string ime_pisca, std::string zanr, int godina_izdavanja) {
    auto pok_na_novu(std::make_shared&lt;Knjiga&gt;(naslov, ime_pisca, zanr, godina_izdavanja));
    //Provjerimo da li postoji vec knjiga sa ovim ev_br
    auto it(mapa_knjiga.begin());
    for ( ; it!=mapa_knjiga.end(); it++) {
        if (it-&gt;first==ev_br) break;
    }
    if (it!=mapa_knjiga.end()) throw std::logic_error("Knjiga vec postoji");
    mapa_knjiga.insert(std::make_pair(ev_br, pok_na_novu));
}


Korisnik &amp;Biblioteka::NadjiKorisnika(int cl_broj) const {
    auto it(mapa_korisnika.begin());
    for (; it!=mapa_korisnika.end(); it++) {
        if (it-&gt;first==cl_broj) break;
    }
    if (it==mapa_korisnika.end()) throw std::logic_error("Korisnik nije nadjen");
    return *(it-&gt;second); //??
}


Knjiga &amp;Biblioteka::NadjiKnjigu(int ev_broj) const {
    auto it(mapa_knjiga.begin());
    for (; it!=mapa_knjiga.end(); it++) {
        if (it-&gt;first==ev_broj) break;
    }
    if (it==mapa_knjiga.end()) throw std::logic_error("Knjiga nije nadjena");
    return *(it-&gt;second); //?
}

void Biblioteka::IzlistajKorisnike() const {
    auto it(mapa_korisnika.begin());
    for (; it!=mapa_korisnika.end(); it++) {
        cout &lt;&lt; "Clanski broj: " &lt;&lt; it-&gt;first &lt;&lt; endl;
        cout &lt;&lt; "Ime i prezime: " &lt;&lt; it-&gt;second-&gt;ime &lt;&lt; " " &lt;&lt; it-&gt;second-&gt;prezime &lt;&lt; endl;
        cout &lt;&lt; "Adresa: " &lt;&lt; it-&gt;second-&gt;adresa &lt;&lt; endl;
        cout &lt;&lt; "Broj telefona: " &lt;&lt; it-&gt;second-&gt;telefon &lt;&lt; endl &lt;&lt; endl;
    }
}

void Biblioteka::IzlistajKnjige() const {
    auto it(mapa_knjiga.begin());
    for (; it!=mapa_knjiga.end(); it++) {
        cout &lt;&lt; "Evidencijski broj: " &lt;&lt; it-&gt;first &lt;&lt; endl;
        cout &lt;&lt; "Naslov: " &lt;&lt; it-&gt;second-&gt;DajNaslov() &lt;&lt; endl;
</font>        cout &lt;&lt; "Pisac: " &lt;&lt; it-&gt;second-&gt;DajAutora() &lt;&lt; endl;
<a name="2"></a><font color="#0000FF"><a href="match23-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_16.gif"/></a>

        cout &lt;&lt; "Zanr: " &lt;&lt; it-&gt;second-&gt;DajZanr() &lt;&lt; endl;
        cout &lt;&lt; "Godina izdavanja: " &lt;&lt; it-&gt;second-&gt;DajGodinuIzdavanja() &lt;&lt; endl;
        if (!(it-&gt;second-&gt;DaLiJeZaduzena())) { cout &lt;&lt; endl; continue; }
        cout &lt;&lt; "Zaduzena kod korisnika: " &lt;&lt; it-&gt;second-&gt;DajKodKogaJe()-&gt;ime &lt;&lt; " " &lt;&lt; it-&gt;second-&gt;DajKodKogaJe()-&gt;prezime &lt;&lt; endl;
        cout &lt;&lt; endl;
    }
}

void Biblioteka::ZaduziKnjigu(int ev_broj, int cl_broj) {
    auto it(mapa_knjiga.begin());
    for (; it!=mapa_knjiga.end(); it++) {
        if (it-&gt;first==ev_broj) {
            if (it-&gt;second-&gt;DaLiJeZaduzena()) throw std::logic_error("Knjiga vec zaduzena");
            auto it2(mapa_korisnika.begin());
            for (; it2!=mapa_korisnika.end(); it2++) {
                if (it2-&gt;first==cl_broj) {
                    //it na knjigu it2 na kokrisnika
                    it-&gt;second-&gt;ZaduziKnjigu(*(it2-&gt;second));
                    break;
                }
            }
            if (it2==mapa_korisnika.end()) throw std::logic_error("Korisnik nije nadjen");
            break;
        }
    }
    if (it==mapa_knjiga.end()) throw std::logic_error("Knjiga nije nadjena");
    
}

void Biblioteka::RazduziKnjigu(int ev_broj) {
    auto it(mapa_knjiga.begin());
    for (; it!=mapa_knjiga.end(); it++) {
        if (it-&gt;first==ev_broj) {
            if (it-&gt;second-&gt;DaLiJeZaduzena()==false) throw std::logic_error ("Knjiga nije zaduzena");
            it-&gt;second-&gt;RazduziKnjigu();
            break;
        }
    }
    if (it==mapa_knjiga.end()) throw std::logic_error("Knjiga nije nadjena");
}
void Biblioteka::PrikaziZaduzenja(int cl_broj) const {
    auto it2(mapa_korisnika.begin());
    for (; it2!=mapa_korisnika.end(); it2++) {
        if (it2-&gt;first==cl_broj) {
            auto it(mapa_knjiga.begin());
            for (; it!=mapa_knjiga.end(); it++) { 
                if (it-&gt;second-&gt;DajKodKogaJe()-&gt;ime==it2-&gt;second-&gt;ime)
                cout &lt;&lt; "Evidencijski broj: " &lt;&lt; it-&gt;first &lt;&lt; endl;
                cout &lt;&lt; "Naslov: " &lt;&lt; it-&gt;second-&gt;DajNaslov() &lt;&lt; endl;
</font>                cout &lt;&lt; "Pisac: " &lt;&lt; it-&gt;second-&gt;DajAutora() &lt;&lt; endl;
<a name="1"></a><font color="#00FF00"><a href="match23-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_25.gif"/></a>

                cout &lt;&lt; "Zanr: " &lt;&lt; it-&gt;second-&gt;DajZanr() &lt;&lt; endl;
                cout &lt;&lt; "Godina izdavanja: " &lt;&lt; it-&gt;second-&gt;DajGodinuIzdavanja() &lt;&lt; endl;  
            }
            if (it==mapa_knjiga.end()) cout &lt;&lt; "Nema zaduzenja za tog korisnika!" &lt;&lt; endl;
        }
    }
    if (it2==mapa_korisnika.end()) throw std::logic_error ("Korisnik nije nadjen");
}

int main () {
    Biblioteka b;
    int opcija(0);
    while(true) {
        cout &lt;&lt; "Odaberite opciju: " &lt;&lt; endl;
        cout &lt;&lt; " 0 - kraj" &lt;&lt; endl &lt;&lt; " 1 - Registriraj novog korisnika" &lt;&lt; endl &lt;&lt; " 2 - Registriraj novu knjigu" &lt;&lt; endl 
        &lt;&lt;" 3 - Izlistaj korisnike" &lt;&lt; endl &lt;&lt; " 4 - Izlistaj knjige" &lt;&lt; endl &lt;&lt; " 5 - Zaduzi knjigu" &lt;&lt; endl 
        &lt;&lt; " 6 - Razduzi knjigu" &lt;&lt; endl &lt;&lt; " 7 - PrikaziZaduzenja" &lt;&lt; endl; 
        cin &gt;&gt; opcija;
        if (opcija==0) return 0;
        if (opcija==1) {
            try {
                int cl_br(0);
                cout &lt;&lt; "Unesite podatke o novom korisniku.\nClanski broj: ";
                cin &gt;&gt; cl_br;
                std::string ime, prezime, adresa, telefon;
                cout &lt;&lt; "Ime: ";
                cin.ignore(1000, '\n');
                std::getline(cin, ime);
                cout &lt;&lt; "Prezime: ";
                std::getline(cin, prezime);
                cout &lt;&lt; "Adresa: ";
                std::getline(cin, adresa);
                cout &lt;&lt; "Telefon: ";
                std::getline(cin, telefon);
                //b.RegistrirajNovogKorisnika(cl_br, ime, prezime, adresa, telefon);
            }
            catch (std::logic_error i) {
                cout &lt;&lt; i.what() &lt;&lt; endl;
                continue;
            }
        }
        if (opcija==2) {
            try {
                int ev_br(0), godina(0);
                cout &lt;&lt; "Unesite podatke o novoj knjizi.\nEvidencijski broj: ";
                cin &gt;&gt; ev_br;
                std::string naslov, ime_pisca, zanr;
                cout &lt;&lt; "Naslov: ";
                cin.ignore(1000, '\n');
                std::getline(cin, naslov);
                cout &lt;&lt; "Ime pisca: ";
                std::getline(cin, ime_pisca);
                cout &lt;&lt; "Zanr: ";
                std::getline(cin, zanr);
                cout &lt;&lt; "Godina: ";
                cin &gt;&gt; godina;
                b.RegistrirajNovuKnjigu(ev_br, naslov, ime_pisca, zanr, godina);
            }
            catch (std::logic_error i) {
                cout &lt;&lt; i.what() &lt;&lt; endl;
            }
        }
        if (opcija==3) {
            cout &lt;&lt; "Korisnici biblioteke: " &lt;&lt; endl;
            b.IzlistajKorisnike();
        }
        if (opcija==4) {
            cout &lt;&lt; "Knjige u biblioteci: " &lt;&lt; endl;
            b.IzlistajKnjige();
        }
        if (opcija==5) {
            try {
                cout &lt;&lt; "Unesite evidencijski broj knjige i clanski broj korisnika: " &lt;&lt; endl;
                int broj(0), cl_broj(0);
                cin &gt;&gt; broj &gt;&gt; cl_broj;
                b.ZaduziKnjigu(broj, cl_broj);
            }
            catch (std::logic_error i) {
                cout &lt;&lt; i.what() &lt;&lt; endl;
            }
        }
        if (opcija==6) {
            try {
                int broj(0);
                cout &lt;&lt; "Unesite evidencijski broj knjige koju zelite razduziti: ";
                cin &gt;&gt; broj;
                b.RazduziKnjigu(broj);
            }
            catch (std::logic_error i) {
                cout &lt;&lt; i.what() &lt;&lt; endl;
            }
        }
        if (opcija==7) {
            try {
                int broj(0);
            cout &lt;&lt; "Unesite clanski broj korisnika: ";
            cin &gt;&gt; broj;
            cout &lt;&lt; "Zaduzenja: " &lt;&lt; endl;
            b.PrikaziZaduzenja(broj);
            }
            catch (std::logic_error i) {
                cout &lt;&lt; i.what() &lt;&lt; endl;
            } 
        }
    }
	return 0;
</font>}</pre>
</body>
</html>
