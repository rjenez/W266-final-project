<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z4/Z2/student3047.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z4/Z2/student3047.cpp<p></p><pre>
<a name="0"></a><font color="#FF0000"><a href="match27-1.html#0" target="1"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_99.gif"/></a>

/B 2016/2017, ZadaÄ‡a 4, Zadatak 2
//Napomena: testovi ce biti dostupni dan pred rok!


#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;cmath&gt;
#include &lt;stdexcept&gt;


int u_cifru(char znak)
{
    return znak - '0';
}

class GradjaninBiH
{
public:
    enum Pol{Musko, Zensko};
private:
    GradjaninBiH* prethodni = nullptr;
    static GradjaninBiH* zadnji;
    std::string _ime;
    std::string _jmbg;
    Pol _pol;
    
    bool provjera_jmbg(long long int jmbg);
    bool da_li_vec_postoji();
    
    void dodaj_u_listu(long long int);
    
    void kreiraj_jmbg(int d, int m, int g, int sr, Pol p);
    void kod_gradjana();
    void popravi_kod();
    
public:
    
    GradjaninBiH(const GradjaninBiH&amp;) = delete;
    GradjaninBiH(GradjaninBiH&amp;&amp;) = delete;

    GradjaninBiH&amp; operator= (const GradjaninBiH&amp;) = delete;
    GradjaninBiH&amp; operator= (GradjaninBiH&amp;&amp;) = delete;

    GradjaninBiH(const std::string&amp; ime, long long int jmbg)
    {
        _ime = ime;
        dodaj_u_listu(jmbg);
        _pol = DajPol();
    }
    
    GradjaninBiH(const std::string&amp; ime, int d, int m, int g, int sr, Pol p);
    
    void PromijeniImeIPrezime(const std::string&amp; s)
    {
        _ime = s;
    }
    
    
    std::string DajImeIPrezime()const
    {
        return _ime;
    }
    
    long long int DajJMBG()const
    {
        return std::stoll(_jmbg);
    }
    
    int DajDanRodjenja()const
    {
        return std::stoi(_jmbg.substr(0, 2));
    }
    
    int DajMjesecRodjenja()const
    {
        return std::stoi(_jmbg.substr(2, 2));
    }
    
    int DajSifruRegije()const
    {
        return std::stoi(_jmbg.substr(7, 2));
    }
    
    Pol DajPol()const
    {
        auto p = std::stoi(_jmbg.substr(9, 3));
        return p &lt; 500 ? Pol::Musko : Pol::Zensko;
    }
    
    int DajGodinuRodjenja()const;
    
    
    ~GradjaninBiH();
};
GradjaninBiH* GradjaninBiH::zadnji = nullptr;

GradjaninBiH::GradjaninBiH(const std::string&amp; ime, int d, int m, int g, int sr, Pol p)
{
    _ime = ime;
    _pol = p;
    kreiraj_jmbg(d, m, g, sr, p);
    if(zadnji == nullptr)
        zadnji = this;
    else{
        prethodni = zadnji;
        zadnji = this;
    }
}

void GradjaninBiH::popravi_kod()
{
    if(_jmbg[11] == '9')
    {
        _jmbg[11] = '0';
        auto a = u_cifru(_jmbg[10]);
        ++a;
        if(a == 10)
        {
            _jmbg = '0';
            _jmbg[9] = u_cifru(_jmbg[9]) + 1 + '0';
        }
        else
            _jmbg[10] = a + '0';
    }
    else 
        _jmbg[11] = u_cifru(_jmbg[11]) + 1 + '0';
}

void GradjaninBiH::kod_gradjana()
{
    OPET:
    for(auto pok = zadnji; pok != nullptr; pok = pok-&gt;prethodni)
    {
        if(this == pok)
            continue;
        if(_jmbg == pok-&gt;_jmbg.substr(0, 12))
        {
            popravi_kod();
            goto OPET;
        }
            
    }
}

void GradjaninBiH::kreiraj_jmbg(int d, int m, int g, int sr, Pol p)
{
    int broj_dana[]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    if((g % 4 == 0 &amp;&amp; g % 100 != 0) || g % 400 == 0)
        ++broj_dana[1]; 
    if(d &lt; 1 || m &lt; 1 || g &lt; 1 || m &gt; 12 || d &gt; broj_dana[m - 1])
        throw std::logic_error("Neispravni podaci");
    if(sr &lt; 0 || sr &gt; 99)
        throw std::logic_error("Neispravni podaci");
    if(g &gt; 2017 || g &lt;= 1017)
        throw std::logic_error("Neispravni podaci");
    
    if(d &lt; 10)
        _jmbg = "0" + std::to_string(d);
    else
        _jmbg = std::to_string(d);
    if(m &lt; 10)
        _jmbg += "0" + std::to_string(m);
    else
        _jmbg += std::to_string(m);
    
    _jmbg += std::to_string(g).substr(1, 3) + std::to_string(sr);

    if(p == Pol::Musko)
        _jmbg += "000";
    else
        _jmbg += "500";
    
    kod_gradjana();
    
     auto c13 = 11 - (7 * (u_cifru(_jmbg[0]) + u_cifru(_jmbg[6]))  + 6 * (u_cifru(_jmbg[1]) + u_cifru(_jmbg[7])) + 
                     5 * (u_cifru(_jmbg[2]) + u_cifru(_jmbg[8]))  + 4 * (u_cifru(_jmbg[3]) + u_cifru(_jmbg[9])) +
                     3 * (u_cifru(_jmbg[4]) + u_cifru(_jmbg[10])) + 2 * (u_cifru(_jmbg[5]) + u_cifru(_jmbg[11])) ) % 11;
    if(c13 == 10)
        throw std::logic_error("Neispravni podaci");
    if(c13 == 11)
        _jmbg += std::to_string(0);   
    else
        _jmbg += std::to_string(c13);
}

GradjaninBiH::~GradjaninBiH()
{
    // ako brisem zadnji
    if(this == zadnji)
        zadnji = this-&gt;prethodni;
    else if(prethodni == nullptr) //ako brisem prvi
    {
        auto q = zadnji-&gt;prethodni, p = zadnji;
        while( q != nullptr)
        {
            p = p-&gt;prethodni;
            q = q-&gt;prethodni;
        }
        p-&gt;prethodni = nullptr;
    }
    else //brisem ostale
    {
        auto q = zadnji-&gt;prethodni, p = zadnji;
        while( q != this)
        {
            p = p-&gt;prethodni;
            q = q-&gt;prethodni;
        }
        p-&gt;prethodni = this-&gt;prethodni;
    }
}

void GradjaninBiH::dodaj_u_listu(long long int jmbg)
{
    if(!provjera_jmbg(jmbg))
        throw std::logic_error("JMBG nije validan");
    if(da_li_vec_postoji())
        throw std::logic_error("Vec postoji gradjanin sa istim JMBG");
        
    if(zadnji == nullptr)
        zadnji = this;
    else{
        prethodni = zadnji;
        zadnji = this;
    }
}

int GradjaninBiH::DajGodinuRodjenja()const
{
    auto b =  std::stoi(_jmbg.substr(4, 3));;
    if(b &lt;= 17 &amp;&amp; b &gt;= 10)
        return std::stoll("20" + std::to_string(b));
    if(b &gt;= 0 &amp;&amp; b &lt; 10)
        return std::stoll("200" + std::to_string(b));
    if(b &gt; 17 &amp;&amp; b &lt;= 99)
        return std::stoll("10" + std::to_string(b));
    return std::stoll("1" + std::to_string(b));
}


bool GradjaninBiH::da_li_vec_postoji()
{
    for(auto pok = zadnji; pok != nullptr; pok = pok-&gt;prethodni)
    {
        if(this == pok)
            continue;
        if(_jmbg == pok-&gt;_jmbg)
            return true;
    }
    return false;
}

bool GradjaninBiH::provjera_jmbg(long long int jmbg)
{
    if(jmbg &lt; 0)
        return false;

    if( int (std::log10(jmbg)) + 1 == 12  )
        _jmbg = "0" + std::to_string(jmbg);
    else
        _jmbg = std::to_string(jmbg);

    if(_jmbg.size() != 13U)
        return false;
    
    int d = DajDanRodjenja();
    int m = DajMjesecRodjenja();
    int g = DajGodinuRodjenja();
    
    int broj_dana[]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    if((g % 4 == 0 &amp;&amp; g % 100 != 0) || g % 400 == 0)
        ++broj_dana[1]; 
    if(d &lt; 1 || m &lt; 1 || g &lt; 1 || m &gt; 12 || d &gt; broj_dana[m - 1])
        return false;
    if(g &gt; 2017 || g &lt;= 1017)
        return false;
    auto c13 = 11 - (7 * (u_cifru(_jmbg[0]) + u_cifru(_jmbg[6]))  + 6 * (u_cifru(_jmbg[1]) + u_cifru(_jmbg[7])) + 
                     5 * (u_cifru(_jmbg[2]) + u_cifru(_jmbg[8]))  + 4 * (u_cifru(_jmbg[3]) + u_cifru(_jmbg[9])) +
                     3 * (u_cifru(_jmbg[4]) + u_cifru(_jmbg[10])) + 2 * (u_cifru(_jmbg[5]) + u_cifru(_jmbg[11])) ) % 11;
    if(c13 == 10)
        return false;
    if(c13 == 11)
        return _jmbg[12] == '0';
     
    return c13 == u_cifru(_jmbg[12]);
}

int main ()
{
    std::cout &lt;&lt; "Koliko gradjana zelite unijeti po JMBG? \n";
    int br_gradjana;
    std::cin &gt;&gt; br_gradjana;
    std::cin.ignore(1000, '\n');
    for(int i = 0; i &lt; br_gradjana; ++i)
    {
        std::cout &lt;&lt; "Unesite ime i prezime (u istom redu): \n";
        std::string ime;
        std::getline(std::cin, ime);
        long long int j;
        std::cout &lt;&lt; "Unesite JMBG: \n";
        std::cin &gt;&gt; j;
        std::cin.ignore(1000, '\n');
        try {
            GradjaninBiH g (ime, j);
            std::cout &lt;&lt; "Unijeli ste gradjanina " &lt;&lt; g.DajImeIPrezime() &lt;&lt; " rodjenog "
                &lt;&lt; g.DajDanRodjenja() &lt;&lt; "." &lt;&lt; g.DajMjesecRodjenja() &lt;&lt; "." &lt;&lt; g.DajGodinuRodjenja()
                &lt;&lt; " u regiji " &lt;&lt; g.DajSifruRegije() &lt;&lt; ", " 
                &lt;&lt; (g.DajPol() == GradjaninBiH::Pol::Musko ? "musko." : "zensko.") &lt;&lt; '\n';
        }
        catch (std::logic_error e) {
            std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
            --i;
        }
    }
    std::cout &lt;&lt; "Koliko gradjana zelite unijeti po datumu rodjenja, regiji i polu? \n";
    std::cin &gt;&gt; br_gradjana;
    std::cin.ignore(1000, '\n');
    for(int i = 0; i &lt; br_gradjana; ++i)
    {
        std::cout &lt;&lt; "Unesite ime i prezime (u istom redu): \n";
        std::string ime;
        std::getline(std::cin, ime);    
        std::cout &lt;&lt; "Unesite datum rodjenja (format dd/mm/gggg): \n";
        char znak;
        int d, m, go;
        std::cin &gt;&gt; d &gt;&gt; znak &gt;&gt; m &gt;&gt; znak &gt;&gt; go;
        std::cout &lt;&lt; "Unesite sifru regije: \n";
        int sr;
        std::cin &gt;&gt; sr;
        std::cout &lt;&lt; "Unesite M za musko, Z za zensko: \n";
        std::cin &gt;&gt; znak;
        std::cin.ignore(1000, '\n');
        try {
            GradjaninBiH g (ime, d, m, go, sr, (znak == 'M' ? GradjaninBiH::Pol::Musko : GradjaninBiH::Pol::Zensko));
            std::cout &lt;&lt; "Unijeli ste gradjanina " &lt;&lt; g.DajImeIPrezime() &lt;&lt; " JMBG: "
                        &lt;&lt; g.DajJMBG() &lt;&lt; ".\n";
        }
        catch (std::logic_error e) {
            std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
            --i;
</font>        }
        
    }
	return 0;
}</pre>
</body>
</html>
