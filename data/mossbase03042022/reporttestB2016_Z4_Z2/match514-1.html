<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z4/Z2/student1364.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z4/Z2/student9673.cpp<p></p><pre>
<a name="4"></a><font color="#FF00FF"><a href="match514-0.html#4" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_1.gif"/></a>

/B 2016/2017, ZadaÄ‡a 4, Zadatak 2
//Napomena: testovi ce biti dostupni dan pred rok!
#include &lt;iostream&gt;
#include &lt;stdexcept&gt;
#include &lt;string&gt;
#include &lt;new&gt;

using std::cin;
using std::cout;
using std::endl;
</font>
struct Datum {
    int dan = 0, mjesec = 0, godina = 0;
                                                                                // prekopirano sa predavanja 9_a
    void Postavi(int d, int m, int g);
    int DajDan(){ return dan; };
    int DajMjesec(){ return mjesec; };
    int DajGodinu(){ return godina; };
};

<a name="1"></a><font color="#00FF00"><a href="match514-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_1.gif"/></a>

void Datum::Postavi(int dan, int mjesec, int godina) {
    int broj_dana[12]{31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
</font>    if((godina % 4 == 0 and godina % 100 != 0) or godina % 400 == 0) broj_dana[1]++;
    if(godina &lt; 1 or dan &lt; 1 or mjesec &lt; 1 or mjesec &gt; 12 or dan &gt; broj_dana[mjesec - 1]) throw std::domain_error("Neispravan datum!");
    Datum::dan = dan; Datum::mjesec = mjesec; Datum::godina = godina;
}

int Cifra13(int c[]){
    return 11 - (7*(c[0]+c[6]) + 6*(c[1]+c[7]) + 5*(c[2]+c[8]) + 4*(c[3]+c[9]) + 3*(c[4]+c[10]) + 2*(c[5]+c[11]))% 11;
}


class GradjaninBiH{
    std::string ime_i_prezime;
    int jmbg[13]{}, sifra_regije;                                               // uvijek broji od 1  - &gt; c1 = jmbg[0] !!!
    Datum dat_rodjenja;
    
public:
    static GradjaninBiH* zadnji;
    GradjaninBiH *prosli = nullptr;                                                         // veza u listi
    enum Pol {Musko, Zensko} pol;

    
<a name="0"></a><font color="#FF0000"><a href="match514-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_2.gif"/></a>

    GradjaninBiH(std::string ime_i_prezime, long long int jmbg);
    GradjaninBiH(std::string ime_i_prezime, int dan_rodjenja, int mjesec_rodjenja,
        int godina_rodjenja, int sifra_regije, Pol pol);                                                // konstruktori i 
    GradjaninBiH(const GradjaninBiH &amp;g) =delete;                                                        // zabrana na dodjelu/ kopiranje
    GradjaninBiH &amp;operator=(const GradjaninBiH &amp;g) =delete;                                                     
    ~GradjaninBiH();                                                                                    // destruktor            

    std::string DajImeIPrezime() const{ return ime_i_prezime; }
</font>    int DajDanRodjenja() const { return dat_rodjenja.dan; }
    int DajMjesecRodjenja() const { return dat_rodjenja.mjesec;}
    int DajGodinuRodjenja() const { return dat_rodjenja.godina; }
    int DajSifruRegije() const { return sifra_regije; }
    long long int DajJMBG() const;
    Pol DajPol() const { return pol;}
    void PromijeniImeIPrezime(std::string novo_ime){ ime_i_prezime = novo_ime; }
};

GradjaninBiH* GradjaninBiH::zadnji = nullptr;               // inicijalizacija staticke varijable klase

GradjaninBiH::GradjaninBiH(std::string ime_i_prezime, long long int jmbg){
    for(auto p = zadnji; p != nullptr; p = p -&gt; prosli)
        if(p -&gt; DajJMBG() == jmbg) throw std::logic_error("Vec postoji gradjanin sa istim JMBG");
    
    this -&gt; ime_i_prezime = ime_i_prezime;
    
    int i(0);
    while(jmbg != 0){
        this -&gt; jmbg[12-i] = jmbg%10;
        jmbg/=10;
        i++;
    }

    int dan (this -&gt; jmbg[0] * 10 + this -&gt; jmbg[1]);
    int mjesec (this -&gt; jmbg[2] * 10 + this -&gt; jmbg[3]);
    int godina (this -&gt; jmbg[4] * 100 + this -&gt; jmbg[5] * 10 + this -&gt; jmbg[6]);

    if(this -&gt; jmbg[4] == 0) godina += 2000;
    else godina += 1000;
    if(godina &gt; 2017) throw std::logic_error("JMBG nije validan");

    try{
        dat_rodjenja.Postavi(dan, mjesec, godina);
    }
    catch(std::domain_error e){
        throw std::logic_error("JMBG nije validan");
    }
    int c13(Cifra13(this -&gt; jmbg));
    if(c13 == 11) c13 = 0;
    if(c13 == 10 || c13 != this -&gt; jmbg[12]) throw std::logic_error("JMBG nije validan");

    sifra_regije = this -&gt; jmbg[7] * 10 + this -&gt; jmbg[8];

    int za_pol(this -&gt; jmbg[9] * 100 + this -&gt; jmbg[10] * 10 + this -&gt; jmbg[11]);
    if(za_pol &lt;= 499) pol = Musko;
    else pol = Zensko;
    
    prosli = zadnji;
    zadnji = this;
}

GradjaninBiH::GradjaninBiH(std::string ime_i_prezime, int dan_rodjenja, int mjesec_rodjenja, int godina_rodjenja, int sifra_regije, Pol pol){
    try{
        dat_rodjenja.Postavi(dan_rodjenja, mjesec_rodjenja, godina_rodjenja);
    }
    catch(std::domain_error e){
        throw std::logic_error("Neispravni podaci");
    }
<a name="2"></a><font color="#0000FF"><a href="match514-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_1.gif"/></a>

    if(sifra_regije &lt; 0 or sifra_regije &gt; 99 or godina_rodjenja &gt; 2017 or godina_rodjenja &lt; 1917) throw std::logic_error("Neispravni podaci");
    
    jmbg[0] = dan_rodjenja/10; jmbg[1] = dan_rodjenja%10; jmbg[2] = mjesec_rodjenja/10; jmbg[3] = mjesec_rodjenja%10;
</font>    jmbg[6] = godina_rodjenja%10; godina_rodjenja /= 10;  jmbg[5] = godina_rodjenja%10; godina_rodjenja /= 10; jmbg[4] = godina_rodjenja%10;    // obradi datum
    jmbg[7] = sifra_regije/10;   jmbg[8] = sifra_regije%10;                                                                                     // sifra regije
    if(pol == Musko) jmbg[9] = 0, jmbg[10] = 0, jmbg[11] = 0;
    else jmbg[9] = 5, jmbg[10] = 0, jmbg[11] = 0;       // pol
    
    jmbg[12] = 11 - (7*(jmbg[0]+jmbg[6]) + 6*(jmbg[1]+jmbg[7]) + 5*(jmbg[2]+jmbg[8]) + 4*(jmbg[3]+jmbg[9]) + 3*jmbg[4]+jmbg[10] + 2*(jmbg[5]+jmbg[11]))% 11;
    if(jmbg[12] == 11) jmbg[12] = 0;
    
    
    for(auto p = zadnji; p != nullptr; p = p -&gt; prosli){
        if(pol == p -&gt; DajPol() and sifra_regije == p -&gt; DajSifruRegije() and dan_rodjenja == p -&gt; DajDanRodjenja()
            and mjesec_rodjenja == p -&gt; DajMjesecRodjenja() and godina_rodjenja == p -&gt; DajDanRodjenja()){
            jmbg[12] = p -&gt; jmbg[12] + 1;
            if(jmbg[12] == 10) jmbg[12] = 0;                                                                            // c13 JMBG
        }
    }
    
    this -&gt; sifra_regije = sifra_regije;
    this -&gt; pol = pol;
    this -&gt; ime_i_prezime = ime_i_prezime;
    
    prosli = zadnji;                                                                                                // azuriranje pokazivaca
    zadnji = this;                                                                                                  // povezane liste
}

GradjaninBiH::~GradjaninBiH(){
    auto p(zadnji);
    if(p == this) zadnji = this -&gt; prosli;
    
    if(this -&gt; prosli == nullptr) {
        while(p -&gt; prosli != this &amp;&amp; p -&gt; prosli != nullptr) p = p -&gt; prosli;
        p -&gt; prosli = nullptr;
    }
    
    else{ 
        while(p != nullptr){
            if(p -&gt; prosli == this) p -&gt; prosli = this -&gt; prosli; 
            p = p -&gt; prosli;
        }
    }
}

long long int GradjaninBiH::DajJMBG() const {
    long long int broj(0);
    
    for(int i = 0; i &lt; 13; i++){
        broj *= 10;
        broj += jmbg[i];
    }
    return broj;
}

int main(){
    int n(0), m(0), i(0), brojac(0);
    
    cout &lt;&lt; "Koliko gradjana zelite unijeti po JMBG? " &lt;&lt; endl;
    cin &gt;&gt; n;
    cin.ignore(1000, '\n');

    GradjaninBiH** pok = new GradjaninBiH*[n]{};
    
    while(i != n ){
        std::string i_i_p("");
        long long int jmbg(0);
        
        cout &lt;&lt; "Unesite ime i prezime (u istom redu): " &lt;&lt; endl;
        std::getline(std::cin, i_i_p);
        cout &lt;&lt; "Unesite JMBG: " &lt;&lt; endl;
        cin &gt;&gt; jmbg;
        cin.ignore(1000, '\n');
        
        try{
<a name="3"></a><font color="#00FFFF"><a href="match514-0.html#3" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_1.gif"/></a>

            pok[brojac] = new GradjaninBiH(i_i_p, jmbg);

            cout &lt;&lt; "Unijeli ste gradjanina " &lt;&lt; pok[brojac] -&gt; DajImeIPrezime() &lt;&lt; " rodjenog " &lt;&lt; pok[brojac] -&gt; DajDanRodjenja() &lt;&lt; "." &lt;&lt; pok[brojac] -&gt; DajMjesecRodjenja()
</font>            &lt;&lt; "." &lt;&lt; pok[brojac] -&gt; DajGodinuRodjenja() &lt;&lt; " u regiji " &lt;&lt; pok[brojac] -&gt; DajSifruRegije() &lt;&lt; ", ";
            auto pol(pok[brojac] -&gt; DajPol());
            if(pol == GradjaninBiH::Musko) cout &lt;&lt; "musko." &lt;&lt; endl;
            else cout &lt;&lt; "zensko." &lt;&lt; endl;
            
            brojac++;
            i++;
        }
        catch(std::logic_error e){
            cout &lt;&lt; e.what() &lt;&lt; endl;
        }
        catch(std::bad_alloc){
            for(int i = 0; i &lt; n; i++) delete pok[i];
            delete[] pok;
            return 0;
        }
    }
    
    cout &lt;&lt; "Koliko gradjana zelite unijeti po datumu rodjenja, regiji i polu? " &lt;&lt; endl;
    cin &gt;&gt; m;
    
    GradjaninBiH **p;
    try{
        p = new GradjaninBiH* [n+m]{};
        for(int i = 0; i &lt; n; i++) p[i] = pok[i];
    }
    catch(...){
        delete[] p;
        delete[] pok;
        p[0] -&gt; ~GradjaninBiH();
        return 0;
    }
                                                                                        // alociraj novi  - &gt; stari nema dovoljno kapaciteta
    cin.ignore(1000, '\n');
    
    i = 0;
    while(i != m){
        std::string i_i_p("");
        int d(0), m(0), g(0), sifra(0);
        char znak, pol;
        
        cout &lt;&lt; "Unesite ime i prezime (u istom redu): " &lt;&lt; endl;
        std::getline(std::cin, i_i_p);
        
        cout &lt;&lt; "Unesite datum rodjenja (format dd/mm/gggg): " &lt;&lt; endl;
        cin &gt;&gt; d &gt;&gt; znak &gt;&gt; m &gt;&gt; znak &gt;&gt; g;
        
        cout &lt;&lt; "Unesite sifru regije: " &lt;&lt; endl;
        cin &gt;&gt; sifra;
        
        cout &lt;&lt; "Unesite M za musko, Z za zensko: " &lt;&lt; endl;
        cin &gt;&gt; pol;
        
        try{
            if(pol == 'M'){
                p[brojac] = new GradjaninBiH (i_i_p, d, m, g, sifra, GradjaninBiH::Musko);
                cout &lt;&lt; "Unijeli ste gradjanina " &lt;&lt; p[brojac] -&gt; DajImeIPrezime() &lt;&lt; " JMBG: " &lt;&lt; p[brojac] -&gt; DajJMBG() &lt;&lt; "." &lt;&lt; endl;
            }
            else if(pol == 'Z'){
                p[brojac] = new GradjaninBiH (i_i_p, d, m, g, sifra, GradjaninBiH::Zensko);
<a name="5"></a><font color="#FF0000"><a href="match514-0.html#5" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_1.gif"/></a>

                cout &lt;&lt; "Unijeli ste gradjanina " &lt;&lt;  p[brojac] -&gt; DajImeIPrezime() &lt;&lt; " JMBG: " &lt;&lt; p[brojac] -&gt; DajJMBG() &lt;&lt; "." &lt;&lt; endl; 
            }
            i++; 
</font>            brojac++;
        }
        catch(std::logic_error e){
            cout &lt;&lt; e.what() &lt;&lt; endl;
        }
        catch(std::bad_alloc){
            p[0] -&gt; ~GradjaninBiH();
            delete []p;
            delete []pok;
        }
        cin.ignore(1000, '\n');
    }
    delete []p;
    delete []pok;
    return 0;
} </pre>
</body>
</html>
