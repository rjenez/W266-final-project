<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z2/Z4/student2553.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z2/Z4/student4425.cpp<p></p><pre>
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;vector&gt;
#include &lt;algorithm&gt;
//
void deallocate(char** niz, int vel) {
    for (int i = 0; i &lt; vel; i++) delete[] niz[i];
    delete[] niz;
}

int PotencijalniKrivci(char**&amp; niz, std::vector&lt;std::string&gt; imena) {
    char** novi_niz(nullptr);
    int i(0);
    try {
        novi_niz = new char*[imena.size()];
        try {
            for(i = 0; i &lt; imena.size(); i++) novi_niz[i] = nullptr;
            for(i = 0; i &lt; imena.size(); i++) {
                novi_niz[i] = new char[imena[i].size()+1]; //+1 za null graničnik
                std::copy(imena[i].begin(), imena[i].end(), novi_niz[i]);
                novi_niz[i][imena[i].size()] = '\0';
            }
            niz = novi_niz;
        } catch (...) {
            for (int j = i-1; j &gt;= 0; j--) delete[] novi_niz[i];
            throw;
        }
    } catch (...) {
        delete[] novi_niz;
        throw;
    }
    
    return imena.size();
}

int OdbaciOptuzbu (char**&amp; niz, int vel, std::string innocent) {
    
    int i(0);
    for (i = 0; i &lt; vel; i++) {
        if (niz[i]!=nullptr) {
            std::string ime = std::string(niz[i]);
            if (ime == innocent) break;
        }
    }
    if (i==vel) {
        std::string err_msg = "Osoba sa imenom "; err_msg+=innocent; err_msg+=std::string(" nije bila optuzena");
        throw std::domain_error(err_msg);
    }
    
    static int nullpok_num(0);
    for (i = 0; i &lt; vel; i++) {
        if (niz[i]!=nullptr) {
            std::string ime = std::string(niz[i]);
            if (ime == innocent) {
                delete[] niz[i];
                niz[i] = nullptr;
                nullpok_num++;
                break;
            }
        }
    }
    
    if (nullpok_num &gt; 10) {
        
        int nova_vel(0);
        //prebroji stvarni broj osoba u spisku
        for (i = 0; i &lt; vel; i++) {
            if (niz[i] != nullptr) nova_vel++;
        }
        
        char** novi_niz(nullptr);
        try {
            novi_niz = new char*[nova_vel];
            int tmp_index(0);
            for (i = 0; i &lt; vel; i++) {
                if (niz[i]!=nullptr) {
                    novi_niz[tmp_index] = niz[i];
                    tmp_index++;
                }
            }
            delete[] niz;
            niz = novi_niz;
            nullpok_num = 0;
            return nova_vel;
        } catch(...) {
            delete[] novi_niz;
            goto no_alloc;
        }
        
    }
    
    no_alloc:
    return vel;
}

int DodajOptuzbu(char**&amp; niz, int vel, std::string suspect) {
    
    char* osumnjiceni(nullptr);
    try {
        osumnjiceni = new char[suspect.length()+1];
        std::copy(suspect.begin(), suspect.end(), osumnjiceni);
        osumnjiceni[suspect.length()] = '\0';
    } catch (...) {
        delete[] osumnjiceni;
        throw;
    }
    
    for (int i = 0; i &lt; vel; i++) {
        if (niz[i] == nullptr) {
            niz[i] = osumnjiceni;
            return vel;
        }
    }
    
    char** novi_niz(nullptr);
    try {
        novi_niz = new char*[vel+1];
        for (int i = 0; i &lt; vel; i++) {
            novi_niz[i] = niz[i];
        }
        novi_niz[vel] = osumnjiceni;
        
        delete[] niz;
        niz = novi_niz;
        vel++;
        return vel;
        
    } catch (...) {
        delete[] novi_niz;
        throw;
    }
    
}

void IzlistajOptuzbu(char** niz, int vel) {
    for (int i = 0; i &lt; vel; i++) {
        if (niz[i] == nullptr) continue;
<a name="3"></a><font color="#00FFFF"><a href="match421-0.html#3" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_2.gif"/></a>

        else std::cout &lt;&lt; niz[i] &lt;&lt; std::endl;
    }
}

int main () {

    std::cout &lt;&lt; "Koliko potencijalnih krivaca zelite unijeti? " &lt;&lt; std::endl;
    int n;
</font><a name="0"></a><font color="#FF0000"><a href="match421-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_6.gif"/></a>

    std::cin &gt;&gt; n;
    std::cin.ignore(10000, '\n');
    
    std::cout &lt;&lt; "Unesite potencijalne krivce: " &lt;&lt; std::endl;
    std::vector&lt;std::string&gt; imena(n);
    for (int i = 0; i &lt; n; i++) {
        std::string tmp;
        std::getline(std::cin, tmp);
        imena[i] = tmp;
</font>    }
    
    char** niz(nullptr);
    int vel(0);
    try {
        vel = PotencijalniKrivci(niz, imena);
    } catch (...) {
        //deallocate(niz, vel);
        std::cout &lt;&lt; "Nedovoljno memorije!";
        //return 0; - uključi ovo sutra u slučaju da ne prođe?
    }
    
    //std::vector&lt;std::string&gt; imena{"1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15"};
    //vel = PotencijalniKrivci(niz, imena);
    while (1) {
        
        std::cout &lt;&lt; "Odaberite opciju: 1 za unos novog optuzenog, 2 za brisanje nekog optuzenog 3 za izlistavanje optuzenih, 0 za kraj: " &lt;&lt; std::endl;
        int command;
        std::cin &gt;&gt; command;
        
        if (command == 0) {
            deallocate(niz, vel);
            break;
        }
        if (command==1) {
                std::cin.ignore(10000, '\n');
<a name="2"></a><font color="#0000FF"><a href="match421-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_3.gif"/></a>

                std::cout &lt;&lt; "Unesite ime novog optuzenog: " &lt;&lt; std::endl;
                std::string tmp2;
                std::getline(std::cin, tmp2);
                try {
                    vel = DodajOptuzbu(niz, vel, tmp2);
                } catch (...) {
</font>                    //uhvati bad_alloc al' nije rečeno šta uraditi s njim
                }
                continue;
        } else if (command==2) { 
                std::cin.ignore(10000, '\n');
<a name="1"></a><font color="#00FF00"><a href="match421-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_5.gif"/></a>

                std::cout &lt;&lt; "Unesite ime koje zelite izbaciti: " &lt;&lt; std::endl;
                std::string tmp3;
                std::getline(std::cin, tmp3);
                try {
                    vel = OdbaciOptuzbu(niz, vel, tmp3);
                } catch (std::domain_error err) { 
                    std::cout &lt;&lt; err.what() &lt;&lt; std::endl;
</font>                }
                continue;
        } else if (command==3) {
                IzlistajOptuzbu(niz, vel);
                continue;
        } else {
                std::cout &lt;&lt; "YOU FORGOT STH!" &lt;&lt; std::endl;
                break;
        }
    }
    
	return 0;
}</pre>
</body>
</html>
