<html>
<head>
<title>../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z2/Z4/student7810.cpp</title>
</head>
<body bgcolor="white">
<hr/>
../../data/programming-homework-dataset-plagiarism-detection/src/B2016/Z2/Z4/student4195.cpp<p></p><pre>
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;cstring&gt;
#include &lt;vector&gt;
#include &lt;stdexcept&gt;
#include &lt;cstdlib&gt;

using namespace std;

int PotencijalniKrivci(char** &amp;pok,vector&lt;string&gt; imena){
    char** alocirani(nullptr);
    int size(0),br(0);
    for(int i=0; i&lt;imena.size(); i++) size++;
    if(imena.size()==0) return 0;
    try{
<a name="2"></a><font color="#0000FF"><a href="match608-0.html#2" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_2_3.gif"/></a>

        alocirani=new char*[imena.size()];
        for(int i=0; i&lt;imena.size(); i++) alocirani[i]=nullptr;
        try{
            for(int i=0; i&lt;imena.size(); i++){
</font>                if(imena.at(i).size()==0) continue; //Preskoci eventualno prazne stringove
                alocirani[br]=new char[imena.at(i).size()+1](); //Inicijalizacija na nulu, tj \0
                strcpy(alocirani[br],imena.at(i).c_str());
                br++;
            }
            pok=alocirani;
        }
        catch(bad_alloc){
            for(int i=0; i&lt;imena.size(); i++) delete[] alocirani[i];
            throw;
        }
    }
    catch(bad_alloc){
        delete[] alocirani;
        throw;
    }
    return br;
}

<a name="3"></a><font color="#00FFFF"><a href="match608-0.html#3" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_3_3.gif"/></a>

int OdbaciOptuzbu(char** &amp;pok, int broj_alociranih, string ime){
    bool ima(false);
    for(int i=0; i&lt;broj_alociranih; i++){
        if(!strcmp(pok[i],ime.c_str())){
</font>            ima=true;
            delete[] pok[i];
            pok[i]=nullptr;
            break;
        }
    }
    if(!ima) throw domain_error("Osoba sa imenom "+ime+" nije bila optuzena");
    int brojac(0);
    for(int i=0; i&lt;broj_alociranih; i++){
        if(pok[i]==nullptr) brojac++;
    }
    char **pok2=nullptr;
    try{
        if(brojac&gt;10){
            pok2 = new char*[broj_alociranih-brojac]; //Ako ovdje ne uspije, idemo na prazni catch - nema se sta brisat
            int br(0);
            for(int i=0; i&lt;broj_alociranih; i++){
                if(pok[i]!=nullptr){
                    pok2[br]=pok[i];
                    pok[i]=nullptr;
                    br++;
                }
                delete[] pok[i];
            }
            delete[] pok;
            pok=pok2;
            return broj_alociranih-brojac;
        }
    }
    catch(bad_alloc){
            //Nemam sta brisati, jedna alokacija ima, ako nije uspjela, nije se nista alociralo svakako
    }
    return broj_alociranih;
}

int DodajOptuzbu(char** &amp;pok, int broj_alociranih, string ime){
    bool ima(false);
<a name="0"></a><font color="#FF0000"><a href="match608-0.html#0" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_0_4.gif"/></a>

    try{
        for(int i=0; i&lt;broj_alociranih; i++){
            if(pok[i]==nullptr){
                ima=true;
                pok[i]=new char[ime.size()+1]();
                strcpy(pok[i],ime.c_str());
</font>                break;
            }
        }
    }
    catch(bad_alloc) {
        return broj_alociranih;
    }
    if(!ima){
        char** pok2=nullptr;
        try{
            pok2=new char*[broj_alociranih+1];
            pok2[broj_alociranih]=nullptr; //Jedina alokacija koja ce se izvrsit
            pok2[broj_alociranih]=new char[ime.size()+1]();
            strcpy(pok2[broj_alociranih],ime.c_str());
            for(int i=0; i&lt;broj_alociranih; i++) pok2[i]=pok[i];
            delete[] pok;
            pok=pok2;
            return broj_alociranih+1;

        }
        catch(bad_alloc){
            delete[] pok2;
            throw;
        }
    }
<a name="4"></a><font color="#FF00FF"><a href="match608-0.html#4" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_4_3.gif"/></a>

    return broj_alociranih;

}

void IzlistajOptuzbu(char** pok, int broj_alociranih){
    for(int i=0; i&lt;broj_alociranih; i++){
        if(pok[i]==nullptr) continue;
</font>        for(int j=0; pok[i][j]!=0; j++) cout&lt;&lt;pok[i][j];
        cout&lt;&lt;endl;
    }
}


int main(){
	int broj_krivaca;
	cout&lt;&lt;"Koliko potencijalnih krivaca zelite unijeti? "&lt;&lt;endl;
	cin&gt;&gt;broj_krivaca;
	cin.ignore(10000,'\n');
<a name="1"></a><font color="#00FF00"><a href="match608-0.html#1" target="0"><img align="left" alt="other" border="0" src="http://moss.stanford.edu/bitmaps/tm_1_4.gif"/></a>

	vector&lt;string&gt; Imena(broj_krivaca);
	cout&lt;&lt;"Unesite potencijalne krivce: "&lt;&lt;endl;
	for(int i=0; i&lt;broj_krivaca; i++) getline(cin,Imena[i]);
	char**pok;
</font>	int broj_alociranih;
	try{
	    broj_alociranih=PotencijalniKrivci(pok,Imena);
		int opcija;
	    do{
	        cout&lt;&lt;"Odaberite opciju: 1 za unos novog optuzenog, 2 za brisanje nekog optuzenog 3 za izlistavanje optuzenih, 0 za kraj: "&lt;&lt;endl;
	        cin&gt;&gt;opcija;
	        cin.ignore(10000,'\n');
	        switch(opcija){
	            case 1:{
	                cout&lt;&lt;"Unesite ime novog optuzenog: "&lt;&lt;endl;
	                string ime; getline(cin,ime); broj_alociranih=DodajOptuzbu(pok,broj_alociranih,ime); break;
	            }
	            case 2:{
	                cout&lt;&lt;"Unesite ime koje zelite izbaciti: "&lt;&lt;endl;
	                try{
	                    string ime; getline(cin,ime); broj_alociranih=OdbaciOptuzbu(pok,broj_alociranih,ime); break;
	                }
	                catch(domain_error e){
	                    cout&lt;&lt;e.what()&lt;&lt;endl;
	                }
	                
	            }
	            case 3:{
	                IzlistajOptuzbu(pok,broj_alociranih); break;
	            }
	            case 0: break;
	
	        }
		}
		while(opcija!=0);
		for(int i=0; i&lt;broj_alociranih; i++) delete[] pok[i];
		delete[] pok;
	}
	catch(bad_alloc){
	    cout&lt;&lt;"Neuspjela alokacija!"&lt;&lt;endl; 
	}
    return 0;

}
</pre>
</body>
</html>
